(function(){const a=document.createElement("link").relList;if(a&&a.supports&&a.supports("modulepreload"))return;for(const T of document.querySelectorAll('link[rel="modulepreload"]'))m(T);new MutationObserver(T=>{for(const S of T)if(S.type==="childList")for(const L of S.addedNodes)L.tagName==="LINK"&&L.rel==="modulepreload"&&m(L)}).observe(document,{childList:!0,subtree:!0});function l(T){const S={};return T.integrity&&(S.integrity=T.integrity),T.referrerPolicy&&(S.referrerPolicy=T.referrerPolicy),T.crossOrigin==="use-credentials"?S.credentials="include":T.crossOrigin==="anonymous"?S.credentials="omit":S.credentials="same-origin",S}function m(T){if(T.ep)return;T.ep=!0;const S=l(T);fetch(T.href,S)}})();function mr(){}const dd=f=>f;function Mo(f,a){for(const l in a)f[l]=a[l];return f}function hd(f){return f()}function ff(){return Object.create(null)}function yn(f){f.forEach(hd)}function Rs(f){return typeof f=="function"}function Ii(f,a){return f!=f?a==a:f!==a||f&&typeof f=="object"||typeof f=="function"}let Ao;function Vn(f,a){return Ao||(Ao=document.createElement("a")),Ao.href=a,f===Ao.href}function _0(f){return Object.keys(f).length===0}function pd(f,...a){if(f==null)return mr;const l=f.subscribe(...a);return l.unsubscribe?()=>l.unsubscribe():l}function oi(f,a,l){f.$$.on_destroy.push(pd(a,l))}function _u(f,a,l,m){if(f){const T=gd(f,a,l,m);return f[0](T)}}function gd(f,a,l,m){return f[1]&&m?Mo(l.ctx.slice(),f[1](m(a))):l.ctx}function Tu(f,a,l,m){if(f[2]&&m){const T=f[2](m(l));if(a.dirty===void 0)return T;if(typeof T=="object"){const S=[],L=Math.max(a.dirty.length,T.length);for(let I=0;I<L;I+=1)S[I]=a.dirty[I]|T[I];return S}return a.dirty|T}return a.dirty}function bu(f,a,l,m,T,S){if(T){const L=gd(a,l,m,S);f.p(L,T)}}function Su(f){if(f.ctx.length>32){const a=[],l=f.ctx.length/32;for(let m=0;m<l;m++)a[m]=-1;return a}return-1}function T0(f){const a={};for(const l in f)l[0]!=="$"&&(a[l]=f[l]);return a}function df(f,a){const l={};a=new Set(a);for(const m in f)!a.has(m)&&m[0]!=="$"&&(l[m]=f[m]);return l}function b0(f){return f&&Rs(f.destroy)?f.destroy:mr}const vd=typeof window<"u";let md=vd?()=>window.performance.now():()=>Date.now(),Lu=vd?f=>requestAnimationFrame(f):mr;const Ls=new Set;function yd(f){Ls.forEach(a=>{a.c(f)||(Ls.delete(a),a.f())}),Ls.size!==0&&Lu(yd)}function Ed(f){let a;return Ls.size===0&&Lu(yd),{promise:new Promise(l=>{Ls.add(a={c:f,f:l})}),abort(){Ls.delete(a)}}}function Le(f,a){f.appendChild(a)}function _d(f){if(!f)return document;const a=f.getRootNode?f.getRootNode():f.ownerDocument;return a&&a.host?a:f.ownerDocument}function S0(f){const a=Oe("style");return L0(_d(f),a),a.sheet}function L0(f,a){return Le(f.head||f,a),a.sheet}function vt(f,a,l){f.insertBefore(a,l||null)}function pt(f){f.parentNode&&f.parentNode.removeChild(f)}function Yi(f,a){for(let l=0;l<f.length;l+=1)f[l]&&f[l].d(a)}function Oe(f){return document.createElement(f)}function hf(f){return document.createElementNS("http://www.w3.org/2000/svg",f)}function ur(f){return document.createTextNode(f)}function yt(){return ur(" ")}function Wo(){return ur("")}function nr(f,a,l,m){return f.addEventListener(a,l,m),()=>f.removeEventListener(a,l,m)}function _e(f,a,l){l==null?f.removeAttribute(a):f.getAttribute(a)!==l&&f.setAttribute(a,l)}function pf(f,a){const l=Object.getOwnPropertyDescriptors(f.__proto__);for(const m in a)a[m]==null?f.removeAttribute(m):m==="style"?f.style.cssText=a[m]:m==="__value"?f.value=f[m]=a[m]:l[m]&&l[m].set?f[m]=a[m]:_e(f,m,a[m])}function A0(f){return Array.from(f.childNodes)}function Ar(f,a){a=""+a,f.data!==a&&(f.data=a)}function lt(f,a,l,m){l===null?f.style.removeProperty(a):f.style.setProperty(a,l,m?"important":"")}function gf(f,a,l){f.classList[l?"add":"remove"](a)}function Td(f,a,{bubbles:l=!1,cancelable:m=!1}={}){const T=document.createEvent("CustomEvent");return T.initCustomEvent(f,l,m,a),T}const xo=new Map;let No=0;function w0(f){let a=5381,l=f.length;for(;l--;)a=(a<<5)-a^f.charCodeAt(l);return a>>>0}function R0(f,a){const l={stylesheet:S0(a),rules:{}};return xo.set(f,l),l}function uu(f,a,l,m,T,S,L,I=0){const k=16.666/m;let x=`{
`;for(let K=0;K<=1;K+=k){const V=a+(l-a)*S(K);x+=K*100+`%{${L(V,1-V)}}
`}const U=x+`100% {${L(l,1-l)}}
}`,O=`__svelte_${w0(U)}_${I}`,E=_d(f),{stylesheet:A,rules:w}=xo.get(E)||R0(E,f);w[O]||(w[O]=!0,A.insertRule(`@keyframes ${O} ${U}`,A.cssRules.length));const te=f.style.animation||"";return f.style.animation=`${te?`${te}, `:""}${O} ${m}ms linear ${T}ms 1 both`,No+=1,O}function cu(f,a){const l=(f.style.animation||"").split(", "),m=l.filter(a?S=>S.indexOf(a)<0:S=>S.indexOf("__svelte")===-1),T=l.length-m.length;T&&(f.style.animation=m.join(", "),No-=T,No||D0())}function D0(){Lu(()=>{No||(xo.forEach(f=>{const{ownerNode:a}=f.stylesheet;a&&pt(a)}),xo.clear())})}let Ta;function Ea(f){Ta=f}function La(){if(!Ta)throw new Error("Function called outside component initialization");return Ta}function Aa(f){La().$$.on_mount.push(f)}function bd(f){La().$$.on_destroy.push(f)}function Au(){const f=La();return(a,l,{cancelable:m=!1}={})=>{const T=f.$$.callbacks[a];if(T){const S=Td(a,l,{cancelable:m});return T.slice().forEach(L=>{L.call(f,S)}),!S.defaultPrevented}return!0}}function Co(f,a){return La().$$.context.set(f,a),a}function ws(f){return La().$$.context.get(f)}const bs=[],Fr=[];let As=[];const vf=[],Sd=Promise.resolve();let fu=!1;function Ld(){fu||(fu=!0,Sd.then(Kn))}function wo(){return Ld(),Sd}function ui(f){As.push(f)}const lu=new Set;let _s=0;function Kn(){if(_s!==0)return;const f=Ta;do{try{for(;_s<bs.length;){const a=bs[_s];_s++,Ea(a),I0(a.$$)}}catch(a){throw bs.length=0,_s=0,a}for(Ea(null),bs.length=0,_s=0;Fr.length;)Fr.pop()();for(let a=0;a<As.length;a+=1){const l=As[a];lu.has(l)||(lu.add(l),l())}As.length=0}while(bs.length);for(;vf.length;)vf.pop()();fu=!1,lu.clear(),Ea(f)}function I0(f){if(f.fragment!==null){f.update(),yn(f.before_update);const a=f.dirty;f.dirty=[-1],f.fragment&&f.fragment.p(f.ctx,a),f.after_update.forEach(ui)}}function k0(f){const a=[],l=[];As.forEach(m=>f.indexOf(m)===-1?a.push(m):l.push(m)),l.forEach(m=>m()),As=a}let va;function Ad(){return va||(va=Promise.resolve(),va.then(()=>{va=null})),va}function _a(f,a,l){f.dispatchEvent(Td(`${a?"intro":"outro"}${l}`))}const Oo=new Set;let li;function Hn(){li={r:0,c:[],p:li}}function qn(){li.r||yn(li.c),li=li.p}function Gt(f,a){f&&f.i&&(Oo.delete(f),f.i(a))}function tr(f,a,l,m){if(f&&f.o){if(Oo.has(f))return;Oo.add(f),li.c.push(()=>{Oo.delete(f),m&&(l&&f.d(1),m())}),f.o(a)}else m&&m()}const wd={duration:0};function C0(f,a,l){const m={direction:"in"};let T=a(f,l,m),S=!1,L,I,k=0;function x(){L&&cu(f,L)}function U(){const{delay:E=0,duration:A=300,easing:w=dd,tick:te=mr,css:K}=T||wd;K&&(L=uu(f,0,1,A,E,w,K,k++)),te(0,1);const V=md()+E,ne=V+A;I&&I.abort(),S=!0,ui(()=>_a(f,!0,"start")),I=Ed(Y=>{if(S){if(Y>=ne)return te(1,0),_a(f,!0,"end"),x(),S=!1;if(Y>=V){const re=w((Y-V)/A);te(re,1-re)}}return S})}let O=!1;return{start(){O||(O=!0,cu(f),Rs(T)?(T=T(m),Ad().then(U)):U())},invalidate(){O=!1},end(){S&&(x(),S=!1)}}}function Uo(f,a,l,m){const T={direction:"both"};let S=a(f,l,T),L=m?0:1,I=null,k=null,x=null;function U(){x&&cu(f,x)}function O(A,w){const te=A.b-L;return w*=Math.abs(te),{a:L,b:A.b,d:te,duration:w,start:A.start,end:A.start+w,group:A.group}}function E(A){const{delay:w=0,duration:te=300,easing:K=dd,tick:V=mr,css:ne}=S||wd,Y={start:md()+w,b:A};A||(Y.group=li,li.r+=1),I||k?k=Y:(ne&&(U(),x=uu(f,L,A,te,w,K,ne)),A&&V(0,1),I=O(Y,te),ui(()=>_a(f,A,"start")),Ed(re=>{if(k&&re>k.start&&(I=O(k,te),k=null,_a(f,I.b,"start"),ne&&(U(),x=uu(f,L,I.b,I.duration,0,K,S.css))),I){if(re>=I.end)V(L=I.b,1-L),_a(f,I.b,"end"),k||(I.b?U():--I.group.r||yn(I.group.c)),I=null;else if(re>=I.start){const ie=re-I.start;L=I.a+I.d*K(ie/I.duration),V(L,1-L)}}return!!(I||k)}))}return{run(A){Rs(S)?Ad().then(()=>{S=S(T),E(A)}):E(A)},end(){U(),I=k=null}}}const O0=typeof window<"u"?window:typeof globalThis<"u"?globalThis:global;function P0(f,a){const l={},m={},T={$$scope:1};let S=f.length;for(;S--;){const L=f[S],I=a[S];if(I){for(const k in L)k in I||(m[k]=1);for(const k in I)T[k]||(l[k]=I[k],T[k]=1);f[S]=I}else for(const k in L)T[k]=1}for(const L in m)L in l||(l[L]=void 0);return l}function zi(f){f&&f.c()}function ki(f,a,l,m){const{fragment:T,after_update:S}=f.$$;T&&T.m(a,l),m||ui(()=>{const L=f.$$.on_mount.map(hd).filter(Rs);f.$$.on_destroy?f.$$.on_destroy.push(...L):yn(L),f.$$.on_mount=[]}),S.forEach(ui)}function Ci(f,a){const l=f.$$;l.fragment!==null&&(k0(l.after_update),yn(l.on_destroy),l.fragment&&l.fragment.d(a),l.on_destroy=l.fragment=null,l.ctx=[])}function F0(f,a){f.$$.dirty[0]===-1&&(bs.push(f),Ld(),f.$$.dirty.fill(0)),f.$$.dirty[a/31|0]|=1<<a%31}function Qi(f,a,l,m,T,S,L,I=[-1]){const k=Ta;Ea(f);const x=f.$$={fragment:null,ctx:[],props:S,update:mr,not_equal:T,bound:ff(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(a.context||(k?k.$$.context:[])),callbacks:ff(),dirty:I,skip_bound:!1,root:a.target||k.$$.root};L&&L(x.root);let U=!1;if(x.ctx=l?l(f,a.props||{},(O,E,...A)=>{const w=A.length?A[0]:E;return x.ctx&&T(x.ctx[O],x.ctx[O]=w)&&(!x.skip_bound&&x.bound[O]&&x.bound[O](w),U&&F0(f,O)),E}):[],x.update(),U=!0,yn(x.before_update),x.fragment=m?m(x.ctx):!1,a.target){if(a.hydrate){const O=A0(a.target);x.fragment&&x.fragment.l(O),O.forEach(pt)}else x.fragment&&x.fragment.c();a.intro&&Gt(f.$$.fragment),ki(f,a.target,a.anchor,a.customElement),Kn()}Ea(k)}class Xi{$destroy(){Ci(this,1),this.$destroy=mr}$on(a,l){if(!Rs(l))return mr;const m=this.$$.callbacks[a]||(this.$$.callbacks[a]=[]);return m.push(l),()=>{const T=m.indexOf(l);T!==-1&&m.splice(T,1)}}$set(a){this.$$set&&!_0(a)&&(this.$$.skip_bound=!0,this.$$set(a),this.$$.skip_bound=!1)}}function Bo(f,a,l,m,T){try{return fetch("https://vimonial.com/api/events",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({type:f,sId:a,tId:l,pId:m,value:T})})}catch{return}}function Lr(f,a){let l=a.active;return l=="USD"?`$${f}`:l=="EUR"?`${f}€`:l=="GBP"?`£${f}`:l=="CAD"?`$${f} CAD`:`$${f}`}const mf=(f,a)=>{let l=Date.now();return()=>{l+a-Date.now()<=0&&(f(),l=Date.now())}},M0=()=>navigator.userAgent.match(/iphone|ipod|ipad/i)?function(){return window.visualViewport.height||document.height}:function(){return document.documentElement.clientHeight||window.innerHeight};var Ss=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function x0(f){return f&&f.__esModule&&Object.prototype.hasOwnProperty.call(f,"default")?f.default:f}var du={},N0={get exports(){return du},set exports(f){du=f}};(function(f,a){typeof window<"u"&&function(l,m){f.exports=m()}(Ss,()=>(()=>{var l={21:(L,I,k)=>{k.r(I),k.d(I,{default:()=>te});var x=function(){function K(V,ne){this.subtle=void 0,this.aesIV=void 0,this.subtle=V,this.aesIV=ne}return K.prototype.decrypt=function(V,ne){return this.subtle.decrypt({name:"AES-CBC",iv:this.aesIV},ne,V)},K}(),U=function(){function K(V,ne){this.subtle=void 0,this.key=void 0,this.subtle=V,this.key=ne}return K.prototype.expandKey=function(){return this.subtle.importKey("raw",this.key,{name:"AES-CBC"},!1,["encrypt","decrypt"])},K}(),O=k(145),E=function(){function K(){this.rcon=[0,1,2,4,8,16,32,64,128,27,54],this.subMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.invSubMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.sBox=new Uint32Array(256),this.invSBox=new Uint32Array(256),this.key=new Uint32Array(0),this.ksRows=0,this.keySize=0,this.keySchedule=void 0,this.invKeySchedule=void 0,this.initTable()}var V=K.prototype;return V.uint8ArrayToUint32Array_=function(ne){for(var Y=new DataView(ne),re=new Uint32Array(4),ie=0;ie<4;ie++)re[ie]=Y.getUint32(4*ie);return re},V.initTable=function(){var ne=this.sBox,Y=this.invSBox,re=this.subMix,ie=re[0],Z=re[1],N=re[2],W=re[3],me=this.invSubMix,xe=me[0],j=me[1],C=me[2],q=me[3],H=new Uint32Array(256),ye=0,he=0,Ee=0;for(Ee=0;Ee<256;Ee++)H[Ee]=Ee<128?Ee<<1:Ee<<1^283;for(Ee=0;Ee<256;Ee++){var Ae=he^he<<1^he<<2^he<<3^he<<4;Ae=Ae>>>8^255&Ae^99,ne[ye]=Ae,Y[Ae]=ye;var qe=H[ye],je=H[qe],Xe=H[je],Ve=257*H[Ae]^16843008*Ae;ie[ye]=Ve<<24|Ve>>>8,Z[ye]=Ve<<16|Ve>>>16,N[ye]=Ve<<8|Ve>>>24,W[ye]=Ve,Ve=16843009*Xe^65537*je^257*qe^16843008*ye,xe[Ae]=Ve<<24|Ve>>>8,j[Ae]=Ve<<16|Ve>>>16,C[Ae]=Ve<<8|Ve>>>24,q[Ae]=Ve,ye?(ye=qe^H[H[H[Xe^qe]]],he^=H[H[he]]):ye=he=1}},V.expandKey=function(ne){for(var Y=this.uint8ArrayToUint32Array_(ne),re=!0,ie=0;ie<Y.length&&re;)re=Y[ie]===this.key[ie],ie++;if(!re){this.key=Y;var Z=this.keySize=Y.length;if(Z!==4&&Z!==6&&Z!==8)throw new Error("Invalid aes key size="+Z);var N,W,me,xe,j=this.ksRows=4*(Z+6+1),C=this.keySchedule=new Uint32Array(j),q=this.invKeySchedule=new Uint32Array(j),H=this.sBox,ye=this.rcon,he=this.invSubMix,Ee=he[0],Ae=he[1],qe=he[2],je=he[3];for(N=0;N<j;N++)N<Z?me=C[N]=Y[N]:(xe=me,N%Z==0?(xe=H[(xe=xe<<8|xe>>>24)>>>24]<<24|H[xe>>>16&255]<<16|H[xe>>>8&255]<<8|H[255&xe],xe^=ye[N/Z|0]<<24):Z>6&&N%Z==4&&(xe=H[xe>>>24]<<24|H[xe>>>16&255]<<16|H[xe>>>8&255]<<8|H[255&xe]),C[N]=me=(C[N-Z]^xe)>>>0);for(W=0;W<j;W++)N=j-W,xe=3&W?C[N]:C[N-4],q[W]=W<4||N<=4?xe:Ee[H[xe>>>24]]^Ae[H[xe>>>16&255]]^qe[H[xe>>>8&255]]^je[H[255&xe]],q[W]=q[W]>>>0}},V.networkToHostOrderSwap=function(ne){return ne<<24|(65280&ne)<<8|(16711680&ne)>>8|ne>>>24},V.decrypt=function(ne,Y,re){for(var ie,Z,N,W,me,xe,j,C,q,H,ye,he,Ee,Ae,qe=this.keySize+6,je=this.invKeySchedule,Xe=this.invSBox,Ve=this.invSubMix,Ie=Ve[0],He=Ve[1],ce=Ve[2],De=Ve[3],ve=this.uint8ArrayToUint32Array_(re),Be=ve[0],Te=ve[1],ze=ve[2],We=ve[3],$e=new Int32Array(ne),it=new Int32Array($e.length),ue=this.networkToHostOrderSwap;Y<$e.length;){for(q=ue($e[Y]),H=ue($e[Y+1]),ye=ue($e[Y+2]),he=ue($e[Y+3]),me=q^je[0],xe=he^je[1],j=ye^je[2],C=H^je[3],Ee=4,Ae=1;Ae<qe;Ae++)ie=Ie[me>>>24]^He[xe>>16&255]^ce[j>>8&255]^De[255&C]^je[Ee],Z=Ie[xe>>>24]^He[j>>16&255]^ce[C>>8&255]^De[255&me]^je[Ee+1],N=Ie[j>>>24]^He[C>>16&255]^ce[me>>8&255]^De[255&xe]^je[Ee+2],W=Ie[C>>>24]^He[me>>16&255]^ce[xe>>8&255]^De[255&j]^je[Ee+3],me=ie,xe=Z,j=N,C=W,Ee+=4;ie=Xe[me>>>24]<<24^Xe[xe>>16&255]<<16^Xe[j>>8&255]<<8^Xe[255&C]^je[Ee],Z=Xe[xe>>>24]<<24^Xe[j>>16&255]<<16^Xe[C>>8&255]<<8^Xe[255&me]^je[Ee+1],N=Xe[j>>>24]<<24^Xe[C>>16&255]<<16^Xe[me>>8&255]<<8^Xe[255&xe]^je[Ee+2],W=Xe[C>>>24]<<24^Xe[me>>16&255]<<16^Xe[xe>>8&255]<<8^Xe[255&j]^je[Ee+3],it[Y]=ue(ie^Be),it[Y+1]=ue(W^Te),it[Y+2]=ue(N^ze),it[Y+3]=ue(Z^We),Be=q,Te=H,ze=ye,We=he,Y+=4}return it.buffer},K}(),A=k(93),w=k(63),te=function(){function K(ne,Y){var re=(Y===void 0?{}:Y).removePKCS7Padding,ie=re===void 0||re;if(this.logEnabled=!0,this.removePKCS7Padding=void 0,this.subtle=null,this.softwareDecrypter=null,this.key=null,this.fastAesKey=null,this.remainderData=null,this.currentIV=null,this.currentResult=null,this.useSoftware=void 0,this.useSoftware=ne.enableSoftwareAES,this.removePKCS7Padding=ie,ie)try{var Z=self.crypto;Z&&(this.subtle=Z.subtle||Z.webkitSubtle)}catch{}this.subtle===null&&(this.useSoftware=!0)}var V=K.prototype;return V.destroy=function(){this.subtle=null,this.softwareDecrypter=null,this.key=null,this.fastAesKey=null,this.remainderData=null,this.currentIV=null,this.currentResult=null},V.isSync=function(){return this.useSoftware},V.flush=function(){var ne=this.currentResult,Y=this.remainderData;if(!ne||Y)return this.reset(),null;var re,ie,Z,N=new Uint8Array(ne);return this.reset(),this.removePKCS7Padding?(Z=(ie=(re=N).byteLength)&&new DataView(re.buffer).getUint8(ie-1))?(0,O.sliceUint8)(re,0,ie-Z):re:N},V.reset=function(){this.currentResult=null,this.currentIV=null,this.remainderData=null,this.softwareDecrypter&&(this.softwareDecrypter=null)},V.decrypt=function(ne,Y,re){var ie=this;return this.useSoftware?new Promise(function(Z,N){ie.softwareDecrypt(new Uint8Array(ne),Y,re);var W=ie.flush();W?Z(W.buffer):N(new Error("[softwareDecrypt] Failed to decrypt data"))}):this.webCryptoDecrypt(new Uint8Array(ne),Y,re)},V.softwareDecrypt=function(ne,Y,re){var ie=this.currentIV,Z=this.currentResult,N=this.remainderData;this.logOnce("JS AES decrypt"),N&&(ne=(0,w.appendUint8Array)(N,ne),this.remainderData=null);var W=this.getValidChunk(ne);if(!W.length)return null;ie&&(re=ie);var me=this.softwareDecrypter;me||(me=this.softwareDecrypter=new E),me.expandKey(Y);var xe=Z;return this.currentResult=me.decrypt(W.buffer,0,re),this.currentIV=(0,O.sliceUint8)(W,-16).buffer,xe||null},V.webCryptoDecrypt=function(ne,Y,re){var ie=this,Z=this.subtle;return this.key===Y&&this.fastAesKey||(this.key=Y,this.fastAesKey=new U(Z,Y)),this.fastAesKey.expandKey().then(function(N){return Z?(ie.logOnce("WebCrypto AES decrypt"),new x(Z,new Uint8Array(re)).decrypt(ne.buffer,N)):Promise.reject(new Error("web crypto not initialized"))}).catch(function(N){return A.logger.warn("[decrypter]: WebCrypto Error, disable WebCrypto API, "+N.name+": "+N.message),ie.onWebCryptoError(ne,Y,re)})},V.onWebCryptoError=function(ne,Y,re){this.useSoftware=!0,this.logEnabled=!0,this.softwareDecrypt(ne,Y,re);var ie=this.flush();if(ie)return ie.buffer;throw new Error("WebCrypto and softwareDecrypt: failed to decrypt data")},V.getValidChunk=function(ne){var Y=ne,re=ne.length-ne.length%16;return re!==ne.length&&(Y=(0,O.sliceUint8)(ne,0,re),this.remainderData=(0,O.sliceUint8)(ne,re)),Y},V.logOnce=function(ne){this.logEnabled&&(A.logger.log("[decrypter]: "+ne),this.logEnabled=!1)},K}()},181:(L,I,k)=>{k.r(I),k.d(I,{canParse:()=>w,decodeFrame:()=>Y,getID3Data:()=>E,getID3Frames:()=>ne,getTimeStamp:()=>te,isFooter:()=>O,isHeader:()=>U,isTimeStampFrame:()=>K,testables:()=>me,utf8ArrayToStr:()=>W});var x,U=function(j,C){return C+10<=j.length&&j[C]===73&&j[C+1]===68&&j[C+2]===51&&j[C+3]<255&&j[C+4]<255&&j[C+6]<128&&j[C+7]<128&&j[C+8]<128&&j[C+9]<128},O=function(j,C){return C+10<=j.length&&j[C]===51&&j[C+1]===68&&j[C+2]===73&&j[C+3]<255&&j[C+4]<255&&j[C+6]<128&&j[C+7]<128&&j[C+8]<128&&j[C+9]<128},E=function(j,C){for(var q=C,H=0;U(j,C);)H+=10,H+=A(j,C+6),O(j,C+10)&&(H+=10),C+=H;if(H>0)return j.subarray(q,q+H)},A=function(j,C){var q=0;return q=(127&j[C])<<21,q|=(127&j[C+1])<<14,(q|=(127&j[C+2])<<7)|127&j[C+3]},w=function(j,C){return U(j,C)&&A(j,C+6)+10<=j.length-C},te=function(j){for(var C=ne(j),q=0;q<C.length;q++){var H=C[q];if(K(H))return N(H)}},K=function(j){return j&&j.key==="PRIV"&&j.info==="com.apple.streaming.transportStreamTimestamp"},V=function(j){var C=String.fromCharCode(j[0],j[1],j[2],j[3]),q=A(j,4);return{type:C,size:q,data:j.subarray(10,10+q)}},ne=function(j){for(var C=0,q=[];U(j,C);){for(var H=A(j,C+6),ye=(C+=10)+H;C+8<ye;){var he=V(j.subarray(C)),Ee=Y(he);Ee&&q.push(Ee),C+=he.size+10}O(j,C)&&(C+=10)}return q},Y=function(j){return j.type==="PRIV"?re(j):j.type[0]==="W"?Z(j):ie(j)},re=function(j){if(!(j.size<2)){var C=W(j.data,!0),q=new Uint8Array(j.data.subarray(C.length+1));return{key:j.type,info:C,data:q.buffer}}},ie=function(j){if(!(j.size<2)){if(j.type==="TXXX"){var C=1,q=W(j.data.subarray(C),!0);C+=q.length+1;var H=W(j.data.subarray(C));return{key:j.type,info:q,data:H}}var ye=W(j.data.subarray(1));return{key:j.type,data:ye}}},Z=function(j){if(j.type==="WXXX"){if(j.size<2)return;var C=1,q=W(j.data.subarray(C),!0);C+=q.length+1;var H=W(j.data.subarray(C));return{key:j.type,info:q,data:H}}var ye=W(j.data);return{key:j.type,data:ye}},N=function(j){if(j.data.byteLength===8){var C=new Uint8Array(j.data),q=1&C[3],H=(C[4]<<23)+(C[5]<<15)+(C[6]<<7)+C[7];return H/=45,q&&(H+=4772185884e-2),Math.round(H)}},W=function(j,C){C===void 0&&(C=!1);var q=xe();if(q){var H=q.decode(j);if(C){var ye=H.indexOf("\0");return ye!==-1?H.substring(0,ye):H}return H.replace(/\0/g,"")}for(var he,Ee,Ae,qe=j.length,je="",Xe=0;Xe<qe;){if((he=j[Xe++])===0&&C)return je;if(he!==0&&he!==3)switch(he>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:je+=String.fromCharCode(he);break;case 12:case 13:Ee=j[Xe++],je+=String.fromCharCode((31&he)<<6|63&Ee);break;case 14:Ee=j[Xe++],Ae=j[Xe++],je+=String.fromCharCode((15&he)<<12|(63&Ee)<<6|(63&Ae)<<0)}}return je},me={decodeTextFrame:ie};function xe(){return x||self.TextDecoder===void 0||(x=new self.TextDecoder("utf-8")),x}},182:(L,I,k)=>{k.r(I),k.d(I,{default:()=>w});var x=k(544),U=k(851),O=k(93),E=k(729),A=k(973);function w(ne){var Y=new E.EventEmitter,re=function(ie,Z){ne.postMessage({event:ie,data:Z})};Y.on(U.Events.FRAG_DECRYPTED,re),Y.on(U.Events.ERROR,re),ne.addEventListener("message",function(ie){var Z=ie.data;switch(Z.cmd){case"init":var N=JSON.parse(Z.config);ne.transmuxer=new x.default(Y,Z.typeSupported,N,Z.vendor,Z.id),(0,O.enableLogs)(N.debug,Z.id),function(){var j=function(q){O.logger[q]=function(H){re("workerLog",{logType:q,message:H})}};for(var C in O.logger)j(C)}(),re("init",null);break;case"configure":ne.transmuxer.configure(Z.config);break;case"demux":var W=ne.transmuxer.push(Z.data,Z.decryptdata,Z.chunkMeta,Z.state);(0,x.isPromise)(W)?(ne.transmuxer.async=!0,W.then(function(j){te(ne,j)}).catch(function(j){re(U.Events.ERROR,{type:A.ErrorTypes.MEDIA_ERROR,details:A.ErrorDetails.FRAG_PARSING_ERROR,chunkMeta:Z.chunkMeta,fatal:!1,error:j,err:j,reason:"transmuxer-worker push error"})})):(ne.transmuxer.async=!1,te(ne,W));break;case"flush":var me=Z.chunkMeta,xe=ne.transmuxer.flush(me);(0,x.isPromise)(xe)||ne.transmuxer.async?((0,x.isPromise)(xe)||(xe=Promise.resolve(xe)),xe.then(function(j){V(ne,j,me)}).catch(function(j){re(U.Events.ERROR,{type:A.ErrorTypes.MEDIA_ERROR,details:A.ErrorDetails.FRAG_PARSING_ERROR,chunkMeta:Z.chunkMeta,fatal:!1,error:j,err:j,reason:"transmuxer-worker flush error"})})):V(ne,xe,me)}})}function te(ne,Y){if(!((re=Y.remuxResult).audio||re.video||re.text||re.id3||re.initSegment))return!1;var re,ie=[],Z=Y.remuxResult,N=Z.audio,W=Z.video;return N&&K(ie,N),W&&K(ie,W),ne.postMessage({event:"transmuxComplete",data:Y},ie),!0}function K(ne,Y){Y.data1&&ne.push(Y.data1.buffer),Y.data2&&ne.push(Y.data2.buffer)}function V(ne,Y,re){Y.reduce(function(ie,Z){return te(ne,Z)||ie},!1)||ne.postMessage({event:"transmuxComplete",data:Y[0]}),ne.postMessage({event:"flush",data:re})}},544:(L,I,k)=>{k.r(I),k.d(I,{TransmuxConfig:()=>wr,TransmuxState:()=>yr,default:()=>cr,isPromise:()=>kr});var x=k(851),U=k(973),O=k(21),E=k(965),A=k(181),w=k(856);function te(pe,$){return pe===void 0&&(pe=""),$===void 0&&($=9e4),{type:pe,id:-1,pid:-1,inputTimeScale:$,sequenceNumber:-1,samples:[],dropped:0}}var K=k(63),V=k(145),ne=function(){function pe(){this._audioTrack=void 0,this._id3Track=void 0,this.frameIndex=0,this.cachedData=null,this.basePTS=null,this.initPTS=null,this.lastPTS=null}var $=pe.prototype;return $.resetInitSegment=function(M,z,Q,se){this._id3Track={type:"id3",id:3,pid:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],dropped:0}},$.resetTimeStamp=function(M){this.initPTS=M,this.resetContiguity()},$.resetContiguity=function(){this.basePTS=null,this.lastPTS=null,this.frameIndex=0},$.canParse=function(M,z){return!1},$.appendFrame=function(M,z,Q){},$.demux=function(M,z){this.cachedData&&(M=(0,K.appendUint8Array)(this.cachedData,M),this.cachedData=null);var Q,se=A.getID3Data(M,0),oe=se?se.length:0,de=this._audioTrack,Ce=this._id3Track,Me=se?A.getTimeStamp(se):void 0,Ne=M.length;for((this.basePTS===null||this.frameIndex===0&&(0,E.isFiniteNumber)(Me))&&(this.basePTS=Y(Me,z,this.initPTS),this.lastPTS=this.basePTS),this.lastPTS===null&&(this.lastPTS=this.basePTS),se&&se.length>0&&Ce.samples.push({pts:this.lastPTS,dts:this.lastPTS,data:se,type:w.MetadataSchema.audioId3,duration:Number.POSITIVE_INFINITY});oe<Ne;){if(this.canParse(M,oe)){var Ze=this.appendFrame(de,M,oe);Ze?(this.frameIndex++,this.lastPTS=Ze.sample.pts,Q=oe+=Ze.length):oe=Ne}else A.canParse(M,oe)?(se=A.getID3Data(M,oe),Ce.samples.push({pts:this.lastPTS,dts:this.lastPTS,data:se,type:w.MetadataSchema.audioId3,duration:Number.POSITIVE_INFINITY}),Q=oe+=se.length):oe++;if(oe===Ne&&Q!==Ne){var at=(0,V.sliceUint8)(M,Q);this.cachedData?this.cachedData=(0,K.appendUint8Array)(this.cachedData,at):this.cachedData=at}}return{audioTrack:de,videoTrack:te(),id3Track:Ce,textTrack:te()}},$.demuxSampleAes=function(M,z,Q){return Promise.reject(new Error("["+this+"] This demuxer does not support Sample-AES decryption"))},$.flush=function(M){var z=this.cachedData;return z&&(this.cachedData=null,this.demux(z,0)),{audioTrack:this._audioTrack,videoTrack:te(),id3Track:this._id3Track,textTrack:te()}},$.destroy=function(){},pe}(),Y=function(pe,$,M){return(0,E.isFiniteNumber)(pe)?90*pe:9e4*$+(M||0)};const re=ne;var ie=k(93);function Z(pe,$){return pe[$]===255&&(246&pe[$+1])==240}function N(pe,$){return 1&pe[$+1]?7:9}function W(pe,$){return(3&pe[$+3])<<11|pe[$+4]<<3|(224&pe[$+5])>>>5}function me(pe,$){return $+1<pe.length&&Z(pe,$)}function xe(pe,$){if(me(pe,$)){var M=N(pe,$);if($+M>=pe.length)return!1;var z=W(pe,$);if(z<=M)return!1;var Q=$+z;return Q===pe.length||me(pe,Q)}return!1}function j(pe,$,M,z,Q){if(!pe.samplerate){var se=function(oe,de,Ce,Me){var Ne,Ze,at,et,ft=navigator.userAgent.toLowerCase(),kt=Me,Ht=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350];Ne=1+((192&de[Ce+2])>>>6);var ct=(60&de[Ce+2])>>>2;if(!(ct>Ht.length-1))return at=(1&de[Ce+2])<<2,at|=(192&de[Ce+3])>>>6,ie.logger.log("manifest codec:"+Me+", ADTS type:"+Ne+", samplingIndex:"+ct),/firefox/i.test(ft)?ct>=6?(Ne=5,et=new Array(4),Ze=ct-3):(Ne=2,et=new Array(2),Ze=ct):ft.indexOf("android")!==-1?(Ne=2,et=new Array(2),Ze=ct):(Ne=5,et=new Array(4),Me&&(Me.indexOf("mp4a.40.29")!==-1||Me.indexOf("mp4a.40.5")!==-1)||!Me&&ct>=6?Ze=ct-3:((Me&&Me.indexOf("mp4a.40.2")!==-1&&(ct>=6&&at===1||/vivaldi/i.test(ft))||!Me&&at===1)&&(Ne=2,et=new Array(2)),Ze=ct)),et[0]=Ne<<3,et[0]|=(14&ct)>>1,et[1]|=(1&ct)<<7,et[1]|=at<<3,Ne===5&&(et[1]|=(14&Ze)>>1,et[2]=(1&Ze)<<7,et[2]|=8,et[3]=0),{config:et,samplerate:Ht[ct],channelCount:at,codec:"mp4a.40."+Ne,manifestCodec:kt};oe.trigger(x.Events.ERROR,{type:U.ErrorTypes.MEDIA_ERROR,details:U.ErrorDetails.FRAG_PARSING_ERROR,fatal:!0,reason:"invalid ADTS sampling index:"+ct})}($,M,z,Q);if(!se)return;pe.config=se.config,pe.samplerate=se.samplerate,pe.channelCount=se.channelCount,pe.codec=se.codec,pe.manifestCodec=se.manifestCodec,ie.logger.log("parsed codec:"+pe.codec+", rate:"+se.samplerate+", channels:"+se.channelCount)}}function C(pe){return 9216e4/pe}function q(pe,$,M,z,Q){var se,oe=z+Q*C(pe.samplerate),de=function(ft,kt){var Ht=N(ft,kt);if(kt+Ht<=ft.length){var ct=W(ft,kt)-Ht;if(ct>0)return{headerLength:Ht,frameLength:ct}}}($,M);if(de){var Ce=de.frameLength,Me=de.headerLength,Ne=Me+Ce,Ze=Math.max(0,M+Ne-$.length);Ze?(se=new Uint8Array(Ne-Me)).set($.subarray(M+Me,$.length),0):se=$.subarray(M+Me,M+Ne);var at={unit:se,pts:oe};return Ze||pe.samples.push(at),{sample:at,length:Ne,missing:Ze}}var et=$.length-M;return(se=new Uint8Array(et)).set($.subarray(M,$.length),0),{sample:{unit:se,pts:oe},length:et,missing:-1}}function H(pe,$){return H=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(M,z){return M.__proto__=z,M},H(pe,$)}const ye=function(pe){var $,M;function z(se,oe){var de;return(de=pe.call(this)||this).observer=void 0,de.config=void 0,de.observer=se,de.config=oe,de}M=pe,($=z).prototype=Object.create(M.prototype),$.prototype.constructor=$,H($,M);var Q=z.prototype;return Q.resetInitSegment=function(se,oe,de,Ce){pe.prototype.resetInitSegment.call(this,se,oe,de,Ce),this._audioTrack={container:"audio/adts",type:"audio",id:2,pid:-1,sequenceNumber:0,segmentCodec:"aac",samples:[],manifestCodec:oe,duration:Ce,inputTimeScale:9e4,dropped:0}},z.probe=function(se){if(!se)return!1;for(var oe=(A.getID3Data(se,0)||[]).length,de=se.length;oe<de;oe++)if(xe(se,oe))return ie.logger.log("ADTS sync word found !"),!0;return!1},Q.canParse=function(se,oe){return function(de,Ce){return function(Me,Ne){return Ne+5<Me.length}(de,Ce)&&Z(de,Ce)&&W(de,Ce)<=de.length-Ce}(se,oe)},Q.appendFrame=function(se,oe,de){j(se,this.observer,oe,de,se.manifestCodec);var Ce=q(se,oe,de,this.basePTS,this.frameIndex);if(Ce&&Ce.missing===0)return Ce},z}(re);var he=/\/emsg[-/]ID3/i;const Ee=function(){function pe(M,z){this.remainderData=null,this.timeOffset=0,this.config=void 0,this.videoTrack=void 0,this.audioTrack=void 0,this.id3Track=void 0,this.txtTrack=void 0,this.config=z}var $=pe.prototype;return $.resetTimeStamp=function(){},$.resetInitSegment=function(M,z,Q,se){var oe=this.videoTrack=te("video",1),de=this.audioTrack=te("audio",1),Ce=this.txtTrack=te("text",1);if(this.id3Track=te("id3",1),this.timeOffset=0,M&&M.byteLength){var Me=(0,K.parseInitSegment)(M);if(Me.video){var Ne=Me.video,Ze=Ne.id,at=Ne.timescale,et=Ne.codec;oe.id=Ze,oe.timescale=Ce.timescale=at,oe.codec=et}if(Me.audio){var ft=Me.audio,kt=ft.id,Ht=ft.timescale,ct=ft.codec;de.id=kt,de.timescale=Ht,de.codec=ct}Ce.id=K.RemuxerTrackIdConfig.text,oe.sampleDuration=0,oe.duration=de.duration=se}},$.resetContiguity=function(){},pe.probe=function(M){return M=M.length>16384?M.subarray(0,16384):M,(0,K.findBox)(M,["moof"]).length>0},$.demux=function(M,z){this.timeOffset=z;var Q=M,se=this.videoTrack,oe=this.txtTrack;if(this.config.progressive){this.remainderData&&(Q=(0,K.appendUint8Array)(this.remainderData,M));var de=(0,K.segmentValidRange)(Q);this.remainderData=de.remainder,se.samples=de.valid||new Uint8Array}else se.samples=Q;var Ce=this.extractID3Track(se,z);return oe.samples=(0,K.parseSamples)(z,se),{videoTrack:se,audioTrack:this.audioTrack,id3Track:Ce,textTrack:this.txtTrack}},$.flush=function(){var M=this.timeOffset,z=this.videoTrack,Q=this.txtTrack;z.samples=this.remainderData||new Uint8Array,this.remainderData=null;var se=this.extractID3Track(z,this.timeOffset);return Q.samples=(0,K.parseSamples)(M,z),{videoTrack:z,audioTrack:te(),id3Track:se,textTrack:te()}},$.extractID3Track=function(M,z){var Q=this.id3Track;if(M.samples.length){var se=(0,K.findBox)(M.samples,["emsg"]);se&&se.forEach(function(oe){var de=(0,K.parseEmsg)(oe);if(he.test(de.schemeIdUri)){var Ce=(0,E.isFiniteNumber)(de.presentationTime)?de.presentationTime/de.timeScale:z+de.presentationTimeDelta/de.timeScale,Me=de.eventDuration===4294967295?Number.POSITIVE_INFINITY:de.eventDuration/de.timeScale;Me<=.001&&(Me=Number.POSITIVE_INFINITY);var Ne=de.payload;Q.samples.push({data:Ne,len:Ne.byteLength,dts:Ce,pts:Ce,type:w.MetadataSchema.emsg,duration:Me})}})}return Q},$.demuxSampleAes=function(M,z,Q){return Promise.reject(new Error("The MP4 demuxer does not support SAMPLE-AES decryption"))},$.destroy=function(){},pe}();var Ae=null,qe=[32,64,96,128,160,192,224,256,288,320,352,384,416,448,32,48,56,64,80,96,112,128,160,192,224,256,320,384,32,40,48,56,64,80,96,112,128,160,192,224,256,320,32,48,56,64,80,96,112,128,144,160,176,192,224,256,8,16,24,32,40,48,56,64,80,96,112,128,144,160],je=[44100,48e3,32e3,22050,24e3,16e3,11025,12e3,8e3],Xe=[[0,72,144,12],[0,0,0,0],[0,72,144,12],[0,144,144,12]],Ve=[0,1,1,4];function Ie(pe,$,M,z,Q){if(!(M+24>$.length)){var se=He($,M);if(se&&M+se.frameLength<=$.length){var oe=z+Q*(9e4*se.samplesPerFrame/se.sampleRate),de={unit:$.subarray(M,M+se.frameLength),pts:oe,dts:oe};return pe.config=[],pe.channelCount=se.channelCount,pe.samplerate=se.sampleRate,pe.samples.push(de),{sample:de,length:se.frameLength,missing:0}}}}function He(pe,$){var M=pe[$+1]>>3&3,z=pe[$+1]>>1&3,Q=pe[$+2]>>4&15,se=pe[$+2]>>2&3;if(M!==1&&Q!==0&&Q!==15&&se!==3){var oe=pe[$+2]>>1&1,de=pe[$+3]>>6,Ce=1e3*qe[14*(M===3?3-z:z===3?3:4)+Q-1],Me=je[3*(M===3?0:M===2?1:2)+se],Ne=de===3?1:2,Ze=Xe[M][z],at=Ve[z],et=8*Ze*at,ft=Math.floor(Ze*Ce/Me+oe)*at;if(Ae===null){var kt=(navigator.userAgent||"").match(/Chrome\/(\d+)/i);Ae=kt?parseInt(kt[1]):0}return Ae&&Ae<=87&&z===2&&Ce>=224e3&&de===0&&(pe[$+3]=128|pe[$+3]),{sampleRate:Me,channelCount:Ne,frameLength:ft,samplesPerFrame:et}}}function ce(pe,$){return pe[$]===255&&(224&pe[$+1])==224&&(6&pe[$+1])!=0}function De(pe,$){return $+1<pe.length&&ce(pe,$)}function ve(pe,$){if($+1<pe.length&&ce(pe,$)){var M=He(pe,$),z=4;M!=null&&M.frameLength&&(z=M.frameLength);var Q=$+z;return Q===pe.length||De(pe,Q)}return!1}const Be=function(){function pe(M){this.data=void 0,this.bytesAvailable=void 0,this.word=void 0,this.bitsAvailable=void 0,this.data=M,this.bytesAvailable=M.byteLength,this.word=0,this.bitsAvailable=0}var $=pe.prototype;return $.loadWord=function(){var M=this.data,z=this.bytesAvailable,Q=M.byteLength-z,se=new Uint8Array(4),oe=Math.min(4,z);if(oe===0)throw new Error("no bytes available");se.set(M.subarray(Q,Q+oe)),this.word=new DataView(se.buffer).getUint32(0),this.bitsAvailable=8*oe,this.bytesAvailable-=oe},$.skipBits=function(M){var z;M=Math.min(M,8*this.bytesAvailable+this.bitsAvailable),this.bitsAvailable>M?(this.word<<=M,this.bitsAvailable-=M):(M-=this.bitsAvailable,M-=(z=M>>3)<<3,this.bytesAvailable-=z,this.loadWord(),this.word<<=M,this.bitsAvailable-=M)},$.readBits=function(M){var z=Math.min(this.bitsAvailable,M),Q=this.word>>>32-z;if(M>32&&ie.logger.error("Cannot read more than 32 bits at a time"),this.bitsAvailable-=z,this.bitsAvailable>0)this.word<<=z;else{if(!(this.bytesAvailable>0))throw new Error("no bits available");this.loadWord()}return(z=M-z)>0&&this.bitsAvailable?Q<<z|this.readBits(z):Q},$.skipLZ=function(){var M;for(M=0;M<this.bitsAvailable;++M)if(this.word&2147483648>>>M)return this.word<<=M,this.bitsAvailable-=M,M;return this.loadWord(),M+this.skipLZ()},$.skipUEG=function(){this.skipBits(1+this.skipLZ())},$.skipEG=function(){this.skipBits(1+this.skipLZ())},$.readUEG=function(){var M=this.skipLZ();return this.readBits(M+1)-1},$.readEG=function(){var M=this.readUEG();return 1&M?1+M>>>1:-1*(M>>>1)},$.readBoolean=function(){return this.readBits(1)===1},$.readUByte=function(){return this.readBits(8)},$.readUShort=function(){return this.readBits(16)},$.readUInt=function(){return this.readBits(32)},$.skipScalingList=function(M){for(var z=8,Q=8,se=0;se<M;se++)Q!==0&&(Q=(z+this.readEG()+256)%256),z=Q===0?z:Q},$.readSPS=function(){var M,z,Q,se=0,oe=0,de=0,Ce=0,Me=this.readUByte.bind(this),Ne=this.readBits.bind(this),Ze=this.readUEG.bind(this),at=this.readBoolean.bind(this),et=this.skipBits.bind(this),ft=this.skipEG.bind(this),kt=this.skipUEG.bind(this),Ht=this.skipScalingList.bind(this);Me();var ct=Me();if(Ne(5),et(3),Me(),kt(),ct===100||ct===110||ct===122||ct===244||ct===44||ct===83||ct===86||ct===118||ct===128){var zt=Ze();if(zt===3&&et(1),kt(),kt(),et(1),at())for(z=zt!==3?8:12,Q=0;Q<z;Q++)at()&&Ht(Q<6?16:64)}kt();var Er=Ze();if(Er===0)Ze();else if(Er===1)for(et(1),ft(),ft(),M=Ze(),Q=0;Q<M;Q++)ft();kt(),et(1);var Qt=Ze(),_r=Ze(),hr=Ne(1);hr===0&&et(1),et(1),at()&&(se=Ze(),oe=Ze(),de=Ze(),Ce=Ze());var mt=[1,1];if(at()&&at())switch(Me()){case 1:mt=[1,1];break;case 2:mt=[12,11];break;case 3:mt=[10,11];break;case 4:mt=[16,11];break;case 5:mt=[40,33];break;case 6:mt=[24,11];break;case 7:mt=[20,11];break;case 8:mt=[32,11];break;case 9:mt=[80,33];break;case 10:mt=[18,11];break;case 11:mt=[15,11];break;case 12:mt=[64,33];break;case 13:mt=[160,99];break;case 14:mt=[4,3];break;case 15:mt=[3,2];break;case 16:mt=[2,1];break;case 255:mt=[Me()<<8|Me(),Me()<<8|Me()]}return{width:Math.ceil(16*(Qt+1)-2*se-2*oe),height:(2-hr)*(_r+1)*16-(hr?2:4)*(de+Ce),pixelRatio:mt}},$.readSliceType=function(){return this.readUByte(),this.readUEG(),this.readUEG()},pe}(),Te=function(){function pe(M,z,Q){this.keyData=void 0,this.decrypter=void 0,this.keyData=Q,this.decrypter=new O.default(z,{removePKCS7Padding:!1})}var $=pe.prototype;return $.decryptBuffer=function(M){return this.decrypter.decrypt(M,this.keyData.key.buffer,this.keyData.iv.buffer)},$.decryptAacSample=function(M,z,Q){var se=this,oe=M[z].unit;if(!(oe.length<=16)){var de=oe.subarray(16,oe.length-oe.length%16),Ce=de.buffer.slice(de.byteOffset,de.byteOffset+de.length);this.decryptBuffer(Ce).then(function(Me){var Ne=new Uint8Array(Me);oe.set(Ne,16),se.decrypter.isSync()||se.decryptAacSamples(M,z+1,Q)})}},$.decryptAacSamples=function(M,z,Q){for(;;z++){if(z>=M.length)return void Q();if(!(M[z].unit.length<32||(this.decryptAacSample(M,z,Q),this.decrypter.isSync())))return}},$.getAvcEncryptedData=function(M){for(var z=16*Math.floor((M.length-48)/160)+16,Q=new Int8Array(z),se=0,oe=32;oe<M.length-16;oe+=160,se+=16)Q.set(M.subarray(oe,oe+16),se);return Q},$.getAvcDecryptedUnit=function(M,z){for(var Q=new Uint8Array(z),se=0,oe=32;oe<M.length-16;oe+=160,se+=16)M.set(Q.subarray(se,se+16),oe);return M},$.decryptAvcSample=function(M,z,Q,se,oe){var de=this,Ce=(0,K.discardEPB)(oe.data),Me=this.getAvcEncryptedData(Ce);this.decryptBuffer(Me.buffer).then(function(Ne){oe.data=de.getAvcDecryptedUnit(Ce,Ne),de.decrypter.isSync()||de.decryptAvcSamples(M,z,Q+1,se)})},$.decryptAvcSamples=function(M,z,Q,se){if(M instanceof Uint8Array)throw new Error("Cannot decrypt samples of type Uint8Array");for(;;z++,Q=0){if(z>=M.length)return void se();for(var oe=M[z].units;!(Q>=oe.length);Q++){var de=oe[Q];if(!(de.data.length<=48||de.type!==1&&de.type!==5||(this.decryptAvcSample(M,z,Q,se,de),this.decrypter.isSync())))return}}},pe}();function ze(){return ze=Object.assign?Object.assign.bind():function(pe){for(var $=1;$<arguments.length;$++){var M=arguments[$];for(var z in M)Object.prototype.hasOwnProperty.call(M,z)&&(pe[z]=M[z])}return pe},ze.apply(this,arguments)}var We=188;function $e(pe,$,M,z){return{key:pe,frame:!1,pts:$,dts:M,units:[],debug:z,length:0}}function it(pe,$){return((31&pe[$+1])<<8)+pe[$+2]}function ue(pe,$){return(31&pe[$+10])<<8|pe[$+11]}function ot(pe,$,M,z){var Q={audio:-1,avc:-1,id3:-1,segmentCodec:"aac"},se=$+3+((15&pe[$+1])<<8|pe[$+2])-4;for($+=12+((15&pe[$+10])<<8|pe[$+11]);$<se;){var oe=it(pe,$);switch(pe[$]){case 207:if(!z){ie.logger.log("ADTS AAC with AES-128-CBC frame encryption found in unencrypted stream");break}case 15:Q.audio===-1&&(Q.audio=oe);break;case 21:Q.id3===-1&&(Q.id3=oe);break;case 219:if(!z){ie.logger.log("H.264 with AES-128-CBC slice encryption found in unencrypted stream");break}case 27:Q.avc===-1&&(Q.avc=oe);break;case 3:case 4:M.mpeg!==!0&&M.mp3!==!0?ie.logger.log("MPEG audio found, not supported in this browser"):Q.audio===-1&&(Q.audio=oe,Q.segmentCodec="mp3");break;case 36:ie.logger.warn("Unsupported HEVC stream type found")}$+=5+((15&pe[$+3])<<8|pe[$+4])}return Q}function Fe(pe){var $,M,z,Q,se,oe=0,de=pe.data;if(!pe||pe.size===0)return null;for(;de[0].length<19&&de.length>1;){var Ce=new Uint8Array(de[0].length+de[1].length);Ce.set(de[0]),Ce.set(de[1],de[0].length),de[0]=Ce,de.splice(1,1)}if((($=de[0])[0]<<16)+($[1]<<8)+$[2]===1){if((M=($[4]<<8)+$[5])&&M>pe.size-6)return null;var Me=$[7];192&Me&&(Q=536870912*(14&$[9])+4194304*(255&$[10])+16384*(254&$[11])+128*(255&$[12])+(254&$[13])/2,64&Me?Q-(se=536870912*(14&$[14])+4194304*(255&$[15])+16384*(254&$[16])+128*(255&$[17])+(254&$[18])/2)>54e5&&(ie.logger.warn(Math.round((Q-se)/9e4)+"s delta between PTS and DTS, align them"),Q=se):se=Q);var Ne=(z=$[8])+9;if(pe.size<=Ne)return null;pe.size-=Ne;for(var Ze=new Uint8Array(pe.size),at=0,et=de.length;at<et;at++){var ft=($=de[at]).byteLength;if(Ne){if(Ne>ft){Ne-=ft;continue}$=$.subarray(Ne),ft-=Ne,Ne=0}Ze.set($,oe),oe+=ft}return M&&(M-=z+3),{data:Ze,pts:Q,dts:se,len:M}}return null}function nt(pe,$){if(pe.units.length&&pe.frame){if(pe.pts===void 0){var M=$.samples,z=M.length;if(!z)return void $.dropped++;var Q=M[z-1];pe.pts=Q.pts,pe.dts=Q.dts}$.samples.push(pe)}pe.debug.length&&ie.logger.log(pe.pts+"/"+pe.dts+":"+pe.debug)}const ht=function(){function pe(M,z,Q){this.observer=void 0,this.config=void 0,this.typeSupported=void 0,this.sampleAes=null,this.pmtParsed=!1,this.audioCodec=void 0,this.videoCodec=void 0,this._duration=0,this._pmtId=-1,this._avcTrack=void 0,this._audioTrack=void 0,this._id3Track=void 0,this._txtTrack=void 0,this.aacOverFlow=null,this.avcSample=null,this.remainderData=null,this.observer=M,this.config=z,this.typeSupported=Q}pe.probe=function(M){var z=pe.syncOffset(M);return z>0&&ie.logger.warn("MPEG2-TS detected but first sync word found @ offset "+z),z!==-1},pe.syncOffset=function(M){for(var z=M.length,Q=Math.min(940,M.length-We)+1,se=0;se<Q;){for(var oe=!1,de=se;de<z&&M[de]===71;de+=We)if(oe||it(M,de)!==0||(oe=!0),oe&&de+We>Q)return se;se++}return-1},pe.createTrack=function(M,z){return{container:M==="video"||M==="audio"?"video/mp2t":void 0,type:M,id:K.RemuxerTrackIdConfig[M],pid:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],dropped:0,duration:M==="audio"?z:void 0}};var $=pe.prototype;return $.resetInitSegment=function(M,z,Q,se){this.pmtParsed=!1,this._pmtId=-1,this._avcTrack=pe.createTrack("video"),this._audioTrack=pe.createTrack("audio",se),this._id3Track=pe.createTrack("id3"),this._txtTrack=pe.createTrack("text"),this._audioTrack.segmentCodec="aac",this.aacOverFlow=null,this.avcSample=null,this.remainderData=null,this.audioCodec=z,this.videoCodec=Q,this._duration=se},$.resetTimeStamp=function(){},$.resetContiguity=function(){var M=this._audioTrack,z=this._avcTrack,Q=this._id3Track;M&&(M.pesData=null),z&&(z.pesData=null),Q&&(Q.pesData=null),this.aacOverFlow=null,this.avcSample=null,this.remainderData=null},$.demux=function(M,z,Q,se){var oe;Q===void 0&&(Q=!1),se===void 0&&(se=!1),Q||(this.sampleAes=null);var de=this._avcTrack,Ce=this._audioTrack,Me=this._id3Track,Ne=this._txtTrack,Ze=de.pid,at=de.pesData,et=Ce.pid,ft=Me.pid,kt=Ce.pesData,Ht=Me.pesData,ct=null,zt=this.pmtParsed,Er=this._pmtId,Qt=M.length;if(this.remainderData&&(Qt=(M=(0,K.appendUint8Array)(this.remainderData,M)).length,this.remainderData=null),Qt<We&&!se)return this.remainderData=M,{audioTrack:Ce,videoTrack:de,id3Track:Me,textTrack:Ne};var _r=Math.max(0,pe.syncOffset(M));(Qt-=(Qt-_r)%We)<M.byteLength&&!se&&(this.remainderData=new Uint8Array(M.buffer,Qt,M.buffer.byteLength-Qt));for(var hr=0,mt=_r;mt<Qt;mt+=We)if(M[mt]===71){var Br=!!(64&M[mt+1]),un=it(M,mt),sr=void 0;if((48&M[mt+3])>>4>1){if((sr=mt+5+M[mt+4])===mt+We)continue}else sr=mt+4;switch(un){case Ze:Br&&(at&&(oe=Fe(at))&&this.parseAVCPES(de,Ne,oe,!1),at={data:[],size:0}),at&&(at.data.push(M.subarray(sr,mt+We)),at.size+=mt+We-sr);break;case et:if(Br){if(kt&&(oe=Fe(kt)))switch(Ce.segmentCodec){case"aac":this.parseAACPES(Ce,oe);break;case"mp3":this.parseMPEGPES(Ce,oe)}kt={data:[],size:0}}kt&&(kt.data.push(M.subarray(sr,mt+We)),kt.size+=mt+We-sr);break;case ft:Br&&(Ht&&(oe=Fe(Ht))&&this.parseID3PES(Me,oe),Ht={data:[],size:0}),Ht&&(Ht.data.push(M.subarray(sr,mt+We)),Ht.size+=mt+We-sr);break;case 0:Br&&(sr+=M[sr]+1),Er=this._pmtId=ue(M,sr);break;case Er:Br&&(sr+=M[sr]+1);var Cr=ot(M,sr,this.typeSupported,Q);(Ze=Cr.avc)>0&&(de.pid=Ze),(et=Cr.audio)>0&&(Ce.pid=et,Ce.segmentCodec=Cr.segmentCodec),(ft=Cr.id3)>0&&(Me.pid=ft),ct===null||zt||(ie.logger.warn("MPEG-TS PMT found at "+mt+" after unknown PID '"+ct+"'. Backtracking to sync byte @"+_r+" to parse all TS packets."),ct=null,mt=_r-188),zt=this.pmtParsed=!0;break;case 17:case 8191:break;default:ct=un}}else hr++;hr>0&&this.observer.emit(x.Events.ERROR,x.Events.ERROR,{type:U.ErrorTypes.MEDIA_ERROR,details:U.ErrorDetails.FRAG_PARSING_ERROR,fatal:!1,reason:"Found "+hr+" TS packet/s that do not start with 0x47"}),de.pesData=at,Ce.pesData=kt,Me.pesData=Ht;var cn={audioTrack:Ce,videoTrack:de,id3Track:Me,textTrack:Ne};return se&&this.extractRemainingSamples(cn),cn},$.flush=function(){var M,z=this.remainderData;return this.remainderData=null,M=z?this.demux(z,-1,!1,!0):{videoTrack:this._avcTrack,audioTrack:this._audioTrack,id3Track:this._id3Track,textTrack:this._txtTrack},this.extractRemainingSamples(M),this.sampleAes?this.decrypt(M,this.sampleAes):M},$.extractRemainingSamples=function(M){var z,Q=M.audioTrack,se=M.videoTrack,oe=M.id3Track,de=M.textTrack,Ce=se.pesData,Me=Q.pesData,Ne=oe.pesData;if(Ce&&(z=Fe(Ce))?(this.parseAVCPES(se,de,z,!0),se.pesData=null):se.pesData=Ce,Me&&(z=Fe(Me))){switch(Q.segmentCodec){case"aac":this.parseAACPES(Q,z);break;case"mp3":this.parseMPEGPES(Q,z)}Q.pesData=null}else Me!=null&&Me.size&&ie.logger.log("last AAC PES packet truncated,might overlap between fragments"),Q.pesData=Me;Ne&&(z=Fe(Ne))?(this.parseID3PES(oe,z),oe.pesData=null):oe.pesData=Ne},$.demuxSampleAes=function(M,z,Q){var se=this.demux(M,Q,!0,!this.config.progressive),oe=this.sampleAes=new Te(this.observer,this.config,z);return this.decrypt(se,oe)},$.decrypt=function(M,z){return new Promise(function(Q){var se=M.audioTrack,oe=M.videoTrack;se.samples&&se.segmentCodec==="aac"?z.decryptAacSamples(se.samples,0,function(){oe.samples?z.decryptAvcSamples(oe.samples,0,0,function(){Q(M)}):Q(M)}):oe.samples&&z.decryptAvcSamples(oe.samples,0,0,function(){Q(M)})})},$.destroy=function(){this._duration=0},$.parseAVCPES=function(M,z,Q,se){var oe,de=this,Ce=this.parseAVCNALu(M,Q.data),Me=this.avcSample,Ne=!1;Q.data=null,Me&&Ce.length&&!M.audFound&&(nt(Me,M),Me=this.avcSample=$e(!1,Q.pts,Q.dts,"")),Ce.forEach(function(Ze){switch(Ze.type){case 1:oe=!0,Me||(Me=de.avcSample=$e(!0,Q.pts,Q.dts,"")),Me.frame=!0;var at=Ze.data;if(Ne&&at.length>4){var et=new Be(at).readSliceType();et!==2&&et!==4&&et!==7&&et!==9||(Me.key=!0)}break;case 5:oe=!0,Me||(Me=de.avcSample=$e(!0,Q.pts,Q.dts,"")),Me.key=!0,Me.frame=!0;break;case 6:oe=!0,(0,K.parseSEIMessageFromNALu)(Ze.data,1,Q.pts,z.samples);break;case 7:if(oe=!0,Ne=!0,!M.sps){var ft=new Be(Ze.data).readSPS();M.width=ft.width,M.height=ft.height,M.pixelRatio=ft.pixelRatio,M.sps=[Ze.data],M.duration=de._duration;for(var kt=Ze.data.subarray(1,4),Ht="avc1.",ct=0;ct<3;ct++){var zt=kt[ct].toString(16);zt.length<2&&(zt="0"+zt),Ht+=zt}M.codec=Ht}break;case 8:oe=!0,M.pps||(M.pps=[Ze.data]);break;case 9:oe=!1,M.audFound=!0,Me&&nt(Me,M),Me=de.avcSample=$e(!1,Q.pts,Q.dts,"");break;case 12:oe=!0;break;default:oe=!1,Me&&(Me.debug+="unknown NAL "+Ze.type+" ")}Me&&oe&&Me.units.push(Ze)}),se&&Me&&(nt(Me,M),this.avcSample=null)},$.getLastNalUnit=function(M){var z,Q,se=this.avcSample;if(se&&se.units.length!==0||(se=M[M.length-1]),(z=se)!==null&&z!==void 0&&z.units){var oe=se.units;Q=oe[oe.length-1]}return Q},$.parseAVCNALu=function(M,z){var Q,se,oe=z.byteLength,de=M.naluState||0,Ce=de,Me=[],Ne=0,Ze=-1,at=0;for(de===-1&&(Ze=0,at=31&z[0],de=0,Ne=1);Ne<oe;)if(Q=z[Ne++],de)if(de!==1)if(Q)if(Q===1){if(Ze>=0){var et={data:z.subarray(Ze,Ne-de-1),type:at};Me.push(et)}else{var ft=this.getLastNalUnit(M.samples);if(ft&&(Ce&&Ne<=4-Ce&&ft.state&&(ft.data=ft.data.subarray(0,ft.data.byteLength-Ce)),(se=Ne-de-1)>0)){var kt=new Uint8Array(ft.data.byteLength+se);kt.set(ft.data,0),kt.set(z.subarray(0,se),ft.data.byteLength),ft.data=kt,ft.state=0}}Ne<oe?(Ze=Ne,at=31&z[Ne],de=0):de=-1}else de=0;else de=3;else de=Q?0:2;else de=Q?0:1;if(Ze>=0&&de>=0){var Ht={data:z.subarray(Ze,oe),type:at,state:de};Me.push(Ht)}if(Me.length===0){var ct=this.getLastNalUnit(M.samples);if(ct){var zt=new Uint8Array(ct.data.byteLength+z.byteLength);zt.set(ct.data,0),zt.set(z,ct.data.byteLength),ct.data=zt}}return M.naluState=de,Me},$.parseAACPES=function(M,z){var Q,se,oe,de,Ce,Me=0,Ne=this.aacOverFlow,Ze=z.data;if(Ne){this.aacOverFlow=null;var at=Ne.missing,et=Ne.sample.unit.byteLength;if(at===-1){var ft=new Uint8Array(et+Ze.byteLength);ft.set(Ne.sample.unit,0),ft.set(Ze,et),Ze=ft}else{var kt=et-at;Ne.sample.unit.set(Ze.subarray(0,at),kt),M.samples.push(Ne.sample),Me=Ne.missing}}for(Q=Me,se=Ze.length;Q<se-1&&!me(Ze,Q);Q++);if(Q===Me||(Q<se-1?(oe="AAC PES did not start with ADTS header,offset:"+Q,de=!1):(oe="no ADTS header found in AAC PES",de=!0),ie.logger.warn("parsing error:"+oe),this.observer.emit(x.Events.ERROR,x.Events.ERROR,{type:U.ErrorTypes.MEDIA_ERROR,details:U.ErrorDetails.FRAG_PARSING_ERROR,fatal:de,reason:oe}),!de)){if(j(M,this.observer,Ze,Q,this.audioCodec),z.pts!==void 0)Ce=z.pts;else{if(!Ne)return void ie.logger.warn("[tsdemuxer]: AAC PES unknown PTS");var Ht=C(M.samplerate);Ce=Ne.sample.pts+Ht}for(var ct,zt=0;Q<se;){if(Q+=(ct=q(M,Ze,Q,Ce,zt)).length,ct.missing){this.aacOverFlow=ct;break}for(zt++;Q<se-1&&!me(Ze,Q);Q++);}}},$.parseMPEGPES=function(M,z){var Q=z.data,se=Q.length,oe=0,de=0,Ce=z.pts;if(Ce!==void 0)for(;de<se;)if(De(Q,de)){var Me=Ie(M,Q,de,Ce,oe);if(!Me)break;de+=Me.length,oe++}else de++;else ie.logger.warn("[tsdemuxer]: MPEG PES unknown PTS")},$.parseID3PES=function(M,z){if(z.pts!==void 0){var Q=ze({},z,{type:this._avcTrack?w.MetadataSchema.emsg:w.MetadataSchema.audioId3,duration:Number.POSITIVE_INFINITY});M.samples.push(Q)}else ie.logger.warn("[tsdemuxer]: ID3 PES unknown PTS")},pe}();function Pt(pe,$){return Pt=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(M,z){return M.__proto__=z,M},Pt(pe,$)}const jt=function(pe){var $,M;function z(){return pe.apply(this,arguments)||this}M=pe,($=z).prototype=Object.create(M.prototype),$.prototype.constructor=$,Pt($,M);var Q=z.prototype;return Q.resetInitSegment=function(se,oe,de,Ce){pe.prototype.resetInitSegment.call(this,se,oe,de,Ce),this._audioTrack={container:"audio/mpeg",type:"audio",id:2,pid:-1,sequenceNumber:0,segmentCodec:"mp3",samples:[],manifestCodec:oe,duration:Ce,inputTimeScale:9e4,dropped:0}},z.probe=function(se){if(!se)return!1;for(var oe=(A.getID3Data(se,0)||[]).length,de=se.length;oe<de;oe++)if(ve(se,oe))return ie.logger.log("MPEG Audio sync word found !"),!0;return!1},Q.canParse=function(se,oe){return function(de,Ce){return ce(de,Ce)&&4<=de.length-Ce}(se,oe)},Q.appendFrame=function(se,oe,de){if(this.basePTS!==null)return Ie(se,oe,de,this.basePTS,this.frameIndex)},z}(re);var Rt=k(524),Ct=k(923);function Ft(pe,$){var M=pe==null?void 0:pe.codec;return M&&M.length>4?M:M==="hvc1"||M==="hev1"?"hvc1.1.c.L120.90":M==="av01"?"av01.0.04M.08":M==="avc1"||$===Ct.ElementaryStreamTypes.VIDEO?"avc1.42e01e":"mp4a.40.5"}const Kt=function(){function pe(){this.emitInitSegment=!1,this.audioCodec=void 0,this.videoCodec=void 0,this.initData=void 0,this.initPTS=void 0,this.initTracks=void 0,this.lastEndTime=null}var $=pe.prototype;return $.destroy=function(){},$.resetTimeStamp=function(M){this.initPTS=M,this.lastEndTime=null},$.resetNextTimestamp=function(){this.lastEndTime=null},$.resetInitSegment=function(M,z,Q,se){this.audioCodec=z,this.videoCodec=Q,this.generateInitSegment((0,K.patchEncyptionData)(M,se)),this.emitInitSegment=!0},$.generateInitSegment=function(M){var z=this.audioCodec,Q=this.videoCodec;if(!M||!M.byteLength)return this.initTracks=void 0,void(this.initData=void 0);var se=this.initData=(0,K.parseInitSegment)(M);z||(z=Ft(se.audio,Ct.ElementaryStreamTypes.AUDIO)),Q||(Q=Ft(se.video,Ct.ElementaryStreamTypes.VIDEO));var oe={};se.audio&&se.video?oe.audiovideo={container:"video/mp4",codec:z+","+Q,initSegment:M,id:"main"}:se.audio?oe.audio={container:"audio/mp4",codec:z,initSegment:M,id:"audio"}:se.video?oe.video={container:"video/mp4",codec:Q,initSegment:M,id:"main"}:ie.logger.warn("[passthrough-remuxer.ts]: initSegment does not contain moov or trak boxes."),this.initTracks=oe},$.remux=function(M,z,Q,se,oe){var de,Ce=this.initPTS,Me=this.lastEndTime,Ne={audio:void 0,video:void 0,text:se,id3:Q,initSegment:void 0};(0,E.isFiniteNumber)(Me)||(Me=this.lastEndTime=oe||0);var Ze=z.samples;if(!Ze||!Ze.length)return Ne;var at={initPTS:void 0,timescale:1},et=this.initData;if(et&&et.length||(this.generateInitSegment(Ze),et=this.initData),!et||!et.length)return ie.logger.warn("[passthrough-remuxer.ts]: Failed to generate initSegment."),Ne;this.emitInitSegment&&(at.tracks=this.initTracks,this.emitInitSegment=!1);var ft=(0,K.getStartDTS)(et,Ze);(0,E.isFiniteNumber)(Ce)||(this.initPTS=at.initPTS=Ce=ft-oe);var kt=(0,K.getDuration)(Ze,et),Ht=M?ft-Ce:Me,ct=Ht+kt;(0,K.offsetStartDTS)(et,Ze,Ce),kt>0?this.lastEndTime=ct:(ie.logger.warn("Duration parsed from mp4 should be greater than zero"),this.resetNextTimestamp());var zt=!!et.audio,Er=!!et.video,Qt="";zt&&(Qt+="audio"),Er&&(Qt+="video");var _r={data1:Ze,startPTS:Ht,startDTS:Ht,endPTS:ct,endDTS:ct,type:Qt,hasAudio:zt,hasVideo:Er,nb:1,dropped:0};Ne.audio=_r.type==="audio"?_r:void 0,Ne.video=_r.type!=="audio"?_r:void 0,Ne.initSegment=at;var hr=(de=this.initPTS)!=null?de:0;return Ne.id3=(0,Rt.flushTextTrackMetadataCueSamples)(Q,oe,hr,hr),se.samples.length&&(Ne.text=(0,Rt.flushTextTrackUserdataCueSamples)(se,oe,hr)),Ne},pe}();var It;try{It=self.performance.now.bind(self.performance)}catch{ie.logger.debug("Unable to use Performance API on this environment"),It=self.Date.now}var Zt=[{demux:Ee,remux:Kt},{demux:ht,remux:Rt.default},{demux:ye,remux:Rt.default},{demux:jt,remux:Rt.default}],cr=function(){function pe(M,z,Q,se,oe){this.async=!1,this.observer=void 0,this.typeSupported=void 0,this.config=void 0,this.vendor=void 0,this.id=void 0,this.demuxer=void 0,this.remuxer=void 0,this.decrypter=void 0,this.probe=void 0,this.decryptionPromise=null,this.transmuxConfig=void 0,this.currentTransmuxState=void 0,this.observer=M,this.typeSupported=z,this.config=Q,this.vendor=se,this.id=oe}var $=pe.prototype;return $.configure=function(M){this.transmuxConfig=M,this.decrypter&&this.decrypter.reset()},$.push=function(M,z,Q,se){var oe=this,de=Q.transmuxing;de.executeStart=It();var Ce=new Uint8Array(M),Me=this.currentTransmuxState,Ne=this.transmuxConfig;se&&(this.currentTransmuxState=se);var Ze=se||Me,at=Ze.contiguous,et=Ze.discontinuity,ft=Ze.trackSwitch,kt=Ze.accurateTimeOffset,Ht=Ze.timeOffset,ct=Ze.initSegmentChange,zt=Ne.audioCodec,Er=Ne.videoCodec,Qt=Ne.defaultInitPts,_r=Ne.duration,hr=Ne.initSegmentData,mt=function(Wn,fn){var or=null;return Wn.byteLength>0&&fn!=null&&fn.key!=null&&fn.iv!==null&&fn.method!=null&&(or=fn),or}(Ce,z);if(mt&&mt.method==="AES-128"){var Br=this.getDecrypter();if(!Br.isSync())return this.decryptionPromise=Br.webCryptoDecrypt(Ce,mt.key.buffer,mt.iv.buffer).then(function(Wn){var fn=oe.push(Wn,null,Q);return oe.decryptionPromise=null,fn}),this.decryptionPromise;var un=Br.softwareDecrypt(Ce,mt.key.buffer,mt.iv.buffer);if(Q.part>-1&&(un=Br.flush()),!un)return de.executeEnd=It(),fr(Q);Ce=new Uint8Array(un)}var sr=this.needsProbing(et,ft);sr&&this.configureTransmuxer(Ce),(et||ft||ct||sr)&&this.resetInitSegment(hr,zt,Er,_r,z),(et||ct||sr)&&this.resetInitialTimestamp(Qt),at||this.resetContiguity();var Cr=this.transmux(Ce,mt,Ht,kt,Q),cn=this.currentTransmuxState;return cn.contiguous=!0,cn.discontinuity=!1,cn.trackSwitch=!1,de.executeEnd=It(),Cr},$.flush=function(M){var z=this,Q=M.transmuxing;Q.executeStart=It();var se=this.decrypter,oe=this.currentTransmuxState,de=this.decryptionPromise;if(de)return de.then(function(){return z.flush(M)});var Ce=[],Me=oe.timeOffset;if(se){var Ne=se.flush();Ne&&Ce.push(this.push(Ne,null,M))}var Ze=this.demuxer,at=this.remuxer;if(!Ze||!at)return this.observer.emit(x.Events.ERROR,x.Events.ERROR,{type:U.ErrorTypes.MEDIA_ERROR,details:U.ErrorDetails.FRAG_PARSING_ERROR,fatal:!0,reason:"no demux matching with content found"}),Q.executeEnd=It(),[fr(M)];var et=Ze.flush(Me);return kr(et)?et.then(function(ft){return z.flushRemux(Ce,ft,M),Ce}):(this.flushRemux(Ce,et,M),Ce)},$.flushRemux=function(M,z,Q){var se=z.audioTrack,oe=z.videoTrack,de=z.id3Track,Ce=z.textTrack,Me=this.currentTransmuxState,Ne=Me.accurateTimeOffset,Ze=Me.timeOffset;ie.logger.log("[transmuxer.ts]: Flushed fragment "+Q.sn+(Q.part>-1?" p: "+Q.part:"")+" of level "+Q.level);var at=this.remuxer.remux(se,oe,de,Ce,Ze,Ne,!0,this.id);M.push({remuxResult:at,chunkMeta:Q}),Q.transmuxing.executeEnd=It()},$.resetInitialTimestamp=function(M){var z=this.demuxer,Q=this.remuxer;z&&Q&&(z.resetTimeStamp(M),Q.resetTimeStamp(M))},$.resetContiguity=function(){var M=this.demuxer,z=this.remuxer;M&&z&&(M.resetContiguity(),z.resetNextTimestamp())},$.resetInitSegment=function(M,z,Q,se,oe){var de=this.demuxer,Ce=this.remuxer;de&&Ce&&(de.resetInitSegment(M,z,Q,se),Ce.resetInitSegment(M,z,Q,oe))},$.destroy=function(){this.demuxer&&(this.demuxer.destroy(),this.demuxer=void 0),this.remuxer&&(this.remuxer.destroy(),this.remuxer=void 0)},$.transmux=function(M,z,Q,se,oe){return z&&z.method==="SAMPLE-AES"?this.transmuxSampleAes(M,z,Q,se,oe):this.transmuxUnencrypted(M,Q,se,oe)},$.transmuxUnencrypted=function(M,z,Q,se){var oe=this.demuxer.demux(M,z,!1,!this.config.progressive),de=oe.audioTrack,Ce=oe.videoTrack,Me=oe.id3Track,Ne=oe.textTrack;return{remuxResult:this.remuxer.remux(de,Ce,Me,Ne,z,Q,!1,this.id),chunkMeta:se}},$.transmuxSampleAes=function(M,z,Q,se,oe){var de=this;return this.demuxer.demuxSampleAes(M,z,Q).then(function(Ce){return{remuxResult:de.remuxer.remux(Ce.audioTrack,Ce.videoTrack,Ce.id3Track,Ce.textTrack,Q,se,!1,de.id),chunkMeta:oe}})},$.configureTransmuxer=function(M){for(var z,Q=this.config,se=this.observer,oe=this.typeSupported,de=this.vendor,Ce=0,Me=Zt.length;Ce<Me;Ce++)if(Zt[Ce].demux.probe(M)){z=Zt[Ce];break}z||(ie.logger.warn("Failed to find demuxer by probing frag, treating as mp4 passthrough"),z={demux:Ee,remux:Kt});var Ne=this.demuxer,Ze=this.remuxer,at=z.remux,et=z.demux;Ze&&Ze instanceof at||(this.remuxer=new at(se,Q,oe,de)),Ne&&Ne instanceof et||(this.demuxer=new et(se,Q,oe),this.probe=et.probe)},$.needsProbing=function(M,z){return!this.demuxer||!this.remuxer||M||z},$.getDecrypter=function(){var M=this.decrypter;return M||(M=this.decrypter=new O.default(this.config)),M},pe}(),fr=function(pe){return{remuxResult:{},chunkMeta:pe}};function kr(pe){return"then"in pe&&pe.then instanceof Function}var wr=function(pe,$,M,z,Q){this.audioCodec=void 0,this.videoCodec=void 0,this.initSegmentData=void 0,this.duration=void 0,this.defaultInitPts=void 0,this.audioCodec=pe,this.videoCodec=$,this.initSegmentData=M,this.duration=z,this.defaultInitPts=Q},yr=function(pe,$,M,z,Q,se){this.discontinuity=void 0,this.contiguous=void 0,this.accurateTimeOffset=void 0,this.trackSwitch=void 0,this.timeOffset=void 0,this.initSegmentChange=void 0,this.discontinuity=pe,this.contiguous=$,this.accurateTimeOffset=M,this.trackSwitch=z,this.timeOffset=Q,this.initSegmentChange=se}},973:(L,I,k)=>{var x,U;k.r(I),k.d(I,{ErrorDetails:()=>U,ErrorTypes:()=>x}),function(O){O.NETWORK_ERROR="networkError",O.MEDIA_ERROR="mediaError",O.KEY_SYSTEM_ERROR="keySystemError",O.MUX_ERROR="muxError",O.OTHER_ERROR="otherError"}(x||(x={})),function(O){O.KEY_SYSTEM_NO_KEYS="keySystemNoKeys",O.KEY_SYSTEM_NO_ACCESS="keySystemNoAccess",O.KEY_SYSTEM_NO_SESSION="keySystemNoSession",O.KEY_SYSTEM_NO_CONFIGURED_LICENSE="keySystemNoConfiguredLicense",O.KEY_SYSTEM_LICENSE_REQUEST_FAILED="keySystemLicenseRequestFailed",O.KEY_SYSTEM_SERVER_CERTIFICATE_REQUEST_FAILED="keySystemServerCertificateRequestFailed",O.KEY_SYSTEM_SERVER_CERTIFICATE_UPDATE_FAILED="keySystemServerCertificateUpdateFailed",O.KEY_SYSTEM_SESSION_UPDATE_FAILED="keySystemSessionUpdateFailed",O.KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED="keySystemStatusOutputRestricted",O.KEY_SYSTEM_STATUS_INTERNAL_ERROR="keySystemStatusInternalError",O.MANIFEST_LOAD_ERROR="manifestLoadError",O.MANIFEST_LOAD_TIMEOUT="manifestLoadTimeOut",O.MANIFEST_PARSING_ERROR="manifestParsingError",O.MANIFEST_INCOMPATIBLE_CODECS_ERROR="manifestIncompatibleCodecsError",O.LEVEL_EMPTY_ERROR="levelEmptyError",O.LEVEL_LOAD_ERROR="levelLoadError",O.LEVEL_LOAD_TIMEOUT="levelLoadTimeOut",O.LEVEL_SWITCH_ERROR="levelSwitchError",O.AUDIO_TRACK_LOAD_ERROR="audioTrackLoadError",O.AUDIO_TRACK_LOAD_TIMEOUT="audioTrackLoadTimeOut",O.SUBTITLE_LOAD_ERROR="subtitleTrackLoadError",O.SUBTITLE_TRACK_LOAD_TIMEOUT="subtitleTrackLoadTimeOut",O.FRAG_LOAD_ERROR="fragLoadError",O.FRAG_LOAD_TIMEOUT="fragLoadTimeOut",O.FRAG_DECRYPT_ERROR="fragDecryptError",O.FRAG_PARSING_ERROR="fragParsingError",O.REMUX_ALLOC_ERROR="remuxAllocError",O.KEY_LOAD_ERROR="keyLoadError",O.KEY_LOAD_TIMEOUT="keyLoadTimeOut",O.BUFFER_ADD_CODEC_ERROR="bufferAddCodecError",O.BUFFER_INCOMPATIBLE_CODECS_ERROR="bufferIncompatibleCodecsError",O.BUFFER_APPEND_ERROR="bufferAppendError",O.BUFFER_APPENDING_ERROR="bufferAppendingError",O.BUFFER_STALLED_ERROR="bufferStalledError",O.BUFFER_FULL_ERROR="bufferFullError",O.BUFFER_SEEK_OVER_HOLE="bufferSeekOverHole",O.BUFFER_NUDGE_ON_STALL="bufferNudgeOnStall",O.INTERNAL_EXCEPTION="internalException",O.INTERNAL_ABORTED="aborted",O.UNKNOWN="unknown"}(U||(U={}))},851:(L,I,k)=>{var x;k.r(I),k.d(I,{Events:()=>x}),function(U){U.MEDIA_ATTACHING="hlsMediaAttaching",U.MEDIA_ATTACHED="hlsMediaAttached",U.MEDIA_DETACHING="hlsMediaDetaching",U.MEDIA_DETACHED="hlsMediaDetached",U.BUFFER_RESET="hlsBufferReset",U.BUFFER_CODECS="hlsBufferCodecs",U.BUFFER_CREATED="hlsBufferCreated",U.BUFFER_APPENDING="hlsBufferAppending",U.BUFFER_APPENDED="hlsBufferAppended",U.BUFFER_EOS="hlsBufferEos",U.BUFFER_FLUSHING="hlsBufferFlushing",U.BUFFER_FLUSHED="hlsBufferFlushed",U.MANIFEST_LOADING="hlsManifestLoading",U.MANIFEST_LOADED="hlsManifestLoaded",U.MANIFEST_PARSED="hlsManifestParsed",U.LEVEL_SWITCHING="hlsLevelSwitching",U.LEVEL_SWITCHED="hlsLevelSwitched",U.LEVEL_LOADING="hlsLevelLoading",U.LEVEL_LOADED="hlsLevelLoaded",U.LEVEL_UPDATED="hlsLevelUpdated",U.LEVEL_PTS_UPDATED="hlsLevelPtsUpdated",U.LEVELS_UPDATED="hlsLevelsUpdated",U.AUDIO_TRACKS_UPDATED="hlsAudioTracksUpdated",U.AUDIO_TRACK_SWITCHING="hlsAudioTrackSwitching",U.AUDIO_TRACK_SWITCHED="hlsAudioTrackSwitched",U.AUDIO_TRACK_LOADING="hlsAudioTrackLoading",U.AUDIO_TRACK_LOADED="hlsAudioTrackLoaded",U.SUBTITLE_TRACKS_UPDATED="hlsSubtitleTracksUpdated",U.SUBTITLE_TRACKS_CLEARED="hlsSubtitleTracksCleared",U.SUBTITLE_TRACK_SWITCH="hlsSubtitleTrackSwitch",U.SUBTITLE_TRACK_LOADING="hlsSubtitleTrackLoading",U.SUBTITLE_TRACK_LOADED="hlsSubtitleTrackLoaded",U.SUBTITLE_FRAG_PROCESSED="hlsSubtitleFragProcessed",U.CUES_PARSED="hlsCuesParsed",U.NON_NATIVE_TEXT_TRACKS_FOUND="hlsNonNativeTextTracksFound",U.INIT_PTS_FOUND="hlsInitPtsFound",U.FRAG_LOADING="hlsFragLoading",U.FRAG_LOAD_EMERGENCY_ABORTED="hlsFragLoadEmergencyAborted",U.FRAG_LOADED="hlsFragLoaded",U.FRAG_DECRYPTED="hlsFragDecrypted",U.FRAG_PARSING_INIT_SEGMENT="hlsFragParsingInitSegment",U.FRAG_PARSING_USERDATA="hlsFragParsingUserdata",U.FRAG_PARSING_METADATA="hlsFragParsingMetadata",U.FRAG_PARSED="hlsFragParsed",U.FRAG_BUFFERED="hlsFragBuffered",U.FRAG_CHANGED="hlsFragChanged",U.FPS_DROP="hlsFpsDrop",U.FPS_DROP_LEVEL_CAPPING="hlsFpsDropLevelCapping",U.ERROR="hlsError",U.DESTROYING="hlsDestroying",U.KEY_LOADING="hlsKeyLoading",U.KEY_LOADED="hlsKeyLoaded",U.LIVE_BACK_BUFFER_REACHED="hlsLiveBackBufferReached",U.BACK_BUFFER_REACHED="hlsBackBufferReached"}(x||(x={}))},76:(L,I,k)=>{k.r(I),k.d(I,{default:()=>An});var x,U=k(945),O=k(965),E=k(851),A=k(973),w=k(93),te=/^(\d+)x(\d+)$/,K=/\s*(.+?)\s*=((?:\".*?\")|.*?)(?:,|$)/g,V=function(){function v(t){for(var n in typeof t=="string"&&(t=v.parseAttrList(t)),t)t.hasOwnProperty(n)&&(this[n]=t[n])}var h=v.prototype;return h.decimalInteger=function(t){var n=parseInt(this[t],10);return n>Number.MAX_SAFE_INTEGER?1/0:n},h.hexadecimalInteger=function(t){if(this[t]){var n=(this[t]||"0x").slice(2);n=(1&n.length?"0":"")+n;for(var s=new Uint8Array(n.length/2),o=0;o<n.length/2;o++)s[o]=parseInt(n.slice(2*o,2*o+2),16);return s}return null},h.hexadecimalIntegerAsNumber=function(t){var n=parseInt(this[t],16);return n>Number.MAX_SAFE_INTEGER?1/0:n},h.decimalFloatingPoint=function(t){return parseFloat(this[t])},h.optionalFloat=function(t,n){var s=this[t];return s?parseFloat(s):n},h.enumeratedString=function(t){return this[t]},h.bool=function(t){return this[t]==="YES"},h.decimalResolution=function(t){var n=te.exec(this[t]);if(n!==null)return{width:parseInt(n[1],10),height:parseInt(n[2],10)}},v.parseAttrList=function(t){var n,s={};for(K.lastIndex=0;(n=K.exec(t))!==null;){var o=n[2];o.indexOf('"')===0&&o.lastIndexOf('"')===o.length-1&&(o=o.slice(1,-1)),s[n[1]]=o}return s},v}();function ne(){return ne=Object.assign?Object.assign.bind():function(v){for(var h=1;h<arguments.length;h++){var t=arguments[h];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(v[n]=t[n])}return v},ne.apply(this,arguments)}function Y(v,h){for(var t=0;t<h.length;t++){var n=h[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(v,typeof(s=function(o,c){if(typeof o!="object"||o===null)return o;var i=o[Symbol.toPrimitive];if(i!==void 0){var u=i.call(o,c);if(typeof u!="object")return u;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(o)}(n.key,"string"))=="symbol"?s:String(s),n)}var s}(function(v){v.ID="ID",v.CLASS="CLASS",v.START_DATE="START-DATE",v.DURATION="DURATION",v.END_DATE="END-DATE",v.END_ON_NEXT="END-ON-NEXT",v.PLANNED_DURATION="PLANNED-DURATION",v.SCTE35_OUT="SCTE35-OUT",v.SCTE35_IN="SCTE35-IN"})(x||(x={}));var re=function(){function v(n,s){if(this.attr=void 0,this._startDate=void 0,this._endDate=void 0,this._badValueForSameId=void 0,s){var o=s.attr;for(var c in o)if(Object.prototype.hasOwnProperty.call(n,c)&&n[c]!==o[c]){w.logger.warn('DATERANGE tag attribute: "'+c+'" does not match for tags with ID: "'+n.ID+'"'),this._badValueForSameId=c;break}n=ne(new V({}),o,n)}if(this.attr=n,this._startDate=new Date(n[x.START_DATE]),x.END_DATE in this.attr){var i=new Date(this.attr[x.END_DATE]);(0,O.isFiniteNumber)(i.getTime())&&(this._endDate=i)}}var h,t;return h=v,(t=[{key:"id",get:function(){return this.attr.ID}},{key:"class",get:function(){return this.attr.CLASS}},{key:"startDate",get:function(){return this._startDate}},{key:"endDate",get:function(){if(this._endDate)return this._endDate;var n=this.duration;return n!==null?new Date(this._startDate.getTime()+1e3*n):null}},{key:"duration",get:function(){if(x.DURATION in this.attr){var n=this.attr.decimalFloatingPoint(x.DURATION);if((0,O.isFiniteNumber)(n))return n}else if(this._endDate)return(this._endDate.getTime()-this._startDate.getTime())/1e3;return null}},{key:"plannedDuration",get:function(){return x.PLANNED_DURATION in this.attr?this.attr.decimalFloatingPoint(x.PLANNED_DURATION):null}},{key:"endOnNext",get:function(){return this.attr.bool(x.END_ON_NEXT)}},{key:"isValid",get:function(){return!!this.id&&!this._badValueForSameId&&(0,O.isFiniteNumber)(this.startDate.getTime())&&(this.duration===null||this.duration>=0)&&(!this.endOnNext||!!this.class)}}])&&Y(h.prototype,t),Object.defineProperty(h,"prototype",{writable:!1}),v}(),ie=k(923);function Z(v,h){for(var t=0;t<h.length;t++){var n=h[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(v,typeof(s=function(o,c){if(typeof o!="object"||o===null)return o;var i=o[Symbol.toPrimitive];if(i!==void 0){var u=i.call(o,c);if(typeof u!="object")return u;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(o)}(n.key,"string"))=="symbol"?s:String(s),n)}var s}var N,W,me,xe=function(){function v(n){this.PTSKnown=!1,this.alignedSliding=!1,this.averagetargetduration=void 0,this.endCC=0,this.endSN=0,this.fragments=void 0,this.fragmentHint=void 0,this.partList=null,this.dateRanges=void 0,this.live=!0,this.ageHeader=0,this.advancedDateTime=void 0,this.updated=!0,this.advanced=!0,this.availabilityDelay=void 0,this.misses=0,this.startCC=0,this.startSN=0,this.startTimeOffset=null,this.targetduration=0,this.totalduration=0,this.type=null,this.url=void 0,this.m3u8="",this.version=null,this.canBlockReload=!1,this.canSkipUntil=0,this.canSkipDateRanges=!1,this.skippedSegments=0,this.recentlyRemovedDateranges=void 0,this.partHoldBack=0,this.holdBack=0,this.partTarget=0,this.preloadHint=void 0,this.renditionReports=void 0,this.tuneInGoal=0,this.deltaUpdateFailed=void 0,this.driftStartTime=0,this.driftEndTime=0,this.driftStart=0,this.driftEnd=0,this.encryptedFragments=void 0,this.fragments=[],this.encryptedFragments=[],this.dateRanges={},this.url=n}var h,t;return v.prototype.reloaded=function(n){if(!n)return this.advanced=!0,void(this.updated=!0);var s=this.lastPartSn-n.lastPartSn,o=this.lastPartIndex-n.lastPartIndex;this.updated=this.endSN!==n.endSN||!!o||!!s,this.advanced=this.endSN>n.endSN||s>0||s===0&&o>0,this.updated||this.advanced?this.misses=Math.floor(.6*n.misses):this.misses=n.misses+1,this.availabilityDelay=n.availabilityDelay},h=v,(t=[{key:"hasProgramDateTime",get:function(){return!!this.fragments.length&&(0,O.isFiniteNumber)(this.fragments[this.fragments.length-1].programDateTime)}},{key:"levelTargetDuration",get:function(){return this.averagetargetduration||this.targetduration||10}},{key:"drift",get:function(){var n=this.driftEndTime-this.driftStartTime;return n>0?1e3*(this.driftEnd-this.driftStart)/n:1}},{key:"edge",get:function(){return this.partEnd||this.fragmentEnd}},{key:"partEnd",get:function(){var n;return(n=this.partList)!==null&&n!==void 0&&n.length?this.partList[this.partList.length-1].end:this.fragmentEnd}},{key:"fragmentEnd",get:function(){var n;return(n=this.fragments)!==null&&n!==void 0&&n.length?this.fragments[this.fragments.length-1].end:0}},{key:"age",get:function(){return this.advancedDateTime?Math.max(Date.now()-this.advancedDateTime,0)/1e3:0}},{key:"lastPartIndex",get:function(){var n;return(n=this.partList)!==null&&n!==void 0&&n.length?this.partList[this.partList.length-1].index:-1}},{key:"lastPartSn",get:function(){var n;return(n=this.partList)!==null&&n!==void 0&&n.length?this.partList[this.partList.length-1].fragment.sn:this.endSN}}])&&Z(h.prototype,t),Object.defineProperty(h,"prototype",{writable:!1}),v}();function j(v){return Uint8Array.from(atob(v),function(h){return h.charCodeAt(0)})}function C(v){return Uint8Array.from(unescape(encodeURIComponent(v)),function(h){return h.charCodeAt(0)})}function q(v){switch(v){case W.FAIRPLAY:return N.FAIRPLAY;case W.PLAYREADY:return N.PLAYREADY;case W.WIDEVINE:return N.WIDEVINE;case W.CLEARKEY:return N.CLEARKEY}}function H(v){switch(v){case N.FAIRPLAY:return W.FAIRPLAY;case N.PLAYREADY:return W.PLAYREADY;case N.WIDEVINE:return W.WIDEVINE;case N.CLEARKEY:return W.CLEARKEY}}function ye(v){var h=v.drmSystems,t=v.widevineLicenseUrl,n=h?[N.FAIRPLAY,N.WIDEVINE,N.PLAYREADY,N.CLEARKEY].filter(function(s){return!!h[s]}):[];return!n[N.WIDEVINE]&&t&&n.push(N.WIDEVINE),n}(function(v){v.CLEARKEY="org.w3.clearkey",v.FAIRPLAY="com.apple.fps",v.PLAYREADY="com.microsoft.playready",v.WIDEVINE="com.widevine.alpha"})(N||(N={})),function(v){v.CLEARKEY="org.w3.clearkey",v.FAIRPLAY="com.apple.streamingkeydelivery",v.PLAYREADY="com.microsoft.playready",v.WIDEVINE="urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed"}(W||(W={})),function(v){v.WIDEVINE="edef8ba979d64acea3c827dcd51d21ed"}(me||(me={}));var he=typeof self<"u"&&self.navigator&&self.navigator.requestMediaKeySystemAccess?self.navigator.requestMediaKeySystemAccess.bind(self.navigator):null,Ee=k(63),Ae={},qe=function(){function v(t,n,s,o,c){o===void 0&&(o=[1]),c===void 0&&(c=null),this.uri=void 0,this.method=void 0,this.keyFormat=void 0,this.keyFormatVersions=void 0,this.encrypted=void 0,this.isCommonEncryption=void 0,this.iv=null,this.key=null,this.keyId=null,this.pssh=null,this.method=t,this.uri=n,this.keyFormat=s,this.keyFormatVersions=o,this.iv=c,this.encrypted=!!t&&t!=="NONE",this.isCommonEncryption=this.encrypted&&t!=="AES-128"}v.clearKeyUriToKeyIdMap=function(){Ae={}};var h=v.prototype;return h.isSupported=function(){if(this.method){if(this.method==="AES-128"||this.method==="NONE")return!0;switch(this.keyFormat){case"identity":return this.method==="SAMPLE-AES";case W.FAIRPLAY:case W.WIDEVINE:case W.PLAYREADY:case W.CLEARKEY:return["ISO-23001-7","SAMPLE-AES","SAMPLE-AES-CENC","SAMPLE-AES-CTR"].indexOf(this.method)!==-1}}return!1},h.getDecryptData=function(t){if(!this.encrypted||!this.uri)return null;if(this.method==="AES-128"&&this.uri&&!this.iv){typeof t!="number"&&(this.method!=="AES-128"||this.iv||w.logger.warn('missing IV for initialization segment with method="'+this.method+'" - compliance issue'),t=0);var n=function(ee){for(var J=new Uint8Array(16),le=12;le<16;le++)J[le]=ee>>8*(15-le)&255;return J}(t);return new v(this.method,this.uri,"identity",this.keyFormatVersions,n)}var s=function(ee){var J,le,Se=ee.split(":"),we=null;if(Se[0]==="data"&&Se.length===2){var be=Se[1].split(";"),Pe=be[be.length-1].split(",");if(Pe.length===2){var tt=Pe[0]==="base64",rt=Pe[1];tt?(be.splice(-1,1),we=j(rt)):(J=C(rt).subarray(0,16),(le=new Uint8Array(16)).set(J,16-J.length),we=le)}}return we}(this.uri);if(s)switch(this.keyFormat){case W.WIDEVINE:this.pssh=s,s.length>=22&&(this.keyId=s.subarray(s.length-22,s.length-6));break;case W.PLAYREADY:var o=new Uint8Array([154,4,240,121,152,64,66,134,171,146,230,91,224,136,95,149]);this.pssh=(0,Ee.mp4pssh)(o,null,s);var c=new Uint16Array(s.buffer,s.byteOffset,s.byteLength/2),i=String.fromCharCode.apply(null,Array.from(c)),u=i.substring(i.indexOf("<"),i.length),p=new DOMParser().parseFromString(u,"text/xml").getElementsByTagName("KID")[0];if(p){var g=p.childNodes[0]?p.childNodes[0].nodeValue:p.getAttribute("VALUE");if(g){var y=j(g).subarray(0,16);(function(ee){var J=function(le,Se,we){var be=le[Se];le[Se]=le[we],le[we]=be};J(ee,0,3),J(ee,1,2),J(ee,4,5),J(ee,6,7)})(y),this.keyId=y}}break;default:var b=s.subarray(0,16);if(b.length!==16){var D=new Uint8Array(16);D.set(b,16-b.length),b=D}this.keyId=b}if(!this.keyId||this.keyId.byteLength!==16){var F=Ae[this.uri];if(!F){var G=Object.keys(Ae).length%Number.MAX_SAFE_INTEGER;F=new Uint8Array(16),new DataView(F.buffer,12,4).setUint32(0,G),Ae[this.uri]=F}this.keyId=F}return this},v}(),je={audio:{a3ds:!0,"ac-3":!0,"ac-4":!0,alac:!0,alaw:!0,dra1:!0,"dts+":!0,"dts-":!0,dtsc:!0,dtse:!0,dtsh:!0,"ec-3":!0,enca:!0,g719:!0,g726:!0,m4ae:!0,mha1:!0,mha2:!0,mhm1:!0,mhm2:!0,mlpa:!0,mp4a:!0,"raw ":!0,Opus:!0,opus:!0,samr:!0,sawb:!0,sawp:!0,sevc:!0,sqcp:!0,ssmv:!0,twos:!0,ulaw:!0},video:{avc1:!0,avc2:!0,avc3:!0,avc4:!0,avcp:!0,av01:!0,drac:!0,dva1:!0,dvav:!0,dvh1:!0,dvhe:!0,encv:!0,hev1:!0,hvc1:!0,mjp2:!0,mp4v:!0,mvc1:!0,mvc2:!0,mvc3:!0,mvc4:!0,resv:!0,rv60:!0,s263:!0,svc1:!0,svc2:!0,"vc-1":!0,vp08:!0,vp09:!0},text:{stpp:!0,wvtt:!0}};function Xe(v,h){return MediaSource.isTypeSupported((h||"video")+'/mp4;codecs="'+v+'"')}function Ve(){return Ve=Object.assign?Object.assign.bind():function(v){for(var h=1;h<arguments.length;h++){var t=arguments[h];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(v[n]=t[n])}return v},Ve.apply(this,arguments)}var Ie=/#EXT-X-STREAM-INF:([^\r\n]*)(?:[\r\n](?:#[^\r\n]*)?)*([^\r\n]+)|#EXT-X-SESSION-DATA:([^\r\n]*)[\r\n]+|#EXT-X-SESSION-KEY:([^\n\r]*)[\r\n]+/g,He=/#EXT-X-MEDIA:(.*)/g,ce=new RegExp([/#EXTINF:\s*(\d*(?:\.\d+)?)(?:,(.*)\s+)?/.source,/(?!#) *(\S[\S ]*)/.source,/#EXT-X-BYTERANGE:*(.+)/.source,/#EXT-X-PROGRAM-DATE-TIME:(.+)/.source,/#.*/.source].join("|"),"g"),De=new RegExp([/#(EXTM3U)/.source,/#EXT-X-(DATERANGE|KEY|MAP|PART|PART-INF|PLAYLIST-TYPE|PRELOAD-HINT|RENDITION-REPORT|SERVER-CONTROL|SKIP|START):(.+)/.source,/#EXT-X-(BITRATE|DISCONTINUITY-SEQUENCE|MEDIA-SEQUENCE|TARGETDURATION|VERSION): *(\d+)/.source,/#EXT-X-(DISCONTINUITY|ENDLIST|GAP)/.source,/(#)([^:]*):(.*)/.source,/(#)(.*)(?:.*)\r?\n?/.source].join("|")),ve=function(){function v(){}return v.findGroup=function(h,t){for(var n=0;n<h.length;n++){var s=h[n];if(s.id===t)return s}},v.convertAVC1ToAVCOTI=function(h){var t=h.split(".");if(t.length>2){var n=t.shift()+".";return(n+=parseInt(t.shift()).toString(16))+("000"+parseInt(t.shift()).toString(16)).slice(-4)}return h},v.resolve=function(h,t){return(0,U.buildAbsoluteURL)(t,h,{alwaysNormalize:!0})},v.parseMasterPlaylist=function(h,t){var n,s=[],o=[],c={},i=[],u=!1;for(Ie.lastIndex=0;(n=Ie.exec(h))!=null;)if(n[1]){var p,g=new V(n[1]),y={attrs:g,bitrate:g.decimalInteger("AVERAGE-BANDWIDTH")||g.decimalInteger("BANDWIDTH"),name:g.NAME,url:v.resolve(n[2],t)},b=g.decimalResolution("RESOLUTION");b&&(y.width=b.width,y.height=b.height),Te((g.CODECS||"").split(/[ ,]+/).filter(function(ee){return ee}),y),y.videoCodec&&y.videoCodec.indexOf("avc1")!==-1&&(y.videoCodec=v.convertAVC1ToAVCOTI(y.videoCodec)),(p=y.unknownCodecs)!==null&&p!==void 0&&p.length||o.push(y),s.push(y)}else if(n[3]){var D=new V(n[3]);D["DATA-ID"]&&(u=!0,c[D["DATA-ID"]]=D)}else if(n[4]){var F=n[4],G=Be(F,t);G.encrypted&&G.isSupported()?i.push(G):w.logger.warn('[Keys] Ignoring invalid EXT-X-SESSION-KEY tag: "'+F+'"')}return{levels:o.length>0&&o.length<s.length?o:s,sessionData:u?c:null,sessionKeys:i.length?i:null}},v.parseMasterPlaylistMedia=function(h,t,n,s){var o;s===void 0&&(s=[]);var c=[],i=0;for(He.lastIndex=0;(o=He.exec(h))!==null;){var u=new V(o[1]);if(u.TYPE===n){var p={attrs:u,bitrate:0,id:i++,groupId:u["GROUP-ID"],instreamId:u["INSTREAM-ID"],name:u.NAME||u.LANGUAGE||"",type:n,default:u.bool("DEFAULT"),autoselect:u.bool("AUTOSELECT"),forced:u.bool("FORCED"),lang:u.LANGUAGE,url:u.URI?v.resolve(u.URI,t):""};if(s.length){var g=v.findGroup(s,p.groupId)||s[0];ze(p,g,"audioCodec"),ze(p,g,"textCodec")}c.push(p)}}return c},v.parseLevelPlaylist=function(h,t,n,s,o){var c,i,u,p=new xe(t),g=p.fragments,y=null,b=0,D=0,F=0,G=0,ee=null,J=new ie.Fragment(s,t),le=-1,Se=!1;for(ce.lastIndex=0,p.m3u8=h;(c=ce.exec(h))!==null;){Se&&(Se=!1,(J=new ie.Fragment(s,t)).start=F,J.sn=b,J.cc=G,J.level=n,y&&(J.initSegment=y,J.rawProgramDateTime=y.rawProgramDateTime,y.rawProgramDateTime=null));var we=c[1];if(we){J.duration=parseFloat(we);var be=(" "+c[2]).slice(1);J.title=be||null,J.tagList.push(be?["INF",we,be]:["INF",we])}else if(c[3])(0,O.isFiniteNumber)(J.duration)&&(J.start=F,u&&it(J,u,p),J.sn=b,J.level=n,J.cc=G,J.urlId=o,g.push(J),J.relurl=(" "+c[3]).slice(1),We(J,ee),ee=J,F+=J.duration,b++,D=0,Se=!0);else if(c[4]){var Pe=(" "+c[4]).slice(1);ee?J.setByteRange(Pe,ee):J.setByteRange(Pe)}else if(c[5])J.rawProgramDateTime=(" "+c[5]).slice(1),J.tagList.push(["PROGRAM-DATE-TIME",J.rawProgramDateTime]),le===-1&&(le=g.length);else{if(!(c=c[0].match(De))){w.logger.warn("No matches on slow regex match for level playlist!");continue}for(i=1;i<c.length&&c[i]===void 0;i++);var tt=(" "+c[i]).slice(1),rt=(" "+c[i+1]).slice(1),Ge=c[i+2]?(" "+c[i+2]).slice(1):"";switch(tt){case"PLAYLIST-TYPE":p.type=rt.toUpperCase();break;case"MEDIA-SEQUENCE":b=p.startSN=parseInt(rt);break;case"SKIP":var Je=new V(rt),Qe=Je.decimalInteger("SKIPPED-SEGMENTS");if((0,O.isFiniteNumber)(Qe)){p.skippedSegments=Qe;for(var Dt=Qe;Dt--;)g.unshift(null);b+=Qe}var Vt=Je.enumeratedString("RECENTLY-REMOVED-DATERANGES");Vt&&(p.recentlyRemovedDateranges=Vt.split("	"));break;case"TARGETDURATION":p.targetduration=parseFloat(rt);break;case"VERSION":p.version=parseInt(rt);break;case"EXTM3U":break;case"ENDLIST":p.live=!1;break;case"#":(rt||Ge)&&J.tagList.push(Ge?[rt,Ge]:[rt]);break;case"DISCONTINUITY":G++,J.tagList.push(["DIS"]);break;case"GAP":J.tagList.push([tt]);break;case"BITRATE":J.tagList.push([tt,rt]);break;case"DATERANGE":var St=new V(rt),wt=new re(St,p.dateRanges[St.ID]);wt.isValid||p.skippedSegments?p.dateRanges[wt.id]=wt:w.logger.warn('Ignoring invalid DATERANGE tag: "'+rt+'"'),J.tagList.push(["EXT-X-DATERANGE",rt]);break;case"DISCONTINUITY-SEQUENCE":G=parseInt(rt);break;case"KEY":var Mt=Be(rt,t);if(Mt.isSupported()){if(Mt.method==="NONE"){u=void 0;break}u||(u={}),u[Mt.keyFormat]&&(u=Ve({},u)),u[Mt.keyFormat]=Mt}else w.logger.warn('[Keys] Ignoring invalid EXT-X-KEY tag: "'+rt+'"');break;case"START":var pr=new V(rt).decimalFloatingPoint("TIME-OFFSET");(0,O.isFiniteNumber)(pr)&&(p.startTimeOffset=pr);break;case"MAP":var gr=new V(rt);if(J.duration){var lr=new ie.Fragment(s,t);$e(lr,gr,n,u),y=lr,J.initSegment=y,y.rawProgramDateTime&&!J.rawProgramDateTime&&(J.rawProgramDateTime=y.rawProgramDateTime)}else $e(J,gr,n,u),y=J,Se=!0;break;case"SERVER-CONTROL":var dr=new V(rt);p.canBlockReload=dr.bool("CAN-BLOCK-RELOAD"),p.canSkipUntil=dr.optionalFloat("CAN-SKIP-UNTIL",0),p.canSkipDateRanges=p.canSkipUntil>0&&dr.bool("CAN-SKIP-DATERANGES"),p.partHoldBack=dr.optionalFloat("PART-HOLD-BACK",0),p.holdBack=dr.optionalFloat("HOLD-BACK",0);break;case"PART-INF":var wn=new V(rt);p.partTarget=wn.decimalFloatingPoint("PART-TARGET");break;case"PART":var Qn=p.partList;Qn||(Qn=p.partList=[]);var Rn=D>0?Qn[Qn.length-1]:void 0,Dn=D++,Xn=new ie.Part(new V(rt),J,t,Dn,Rn);Qn.push(Xn),J.duration+=Xn.duration;break;case"PRELOAD-HINT":var P=new V(rt);p.preloadHint=P;break;case"RENDITION-REPORT":var gt=new V(rt);p.renditionReports=p.renditionReports||[],p.renditionReports.push(gt);break;default:w.logger.warn("line parsed but not handled: "+c)}}}ee&&!ee.relurl?(g.pop(),F-=ee.duration,p.partList&&(p.fragmentHint=ee)):p.partList&&(We(J,ee),J.cc=G,p.fragmentHint=J,u&&it(J,u,p));var bt=g.length,Nr=g[0],At=g[bt-1];if((F+=p.skippedSegments*p.targetduration)>0&&bt&&At){p.averagetargetduration=F/bt;var In=At.sn;p.endSN=In!=="initSegment"?In:0,p.live||(At.endList=!0),Nr&&(p.startCC=Nr.cc)}else p.endSN=0,p.startCC=0;return p.fragmentHint&&(F+=p.fragmentHint.duration),p.totalduration=F,p.endCC=G,le>0&&function(bi,kn){for(var Gr=bi[kn],Nn=kn;Nn--;){var qr=bi[Nn];if(!qr)return;qr.programDateTime=Gr.programDateTime-1e3*qr.duration,Gr=qr}}(g,le),p},v}();function Be(v,h){var t,n,s=new V(v),o=(t=s.enumeratedString("METHOD"))!=null?t:"",c=s.URI,i=s.hexadecimalInteger("IV"),u=s.enumeratedString("KEYFORMATVERSIONS"),p=(n=s.enumeratedString("KEYFORMAT"))!=null?n:"identity";c&&s.IV&&!i&&w.logger.error("Invalid IV: "+s.IV);var g=c?ve.resolve(c,h):"",y=(u||"1").split("/").map(Number).filter(Number.isFinite);return new qe(o,g,p,y,i)}function Te(v,h){["video","audio","text"].forEach(function(t){var n=v.filter(function(o){return function(c,i){var u=je[i];return!!u&&u[c.slice(0,4)]===!0}(o,t)});if(n.length){var s=n.filter(function(o){return o.lastIndexOf("avc1",0)===0||o.lastIndexOf("mp4a",0)===0});h[t+"Codec"]=s.length>0?s[0]:n[0],v=v.filter(function(o){return n.indexOf(o)===-1})}}),h.unknownCodecs=v}function ze(v,h,t){var n=h[t];n&&(v[t]=n)}function We(v,h){v.rawProgramDateTime?v.programDateTime=Date.parse(v.rawProgramDateTime):h!=null&&h.programDateTime&&(v.programDateTime=h.endProgramDateTime),(0,O.isFiniteNumber)(v.programDateTime)||(v.programDateTime=null,v.rawProgramDateTime=null)}function $e(v,h,t,n){v.relurl=h.URI,h.BYTERANGE&&v.setByteRange(h.BYTERANGE),v.level=t,v.sn="initSegment",n&&(v.levelkeys=n),v.initSegment=null}function it(v,h,t){v.levelkeys=h;var n=t.encryptedFragments;n.length&&n[n.length-1].levelkeys===h||!Object.keys(h).some(function(s){return h[s].isCommonEncryption})||n.push(v)}var ue=k(308);function ot(v,h){var t=v.url;return t!==void 0&&t.indexOf("data:")!==0||(t=h.url),t}const Fe=function(){function v(t){this.hls=void 0,this.loaders=Object.create(null),this.hls=t,this.registerListeners()}var h=v.prototype;return h.startLoad=function(t){},h.stopLoad=function(){this.destroyInternalLoaders()},h.registerListeners=function(){var t=this.hls;t.on(E.Events.MANIFEST_LOADING,this.onManifestLoading,this),t.on(E.Events.LEVEL_LOADING,this.onLevelLoading,this),t.on(E.Events.AUDIO_TRACK_LOADING,this.onAudioTrackLoading,this),t.on(E.Events.SUBTITLE_TRACK_LOADING,this.onSubtitleTrackLoading,this)},h.unregisterListeners=function(){var t=this.hls;t.off(E.Events.MANIFEST_LOADING,this.onManifestLoading,this),t.off(E.Events.LEVEL_LOADING,this.onLevelLoading,this),t.off(E.Events.AUDIO_TRACK_LOADING,this.onAudioTrackLoading,this),t.off(E.Events.SUBTITLE_TRACK_LOADING,this.onSubtitleTrackLoading,this)},h.createInternalLoader=function(t){var n=this.hls.config,s=n.pLoader,o=n.loader,c=new(s||o)(n);return t.loader=c,this.loaders[t.type]=c,c},h.getInternalLoader=function(t){return this.loaders[t.type]},h.resetInternalLoader=function(t){this.loaders[t]&&delete this.loaders[t]},h.destroyInternalLoaders=function(){for(var t in this.loaders){var n=this.loaders[t];n&&n.destroy(),this.resetInternalLoader(t)}},h.destroy=function(){this.unregisterListeners(),this.destroyInternalLoaders()},h.onManifestLoading=function(t,n){var s=n.url;this.load({id:null,groupId:null,level:0,responseType:"text",type:ue.PlaylistContextType.MANIFEST,url:s,deliveryDirectives:null})},h.onLevelLoading=function(t,n){var s=n.id,o=n.level,c=n.url,i=n.deliveryDirectives;this.load({id:s,groupId:null,level:o,responseType:"text",type:ue.PlaylistContextType.LEVEL,url:c,deliveryDirectives:i})},h.onAudioTrackLoading=function(t,n){var s=n.id,o=n.groupId,c=n.url,i=n.deliveryDirectives;this.load({id:s,groupId:o,level:null,responseType:"text",type:ue.PlaylistContextType.AUDIO_TRACK,url:c,deliveryDirectives:i})},h.onSubtitleTrackLoading=function(t,n){var s=n.id,o=n.groupId,c=n.url,i=n.deliveryDirectives;this.load({id:s,groupId:o,level:null,responseType:"text",type:ue.PlaylistContextType.SUBTITLE_TRACK,url:c,deliveryDirectives:i})},h.load=function(t){var n,s,o,c,i,u,p=this.hls.config,g=this.getInternalLoader(t);if(g){var y=g.context;if(y&&y.url===t.url)return void w.logger.trace("[playlist-loader]: playlist request ongoing");w.logger.log("[playlist-loader]: aborting previous loader for type: "+t.type),g.abort()}switch(t.type){case ue.PlaylistContextType.MANIFEST:s=p.manifestLoadingMaxRetry,o=p.manifestLoadingTimeOut,c=p.manifestLoadingRetryDelay,i=p.manifestLoadingMaxRetryTimeout;break;case ue.PlaylistContextType.LEVEL:case ue.PlaylistContextType.AUDIO_TRACK:case ue.PlaylistContextType.SUBTITLE_TRACK:s=0,o=p.levelLoadingTimeOut;break;default:s=p.levelLoadingMaxRetry,o=p.levelLoadingTimeOut,c=p.levelLoadingRetryDelay,i=p.levelLoadingMaxRetryTimeout}if(g=this.createInternalLoader(t),(n=t.deliveryDirectives)!==null&&n!==void 0&&n.part&&(t.type===ue.PlaylistContextType.LEVEL&&t.level!==null?u=this.hls.levels[t.level].details:t.type===ue.PlaylistContextType.AUDIO_TRACK&&t.id!==null?u=this.hls.audioTracks[t.id].details:t.type===ue.PlaylistContextType.SUBTITLE_TRACK&&t.id!==null&&(u=this.hls.subtitleTracks[t.id].details),u)){var b=u.partTarget,D=u.targetduration;b&&D&&(o=Math.min(1e3*Math.max(3*b,.8*D),o))}var F={timeout:o,maxRetry:s,retryDelay:c,maxRetryDelay:i,highWaterMark:0},G={onSuccess:this.loadsuccess.bind(this),onError:this.loaderror.bind(this),onTimeout:this.loadtimeout.bind(this)};g.load(t,F,G)},h.loadsuccess=function(t,n,s,o){o===void 0&&(o=null),this.resetInternalLoader(s.type);var c=t.data;c.indexOf("#EXTM3U")===0?(n.parsing.start=performance.now(),c.indexOf("#EXTINF:")>0||c.indexOf("#EXT-X-TARGETDURATION:")>0?this.handleTrackOrLevelPlaylist(t,n,s,o):this.handleMasterPlaylist(t,n,s,o)):this.handleManifestParsingError(t,s,"no EXTM3U delimiter",o)},h.loaderror=function(t,n,s){s===void 0&&(s=null),this.handleNetworkError(n,s,!1,t)},h.loadtimeout=function(t,n,s){s===void 0&&(s=null),this.handleNetworkError(n,s,!0)},h.handleMasterPlaylist=function(t,n,s,o){var c=this.hls,i=t.data,u=ot(t,s),p=ve.parseMasterPlaylist(i,u),g=p.levels,y=p.sessionData,b=p.sessionKeys;if(g.length){var D=g.map(function(le){return{id:le.attrs.AUDIO,audioCodec:le.audioCodec}}),F=g.map(function(le){return{id:le.attrs.SUBTITLES,textCodec:le.textCodec}}),G=ve.parseMasterPlaylistMedia(i,u,"AUDIO",D),ee=ve.parseMasterPlaylistMedia(i,u,"SUBTITLES",F),J=ve.parseMasterPlaylistMedia(i,u,"CLOSED-CAPTIONS");G.length&&(G.some(function(le){return!le.url})||!g[0].audioCodec||g[0].attrs.AUDIO||(w.logger.log("[playlist-loader]: audio codec signaled in quality level, but no embedded audio track signaled, create one"),G.unshift({type:"main",name:"main",default:!1,autoselect:!1,forced:!1,id:-1,attrs:new V({}),bitrate:0,url:""}))),c.trigger(E.Events.MANIFEST_LOADED,{levels:g,audioTracks:G,subtitles:ee,captions:J,url:u,stats:n,networkDetails:o,sessionData:y,sessionKeys:b})}else this.handleManifestParsingError(t,s,"no level found in manifest",o)},h.handleTrackOrLevelPlaylist=function(t,n,s,o){var c=this.hls,i=s.id,u=s.level,p=s.type,g=ot(t,s),y=(0,O.isFiniteNumber)(i)?i:0,b=(0,O.isFiniteNumber)(u)?u:y,D=function(ee){switch(ee.type){case ue.PlaylistContextType.AUDIO_TRACK:return ue.PlaylistLevelType.AUDIO;case ue.PlaylistContextType.SUBTITLE_TRACK:return ue.PlaylistLevelType.SUBTITLE;default:return ue.PlaylistLevelType.MAIN}}(s),F=ve.parseLevelPlaylist(t.data,g,b,D,y);if(F.fragments.length){if(p===ue.PlaylistContextType.MANIFEST){var G={attrs:new V({}),bitrate:0,details:F,name:"",url:g};c.trigger(E.Events.MANIFEST_LOADED,{levels:[G],audioTracks:[],url:g,stats:n,networkDetails:o,sessionData:null,sessionKeys:null})}n.parsing.end=performance.now(),s.levelDetails=F,this.handlePlaylistLoaded(t,n,s,o)}else c.trigger(E.Events.ERROR,{type:A.ErrorTypes.NETWORK_ERROR,details:A.ErrorDetails.LEVEL_EMPTY_ERROR,fatal:!1,url:g,reason:"no fragments found in level",level:typeof s.level=="number"?s.level:void 0})},h.handleManifestParsingError=function(t,n,s,o){this.hls.trigger(E.Events.ERROR,{type:A.ErrorTypes.NETWORK_ERROR,details:A.ErrorDetails.MANIFEST_PARSING_ERROR,fatal:n.type===ue.PlaylistContextType.MANIFEST,url:t.url,reason:s,response:t,context:n,networkDetails:o})},h.handleNetworkError=function(t,n,s,o){s===void 0&&(s=!1),w.logger.warn("[playlist-loader]: A network "+(s?"timeout":"error")+" occurred while loading "+t.type+" level: "+t.level+" id: "+t.id+' group-id: "'+t.groupId+'"');var c=A.ErrorDetails.UNKNOWN,i=!1,u=this.getInternalLoader(t);switch(t.type){case ue.PlaylistContextType.MANIFEST:c=s?A.ErrorDetails.MANIFEST_LOAD_TIMEOUT:A.ErrorDetails.MANIFEST_LOAD_ERROR,i=!0;break;case ue.PlaylistContextType.LEVEL:c=s?A.ErrorDetails.LEVEL_LOAD_TIMEOUT:A.ErrorDetails.LEVEL_LOAD_ERROR,i=!1;break;case ue.PlaylistContextType.AUDIO_TRACK:c=s?A.ErrorDetails.AUDIO_TRACK_LOAD_TIMEOUT:A.ErrorDetails.AUDIO_TRACK_LOAD_ERROR,i=!1;break;case ue.PlaylistContextType.SUBTITLE_TRACK:c=s?A.ErrorDetails.SUBTITLE_TRACK_LOAD_TIMEOUT:A.ErrorDetails.SUBTITLE_LOAD_ERROR,i=!1}u&&this.resetInternalLoader(t.type);var p={type:A.ErrorTypes.NETWORK_ERROR,details:c,fatal:i,url:t.url,loader:u,context:t,networkDetails:n};o&&(p.response=o),this.hls.trigger(E.Events.ERROR,p)},h.handlePlaylistLoaded=function(t,n,s,o){var c=s.type,i=s.level,u=s.id,p=s.groupId,g=s.loader,y=s.levelDetails,b=s.deliveryDirectives;if(y!=null&&y.targetduration){if(g)switch(y.live&&(g.getCacheAge&&(y.ageHeader=g.getCacheAge()||0),g.getCacheAge&&!isNaN(y.ageHeader)||(y.ageHeader=0)),c){case ue.PlaylistContextType.MANIFEST:case ue.PlaylistContextType.LEVEL:this.hls.trigger(E.Events.LEVEL_LOADED,{details:y,level:i||0,id:u||0,stats:n,networkDetails:o,deliveryDirectives:b});break;case ue.PlaylistContextType.AUDIO_TRACK:this.hls.trigger(E.Events.AUDIO_TRACK_LOADED,{details:y,id:u||0,groupId:p||"",stats:n,networkDetails:o,deliveryDirectives:b});break;case ue.PlaylistContextType.SUBTITLE_TRACK:this.hls.trigger(E.Events.SUBTITLE_TRACK_LOADED,{details:y,id:u||0,groupId:p||"",stats:n,networkDetails:o,deliveryDirectives:b})}}else this.handleManifestParsingError(t,s,"invalid target duration",o)},v}();function nt(v,h){var t;try{t=new Event("addtrack")}catch{(t=document.createEvent("Event")).initEvent("addtrack",!1,!1)}t.track=v,h.dispatchEvent(t)}function ht(v,h){var t=v.mode;if(t==="disabled"&&(v.mode="hidden"),v.cues&&!v.cues.getCueById(h.id))try{if(v.addCue(h),!v.cues.getCueById(h.id))throw new Error("addCue is failed for: "+h)}catch(s){w.logger.debug("[texttrack-utils]: "+s);var n=new self.TextTrackCue(h.startTime,h.endTime,h.text);n.id=h.id,v.addCue(n)}t==="disabled"&&(v.mode=t)}function Pt(v){var h=v.mode;if(h==="disabled"&&(v.mode="hidden"),v.cues)for(var t=v.cues.length;t--;)v.removeCue(v.cues[t]);h==="disabled"&&(v.mode=h)}function jt(v,h,t,n){var s=v.mode;if(s==="disabled"&&(v.mode="hidden"),v.cues&&v.cues.length>0)for(var o=function(i,u,p){var g=[],y=function(G,ee){if(ee<G[0].startTime)return 0;var J=G.length-1;if(ee>G[J].endTime)return-1;for(var le=0,Se=J;le<=Se;){var we=Math.floor((Se+le)/2);if(ee<G[we].startTime)Se=we-1;else{if(!(ee>G[we].startTime&&le<J))return we;le=we+1}}return G[le].startTime-ee<ee-G[Se].startTime?le:Se}(i,u);if(y>-1)for(var b=y,D=i.length;b<D;b++){var F=i[b];if(F.startTime>=u&&F.endTime<=p)g.push(F);else if(F.startTime>p)return g}return g}(v.cues,h,t),c=0;c<o.length;c++)n&&!n(o[c])||v.removeCue(o[c]);s==="disabled"&&(v.mode=s)}var Rt=k(181),Ct=k(856);function Ft(){return self.WebKitDataCue||self.VTTCue||self.TextTrackCue}var Kt=function(){var v=Ft();try{new v(0,Number.POSITIVE_INFINITY,"")}catch{return Number.MAX_VALUE}return Number.POSITIVE_INFINITY}();function It(v,h){return v.getTime()/1e3-h}const Zt=function(){function v(t){this.hls=void 0,this.id3Track=null,this.media=null,this.dateRangeCuesAppended={},this.hls=t,this._registerListeners()}var h=v.prototype;return h.destroy=function(){this._unregisterListeners(),this.id3Track=null,this.media=null,this.dateRangeCuesAppended={},this.hls=null},h._registerListeners=function(){var t=this.hls;t.on(E.Events.MEDIA_ATTACHED,this.onMediaAttached,this),t.on(E.Events.MEDIA_DETACHING,this.onMediaDetaching,this),t.on(E.Events.MANIFEST_LOADING,this.onManifestLoading,this),t.on(E.Events.FRAG_PARSING_METADATA,this.onFragParsingMetadata,this),t.on(E.Events.BUFFER_FLUSHING,this.onBufferFlushing,this),t.on(E.Events.LEVEL_UPDATED,this.onLevelUpdated,this)},h._unregisterListeners=function(){var t=this.hls;t.off(E.Events.MEDIA_ATTACHED,this.onMediaAttached,this),t.off(E.Events.MEDIA_DETACHING,this.onMediaDetaching,this),t.off(E.Events.MANIFEST_LOADING,this.onManifestLoading,this),t.off(E.Events.FRAG_PARSING_METADATA,this.onFragParsingMetadata,this),t.off(E.Events.BUFFER_FLUSHING,this.onBufferFlushing,this),t.off(E.Events.LEVEL_UPDATED,this.onLevelUpdated,this)},h.onMediaAttached=function(t,n){this.media=n.media},h.onMediaDetaching=function(){this.id3Track&&(Pt(this.id3Track),this.id3Track=null,this.media=null,this.dateRangeCuesAppended={})},h.onManifestLoading=function(){this.dateRangeCuesAppended={}},h.createTrack=function(t){var n=this.getID3Track(t.textTracks);return n.mode="hidden",n},h.getID3Track=function(t){if(this.media){for(var n=0;n<t.length;n++){var s=t[n];if(s.kind==="metadata"&&s.label==="id3")return nt(s,this.media),s}return this.media.addTextTrack("metadata","id3")}},h.onFragParsingMetadata=function(t,n){if(this.media){var s=this.hls.config,o=s.enableEmsgMetadataCues,c=s.enableID3MetadataCues;if(o||c){var i=n.samples;this.id3Track||(this.id3Track=this.createTrack(this.media));for(var u=Ft(),p=0;p<i.length;p++){var g=i[p].type;if((g!==Ct.MetadataSchema.emsg||o)&&c){var y=Rt.getID3Frames(i[p].data);if(y){var b=i[p].pts,D=b+i[p].duration;D>Kt&&(D=Kt),D-b<=0&&(D=b+.25);for(var F=0;F<y.length;F++){var G=y[F];if(!Rt.isTimeStampFrame(G)){this.updateId3CueEnds(b);var ee=new u(b,D,"");ee.value=G,g&&(ee.type=g),this.id3Track.addCue(ee)}}}}}}}},h.updateId3CueEnds=function(t){var n,s=(n=this.id3Track)===null||n===void 0?void 0:n.cues;if(s)for(var o=s.length;o--;){var c=s[o];c.startTime<t&&c.endTime===Kt&&(c.endTime=t)}},h.onBufferFlushing=function(t,n){var s=n.startOffset,o=n.endOffset,c=n.type,i=this.id3Track,u=this.hls;if(u){var p=u.config,g=p.enableEmsgMetadataCues,y=p.enableID3MetadataCues;i&&(g||y)&&jt(i,s,o,c==="audio"?function(b){return b.type===Ct.MetadataSchema.audioId3&&y}:c==="video"?function(b){return b.type===Ct.MetadataSchema.emsg&&g}:function(b){return b.type===Ct.MetadataSchema.audioId3&&y||b.type===Ct.MetadataSchema.emsg&&g})}},h.onLevelUpdated=function(t,n){var s=this,o=n.details;if(this.media&&o.hasProgramDateTime&&this.hls.config.enableDateRangeMetadataCues){var c=this.dateRangeCuesAppended,i=this.id3Track,u=o.dateRanges,p=Object.keys(u);if(i)for(var g=Object.keys(c).filter(function(le){return!p.includes(le)}),y=function(le){var Se=g[le];Object.keys(c[Se].cues).forEach(function(we){i.removeCue(c[Se].cues[we])}),delete c[Se]},b=g.length;b--;)y(b);var D=o.fragments[o.fragments.length-1];if(p.length!==0&&(0,O.isFiniteNumber)(D==null?void 0:D.programDateTime)){this.id3Track||(this.id3Track=this.createTrack(this.media));for(var F=D.programDateTime/1e3-D.start,G=Ft(),ee=function(le){var Se=p[le],we=u[Se],be=c[Se],Pe=(be==null?void 0:be.cues)||{},tt=(be==null?void 0:be.durationKnown)||!1,rt=It(we.startDate,F),Ge=Kt,Je=we.endDate;if(Je)Ge=It(Je,F),tt=!0;else if(we.endOnNext&&!tt){var Qe=p.reduce(function(gr,lr){var dr=u[lr];return dr.class===we.class&&dr.id!==lr&&dr.startDate>we.startDate&&gr.push(dr),gr},[]).sort(function(gr,lr){return gr.startDate.getTime()-lr.startDate.getTime()})[0];Qe&&(Ge=It(Qe.startDate,F),tt=!0)}for(var Dt,Vt=Object.keys(we.attr),St=0;St<Vt.length;St++){var wt=Vt[St];if(wt!==x.ID&&wt!==x.CLASS&&wt!==x.START_DATE&&wt!==x.DURATION&&wt!==x.END_DATE&&wt!==x.END_ON_NEXT){var Mt=Pe[wt];if(Mt)tt&&!be.durationKnown&&(Mt.endTime=Ge);else{var pr=we.attr[wt];Mt=new G(rt,Ge,""),wt!==x.SCTE35_OUT&&wt!==x.SCTE35_IN||(Dt=pr,pr=Uint8Array.from(Dt.replace(/^0x/,"").replace(/([\da-fA-F]{2}) ?/g,"0x$1 ").replace(/ +$/,"").split(" ")).buffer),Mt.value={key:wt,data:pr},Mt.type=Ct.MetadataSchema.dateRange,s.id3Track.addCue(Mt),Pe[wt]=Mt}}}c[Se]={cues:Pe,dateRange:we,durationKnown:tt}},J=0;J<p.length;J++)ee(J)}}},v}();function cr(v,h){for(var t=0;t<h.length;t++){var n=h[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(v,typeof(s=function(o,c){if(typeof o!="object"||o===null)return o;var i=o[Symbol.toPrimitive];if(i!==void 0){var u=i.call(o,c);if(typeof u!="object")return u;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(o)}(n.key,"string"))=="symbol"?s:String(s),n)}var s}var fr=function(){function v(s){var o=this;this.hls=void 0,this.config=void 0,this.media=null,this.levelDetails=null,this.currentTime=0,this.stallCount=0,this._latency=null,this.timeupdateHandler=function(){return o.timeupdate()},this.hls=s,this.config=s.config,this.registerListeners()}var h,t,n=v.prototype;return n.destroy=function(){this.unregisterListeners(),this.onMediaDetaching(),this.levelDetails=null,this.hls=this.timeupdateHandler=null},n.registerListeners=function(){this.hls.on(E.Events.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.on(E.Events.MEDIA_DETACHING,this.onMediaDetaching,this),this.hls.on(E.Events.MANIFEST_LOADING,this.onManifestLoading,this),this.hls.on(E.Events.LEVEL_UPDATED,this.onLevelUpdated,this),this.hls.on(E.Events.ERROR,this.onError,this)},n.unregisterListeners=function(){this.hls.off(E.Events.MEDIA_ATTACHED,this.onMediaAttached),this.hls.off(E.Events.MEDIA_DETACHING,this.onMediaDetaching),this.hls.off(E.Events.MANIFEST_LOADING,this.onManifestLoading),this.hls.off(E.Events.LEVEL_UPDATED,this.onLevelUpdated),this.hls.off(E.Events.ERROR,this.onError)},n.onMediaAttached=function(s,o){this.media=o.media,this.media.addEventListener("timeupdate",this.timeupdateHandler)},n.onMediaDetaching=function(){this.media&&(this.media.removeEventListener("timeupdate",this.timeupdateHandler),this.media=null)},n.onManifestLoading=function(){this.levelDetails=null,this._latency=null,this.stallCount=0},n.onLevelUpdated=function(s,o){var c=o.details;this.levelDetails=c,c.advanced&&this.timeupdate(),!c.live&&this.media&&this.media.removeEventListener("timeupdate",this.timeupdateHandler)},n.onError=function(s,o){o.details===A.ErrorDetails.BUFFER_STALLED_ERROR&&(this.stallCount++,w.logger.warn("[playback-rate-controller]: Stall detected, adjusting target latency"))},n.timeupdate=function(){var s=this.media,o=this.levelDetails;if(s&&o){this.currentTime=s.currentTime;var c=this.computeLatency();if(c!==null){this._latency=c;var i=this.config,u=i.lowLatencyMode,p=i.maxLiveSyncPlaybackRate;if(u&&p!==1){var g=this.targetLatency;if(g!==null){var y=c-g,b=y<Math.min(this.maxLatency,g+o.targetduration);if(o.live&&b&&y>.05&&this.forwardBufferLength>1){var D=Math.min(2,Math.max(1,p)),F=Math.round(2/(1+Math.exp(-.75*y-this.edgeStalled))*20)/20;s.playbackRate=Math.min(D,Math.max(1,F))}else s.playbackRate!==1&&s.playbackRate!==0&&(s.playbackRate=1)}}}}},n.estimateLiveEdge=function(){var s=this.levelDetails;return s===null?null:s.edge+s.age},n.computeLatency=function(){var s=this.estimateLiveEdge();return s===null?null:s-this.currentTime},h=v,(t=[{key:"latency",get:function(){return this._latency||0}},{key:"maxLatency",get:function(){var s=this.config,o=this.levelDetails;return s.liveMaxLatencyDuration!==void 0?s.liveMaxLatencyDuration:o?s.liveMaxLatencyDurationCount*o.targetduration:0}},{key:"targetLatency",get:function(){var s=this.levelDetails;if(s===null)return null;var o=s.holdBack,c=s.partHoldBack,i=s.targetduration,u=this.config,p=u.liveSyncDuration,g=u.liveSyncDurationCount,y=u.lowLatencyMode,b=this.hls.userConfig,D=y&&c||o;(b.liveSyncDuration||b.liveSyncDurationCount||D===0)&&(D=p!==void 0?p:g*i);var F=i;return D+Math.min(1*this.stallCount,F)}},{key:"liveSyncPosition",get:function(){var s=this.estimateLiveEdge(),o=this.targetLatency,c=this.levelDetails;if(s===null||o===null||c===null)return null;var i=c.edge,u=s-o-this.edgeStalled,p=i-c.totalduration,g=i-(this.config.lowLatencyMode&&c.partTarget||c.targetduration);return Math.min(Math.max(p,u),g)}},{key:"drift",get:function(){var s=this.levelDetails;return s===null?1:s.drift}},{key:"edgeStalled",get:function(){var s=this.levelDetails;if(s===null)return 0;var o=3*(this.config.lowLatencyMode&&s.partTarget||s.targetduration);return Math.max(s.age-o,0)}},{key:"forwardBufferLength",get:function(){var s=this.media,o=this.levelDetails;if(!s||!o)return 0;var c=s.buffered.length;return(c?s.buffered.end(c-1):o.edge)-this.currentTime}}])&&cr(h.prototype,t),Object.defineProperty(h,"prototype",{writable:!1}),v}();function kr(v,h){for(var t=0;t<h.length;t++){var n=h[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(v,typeof(s=function(o,c){if(typeof o!="object"||o===null)return o;var i=o[Symbol.toPrimitive];if(i!==void 0){var u=i.call(o,c);if(typeof u!="object")return u;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(o)}(n.key,"string"))=="symbol"?s:String(s),n)}var s}var wr,yr=["NONE","TYPE-0","TYPE-1","TYPE-2",null];(function(v){v.No="",v.Yes="YES",v.v2="v2"})(wr||(wr={}));var pe=function(){function v(h,t,n){this.msn=void 0,this.part=void 0,this.skip=void 0,this.msn=h,this.part=t,this.skip=n}return v.prototype.addDirectives=function(h){var t=new self.URL(h);return this.msn!==void 0&&t.searchParams.set("_HLS_msn",this.msn.toString()),this.part!==void 0&&t.searchParams.set("_HLS_part",this.part.toString()),this.skip&&t.searchParams.set("_HLS_skip",this.skip),t.href},v}(),$=function(){function v(n){this.attrs=void 0,this.audioCodec=void 0,this.bitrate=void 0,this.codecSet=void 0,this.height=void 0,this.id=void 0,this.name=void 0,this.videoCodec=void 0,this.width=void 0,this.unknownCodecs=void 0,this.audioGroupIds=void 0,this.details=void 0,this.fragmentError=0,this.loadError=0,this.loaded=void 0,this.realBitrate=0,this.textGroupIds=void 0,this.url=void 0,this._urlId=0,this.url=[n.url],this.attrs=n.attrs,this.bitrate=n.bitrate,n.details&&(this.details=n.details),this.id=n.id||0,this.name=n.name,this.width=n.width||0,this.height=n.height||0,this.audioCodec=n.audioCodec,this.videoCodec=n.videoCodec,this.unknownCodecs=n.unknownCodecs,this.codecSet=[n.videoCodec,n.audioCodec].filter(function(s){return s}).join(",").replace(/\.[^.,]+/g,"")}var h,t;return h=v,(t=[{key:"maxBitrate",get:function(){return Math.max(this.realBitrate,this.bitrate)}},{key:"uri",get:function(){return this.url[this._urlId]||""}},{key:"urlId",get:function(){return this._urlId},set:function(n){var s=n%this.url.length;this._urlId!==s&&(this.details=void 0,this._urlId=s)}}])&&kr(h.prototype,t),Object.defineProperty(h,"prototype",{writable:!1}),v}();function M(){return M=Object.assign?Object.assign.bind():function(v){for(var h=1;h<arguments.length;h++){var t=arguments[h];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(v[n]=t[n])}return v},M.apply(this,arguments)}function z(v,h,t){switch(h){case"audio":v.audioGroupIds||(v.audioGroupIds=[]),v.audioGroupIds.push(t);break;case"text":v.textGroupIds||(v.textGroupIds=[]),v.textGroupIds.push(t)}}function Q(v){var h={};v.forEach(function(t){var n=t.groupId||"";t.id=h[n]=h[n]||0,h[n]++})}function se(v,h){var t=h.startPTS;if((0,O.isFiniteNumber)(t)){var n,s=0;h.sn>v.sn?(s=t-v.start,n=v):(s=v.start-t,n=h),n.duration!==s&&(n.duration=s)}else h.sn>v.sn?v.cc===h.cc&&v.minEndPTS?h.start=v.start+(v.minEndPTS-v.start):h.start=v.start+v.duration:h.start=Math.max(v.start-h.duration,0)}function oe(v,h,t,n,s,o){n-t<=0&&(w.logger.warn("Fragment should have a positive duration",h),n=t+h.duration,o=s+h.duration);var c=t,i=n,u=h.startPTS,p=h.endPTS;if((0,O.isFiniteNumber)(u)){var g=Math.abs(u-t);(0,O.isFiniteNumber)(h.deltaPTS)?h.deltaPTS=Math.max(g,h.deltaPTS):h.deltaPTS=g,c=Math.max(t,u),t=Math.min(t,u),s=Math.min(s,h.startDTS),i=Math.min(n,p),n=Math.max(n,p),o=Math.max(o,h.endDTS)}h.duration=n-t;var y=t-h.start;h.start=h.startPTS=t,h.maxStartPTS=c,h.startDTS=s,h.endPTS=n,h.minEndPTS=i,h.endDTS=o;var b,D=h.sn;if(!v||D<v.startSN||D>v.endSN)return 0;var F=D-v.startSN,G=v.fragments;for(G[F]=h,b=F;b>0;b--)se(G[b],G[b-1]);for(b=F;b<G.length-1;b++)se(G[b],G[b+1]);return v.fragmentHint&&se(G[G.length-1],v.fragmentHint),v.PTSKnown=v.alignedSliding=!0,y}function de(v,h){var t=h.startSN+h.skippedSegments-v.startSN,n=v.fragments;t<0||t>=n.length||Ce(h,n[t].start)}function Ce(v,h){if(h){for(var t=v.fragments,n=v.skippedSegments;n<t.length;n++)t[n].start+=h;v.fragmentHint&&(v.fragmentHint.start+=h)}}var Me=function(){function v(t,n){this.hls=void 0,this.timer=-1,this.requestScheduled=-1,this.canLoad=!1,this.retryCount=0,this.log=void 0,this.warn=void 0,this.log=w.logger.log.bind(w.logger,n+":"),this.warn=w.logger.warn.bind(w.logger,n+":"),this.hls=t}var h=v.prototype;return h.destroy=function(){this.clearTimer(),this.hls=this.log=this.warn=null},h.onError=function(t,n){!n.fatal||n.type!==A.ErrorTypes.NETWORK_ERROR&&n.type!==A.ErrorTypes.KEY_SYSTEM_ERROR||this.stopLoad()},h.clearTimer=function(){clearTimeout(this.timer),this.timer=-1},h.startLoad=function(){this.canLoad=!0,this.retryCount=0,this.requestScheduled=-1,this.loadPlaylist()},h.stopLoad=function(){this.canLoad=!1,this.clearTimer()},h.switchParams=function(t,n){var s=n==null?void 0:n.renditionReports;if(s)for(var o=0;o<s.length;o++){var c=s[o],i=void 0;try{i=new self.URL(c.URI,n.url).href}catch(y){w.logger.warn("Could not construct new URL for Rendition Report: "+y),i=c.URI||""}if(i===t.slice(-i.length)){var u=parseInt(c["LAST-MSN"])||(n==null?void 0:n.lastPartSn),p=parseInt(c["LAST-PART"])||(n==null?void 0:n.lastPartIndex);if(this.hls.config.lowLatencyMode){var g=Math.min(n.age-n.partTarget,n.targetduration);p>=0&&g>n.partTarget&&(p+=1)}return new pe(u,p>=0?p:void 0,wr.No)}}},h.loadPlaylist=function(t){this.requestScheduled===-1&&(this.requestScheduled=self.performance.now())},h.shouldLoadTrack=function(t){return this.canLoad&&t&&!!t.url&&(!t.details||t.details.live)},h.playlistLoaded=function(t,n,s){var o=this,c=n.details,i=n.stats,u=self.performance.now(),p=i.loading.first?Math.max(0,u-i.loading.first):0;if(c.advancedDateTime=Date.now()-p,c.live||s!=null&&s.live){if(c.reloaded(s),s&&this.log("live playlist "+t+" "+(c.advanced?"REFRESHED "+c.lastPartSn+"-"+c.lastPartIndex:"MISSED")),s&&c.fragments.length>0&&function(Je,Qe){for(var Dt=null,Vt=Je.fragments,St=Vt.length-1;St>=0;St--){var wt=Vt[St].initSegment;if(wt){Dt=wt;break}}Je.fragmentHint&&delete Je.fragmentHint.endPTS;var Mt,pr,gr,lr,dr,wn=0;if(function(gt,bt,Nr){for(var At=bt.skippedSegments,In=Math.max(gt.startSN,bt.startSN)-bt.startSN,bi=(gt.fragmentHint?1:0)+(At?bt.endSN:Math.min(gt.endSN,bt.endSN))-bt.startSN,kn=bt.startSN-gt.startSN,Gr=bt.fragmentHint?bt.fragments.concat(bt.fragmentHint):bt.fragments,Nn=gt.fragmentHint?gt.fragments.concat(gt.fragmentHint):gt.fragments,qr=In;qr<=bi;qr++){var aa=Nn[kn+qr],ps=Gr[qr];At&&!ps&&qr<At&&(ps=bt.fragments[qr]=aa),aa&&ps&&Nr(aa,ps)}}(Je,Qe,function(gt,bt){gt.relurl&&(wn=gt.cc-bt.cc),(0,O.isFiniteNumber)(gt.startPTS)&&(0,O.isFiniteNumber)(gt.endPTS)&&(bt.start=bt.startPTS=gt.startPTS,bt.startDTS=gt.startDTS,bt.appendedPTS=gt.appendedPTS,bt.maxStartPTS=gt.maxStartPTS,bt.endPTS=gt.endPTS,bt.endDTS=gt.endDTS,bt.minEndPTS=gt.minEndPTS,bt.duration=gt.endPTS-gt.startPTS,bt.duration&&(Mt=bt),Qe.PTSKnown=Qe.alignedSliding=!0),bt.elementaryStreams=gt.elementaryStreams,bt.loader=gt.loader,bt.stats=gt.stats,bt.urlId=gt.urlId,gt.initSegment&&(bt.initSegment=gt.initSegment,Dt=gt.initSegment)}),Dt&&(Qe.fragmentHint?Qe.fragments.concat(Qe.fragmentHint):Qe.fragments).forEach(function(gt){var bt;gt.initSegment&&gt.initSegment.relurl!==((bt=Dt)===null||bt===void 0?void 0:bt.relurl)||(gt.initSegment=Dt)}),Qe.skippedSegments)if(Qe.deltaUpdateFailed=Qe.fragments.some(function(gt){return!gt}),Qe.deltaUpdateFailed){w.logger.warn("[level-helper] Previous playlist missing segments skipped in delta playlist");for(var Qn=Qe.skippedSegments;Qn--;)Qe.fragments.shift();Qe.startSN=Qe.fragments[0].sn,Qe.startCC=Qe.fragments[0].cc}else Qe.canSkipDateRanges&&(Qe.dateRanges=(pr=Je.dateRanges,gr=Qe.dateRanges,lr=Qe.recentlyRemovedDateranges,dr=M({},pr),lr&&lr.forEach(function(gt){delete dr[gt]}),Object.keys(gr).forEach(function(gt){var bt=new re(gr[gt].attr,dr[gt]);bt.isValid?dr[gt]=bt:w.logger.warn('Ignoring invalid Playlist Delta Update DATERANGE tag: "'+JSON.stringify(gr[gt].attr)+'"')}),dr));var Rn=Qe.fragments;if(wn){w.logger.warn("discontinuity sliding from playlist, take drift into account");for(var Dn=0;Dn<Rn.length;Dn++)Rn[Dn].cc+=wn}Qe.skippedSegments&&(Qe.startCC=Qe.fragments[0].cc),function(gt,bt,Nr){if(gt&&bt)for(var At=0,In=0,bi=gt.length;In<=bi;In++){var kn=gt[In],Gr=bt[In+At];kn&&Gr&&kn.index===Gr.index&&kn.fragment.sn===Gr.fragment.sn?(Nn=kn,(qr=Gr).elementaryStreams=Nn.elementaryStreams,qr.stats=Nn.stats):At--}var Nn,qr}(Je.partList,Qe.partList),Mt?oe(Qe,Mt,Mt.startPTS,Mt.endPTS,Mt.startDTS,Mt.endDTS):de(Je,Qe),Rn.length&&(Qe.totalduration=Qe.edge-Rn[0].start),Qe.driftStartTime=Je.driftStartTime,Qe.driftStart=Je.driftStart;var Xn=Qe.advancedDateTime;if(Qe.advanced&&Xn){var P=Qe.edge;Qe.driftStart||(Qe.driftStartTime=Xn,Qe.driftStart=P),Qe.driftEndTime=Xn,Qe.driftEnd=P}else Qe.driftEndTime=Je.driftEndTime,Qe.driftEnd=Je.driftEnd,Qe.advancedDateTime=Je.advancedDateTime}(s,c),!this.canLoad||!c.live)return;var g,y=void 0,b=void 0;if(c.canBlockReload&&c.endSN&&c.advanced){var D=this.hls.config.lowLatencyMode,F=c.lastPartSn,G=c.endSN,ee=c.lastPartIndex,J=F===G;ee!==-1?(y=J?G+1:F,b=J?D?0:ee:ee+1):y=G+1;var le=c.age,Se=le+c.ageHeader,we=Math.min(Se-c.partTarget,1.5*c.targetduration);if(we>0){if(s&&we>s.tuneInGoal)this.warn("CDN Tune-in goal increased from: "+s.tuneInGoal+" to: "+we+" with playlist age: "+c.age),we=0;else{var be=Math.floor(we/c.targetduration);y+=be,b!==void 0&&(b+=Math.round(we%c.targetduration/c.partTarget)),this.log("CDN Tune-in age: "+c.ageHeader+"s last advanced "+le.toFixed(2)+"s goal: "+we+" skip sn "+be+" to part "+b)}c.tuneInGoal=we}if(g=this.getDeliveryDirectives(c,n.deliveryDirectives,y,b),D||!J)return void this.loadPlaylist(g)}else g=this.getDeliveryDirectives(c,n.deliveryDirectives,y,b);var Pe=this.hls.mainForwardBufferInfo,tt=Pe?Pe.end-Pe.len:0,rt=function(Je,Qe){Qe===void 0&&(Qe=1/0);var Dt=1e3*Je.targetduration;if(Je.updated){var Vt=Je.fragments;if(Vt.length&&4*Dt>Qe){var St=1e3*Vt[Vt.length-1].duration;St<Dt&&(Dt=St)}}else Dt/=2;return Math.round(Dt)}(c,1e3*(c.edge-tt));c.updated?u>this.requestScheduled+rt&&(this.requestScheduled=i.loading.start):this.requestScheduled=-1,y!==void 0&&c.canBlockReload?this.requestScheduled=i.loading.first+rt-(1e3*c.partTarget||1e3):this.requestScheduled=(this.requestScheduled===-1?u:this.requestScheduled)+rt;var Ge=this.requestScheduled-u;Ge=Math.max(0,Ge),this.log("reload live playlist "+t+" in "+Math.round(Ge)+" ms"),this.timer=self.setTimeout(function(){return o.loadPlaylist(g)},Ge)}else this.clearTimer()},h.getDeliveryDirectives=function(t,n,s,o){var c=function(i,u){var p=i.canSkipUntil,g=i.canSkipDateRanges,y=i.endSN;return p&&(u!==void 0?u-y:0)<p?g?wr.v2:wr.Yes:wr.No}(t,s);return n!=null&&n.skip&&t.deltaUpdateFailed&&(s=n.msn,o=n.part,c=wr.No),new pe(s,o,c)},h.retryLoadingOrFail=function(t){var n,s=this,o=this.hls.config,c=this.retryCount<o.levelLoadingMaxRetry;if(c)if(this.requestScheduled=-1,this.retryCount++,t.details.indexOf("LoadTimeOut")>-1&&(n=t.context)!==null&&n!==void 0&&n.deliveryDirectives)this.warn("retry playlist loading #"+this.retryCount+' after "'+t.details+'"'),this.loadPlaylist();else{var i=Math.min(Math.pow(2,this.retryCount)*o.levelLoadingRetryDelay,o.levelLoadingMaxRetryTimeout);this.timer=self.setTimeout(function(){return s.loadPlaylist()},i),this.warn("retry playlist loading #"+this.retryCount+" in "+i+' ms after "'+t.details+'"')}else this.warn('cannot recover from error "'+t.details+'"'),this.clearTimer(),t.fatal=!0;return c},v}();function Ne(){return Ne=Object.assign?Object.assign.bind():function(v){for(var h=1;h<arguments.length;h++){var t=arguments[h];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(v[n]=t[n])}return v},Ne.apply(this,arguments)}function Ze(v,h){for(var t=0;t<h.length;t++){var n=h[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(v,typeof(s=function(o,c){if(typeof o!="object"||o===null)return o;var i=o[Symbol.toPrimitive];if(i!==void 0){var u=i.call(o,c);if(typeof u!="object")return u;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(o)}(n.key,"string"))=="symbol"?s:String(s),n)}var s}function at(v,h){return at=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,n){return t.__proto__=n,t},at(v,h)}var et,ft=/chrome|firefox/.test(navigator.userAgent.toLowerCase()),kt=function(v){var h,t;function n(i){var u;return(u=v.call(this,i,"[level-controller]")||this)._levels=[],u._firstLevel=-1,u._startLevel=void 0,u.currentLevelIndex=-1,u.manualLevelIndex=-1,u.onParsedComplete=void 0,u._registerListeners(),u}t=v,(h=n).prototype=Object.create(t.prototype),h.prototype.constructor=h,at(h,t);var s,o,c=n.prototype;return c._registerListeners=function(){var i=this.hls;i.on(E.Events.MANIFEST_LOADED,this.onManifestLoaded,this),i.on(E.Events.LEVEL_LOADED,this.onLevelLoaded,this),i.on(E.Events.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),i.on(E.Events.FRAG_LOADED,this.onFragLoaded,this),i.on(E.Events.ERROR,this.onError,this)},c._unregisterListeners=function(){var i=this.hls;i.off(E.Events.MANIFEST_LOADED,this.onManifestLoaded,this),i.off(E.Events.LEVEL_LOADED,this.onLevelLoaded,this),i.off(E.Events.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),i.off(E.Events.FRAG_LOADED,this.onFragLoaded,this),i.off(E.Events.ERROR,this.onError,this)},c.destroy=function(){this._unregisterListeners(),this.manualLevelIndex=-1,this._levels.length=0,v.prototype.destroy.call(this)},c.startLoad=function(){this._levels.forEach(function(i){i.loadError=0}),v.prototype.startLoad.call(this)},c.onManifestLoaded=function(i,u){var p,g,y=[],b=[],D=[],F={},G=!1,ee=!1,J=!1;if(u.levels.forEach(function(be){var Pe=be.attrs;G=G||!(!be.width||!be.height),ee=ee||!!be.videoCodec,J=J||!!be.audioCodec,ft&&be.audioCodec&&be.audioCodec.indexOf("mp4a.40.34")!==-1&&(be.audioCodec=void 0);var tt=be.bitrate+"-"+be.attrs.RESOLUTION+"-"+be.attrs.CODECS;(g=F[tt])?g.url.push(be.url):(g=new $(be),F[tt]=g,y.push(g)),Pe&&(Pe.AUDIO&&z(g,"audio",Pe.AUDIO),Pe.SUBTITLES&&z(g,"text",Pe.SUBTITLES))}),(G||ee)&&J&&(y=y.filter(function(be){var Pe=be.videoCodec,tt=be.width,rt=be.height;return!!Pe||!(!tt||!rt)})),y=y.filter(function(be){var Pe=be.audioCodec,tt=be.videoCodec;return(!Pe||Xe(Pe,"audio"))&&(!tt||Xe(tt,"video"))}),u.audioTracks&&Q(b=u.audioTracks.filter(function(be){return!be.audioCodec||Xe(be.audioCodec,"audio")})),u.subtitles&&Q(D=u.subtitles),y.length>0){p=y[0].bitrate,y.sort(function(be,Pe){return be.attrs["HDCP-LEVEL"]!==Pe.attrs["HDCP-LEVEL"]?(be.attrs["HDCP-LEVEL"]||"")>(Pe.attrs["HDCP-LEVEL"]||"")?1:-1:be.bitrate!==Pe.bitrate?be.bitrate-Pe.bitrate:be.attrs.SCORE!==Pe.attrs.SCORE?be.attrs.decimalFloatingPoint("SCORE")-Pe.attrs.decimalFloatingPoint("SCORE"):G&&be.height!==Pe.height?be.height-Pe.height:0}),this._levels=y;for(var le=0;le<y.length;le++)if(y[le].bitrate===p){this._firstLevel=le,this.log("manifest loaded, "+y.length+" level(s) found, first bitrate: "+p);break}var Se=J&&!ee,we={levels:y,audioTracks:b,subtitleTracks:D,sessionData:u.sessionData,sessionKeys:u.sessionKeys,firstLevel:this._firstLevel,stats:u.stats,audio:J,video:ee,altAudio:!Se&&b.some(function(be){return!!be.url})};this.hls.trigger(E.Events.MANIFEST_PARSED,we),(this.hls.config.autoStartLoad||this.hls.forceStartLoad)&&this.hls.startLoad(this.hls.config.startPosition)}else this.hls.trigger(E.Events.ERROR,{type:A.ErrorTypes.MEDIA_ERROR,details:A.ErrorDetails.MANIFEST_INCOMPATIBLE_CODECS_ERROR,fatal:!0,url:u.url,reason:"no level with compatible codecs found in manifest"})},c.onError=function(i,u){var p,g;if(v.prototype.onError.call(this,i,u),!u.fatal){var y=u.context,b=this._levels[this.currentLevelIndex];if(y&&(y.type===ue.PlaylistContextType.AUDIO_TRACK&&b.audioGroupIds&&y.groupId===b.audioGroupIds[b.urlId]||y.type===ue.PlaylistContextType.SUBTITLE_TRACK&&b.textGroupIds&&y.groupId===b.textGroupIds[b.urlId]))this.redundantFailover(this.currentLevelIndex);else{var D,F=!1,G=!0;switch(u.details){case A.ErrorDetails.FRAG_LOAD_ERROR:case A.ErrorDetails.FRAG_LOAD_TIMEOUT:case A.ErrorDetails.KEY_LOAD_ERROR:case A.ErrorDetails.KEY_LOAD_TIMEOUT:if(u.frag){var ee=u.frag.type===ue.PlaylistLevelType.MAIN?u.frag.level:this.currentLevelIndex,J=this._levels[ee];J?(J.fragmentError++,J.fragmentError>this.hls.config.fragLoadingMaxRetry&&(D=ee)):D=ee}break;case A.ErrorDetails.KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED:var le=b.attrs["HDCP-LEVEL"];le&&(this.hls.maxHdcpLevel=yr[yr.indexOf(le)-1],this.warn('Restricting playback to HDCP-LEVEL of "'+this.hls.maxHdcpLevel+'" or lower'));case A.ErrorDetails.FRAG_PARSING_ERROR:case A.ErrorDetails.KEY_SYSTEM_NO_SESSION:D=((p=u.frag)===null||p===void 0?void 0:p.type)===ue.PlaylistLevelType.MAIN?u.frag.level:this.currentLevelIndex,u.levelRetry=!1;break;case A.ErrorDetails.LEVEL_LOAD_ERROR:case A.ErrorDetails.LEVEL_LOAD_TIMEOUT:y&&(y.deliveryDirectives&&(G=!1),D=y.level),F=!0;break;case A.ErrorDetails.REMUX_ALLOC_ERROR:D=(g=u.level)!=null?g:this.currentLevelIndex,F=!0}D!==void 0&&this.recoverLevel(u,D,F,G)}}},c.recoverLevel=function(i,u,p,g){var y=i.details,b=this._levels[u];if(b.loadError++,p){if(!this.retryLoadingOrFail(i))return void(this.currentLevelIndex=-1);i.levelRetry=!0}if(g){var D=b.url.length;if(D>1&&b.loadError<D)i.levelRetry=!0,this.redundantFailover(u);else if(this.manualLevelIndex===-1){for(var F=-1,G=this._levels,ee=G.length;ee--;){var J=(ee+this.currentLevelIndex)%G.length;if(J!==this.currentLevelIndex&&G[J].loadError===0){F=J;break}}F>-1&&this.currentLevelIndex!==F?(this.warn(y+": switch to "+F),i.levelRetry=!0,this.hls.nextAutoLevel=F):i.levelRetry===!1&&(i.fatal=!0)}}},c.redundantFailover=function(i){var u=this._levels[i],p=u.url.length;if(p>1){var g=(u.urlId+1)%p;this.warn("Switching to redundant URL-id "+g),this._levels.forEach(function(y){y.urlId=g}),this.level=i}},c.onFragLoaded=function(i,u){var p=u.frag;if(p!==void 0&&p.type===ue.PlaylistLevelType.MAIN){var g=this._levels[p.level];g!==void 0&&(g.fragmentError=0,g.loadError=0)}},c.onLevelLoaded=function(i,u){var p,g,y=u.level,b=u.details,D=this._levels[y];if(!D)return this.warn("Invalid level index "+y),void((g=u.deliveryDirectives)!==null&&g!==void 0&&g.skip&&(b.deltaUpdateFailed=!0));y===this.currentLevelIndex?(D.fragmentError===0&&(D.loadError=0,this.retryCount=0),this.playlistLoaded(y,u,D.details)):(p=u.deliveryDirectives)!==null&&p!==void 0&&p.skip&&(b.deltaUpdateFailed=!0)},c.onAudioTrackSwitched=function(i,u){var p=this.hls.levels[this.currentLevelIndex];if(p&&p.audioGroupIds){for(var g=-1,y=this.hls.audioTracks[u.id].groupId,b=0;b<p.audioGroupIds.length;b++)if(p.audioGroupIds[b]===y){g=b;break}g!==p.urlId&&(p.urlId=g,this.startLoad())}},c.loadPlaylist=function(i){v.prototype.loadPlaylist.call(this);var u=this.currentLevelIndex,p=this._levels[u];if(this.canLoad&&p&&p.url.length>0){var g=p.urlId,y=p.url[g];if(i)try{y=i.addDirectives(y)}catch(b){this.warn("Could not construct new URL with HLS Delivery Directives: "+b)}this.log("Attempt loading level index "+u+((i==null?void 0:i.msn)!==void 0?" at sn "+i.msn+" part "+i.part:"")+" with URL-id "+g+" "+y),this.clearTimer(),this.hls.trigger(E.Events.LEVEL_LOADING,{url:y,level:u,id:g,deliveryDirectives:i||null})}},c.removeLevel=function(i,u){var p=function(y,b){return b!==u},g=this._levels.filter(function(y,b){return b!==i||y.url.length>1&&u!==void 0&&(y.url=y.url.filter(p),y.audioGroupIds&&(y.audioGroupIds=y.audioGroupIds.filter(p)),y.textGroupIds&&(y.textGroupIds=y.textGroupIds.filter(p)),y.urlId=0,!0)}).map(function(y,b){var D=y.details;return D!=null&&D.fragments&&D.fragments.forEach(function(F){F.level=b}),y});this._levels=g,this.hls.trigger(E.Events.LEVELS_UPDATED,{levels:g})},s=n,(o=[{key:"levels",get:function(){return this._levels.length===0?null:this._levels}},{key:"level",get:function(){return this.currentLevelIndex},set:function(i){var u,p=this._levels;if(p.length!==0&&(this.currentLevelIndex!==i||(u=p[i])===null||u===void 0||!u.details)){if(i<0||i>=p.length){var g=i<0;if(this.hls.trigger(E.Events.ERROR,{type:A.ErrorTypes.OTHER_ERROR,details:A.ErrorDetails.LEVEL_SWITCH_ERROR,level:i,fatal:g,reason:"invalid level idx"}),g)return;i=Math.min(i,p.length-1)}this.clearTimer();var y=this.currentLevelIndex,b=p[y],D=p[i];this.log("switching to level "+i+" from "+y),this.currentLevelIndex=i;var F=Ne({},D,{level:i,maxBitrate:D.maxBitrate,uri:D.uri,urlId:D.urlId});delete F._urlId,this.hls.trigger(E.Events.LEVEL_SWITCHING,F);var G=D.details;if(!G||G.live){var ee=this.switchParams(D.uri,b==null?void 0:b.details);this.loadPlaylist(ee)}}}},{key:"manualLevel",get:function(){return this.manualLevelIndex},set:function(i){this.manualLevelIndex=i,this._startLevel===void 0&&(this._startLevel=i),i!==-1&&(this.level=i)}},{key:"firstLevel",get:function(){return this._firstLevel},set:function(i){this._firstLevel=i}},{key:"startLevel",get:function(){if(this._startLevel===void 0){var i=this.hls.config.startLevel;return i!==void 0?i:this._firstLevel}return this._startLevel},set:function(i){this._startLevel=i}},{key:"nextLoadLevel",get:function(){return this.manualLevelIndex!==-1?this.manualLevelIndex:this.hls.nextAutoLevel},set:function(i){this.level=i,this.manualLevelIndex===-1&&(this.hls.nextAutoLevel=i)}}])&&Ze(s.prototype,o),Object.defineProperty(s,"prototype",{writable:!1}),n}(Me);(function(v){v.NOT_LOADED="NOT_LOADED",v.APPENDING="APPENDING",v.PARTIAL="PARTIAL",v.OK="OK"})(et||(et={}));var Ht=function(){function v(t){this.activeFragment=null,this.activeParts=null,this.endListFragments=Object.create(null),this.fragments=Object.create(null),this.timeRanges=Object.create(null),this.bufferPadding=.2,this.hls=void 0,this.hls=t,this._registerListeners()}var h=v.prototype;return h._registerListeners=function(){var t=this.hls;t.on(E.Events.BUFFER_APPENDED,this.onBufferAppended,this),t.on(E.Events.FRAG_BUFFERED,this.onFragBuffered,this),t.on(E.Events.FRAG_LOADED,this.onFragLoaded,this)},h._unregisterListeners=function(){var t=this.hls;t.off(E.Events.BUFFER_APPENDED,this.onBufferAppended,this),t.off(E.Events.FRAG_BUFFERED,this.onFragBuffered,this),t.off(E.Events.FRAG_LOADED,this.onFragLoaded,this)},h.destroy=function(){this._unregisterListeners(),this.fragments=this.endListFragments=this.timeRanges=this.activeFragment=this.activeParts=null},h.getAppendedFrag=function(t,n){if(n===ue.PlaylistLevelType.MAIN){var s=this.activeFragment,o=this.activeParts;if(!s)return null;if(o)for(var c=o.length;c--;){var i=o[c],u=i?i.end:s.appendedPTS;if(i.start<=t&&u!==void 0&&t<=u)return c>9&&(this.activeParts=o.slice(c-9)),i}else if(s.start<=t&&s.appendedPTS!==void 0&&t<=s.appendedPTS)return s}return this.getBufferedFrag(t,n)},h.getBufferedFrag=function(t,n){for(var s=this.fragments,o=Object.keys(s),c=o.length;c--;){var i=s[o[c]];if((i==null?void 0:i.body.type)===n&&i.buffered){var u=i.body;if(u.start<=t&&t<=u.end)return u}}return null},h.detectEvictedFragments=function(t,n,s){var o=this;this.timeRanges&&(this.timeRanges[t]=n),Object.keys(this.fragments).forEach(function(c){var i=o.fragments[c];if(i)if(i.buffered||i.loaded){var u=i.range[t];u&&u.time.some(function(p){var g=!o.isTimeBuffered(p.startPTS,p.endPTS,n);return g&&o.removeFragment(i.body),g})}else i.body.type===s&&o.removeFragment(i.body)})},h.detectPartialFragments=function(t){var n=this,s=this.timeRanges,o=t.frag,c=t.part;if(s&&o.sn!=="initSegment"){var i=zt(o),u=this.fragments[i];u&&(Object.keys(s).forEach(function(p){var g=o.elementaryStreams[p];if(g){var y=s[p],b=c!==null||g.partial===!0;u.range[p]=n.getBufferedTimes(o,c,b,y)}}),u.loaded=null,Object.keys(u.range).length?(u.buffered=!0,u.body.endList&&(this.endListFragments[u.body.type]=u)):this.removeFragment(u.body))}},h.fragBuffered=function(t){var n=zt(t),s=this.fragments[n];s&&(s.loaded=null,s.buffered=!0)},h.getBufferedTimes=function(t,n,s,o){for(var c={time:[],partial:s},i=n?n.start:t.start,u=n?n.end:t.end,p=t.minEndPTS||u,g=t.maxStartPTS||i,y=0;y<o.length;y++){var b=o.start(y)-this.bufferPadding,D=o.end(y)+this.bufferPadding;if(g>=b&&p<=D){c.time.push({startPTS:Math.max(i,o.start(y)),endPTS:Math.min(u,o.end(y))});break}if(i<D&&u>b)c.partial=!0,c.time.push({startPTS:Math.max(i,o.start(y)),endPTS:Math.min(u,o.end(y))});else if(u<=b)break}return c},h.getPartialFragment=function(t){var n,s,o,c=null,i=0,u=this.bufferPadding,p=this.fragments;return Object.keys(p).forEach(function(g){var y=p[g];y&&ct(y)&&(s=y.body.start-u,o=y.body.end+u,t>=s&&t<=o&&(n=Math.min(t-s,o-t),i<=n&&(c=y.body,i=n)))}),c},h.isEndListAppended=function(t){var n=this.endListFragments[t];return n!==void 0&&(n.buffered||ct(n))},h.getState=function(t){var n=zt(t),s=this.fragments[n];return s?s.buffered?ct(s)?et.PARTIAL:et.OK:et.APPENDING:et.NOT_LOADED},h.isTimeBuffered=function(t,n,s){for(var o,c,i=0;i<s.length;i++){if(o=s.start(i)-this.bufferPadding,c=s.end(i)+this.bufferPadding,t>=o&&n<=c)return!0;if(n<=o)return!1}return!1},h.onFragLoaded=function(t,n){var s=n.frag,o=n.part;if(s.sn!=="initSegment"&&!s.bitrateTest&&!o){var c=zt(s);this.fragments[c]={body:s,loaded:n,buffered:!1,range:Object.create(null)}}},h.onBufferAppended=function(t,n){var s=this,o=n.frag,c=n.part,i=n.timeRanges;if(o.type===ue.PlaylistLevelType.MAIN)if(this.activeFragment!==o&&(this.activeFragment=o,o.appendedPTS=void 0),c){var u=this.activeParts;u||(this.activeParts=u=[]),u.push(c)}else this.activeParts=null;this.timeRanges=i,Object.keys(i).forEach(function(p){var g=i[p];if(s.detectEvictedFragments(p,g),!c&&o.type===ue.PlaylistLevelType.MAIN){var y=o.elementaryStreams[p];if(!y)return;for(var b=0;b<g.length;b++){var D=g.end(b);D<=y.endPTS&&D>y.startPTS?o.appendedPTS=Math.max(D,o.appendedPTS||0):o.appendedPTS=y.endPTS}}})},h.onFragBuffered=function(t,n){this.detectPartialFragments(n)},h.hasFragment=function(t){var n=zt(t);return!!this.fragments[n]},h.removeFragmentsInRange=function(t,n,s){var o=this;Object.keys(this.fragments).forEach(function(c){var i=o.fragments[c];if(i&&i.buffered){var u=i.body;u.type===s&&u.start<n&&u.end>t&&o.removeFragment(u)}})},h.removeFragment=function(t){var n=zt(t);t.stats.loaded=0,t.clearElementaryStreamInfo(),t.appendedPTS=void 0,delete this.fragments[n],t.endList&&delete this.endListFragments[t.type]},h.removeAllFragments=function(){this.fragments=Object.create(null),this.endListFragments=Object.create(null),this.activeFragment=null,this.activeParts=null},v}();function ct(v){var h,t;return v.buffered&&(((h=v.range.video)===null||h===void 0?void 0:h.partial)||((t=v.range.audio)===null||t===void 0?void 0:t.partial))}function zt(v){return v.type+"_"+v.level+"_"+v.urlId+"_"+v.sn}function Er(v){var h=typeof Map=="function"?new Map:void 0;return Er=function(t){if(t===null||(n=t,Function.toString.call(n).indexOf("[native code]")===-1))return t;var n;if(typeof t!="function")throw new TypeError("Super expression must either be null or a function");if(h!==void 0){if(h.has(t))return h.get(t);h.set(t,s)}function s(){return Qt(t,arguments,mt(this).constructor)}return s.prototype=Object.create(t.prototype,{constructor:{value:s,enumerable:!1,writable:!0,configurable:!0}}),hr(s,t)},Er(v)}function Qt(v,h,t){return Qt=_r()?Reflect.construct.bind():function(n,s,o){var c=[null];c.push.apply(c,s);var i=new(Function.bind.apply(n,c));return o&&hr(i,o.prototype),i},Qt.apply(null,arguments)}function _r(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function hr(v,h){return hr=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,n){return t.__proto__=n,t},hr(v,h)}function mt(v){return mt=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(h){return h.__proto__||Object.getPrototypeOf(h)},mt(v)}var Br=Math.pow(2,17),un=function(){function v(t){this.config=void 0,this.loader=null,this.partLoadTimeout=-1,this.config=t}var h=v.prototype;return h.destroy=function(){this.loader&&(this.loader.destroy(),this.loader=null)},h.abort=function(){this.loader&&this.loader.abort()},h.load=function(t,n){var s=this,o=t.url;if(!o)return Promise.reject(new Cr({type:A.ErrorTypes.NETWORK_ERROR,details:A.ErrorDetails.FRAG_LOAD_ERROR,fatal:!1,frag:t,networkDetails:null},"Fragment does not have a "+(o?"part list":"url")));this.abort();var c=this.config,i=c.fLoader,u=c.loader;return new Promise(function(p,g){s.loader&&s.loader.destroy();var y=s.loader=t.loader=i?new i(c):new u(c),b=sr(t),D={timeout:c.fragLoadingTimeOut,maxRetry:0,retryDelay:0,maxRetryDelay:c.fragLoadingMaxRetryTimeout,highWaterMark:t.sn==="initSegment"?1/0:Br};t.stats=y.stats,y.load(b,D,{onSuccess:function(F,G,ee,J){s.resetLoader(t,y);var le=F.data;ee.resetIV&&t.decryptdata&&(t.decryptdata.iv=new Uint8Array(le.slice(0,16)),le=le.slice(16)),p({frag:t,part:null,payload:le,networkDetails:J})},onError:function(F,G,ee){s.resetLoader(t,y),g(new Cr({type:A.ErrorTypes.NETWORK_ERROR,details:A.ErrorDetails.FRAG_LOAD_ERROR,fatal:!1,frag:t,response:F,networkDetails:ee}))},onAbort:function(F,G,ee){s.resetLoader(t,y),g(new Cr({type:A.ErrorTypes.NETWORK_ERROR,details:A.ErrorDetails.INTERNAL_ABORTED,fatal:!1,frag:t,networkDetails:ee}))},onTimeout:function(F,G,ee){s.resetLoader(t,y),g(new Cr({type:A.ErrorTypes.NETWORK_ERROR,details:A.ErrorDetails.FRAG_LOAD_TIMEOUT,fatal:!1,frag:t,networkDetails:ee}))},onProgress:function(F,G,ee,J){n&&n({frag:t,part:null,payload:ee,networkDetails:J})}})})},h.loadPart=function(t,n,s){var o=this;this.abort();var c=this.config,i=c.fLoader,u=c.loader;return new Promise(function(p,g){o.loader&&o.loader.destroy();var y=o.loader=t.loader=i?new i(c):new u(c),b=sr(t,n),D={timeout:c.fragLoadingTimeOut,maxRetry:0,retryDelay:0,maxRetryDelay:c.fragLoadingMaxRetryTimeout,highWaterMark:Br};n.stats=y.stats,y.load(b,D,{onSuccess:function(F,G,ee,J){o.resetLoader(t,y),o.updateStatsFromPart(t,n);var le={frag:t,part:n,payload:F.data,networkDetails:J};s(le),p(le)},onError:function(F,G,ee){o.resetLoader(t,y),g(new Cr({type:A.ErrorTypes.NETWORK_ERROR,details:A.ErrorDetails.FRAG_LOAD_ERROR,fatal:!1,frag:t,part:n,response:F,networkDetails:ee}))},onAbort:function(F,G,ee){t.stats.aborted=n.stats.aborted,o.resetLoader(t,y),g(new Cr({type:A.ErrorTypes.NETWORK_ERROR,details:A.ErrorDetails.INTERNAL_ABORTED,fatal:!1,frag:t,part:n,networkDetails:ee}))},onTimeout:function(F,G,ee){o.resetLoader(t,y),g(new Cr({type:A.ErrorTypes.NETWORK_ERROR,details:A.ErrorDetails.FRAG_LOAD_TIMEOUT,fatal:!1,frag:t,part:n,networkDetails:ee}))}})})},h.updateStatsFromPart=function(t,n){var s=t.stats,o=n.stats,c=o.total;if(s.loaded+=o.loaded,c){var i=Math.round(t.duration/n.duration),u=Math.min(Math.round(s.loaded/c),i),p=(i-u)*Math.round(s.loaded/u);s.total=s.loaded+p}else s.total=Math.max(s.loaded,s.total);var g=s.loading,y=o.loading;g.start?g.first+=y.first-y.start:(g.start=y.start,g.first=y.first),g.end=y.end},h.resetLoader=function(t,n){t.loader=null,this.loader===n&&(self.clearTimeout(this.partLoadTimeout),this.loader=null),n.destroy()},v}();function sr(v,h){h===void 0&&(h=null);var t=h||v,n={frag:v,part:h,responseType:"arraybuffer",url:t.url,headers:{},rangeStart:0,rangeEnd:0},s=t.byteRangeStartOffset,o=t.byteRangeEndOffset;if((0,O.isFiniteNumber)(s)&&(0,O.isFiniteNumber)(o)){var c,i=s,u=o;if(v.sn==="initSegment"&&((c=v.decryptdata)===null||c===void 0?void 0:c.method)==="AES-128"){var p=o-s;p%16&&(u=o+(16-p%16)),s!==0&&(n.resetIV=!0,i=s-16)}n.rangeStart=i,n.rangeEnd=u}return n}var Cr=function(v){var h,t;function n(s){for(var o,c=arguments.length,i=new Array(c>1?c-1:0),u=1;u<c;u++)i[u-1]=arguments[u];return(o=v.call.apply(v,[this].concat(i))||this).data=void 0,o.data=s,o}return t=v,(h=n).prototype=Object.create(t.prototype),h.prototype.constructor=h,hr(h,t),n}(Er(Error)),cn=function(){function v(t){this.config=void 0,this.keyUriToKeyInfo={},this.emeController=null,this.config=t}var h=v.prototype;return h.abort=function(){for(var t in this.keyUriToKeyInfo){var n=this.keyUriToKeyInfo[t].loader;n&&n.abort()}},h.detach=function(){for(var t in this.keyUriToKeyInfo){var n=this.keyUriToKeyInfo[t];(n.mediaKeySessionContext||n.decryptdata.isCommonEncryption)&&delete this.keyUriToKeyInfo[t]}},h.destroy=function(){for(var t in this.detach(),this.keyUriToKeyInfo){var n=this.keyUriToKeyInfo[t].loader;n&&n.destroy()}this.keyUriToKeyInfo={}},h.createKeyLoadError=function(t,n,s,o){return n===void 0&&(n=A.ErrorDetails.KEY_LOAD_ERROR),new Cr({type:A.ErrorTypes.NETWORK_ERROR,details:n,fatal:!1,frag:t,networkDetails:s})},h.loadClear=function(t,n){var s=this;if(this.emeController&&this.config.emeEnabled)for(var o=t.sn,c=t.cc,i=function(p){var g=n[p];if(c<=g.cc&&(o==="initSegment"||o<g.sn))return s.emeController.selectKeySystemFormat(g).then(function(y){g.setKeyFormat(y)}),"break"},u=0;u<n.length&&i(u)!=="break";u++);},h.load=function(t){var n=this;return!t.decryptdata&&t.encrypted&&this.emeController?this.emeController.selectKeySystemFormat(t).then(function(s){return n.loadInternal(t,s)}):this.loadInternal(t)},h.loadInternal=function(t,n){var s,o;n&&t.setKeyFormat(n);var c=t.decryptdata;if(!c){var i=n?"Expected frag.decryptdata to be defined after setting format "+n:"Missing decryption data on fragment in onKeyLoading";return Promise.reject(this.createKeyLoadError(t,A.ErrorDetails.KEY_LOAD_ERROR,null,i))}var u=c.uri;if(!u)return Promise.reject(this.createKeyLoadError(t,A.ErrorDetails.KEY_LOAD_ERROR,null,'Invalid key URI: "'+u+'"'));var p,g=this.keyUriToKeyInfo[u];if((s=g)!==null&&s!==void 0&&s.decryptdata.key)return c.key=g.decryptdata.key,Promise.resolve({frag:t,keyInfo:g});if((o=g)!==null&&o!==void 0&&o.keyLoadPromise)switch((p=g.mediaKeySessionContext)===null||p===void 0?void 0:p.keyStatus){case void 0:case"status-pending":case"usable":case"usable-in-future":return g.keyLoadPromise.then(function(y){return c.key=y.keyInfo.decryptdata.key,{frag:t,keyInfo:g}})}switch(g=this.keyUriToKeyInfo[u]={decryptdata:c,keyLoadPromise:null,loader:null,mediaKeySessionContext:null},c.method){case"ISO-23001-7":case"SAMPLE-AES":case"SAMPLE-AES-CENC":case"SAMPLE-AES-CTR":return c.keyFormat==="identity"?this.loadKeyHTTP(g,t):this.loadKeyEME(g,t);case"AES-128":return this.loadKeyHTTP(g,t);default:return Promise.reject(this.createKeyLoadError(t,A.ErrorDetails.KEY_LOAD_ERROR,null,'Key supplied with unsupported METHOD: "'+c.method+'"'))}},h.loadKeyEME=function(t,n){var s={frag:n,keyInfo:t};if(this.emeController&&this.config.emeEnabled){var o=this.emeController.loadKey(s);if(o)return(t.keyLoadPromise=o.then(function(c){return t.mediaKeySessionContext=c,s})).catch(function(c){throw t.keyLoadPromise=null,c})}return Promise.resolve(s)},h.loadKeyHTTP=function(t,n){var s=this,o=this.config,c=new o.loader(o);return n.keyLoader=t.loader=c,t.keyLoadPromise=new Promise(function(i,u){var p={keyInfo:t,frag:n,responseType:"arraybuffer",url:t.decryptdata.uri},g={timeout:o.fragLoadingTimeOut,maxRetry:0,retryDelay:o.fragLoadingRetryDelay,maxRetryDelay:o.fragLoadingMaxRetryTimeout,highWaterMark:0},y={onSuccess:function(b,D,F,G){var ee=F.frag,J=F.keyInfo,le=F.url;if(!ee.decryptdata||J!==s.keyUriToKeyInfo[le])return u(s.createKeyLoadError(ee,A.ErrorDetails.KEY_LOAD_ERROR,G,"after key load, decryptdata unset or changed"));J.decryptdata.key=ee.decryptdata.key=new Uint8Array(b.data),ee.keyLoader=null,J.loader=null,i({frag:ee,keyInfo:J})},onError:function(b,D,F){s.resetLoader(D),u(s.createKeyLoadError(n,A.ErrorDetails.KEY_LOAD_ERROR,F))},onTimeout:function(b,D,F){s.resetLoader(D),u(s.createKeyLoadError(n,A.ErrorDetails.KEY_LOAD_TIMEOUT,F))},onAbort:function(b,D,F){s.resetLoader(D),u(s.createKeyLoadError(n,A.ErrorDetails.INTERNAL_ABORTED,F))}};c.load(p,g,y)})},h.resetLoader=function(t){var n=t.frag,s=t.keyInfo,o=t.url,c=s.loader;n.keyLoader===c&&(n.keyLoader=null,s.loader=null),delete this.keyUriToKeyInfo[o],c&&c.destroy()},v}(),Wn=function(){function v(){this._boundTick=void 0,this._tickTimer=null,this._tickInterval=null,this._tickCallCount=0,this._boundTick=this.tick.bind(this)}var h=v.prototype;return h.destroy=function(){this.onHandlerDestroying(),this.onHandlerDestroyed()},h.onHandlerDestroying=function(){this.clearNextTick(),this.clearInterval()},h.onHandlerDestroyed=function(){},h.hasInterval=function(){return!!this._tickInterval},h.hasNextTick=function(){return!!this._tickTimer},h.setInterval=function(t){return!this._tickInterval&&(this._tickInterval=self.setInterval(this._boundTick,t),!0)},h.clearInterval=function(){return!!this._tickInterval&&(self.clearInterval(this._tickInterval),this._tickInterval=null,!0)},h.clearNextTick=function(){return!!this._tickTimer&&(self.clearTimeout(this._tickTimer),this._tickTimer=null,!0)},h.tick=function(){this._tickCallCount++,this._tickCallCount===1&&(this.doTick(),this._tickCallCount>1&&this.tickImmediate(),this._tickCallCount=0)},h.tickImmediate=function(){this.clearNextTick(),this._tickTimer=self.setTimeout(this._boundTick,0)},h.doTick=function(){},v}(),fn={length:0,start:function(){return 0},end:function(){return 0}},or=function(){function v(){}return v.isBuffered=function(h,t){try{if(h){for(var n=v.getBuffered(h),s=0;s<n.length;s++)if(t>=n.start(s)&&t<=n.end(s))return!0}}catch{}return!1},v.bufferInfo=function(h,t,n){try{if(h){var s,o=v.getBuffered(h),c=[];for(s=0;s<o.length;s++)c.push({start:o.start(s),end:o.end(s)});return this.bufferedInfo(c,t,n)}}catch{}return{len:0,start:t,end:t,nextStart:void 0}},v.bufferedInfo=function(h,t,n){t=Math.max(0,t),h.sort(function(G,ee){return G.start-ee.start||ee.end-G.end});var s=[];if(n)for(var o=0;o<h.length;o++){var c=s.length;if(c){var i=s[c-1].end;h[o].start-i<n?h[o].end>i&&(s[c-1].end=h[o].end):s.push(h[o])}else s.push(h[o])}else s=h;for(var u,p=0,g=t,y=t,b=0;b<s.length;b++){var D=s[b].start,F=s[b].end;if(t+n>=D&&t<F)g=D,p=(y=F)-t;else if(t+n<D){u=D;break}}return{len:p,start:g||0,end:y||0,nextStart:u}},v.getBuffered=function(h){try{return h.buffered}catch(t){return w.logger.log("failed to get media.buffered",t),fn}},v}(),Ds=function(v,h,t,n,s,o){n===void 0&&(n=0),s===void 0&&(s=-1),o===void 0&&(o=!1),this.level=void 0,this.sn=void 0,this.part=void 0,this.id=void 0,this.size=void 0,this.partial=void 0,this.transmuxing={start:0,executeStart:0,executeEnd:0,end:0},this.buffering={audio:{start:0,executeStart:0,executeEnd:0,end:0},video:{start:0,executeStart:0,executeEnd:0,end:0},audiovideo:{start:0,executeStart:0,executeEnd:0,end:0}},this.level=v,this.sn=h,this.id=t,this.size=n,this.part=s,this.partial=o};function Ra(v,h){for(var t=null,n=0,s=v.length;n<s;n++){var o=v[n];if(o&&o.cc===h){t=o;break}}return t}function Da(v,h){if(v){var t=v.start+h;v.start=v.startPTS=t,v.endPTS=t+v.duration}}function Is(v,h){for(var t=h.fragments,n=0,s=t.length;n<s;n++)Da(t[n],v);h.fragmentHint&&Da(h.fragmentHint,v),h.alignedSliding=!0}function Ia(v,h){if(v.hasProgramDateTime&&h.hasProgramDateTime){var t=v.fragments,n=h.fragments;if(t.length&&n.length){var s=n[Math.round(n.length/2)-1],o=Ra(t,s.cc)||t[Math.round(t.length/2)-1],c=s.programDateTime,i=o.programDateTime;c!==null&&i!==null&&Is((i-c)/1e3-(o.start-s.start),v)}}}const Oi=function(v,h){for(var t=0,n=v.length-1,s=null,o=null;t<=n;){var c=h(o=v[s=(t+n)/2|0]);if(c>0)t=s+1;else{if(!(c<0))return o;n=s-1}}return null};function ks(v,h,t,n){t===void 0&&(t=0),n===void 0&&(n=0);var s=null;if(v?s=h[v.sn-h[0].sn+1]||null:t===0&&h[0].start===0&&(s=h[0]),s&&ci(t,n,s)===0)return s;var o=Oi(h,ci.bind(null,t,n));return!o||o===v&&s?s:o}function ci(v,h,t){if(v===void 0&&(v=0),h===void 0&&(h=0),t.start<=v&&t.start+t.duration>v)return 0;var n=Math.min(h,t.duration+(t.deltaPTS?t.deltaPTS:0));return t.start+t.duration-n<=v?1:t.start-n>v&&t.start?-1:0}function zo(v,h,t){var n=1e3*Math.min(h,t.duration+(t.deltaPTS?t.deltaPTS:0));return(t.endProgramDateTime||0)-n>v}var Qo=k(21);const Xo=function(v){for(var h="",t=v.length,n=0;n<t;n++)h+="["+v.start(n).toFixed(3)+"-"+v.end(n).toFixed(3)+"]";return h};function ka(v,h){for(var t=0;t<h.length;t++){var n=h[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(v,typeof(s=function(o,c){if(typeof o!="object"||o===null)return o;var i=o[Symbol.toPrimitive];if(i!==void 0){var u=i.call(o,c);if(typeof u!="object")return u;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(o)}(n.key,"string"))=="symbol"?s:String(s),n)}var s}function Zi(v,h){return Zi=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,n){return t.__proto__=n,t},Zi(v,h)}var zr="STOPPED",Nt="IDLE",Cs="KEY_LOADING",fi="FRAG_LOADING",di="FRAG_LOADING_WAITING_RETRY",Pi="WAITING_TRACK",nn="PARSING",hi="PARSED",jn="ENDED",En="ERROR",pi="WAITING_INIT_PTS",_n="WAITING_LEVEL",Ji=function(v){var h,t;function n(i,u,p,g){var y;return(y=v.call(this)||this).hls=void 0,y.fragPrevious=null,y.fragCurrent=null,y.fragmentTracker=void 0,y.transmuxer=null,y._state=zr,y.media=null,y.mediaBuffer=null,y.config=void 0,y.bitrateTest=!1,y.lastCurrentTime=0,y.nextLoadPosition=0,y.startPosition=0,y.loadedmetadata=!1,y.fragLoadError=0,y.retryDate=0,y.levels=null,y.fragmentLoader=void 0,y.keyLoader=void 0,y.levelLastLoaded=null,y.startFragRequested=!1,y.decrypter=void 0,y.initPTS=[],y.onvseeking=null,y.onvended=null,y.logPrefix="",y.log=void 0,y.warn=void 0,y.logPrefix=g,y.log=w.logger.log.bind(w.logger,g+":"),y.warn=w.logger.warn.bind(w.logger,g+":"),y.hls=i,y.fragmentLoader=new un(i.config),y.keyLoader=p,y.fragmentTracker=u,y.config=i.config,y.decrypter=new Qo.default(i.config),i.on(E.Events.LEVEL_SWITCHING,y.onLevelSwitching,function(b){if(b===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return b}(y)),y}t=v,(h=n).prototype=Object.create(t.prototype),h.prototype.constructor=h,Zi(h,t);var s,o,c=n.prototype;return c.doTick=function(){this.onTickEnd()},c.onTickEnd=function(){},c.startLoad=function(i){},c.stopLoad=function(){this.fragmentLoader.abort(),this.keyLoader.abort();var i=this.fragCurrent;i&&(i.abortRequests(),this.fragmentTracker.removeFragment(i)),this.resetTransmuxer(),this.fragCurrent=null,this.fragPrevious=null,this.clearInterval(),this.clearNextTick(),this.state=zr},c._streamEnded=function(i,u){if(u.live||i.nextStart||!i.end||!this.media)return!1;var p=u.partList;if(p!=null&&p.length){var g=p[p.length-1];return or.isBuffered(this.media,g.start+g.duration/2)}var y=u.fragments[u.fragments.length-1].type;return this.fragmentTracker.isEndListAppended(y)},c.getLevelDetails=function(){var i;if(this.levels&&this.levelLastLoaded!==null)return(i=this.levels[this.levelLastLoaded])===null||i===void 0?void 0:i.details},c.onMediaAttached=function(i,u){var p=this.media=this.mediaBuffer=u.media;this.onvseeking=this.onMediaSeeking.bind(this),this.onvended=this.onMediaEnded.bind(this),p.addEventListener("seeking",this.onvseeking),p.addEventListener("ended",this.onvended);var g=this.config;this.levels&&g.autoStartLoad&&this.state===zr&&this.startLoad(g.startPosition)},c.onMediaDetaching=function(){var i=this.media;i!=null&&i.ended&&(this.log("MSE detaching and video ended, reset startPosition"),this.startPosition=this.lastCurrentTime=0),i&&this.onvseeking&&this.onvended&&(i.removeEventListener("seeking",this.onvseeking),i.removeEventListener("ended",this.onvended),this.onvseeking=this.onvended=null),this.keyLoader&&this.keyLoader.detach(),this.media=this.mediaBuffer=null,this.loadedmetadata=!1,this.fragmentTracker.removeAllFragments(),this.stopLoad()},c.onMediaSeeking=function(){var i=this.config,u=this.fragCurrent,p=this.media,g=this.mediaBuffer,y=this.state,b=p?p.currentTime:0,D=or.bufferInfo(g||p,b,i.maxBufferHole);if(this.log("media seeking to "+((0,O.isFiniteNumber)(b)?b.toFixed(3):b)+", state: "+y),this.state===jn)this.resetLoadingState();else if(u){var F=i.maxFragLookUpTolerance,G=u.start-F,ee=u.start+u.duration+F;if(!D.len||ee<D.start||G>D.end){var J=b>ee;(b<G||J)&&(J&&u.loader&&(this.log("seeking outside of buffer while fragment load in progress, cancel fragment load"),u.abortRequests()),this.resetLoadingState())}}p&&(this.lastCurrentTime=b),this.loadedmetadata||D.len||(this.nextLoadPosition=this.startPosition=b),this.tickImmediate()},c.onMediaEnded=function(){this.startPosition=this.lastCurrentTime=0},c.onLevelSwitching=function(i,u){this.fragLoadError=0},c.onHandlerDestroying=function(){this.stopLoad(),v.prototype.onHandlerDestroying.call(this)},c.onHandlerDestroyed=function(){this.state=zr,this.hls.off(E.Events.LEVEL_SWITCHING,this.onLevelSwitching,this),this.fragmentLoader&&this.fragmentLoader.destroy(),this.keyLoader&&this.keyLoader.destroy(),this.decrypter&&this.decrypter.destroy(),this.hls=this.log=this.warn=this.decrypter=this.keyLoader=this.fragmentLoader=this.fragmentTracker=null,v.prototype.onHandlerDestroyed.call(this)},c.loadFragment=function(i,u,p){this._loadFragForPlayback(i,u,p)},c._loadFragForPlayback=function(i,u,p){var g=this;this._doFragLoad(i,u,p,function(y){if(g.fragContextChanged(i))return g.warn("Fragment "+i.sn+(y.part?" p: "+y.part.index:"")+" of level "+i.level+" was dropped during download."),void g.fragmentTracker.removeFragment(i);i.stats.chunkCount++,g._handleFragmentLoadProgress(y)}).then(function(y){if(y){g.fragLoadError=0;var b=g.state;g.fragContextChanged(i)?(b===fi||!g.fragCurrent&&b===nn)&&(g.fragmentTracker.removeFragment(i),g.state=Nt):("payload"in y&&(g.log("Loaded fragment "+i.sn+" of level "+i.level),g.hls.trigger(E.Events.FRAG_LOADED,y)),g._handleFragmentLoadComplete(y))}}).catch(function(y){g.state!==zr&&g.state!==En&&(g.warn(y),g.resetFragmentLoading(i))})},c.flushMainBuffer=function(i,u,p){if(p===void 0&&(p=null),i-u){var g={startOffset:i,endOffset:u,type:p};this.fragLoadError=0,this.hls.trigger(E.Events.BUFFER_FLUSHING,g)}},c._loadInitSegment=function(i,u){var p=this;this._doFragLoad(i,u).then(function(g){if(!g||p.fragContextChanged(i)||!p.levels)throw new Error("init load aborted");return g}).then(function(g){var y=p.hls,b=g.payload,D=i.decryptdata;if(b&&b.byteLength>0&&D&&D.key&&D.iv&&D.method==="AES-128"){var F=self.performance.now();return p.decrypter.decrypt(new Uint8Array(b),D.key.buffer,D.iv.buffer).then(function(G){var ee=self.performance.now();return y.trigger(E.Events.FRAG_DECRYPTED,{frag:i,payload:G,stats:{tstart:F,tdecrypt:ee}}),g.payload=G,g})}return g}).then(function(g){var y=p.fragCurrent,b=p.hls,D=p.levels;if(!D)throw new Error("init load aborted, missing levels");D[i.level].details;var F=i.stats;p.state=Nt,p.fragLoadError=0,i.data=new Uint8Array(g.payload),F.parsing.start=F.buffering.start=self.performance.now(),F.parsing.end=F.buffering.end=self.performance.now(),g.frag===y&&b.trigger(E.Events.FRAG_BUFFERED,{stats:F,frag:y,part:null,id:i.type}),p.tick()}).catch(function(g){p.state!==zr&&p.state!==En&&(p.warn(g),p.resetFragmentLoading(i))})},c.fragContextChanged=function(i){var u=this.fragCurrent;return!i||!u||i.level!==u.level||i.sn!==u.sn||i.urlId!==u.urlId},c.fragBufferedComplete=function(i,u){var p,g,y,b,D=this.mediaBuffer?this.mediaBuffer:this.media;this.log("Buffered "+i.type+" sn: "+i.sn+(u?" part: "+u.index:"")+" of "+(this.logPrefix==="[stream-controller]"?"level":"track")+" "+i.level+" (frag:["+((p=i.startPTS)!=null?p:NaN).toFixed(3)+"-"+((g=i.endPTS)!=null?g:NaN).toFixed(3)+"] > buffer:"+(D?Xo(or.getBuffered(D)):"(detached)")+")"),this.state=Nt,D&&(!this.loadedmetadata&&i.type==ue.PlaylistLevelType.MAIN&&D.buffered.length&&((y=this.fragCurrent)===null||y===void 0?void 0:y.sn)===((b=this.fragPrevious)===null||b===void 0?void 0:b.sn)&&(this.loadedmetadata=!0,this.seekToStartPos()),this.tick())},c.seekToStartPos=function(){},c._handleFragmentLoadComplete=function(i){var u=this.transmuxer;if(u){var p=i.frag,g=i.part,y=i.partsLoaded,b=!y||y.length===0||y.some(function(F){return!F}),D=new Ds(p.level,p.sn,p.stats.chunkCount+1,0,g?g.index:-1,!b);u.flush(D)}},c._handleFragmentLoadProgress=function(i){},c._doFragLoad=function(i,u,p,g){var y,b=this;if(p===void 0&&(p=null),!this.levels)throw new Error("frag load aborted, missing levels");var D=null;if(!i.encrypted||(y=i.decryptdata)!==null&&y!==void 0&&y.key?!i.encrypted&&u.encryptedFragments.length&&this.keyLoader.loadClear(i,u.encryptedFragments):(this.log("Loading key for "+i.sn+" of ["+u.startSN+"-"+u.endSN+"], "+(this.logPrefix==="[stream-controller]"?"level":"track")+" "+i.level),this.state=Cs,this.fragCurrent=i,D=this.keyLoader.load(i).then(function(le){if(!b.fragContextChanged(le.frag))return b.hls.trigger(E.Events.KEY_LOADED,le),b.state===Cs&&(b.state=Nt),le}),this.hls.trigger(E.Events.KEY_LOADING,{frag:i}),this.throwIfFragContextChanged("KEY_LOADING")),p=Math.max(i.start,p||0),this.config.lowLatencyMode&&u){var F=u.partList;if(F&&g){p>i.end&&u.fragmentHint&&(i=u.fragmentHint);var G=this.getNextPart(F,i,p);if(G>-1){var ee=F[G];return this.log("Loading part sn: "+i.sn+" p: "+ee.index+" cc: "+i.cc+" of playlist ["+u.startSN+"-"+u.endSN+"] parts [0-"+G+"-"+(F.length-1)+"] "+(this.logPrefix==="[stream-controller]"?"level":"track")+": "+i.level+", target: "+parseFloat(p.toFixed(3))),this.nextLoadPosition=ee.start+ee.duration,this.state=fi,this.hls.trigger(E.Events.FRAG_LOADING,{frag:i,part:F[G],targetBufferTime:p}),this.throwIfFragContextChanged("FRAG_LOADING parts"),D?D.then(function(le){return!le||b.fragContextChanged(le.frag)?null:b.doFragPartsLoad(i,F,G,g)}).catch(function(le){return b.handleFragLoadError(le)}):this.doFragPartsLoad(i,F,G,g).catch(function(le){return b.handleFragLoadError(le)})}if(!i.url||this.loadedEndOfParts(F,p))return Promise.resolve(null)}}this.log("Loading fragment "+i.sn+" cc: "+i.cc+" "+(u?"of ["+u.startSN+"-"+u.endSN+"] ":"")+(this.logPrefix==="[stream-controller]"?"level":"track")+": "+i.level+", target: "+parseFloat(p.toFixed(3))),(0,O.isFiniteNumber)(i.sn)&&!this.bitrateTest&&(this.nextLoadPosition=i.start+i.duration),this.state=fi,this.hls.trigger(E.Events.FRAG_LOADING,{frag:i,targetBufferTime:p}),this.throwIfFragContextChanged("FRAG_LOADING");var J=this.config.progressive;return J&&D?D.then(function(le){return!le||b.fragContextChanged(le==null?void 0:le.frag)?null:b.fragmentLoader.load(i,g)}).catch(function(le){return b.handleFragLoadError(le)}):Promise.all([this.fragmentLoader.load(i,J?g:void 0),D]).then(function(le){var Se=le[0];return!J&&Se&&g&&g(Se),Se}).catch(function(le){return b.handleFragLoadError(le)})},c.throwIfFragContextChanged=function(i){if(this.fragCurrent===null)throw new Error("frag load aborted, context changed in "+i)},c.doFragPartsLoad=function(i,u,p,g){var y=this;return new Promise(function(b,D){var F=[];(function G(ee){var J=u[ee];y.fragmentLoader.loadPart(i,J,g).then(function(le){F[J.index]=le;var Se=le.part;y.hls.trigger(E.Events.FRAG_LOADED,le);var we=u[ee+1];if(!we||we.fragment!==i)return b({frag:i,part:Se,partsLoaded:F});G(ee+1)}).catch(D)})(p)})},c.handleFragLoadError=function(i){if("data"in i){var u=i.data;i.data&&u.details===A.ErrorDetails.INTERNAL_ABORTED?this.handleFragLoadAborted(u.frag,u.part):this.hls.trigger(E.Events.ERROR,u)}else this.hls.trigger(E.Events.ERROR,{type:A.ErrorTypes.OTHER_ERROR,details:A.ErrorDetails.INTERNAL_EXCEPTION,err:i,fatal:!0});return null},c._handleTransmuxerFlush=function(i){var u=this.getCurrentContext(i);if(u&&this.state===nn){var p=u.frag,g=u.part,y=u.level,b=self.performance.now();p.stats.parsing.end=b,g&&(g.stats.parsing.end=b),this.updateLevelTiming(p,g,y,i.partial)}else this.fragCurrent||this.state===zr||this.state===En||(this.state=Nt)},c.getCurrentContext=function(i){var u=this.levels,p=i.level,g=i.sn,y=i.part;if(!u||!u[p])return this.warn("Levels object was unset while buffering fragment "+g+" of level "+p+". The current chunk will not be buffered."),null;var b=u[p],D=y>-1?function(G,ee,J){if(!G||!G.details)return null;var le=G.details.partList;if(le)for(var Se=le.length;Se--;){var we=le[Se];if(we.index===J&&we.fragment.sn===ee)return we}return null}(b,g,y):null,F=D?D.fragment:function(G,ee,J){if(!G||!G.details)return null;var le=G.details,Se=le.fragments[ee-le.startSN];return Se||((Se=le.fragmentHint)&&Se.sn===ee?Se:ee<le.startSN&&J&&J.sn===ee?J:null)}(b,g,this.fragCurrent);return F?{frag:F,part:D,level:b}:null},c.bufferFragmentData=function(i,u,p,g){if(i&&this.state===nn){var y=i.data1,b=i.data2,D=y;if(y&&b&&(D=(0,Ee.appendUint8Array)(y,b)),D&&D.length){var F={type:i.type,frag:u,part:p,chunkMeta:g,parent:u.type,data:D};this.hls.trigger(E.Events.BUFFER_APPENDING,F),i.dropped&&i.independent&&!p&&this.flushBufferGap(u)}}},c.flushBufferGap=function(i){var u=this.media;if(u)if(or.isBuffered(u,u.currentTime)){var p=u.currentTime,g=or.bufferInfo(u,p,0),y=i.duration,b=Math.min(2*this.config.maxFragLookUpTolerance,.25*y),D=Math.max(Math.min(i.start-b,g.end-b),p+b);i.start-D>b&&this.flushMainBuffer(D,i.start)}else this.flushMainBuffer(0,i.start)},c.getFwdBufferInfo=function(i,u){var p=this.config,g=this.getLoadPosition();if(!(0,O.isFiniteNumber)(g))return null;var y=or.bufferInfo(i,g,p.maxBufferHole);if(y.len===0&&y.nextStart!==void 0){var b=this.fragmentTracker.getBufferedFrag(g,u);if(b&&y.nextStart<b.end)return or.bufferInfo(i,g,Math.max(y.nextStart,p.maxBufferHole))}return y},c.getMaxBufferLength=function(i){var u,p=this.config;return u=i?Math.max(8*p.maxBufferSize/i,p.maxBufferLength):p.maxBufferLength,Math.min(u,p.maxMaxBufferLength)},c.reduceMaxBufferLength=function(i){var u=this.config,p=i||u.maxBufferLength;return u.maxMaxBufferLength>=p&&(u.maxMaxBufferLength/=2,this.warn("Reduce max buffer length to "+u.maxMaxBufferLength+"s"),!0)},c.getNextFragment=function(i,u){var p=u.fragments,g=p.length;if(!g)return null;var y,b=this.config,D=p[0].start;if(u.live){var F=b.initialLiveManifestSize;if(g<F)return this.warn("Not enough fragments to start playback (have: "+g+", need: "+F+")"),null;u.PTSKnown||this.startFragRequested||this.startPosition!==-1||(y=this.getInitialLiveFragment(u,p),this.startPosition=y?this.hls.liveSyncPosition||y.start:i)}else i<=D&&(y=p[0]);if(!y){var G=b.lowLatencyMode?u.partEnd:u.fragmentEnd;y=this.getFragmentAtPosition(i,G,u)}return this.mapToInitFragWhenRequired(y)},c.mapToInitFragWhenRequired=function(i){return i==null||!i.initSegment||i!=null&&i.initSegment.data||this.bitrateTest?i:i.initSegment},c.getNextPart=function(i,u,p){for(var g=-1,y=!1,b=!0,D=0,F=i.length;D<F;D++){var G=i[D];if(b=b&&!G.independent,g>-1&&p<G.start)break;var ee=G.loaded;ee?g=-1:(y||G.independent||b)&&G.fragment===u&&(g=D),y=ee}return g},c.loadedEndOfParts=function(i,u){var p=i[i.length-1];return p&&u>p.start&&p.loaded},c.getInitialLiveFragment=function(i,u){var p=this.fragPrevious,g=null;if(p){if(i.hasProgramDateTime&&(this.log("Live playlist, switching playlist, load frag with same PDT: "+p.programDateTime),g=function(F,G,ee){if(G===null||!Array.isArray(F)||!F.length||!(0,O.isFiniteNumber)(G)||G<(F[0].programDateTime||0)||G>=(F[F.length-1].endProgramDateTime||0))return null;ee=ee||0;for(var J=0;J<F.length;++J){var le=F[J];if(zo(G,ee,le))return le}return null}(u,p.endProgramDateTime,this.config.maxFragLookUpTolerance)),!g){var y=p.sn+1;if(y>=i.startSN&&y<=i.endSN){var b=u[y-i.startSN];p.cc===b.cc&&(g=b,this.log("Live playlist, switching playlist, load frag with next SN: "+g.sn))}g||(g=function(F,G){return Oi(F,function(ee){return ee.cc<G?1:ee.cc>G?-1:0})}(u,p.cc),g&&this.log("Live playlist, switching playlist, load frag with same CC: "+g.sn))}}else{var D=this.hls.liveSyncPosition;D!==null&&(g=this.getFragmentAtPosition(D,this.bitrateTest?i.fragmentEnd:i.edge,i))}return g},c.getFragmentAtPosition=function(i,u,p){var g,y=this.config,b=this.fragPrevious,D=p.fragments,F=p.endSN,G=p.fragmentHint,ee=y.maxFragLookUpTolerance,J=!!(y.lowLatencyMode&&p.partList&&G);if(J&&G&&!this.bitrateTest&&(D=D.concat(G),F=G.sn),g=i<u?ks(b,D,i,i>u-ee?0:ee):D[D.length-1]){var le=g.sn-p.startSN;if(this.fragmentTracker.getState(g)===et.OK&&(b=g),b&&g.sn===b.sn&&!J&&b&&g.level===b.level){var Se=D[le+1];g.sn<F&&this.fragmentTracker.getState(Se)!==et.OK?(this.log("SN "+g.sn+" just loaded, load next one: "+Se.sn),g=Se):g=null}}return g},c.synchronizeToLiveEdge=function(i){var u=this.config,p=this.media;if(p){var g=this.hls.liveSyncPosition,y=p.currentTime,b=i.fragments[0].start,D=i.edge,F=y>=b-u.maxFragLookUpTolerance&&y<=D;if(g!==null&&p.duration>g&&(y<g||!F)){var G=u.liveMaxLatencyDuration!==void 0?u.liveMaxLatencyDuration:u.liveMaxLatencyDurationCount*i.targetduration;(!F&&p.readyState<4||y<D-G)&&(this.loadedmetadata||(this.nextLoadPosition=g),p.readyState&&(this.warn("Playback: "+y.toFixed(3)+" is located too far from the end of live sliding playlist: "+D+", reset currentTime to : "+g.toFixed(3)),p.currentTime=g))}}},c.alignPlaylists=function(i,u){var p=this.levels,g=this.levelLastLoaded,y=this.fragPrevious,b=g!==null?p[g]:null,D=i.fragments.length;if(!D)return this.warn("No fragments in live playlist"),0;var F=i.fragments[0].start,G=!u,ee=i.alignedSliding&&(0,O.isFiniteNumber)(F);if(G||!ee&&!F){(function(le,Se,we){Se&&(function(be,Pe,tt){if(function(Ge,Je,Qe){return!(!Je.details||!(Qe.endCC>Qe.startCC||Ge&&Ge.cc<Qe.startCC))}(be,tt,Pe)){var rt=function(Ge,Je,Qe){var Dt=Ge.fragments,Vt=Je.fragments;if(Vt.length&&Dt.length){var St=Ra(Dt,Vt[0].cc);if(St&&(!St||St.startPTS))return St;w.logger.log("No frag in previous level to align on")}else w.logger.log("No fragments to align")}(tt.details,Pe);rt&&(0,O.isFiniteNumber)(rt.start)&&(w.logger.log("Adjusting PTS using last level due to CC increase within current level "+Pe.url),Is(rt.start,Pe))}}(le,we,Se),!we.alignedSliding&&Se.details&&function(be,Pe){if(Pe.fragments.length&&be.hasProgramDateTime&&Pe.hasProgramDateTime){var tt=Pe.fragments[0].programDateTime,rt=be.fragments[0].programDateTime,Ge=(rt-tt)/1e3+Pe.fragments[0].start;Ge&&(0,O.isFiniteNumber)(Ge)&&(w.logger.log("Adjusting PTS using programDateTime delta "+(rt-tt)+"ms, sliding:"+Ge.toFixed(3)+" "+be.url+" "),Is(Ge,be))}}(we,Se.details),we.alignedSliding||!Se.details||we.skippedSegments||de(Se.details,we))})(y,b,i);var J=i.fragments[0].start;return this.log("Live playlist sliding: "+J.toFixed(2)+" start-sn: "+(u?u.startSN:"na")+"->"+i.startSN+" prev-sn: "+(y?y.sn:"na")+" fragments: "+D),J}return F},c.waitForCdnTuneIn=function(i){return i.live&&i.canBlockReload&&i.partTarget&&i.tuneInGoal>Math.max(i.partHoldBack,3*i.partTarget)},c.setStartPosition=function(i,u){var p=this.startPosition;if(p<u&&(p=-1),p===-1||this.lastCurrentTime===-1){var g=i.startTimeOffset;(0,O.isFiniteNumber)(g)?(p=u+g,g<0&&(p+=i.totalduration),p=Math.min(Math.max(u,p),u+i.totalduration),this.log("Start time offset "+g+" found in playlist, adjust startPosition to "+p),this.startPosition=p):i.live?p=this.hls.liveSyncPosition||u:this.startPosition=p=0,this.lastCurrentTime=p}this.nextLoadPosition=p},c.getLoadPosition=function(){var i=this.media,u=0;return this.loadedmetadata&&i?u=i.currentTime:this.nextLoadPosition&&(u=this.nextLoadPosition),u},c.handleFragLoadAborted=function(i,u){this.transmuxer&&i.sn!=="initSegment"&&i.stats.aborted&&(this.warn("Fragment "+i.sn+(u?" part"+u.index:"")+" of level "+i.level+" was aborted"),this.resetFragmentLoading(i))},c.resetFragmentLoading=function(i){this.fragCurrent&&(this.fragContextChanged(i)||this.state===di)||(this.state=Nt)},c.onFragmentOrKeyLoadError=function(i,u){if(u.fatal)return this.stopLoad(),void(this.state=En);var p=this.config;if(u.chunkMeta){var g=this.getCurrentContext(u.chunkMeta);g&&(u.frag=g.frag,u.levelRetry=!0,this.fragLoadError=p.fragLoadingMaxRetry)}var y=u.frag;if(y&&y.type===i)if(this.fragCurrent,this.fragLoadError+1<=p.fragLoadingMaxRetry){this.loadedmetadata||(this.startFragRequested=!1,this.nextLoadPosition=this.startPosition);var b=Math.min(Math.pow(2,this.fragLoadError)*p.fragLoadingRetryDelay,p.fragLoadingMaxRetryTimeout);this.warn("Fragment "+y.sn+" of "+i+" "+y.level+" failed to load, retrying in "+b+"ms"),this.retryDate=self.performance.now()+b,this.fragLoadError++,this.state=di}else u.levelRetry?(i===ue.PlaylistLevelType.AUDIO&&(this.fragCurrent=null),this.fragLoadError=0,this.state=Nt):(w.logger.error(u.details+" reaches max retry, redispatch as fatal ..."),u.fatal=!0,this.hls.stopLoad(),this.state=En)},c.afterBufferFlushed=function(i,u,p){if(i){var g=or.getBuffered(i);this.fragmentTracker.detectEvictedFragments(u,g,p),this.state===jn&&this.resetLoadingState()}},c.resetLoadingState=function(){this.log("Reset loading state"),this.fragCurrent=null,this.fragPrevious=null,this.state=Nt},c.resetStartWhenNotLoaded=function(i){if(!this.loadedmetadata){this.startFragRequested=!1;var u=this.levels?this.levels[i].details:null;u!=null&&u.live?(this.startPosition=-1,this.setStartPosition(u,0),this.resetLoadingState()):this.nextLoadPosition=this.startPosition}},c.updateLevelTiming=function(i,u,p,g){var y=this,b=p.details;Object.keys(i.elementaryStreams).reduce(function(D,F){var G=i.elementaryStreams[F];if(G){var ee=G.endPTS-G.startPTS;if(ee<=0)return y.warn("Could not parse fragment "+i.sn+" "+F+" duration reliably ("+ee+")"),D||!1;var J=g?0:oe(b,i,G.startPTS,G.endPTS,G.startDTS,G.endDTS);return y.hls.trigger(E.Events.LEVEL_PTS_UPDATED,{details:b,level:p,drift:J,type:F,frag:i,start:G.startPTS,end:G.endPTS}),!0}return D},!1)||(this.warn("Found no media in fragment "+i.sn+" of level "+p.id+" resetting transmuxer to fallback to playlist timing"),this.resetTransmuxer()),this.state=hi,this.hls.trigger(E.Events.FRAG_PARSED,{frag:i,part:u})},c.resetTransmuxer=function(){this.transmuxer&&(this.transmuxer.destroy(),this.transmuxer=null)},s=n,(o=[{key:"state",get:function(){return this._state},set:function(i){var u=this._state;u!==i&&(this._state=i,this.log(u+"->"+i))}}])&&ka(s.prototype,o),Object.defineProperty(s,"prototype",{writable:!1}),n}(Wn);function Os(){return self.MediaSource||self.WebKitMediaSource}function Ps(){return self.SourceBuffer||self.WebKitSourceBuffer}var $i=function(){var v=ENTRY_MODULE,h={},t=function s(o){var c=h[o];if(c!==void 0)return c.exports;var i=h[o]={exports:{}};return v[o].call(i.exports,i,i.exports,s),i.exports};t.m=v,t.n=function(s){var o=s&&s.__esModule?function(){return s.default}:function(){return s};return t.d(o,{a:o}),o},t.d=function(s,o){for(var c in o)t.o(o,c)&&!t.o(s,c)&&Object.defineProperty(s,c,{enumerable:!0,get:o[c]})},t.o=function(s,o){return Object.prototype.hasOwnProperty.call(s,o)},t.r=function(s){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(s,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(s,"__esModule",{value:!0})};var n=t(ENTRY_MODULE);return n.default||n}.toString().split("ENTRY_MODULE"),es="\\(\\s*(/\\*.*?\\*/)?\\s*.*?([\\.|\\-|\\+|\\w|/|@]+).*?\\)";function Ca(v){return(v+"").replace(/[.?*+^$[\]\\(){}|-]/g,"\\$&")}function Oa(v,h,t){var n={};n[t]=[];var s=h.toString().replace(/^"[^"]+"/,"function"),o=s.match(/^function\s?\w*\(\w+,\s*\w+,\s*(\w+)\)/)||s.match(/^\(\w+,\s*\w+,\s*(\w+)\)\s?\=\s?\>/);if(!o)return n;for(var c,i=o[1],u=new RegExp("(\\\\n|\\W)"+Ca(i)+es,"g");c=u.exec(s);)c[3]!=="dll-reference"&&n[t].push(c[3]);for(u=new RegExp("\\("+Ca(i)+'\\("(dll-reference\\s([\\.|\\-|\\+|\\w|/|@]+))"\\)\\)'+es,"g");c=u.exec(s);)v[c[2]]||(n[t].push(c[1]),v[c[2]]=k(c[1]).m),n[c[2]]=n[c[2]]||[],n[c[2]].push(c[4]);for(var p,g=Object.keys(n),y=0;y<g.length;y++)for(var b=0;b<n[g[y]].length;b++)p=n[g[y]][b],isNaN(1*p)||(n[g[y]][b]=1*n[g[y]][b]);return n}function Fs(v){return Object.keys(v).reduce(function(h,t){return h||v[t].length>0},!1)}function ts(v,h,t,n){var s=v[n].map(function(o){return'"'+o+'": '+h[n][o].toString().replace(/^"[^"]+"/,"function")}).join(",");return $i[0]+"{"+s+"}"+$i[1]+'"'+t+'"'+$i[2]}var Qr=k(544),rs=k(729),Pa=k.n(rs),Ms=Os()||{isTypeSupported:function(){return!1}},xs=function(){function v(t,n,s,o){var c=this;this.hls=void 0,this.id=void 0,this.observer=void 0,this.frag=null,this.part=null,this.useWorker=void 0,this.worker=void 0,this.onwmsg=void 0,this.transmuxer=null,this.onTransmuxComplete=void 0,this.onFlush=void 0;var i=t.config;this.hls=t,this.id=n,this.useWorker=!!i.enableWorker,this.onTransmuxComplete=s,this.onFlush=o;var u=function(b,D){(D=D||{}).frag=c.frag,D.id=c.id,c.hls.trigger(b,D)};this.observer=new rs.EventEmitter,this.observer.on(E.Events.FRAG_DECRYPTED,u),this.observer.on(E.Events.ERROR,u);var p={mp4:Ms.isTypeSupported("video/mp4"),mpeg:Ms.isTypeSupported("audio/mpeg"),mp3:Ms.isTypeSupported('audio/mp4; codecs="mp3"')},g=navigator.vendor;if(this.useWorker&&typeof Worker<"u"){var y;w.logger.log("demuxing in webworker");try{y=this.worker=function(b,D){D=D||{};var F={main:k.m},G=D.all?{main:Object.keys(F.main)}:function(we,be){for(var Pe={main:[be]},tt={main:[]},rt={main:{}};Fs(Pe);)for(var Ge=Object.keys(Pe),Je=0;Je<Ge.length;Je++){var Qe=Ge[Je],Dt=Pe[Qe].pop();if(rt[Qe]=rt[Qe]||{},!rt[Qe][Dt]&&we[Qe][Dt]){rt[Qe][Dt]=!0,tt[Qe]=tt[Qe]||[],tt[Qe].push(Dt);for(var Vt=Oa(we,we[Qe][Dt],Qe),St=Object.keys(Vt),wt=0;wt<St.length;wt++)Pe[St[wt]]=Pe[St[wt]]||[],Pe[St[wt]]=Pe[St[wt]].concat(Vt[St[wt]])}}return tt}(F,b),ee="";Object.keys(G).filter(function(we){return we!=="main"}).forEach(function(we){for(var be=0;G[we][be];)be++;G[we].push(be),F[we][be]="(function(module, exports, __webpack_require__) { module.exports = __webpack_require__; })",ee=ee+"var "+we+" = ("+ts(G,F,be,modules)+`)();
`}),ee=ee+"new (("+ts(G,F,b,"main")+")())(self);";var J=new window.Blob([ee],{type:"text/javascript"}),le=(window.URL||window.webkitURL||window.mozURL||window.msURL).createObjectURL(J),Se=new window.Worker(le);return Se.objectURL=le,Se}(182),this.onwmsg=this.onWorkerMessage.bind(this),y.addEventListener("message",this.onwmsg),y.onerror=function(b){c.useWorker=!1,w.logger.warn("Exception in webworker, fallback to inline"),c.hls.trigger(E.Events.ERROR,{type:A.ErrorTypes.OTHER_ERROR,details:A.ErrorDetails.INTERNAL_EXCEPTION,fatal:!1,event:"demuxerWorker",error:new Error(b.message+"  ("+b.filename+":"+b.lineno+")")})},y.postMessage({cmd:"init",typeSupported:p,vendor:g,id:n,config:JSON.stringify(i)})}catch(b){w.logger.warn("Error in worker:",b),w.logger.error("Error while initializing DemuxerWorker, fallback to inline"),y&&self.URL.revokeObjectURL(y.objectURL),this.transmuxer=new Qr.default(this.observer,p,i,g,n),this.worker=null}}else this.transmuxer=new Qr.default(this.observer,p,i,g,n)}var h=v.prototype;return h.destroy=function(){var t=this.worker;if(t)t.removeEventListener("message",this.onwmsg),t.terminate(),this.worker=null,this.onwmsg=void 0;else{var n=this.transmuxer;n&&(n.destroy(),this.transmuxer=null)}var s=this.observer;s&&s.removeAllListeners(),this.frag=null,this.observer=null,this.hls=null},h.push=function(t,n,s,o,c,i,u,p,g,y){var b,D,F=this;g.transmuxing.start=self.performance.now();var G=this.transmuxer,ee=this.worker,J=i?i.start:c.start,le=c.decryptdata,Se=this.frag,we=!(Se&&c.cc===Se.cc),be=!(Se&&g.level===Se.level),Pe=Se?g.sn-Se.sn:-1,tt=this.part?g.part-this.part.index:-1,rt=Pe===0&&g.id>1&&g.id===(Se==null?void 0:Se.stats.chunkCount),Ge=!be&&(Pe===1||Pe===0&&(tt===1||rt&&tt<=0)),Je=self.performance.now();(be||Pe||c.stats.parsing.start===0)&&(c.stats.parsing.start=Je),!i||!tt&&Ge||(i.stats.parsing.start=Je);var Qe=!(Se&&((b=c.initSegment)===null||b===void 0?void 0:b.url)===((D=Se.initSegment)===null||D===void 0?void 0:D.url)),Dt=new Qr.TransmuxState(we,Ge,p,be,J,Qe);if(!Ge||we||Qe){w.logger.log("[transmuxer-interface, "+c.type+"]: Starting new transmux session for sn: "+g.sn+" p: "+g.part+" level: "+g.level+" id: "+g.id+`
        discontinuity: `+we+`
        trackSwitch: `+be+`
        contiguous: `+Ge+`
        accurateTimeOffset: `+p+`
        timeOffset: `+J+`
        initSegmentChange: `+Qe);var Vt=new Qr.TransmuxConfig(s,o,n,u,y);this.configureTransmuxer(Vt)}if(this.frag=c,this.part=i,ee)ee.postMessage({cmd:"demux",data:t,decryptdata:le,chunkMeta:g,state:Dt},t instanceof ArrayBuffer?[t]:[]);else if(G){var St=G.push(t,le,g,Dt);(0,Qr.isPromise)(St)?(G.async=!0,St.then(function(wt){F.handleTransmuxComplete(wt)}).catch(function(wt){F.transmuxerError(wt,g,"transmuxer-interface push error")})):(G.async=!1,this.handleTransmuxComplete(St))}},h.flush=function(t){var n=this;t.transmuxing.start=self.performance.now();var s=this.transmuxer,o=this.worker;if(o)o.postMessage({cmd:"flush",chunkMeta:t});else if(s){var c=s.flush(t);(0,Qr.isPromise)(c)||s.async?((0,Qr.isPromise)(c)||(c=Promise.resolve(c)),c.then(function(i){n.handleFlushResult(i,t)}).catch(function(i){n.transmuxerError(i,t,"transmuxer-interface flush error")})):this.handleFlushResult(c,t)}},h.transmuxerError=function(t,n,s){this.hls&&this.hls.trigger(E.Events.ERROR,{type:A.ErrorTypes.MEDIA_ERROR,details:A.ErrorDetails.FRAG_PARSING_ERROR,chunkMeta:n,fatal:!1,error:t,err:t,reason:s})},h.handleFlushResult=function(t,n){var s=this;t.forEach(function(o){s.handleTransmuxComplete(o)}),this.onFlush(n)},h.onWorkerMessage=function(t){var n=t.data,s=this.hls;switch(n.event){case"init":self.URL.revokeObjectURL(this.worker.objectURL);break;case"transmuxComplete":this.handleTransmuxComplete(n.data);break;case"flush":this.onFlush(n.data);break;case"workerLog":w.logger[n.data.logType]&&w.logger[n.data.logType](n.data.message);break;default:n.data=n.data||{},n.data.frag=this.frag,n.data.id=this.id,s.trigger(n.event,n.data)}},h.configureTransmuxer=function(t){var n=this.worker,s=this.transmuxer;n?n.postMessage({cmd:"configure",config:t}):s&&s.configure(t)},h.handleTransmuxComplete=function(t){t.chunkMeta.transmuxing.end=self.performance.now(),this.onTransmuxComplete(t)},v}(),Fa=function(){function v(t,n,s,o){this.config=void 0,this.media=null,this.fragmentTracker=void 0,this.hls=void 0,this.nudgeRetry=0,this.stallReported=!1,this.stalled=null,this.moved=!1,this.seeking=!1,this.config=t,this.media=n,this.fragmentTracker=s,this.hls=o}var h=v.prototype;return h.destroy=function(){this.media=null,this.hls=this.fragmentTracker=null},h.poll=function(t,n){var s=this.config,o=this.media,c=this.stalled;if(o!==null){var i=o.currentTime,u=o.seeking,p=this.seeking&&!u,g=!this.seeking&&u;if(this.seeking=u,i===t){if((g||p)&&(this.stalled=null),!(o.paused&&!u||o.ended||o.playbackRate===0)&&or.getBuffered(o).length){var y=or.bufferInfo(o,i,0),b=y.len>0,D=y.nextStart||0;if(b||D){if(u){var F=y.len>2,G=!D||n&&n.start<=i||D-i>2&&!this.fragmentTracker.getPartialFragment(i);if(F||G)return;this.moved=!1}if(!this.moved&&this.stalled!==null){var ee,J=Math.max(D,y.start||0)-i,le=this.hls.levels?this.hls.levels[this.hls.currentLevel]:null,Se=!(le==null||(ee=le.details)===null||ee===void 0)&&ee.live?2*le.details.targetduration:2;if(J>0&&J<=Se)return void this._trySkipBufferHole(null)}var we=self.performance.now();if(c!==null){var be=we-c;if(u||!(be>=250)||(this._reportStall(y),this.media)){var Pe=or.bufferInfo(o,i,s.maxBufferHole);this._tryFixBufferStall(Pe,be)}}else this.stalled=we}}}else if(this.moved=!0,c!==null){if(this.stallReported){var tt=self.performance.now()-c;w.logger.warn("playback not stuck anymore @"+i+", after "+Math.round(tt)+"ms"),this.stallReported=!1}this.stalled=null,this.nudgeRetry=0}}},h._tryFixBufferStall=function(t,n){var s=this.config,o=this.fragmentTracker,c=this.media;if(c!==null){var i=c.currentTime,u=o.getPartialFragment(i);if(u&&(this._trySkipBufferHole(u)||!this.media))return;t.len>s.maxBufferHole&&n>1e3*s.highBufferWatchdogPeriod&&(w.logger.warn("Trying to nudge playhead over buffer-hole"),this.stalled=null,this._tryNudgeBuffer())}},h._reportStall=function(t){var n=this.hls,s=this.media;!this.stallReported&&s&&(this.stallReported=!0,w.logger.warn("Playback stalling at @"+s.currentTime+" due to low buffer ("+JSON.stringify(t)+")"),n.trigger(E.Events.ERROR,{type:A.ErrorTypes.MEDIA_ERROR,details:A.ErrorDetails.BUFFER_STALLED_ERROR,fatal:!1,buffer:t.len}))},h._trySkipBufferHole=function(t){var n=this.config,s=this.hls,o=this.media;if(o===null)return 0;for(var c=o.currentTime,i=0,u=or.getBuffered(o),p=0;p<u.length;p++){var g=u.start(p);if(c+n.maxBufferHole>=i&&c<g){var y=Math.max(g+.05,o.currentTime+.1);return w.logger.warn("skipping hole, adjusting currentTime from "+c+" to "+y),this.moved=!0,this.stalled=null,o.currentTime=y,t&&s.trigger(E.Events.ERROR,{type:A.ErrorTypes.MEDIA_ERROR,details:A.ErrorDetails.BUFFER_SEEK_OVER_HOLE,fatal:!1,reason:"fragment loaded with buffer holes, seeking from "+c+" to "+y,frag:t}),y}i=u.end(p)}return 0},h._tryNudgeBuffer=function(){var t=this.config,n=this.hls,s=this.media,o=this.nudgeRetry;if(s!==null){var c=s.currentTime;if(this.nudgeRetry++,o<t.nudgeMaxRetry){var i=c+(o+1)*t.nudgeOffset;w.logger.warn("Nudging 'currentTime' from "+c+" to "+i),s.currentTime=i,n.trigger(E.Events.ERROR,{type:A.ErrorTypes.MEDIA_ERROR,details:A.ErrorDetails.BUFFER_NUDGE_ON_STALL,fatal:!1})}else w.logger.error("Playhead still not moving while enough data buffered @"+c+" after "+t.nudgeMaxRetry+" nudges"),n.trigger(E.Events.ERROR,{type:A.ErrorTypes.MEDIA_ERROR,details:A.ErrorDetails.BUFFER_STALLED_ERROR,fatal:!0})}},v}();function Ma(v,h){for(var t=0;t<h.length;t++){var n=h[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(v,typeof(s=function(o,c){if(typeof o!="object"||o===null)return o;var i=o[Symbol.toPrimitive];if(i!==void 0){var u=i.call(o,c);if(typeof u!="object")return u;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(o)}(n.key,"string"))=="symbol"?s:String(s),n)}var s}function ns(v,h){return ns=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,n){return t.__proto__=n,t},ns(v,h)}var Zo=function(v){var h,t;function n(i,u,p){var g;return(g=v.call(this,i,u,p,"[stream-controller]")||this).audioCodecSwap=!1,g.gapController=null,g.level=-1,g._forceStartLoad=!1,g.altAudio=!1,g.audioOnly=!1,g.fragPlaying=null,g.onvplaying=null,g.onvseeked=null,g.fragLastKbps=0,g.couldBacktrack=!1,g.backtrackFragment=null,g.audioCodecSwitch=!1,g.videoBuffer=null,g._registerListeners(),g}t=v,(h=n).prototype=Object.create(t.prototype),h.prototype.constructor=h,ns(h,t);var s,o,c=n.prototype;return c._registerListeners=function(){var i=this.hls;i.on(E.Events.MEDIA_ATTACHED,this.onMediaAttached,this),i.on(E.Events.MEDIA_DETACHING,this.onMediaDetaching,this),i.on(E.Events.MANIFEST_LOADING,this.onManifestLoading,this),i.on(E.Events.MANIFEST_PARSED,this.onManifestParsed,this),i.on(E.Events.LEVEL_LOADING,this.onLevelLoading,this),i.on(E.Events.LEVEL_LOADED,this.onLevelLoaded,this),i.on(E.Events.FRAG_LOAD_EMERGENCY_ABORTED,this.onFragLoadEmergencyAborted,this),i.on(E.Events.ERROR,this.onError,this),i.on(E.Events.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),i.on(E.Events.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),i.on(E.Events.BUFFER_CREATED,this.onBufferCreated,this),i.on(E.Events.BUFFER_FLUSHED,this.onBufferFlushed,this),i.on(E.Events.LEVELS_UPDATED,this.onLevelsUpdated,this),i.on(E.Events.FRAG_BUFFERED,this.onFragBuffered,this)},c._unregisterListeners=function(){var i=this.hls;i.off(E.Events.MEDIA_ATTACHED,this.onMediaAttached,this),i.off(E.Events.MEDIA_DETACHING,this.onMediaDetaching,this),i.off(E.Events.MANIFEST_LOADING,this.onManifestLoading,this),i.off(E.Events.MANIFEST_PARSED,this.onManifestParsed,this),i.off(E.Events.LEVEL_LOADED,this.onLevelLoaded,this),i.off(E.Events.FRAG_LOAD_EMERGENCY_ABORTED,this.onFragLoadEmergencyAborted,this),i.off(E.Events.ERROR,this.onError,this),i.off(E.Events.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),i.off(E.Events.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),i.off(E.Events.BUFFER_CREATED,this.onBufferCreated,this),i.off(E.Events.BUFFER_FLUSHED,this.onBufferFlushed,this),i.off(E.Events.LEVELS_UPDATED,this.onLevelsUpdated,this),i.off(E.Events.FRAG_BUFFERED,this.onFragBuffered,this)},c.onHandlerDestroying=function(){this._unregisterListeners(),this.onMediaDetaching()},c.startLoad=function(i){if(this.levels){var u=this.lastCurrentTime,p=this.hls;if(this.stopLoad(),this.setInterval(100),this.level=-1,this.fragLoadError=0,!this.startFragRequested){var g=p.startLevel;g===-1&&(p.config.testBandwidth&&this.levels.length>1?(g=0,this.bitrateTest=!0):g=p.nextAutoLevel),this.level=p.nextLoadLevel=g,this.loadedmetadata=!1}u>0&&i===-1&&(this.log("Override startPosition with lastCurrentTime @"+u.toFixed(3)),i=u),this.state=Nt,this.nextLoadPosition=this.startPosition=this.lastCurrentTime=i,this.tick()}else this._forceStartLoad=!0,this.state=zr},c.stopLoad=function(){this._forceStartLoad=!1,v.prototype.stopLoad.call(this)},c.doTick=function(){switch(this.state){case Nt:this.doTickIdle();break;case _n:var i,u=this.levels,p=this.level,g=u==null||(i=u[p])===null||i===void 0?void 0:i.details;if(g&&(!g.live||this.levelLastLoaded===this.level)){if(this.waitForCdnTuneIn(g))break;this.state=Nt;break}break;case di:var y,b=self.performance.now(),D=this.retryDate;(!D||b>=D||(y=this.media)!==null&&y!==void 0&&y.seeking)&&(this.log("retryDate reached, switch back to IDLE state"),this.resetStartWhenNotLoaded(this.level),this.state=Nt)}this.onTickEnd()},c.onTickEnd=function(){v.prototype.onTickEnd.call(this),this.checkBuffer(),this.checkFragmentChanged()},c.doTickIdle=function(){var i=this.hls,u=this.levelLastLoaded,p=this.levels,g=this.media,y=i.config,b=i.nextLoadLevel;if(u!==null&&(g||!this.startFragRequested&&y.startFragPrefetch)&&(!this.altAudio||!this.audioOnly)&&p&&p[b]){var D=p[b],F=this.getMainFwdBufferInfo();if(F!==null){var G=this.getLevelDetails();if(G&&this._streamEnded(F,G)){var ee={};return this.altAudio&&(ee.type="video"),this.hls.trigger(E.Events.BUFFER_EOS,ee),void(this.state=jn)}this.level=i.nextLoadLevel=b;var J=D.details;if(!J||this.state===_n||J.live&&this.levelLastLoaded!==b)return this.level=b,void(this.state=_n);if(!(F.len>=this.getMaxBufferLength(D.maxBitrate))){this.backtrackFragment&&this.backtrackFragment.start>F.end&&(this.backtrackFragment=null);var le=this.backtrackFragment?this.backtrackFragment.start:F.end,Se=this.getNextFragment(le,J);if(this.couldBacktrack&&!this.fragPrevious&&Se&&Se.sn!=="initSegment"&&this.fragmentTracker.getState(Se)!==et.OK){var we,be=((we=this.backtrackFragment)!=null?we:Se).sn-J.startSN,Pe=J.fragments[be-1];Pe&&Se.cc===Pe.cc&&(Se=Pe,this.fragmentTracker.removeFragment(Pe))}else this.backtrackFragment&&F.len&&(this.backtrackFragment=null);if(Se&&this.fragmentTracker.getState(Se)===et.OK&&this.nextLoadPosition>le){var tt=this.audioOnly&&!this.altAudio?ie.ElementaryStreamTypes.AUDIO:ie.ElementaryStreamTypes.VIDEO,rt=(tt===ie.ElementaryStreamTypes.VIDEO?this.videoBuffer:this.mediaBuffer)||this.media;rt&&this.afterBufferFlushed(rt,tt,ue.PlaylistLevelType.MAIN),Se=this.getNextFragment(this.nextLoadPosition,J)}Se&&(!Se.initSegment||Se.initSegment.data||this.bitrateTest||(Se=Se.initSegment),this.loadFragment(Se,J,le))}}}},c.loadFragment=function(i,u,p){var g,y=this.fragmentTracker.getState(i);this.fragCurrent=i,y===et.NOT_LOADED?i.sn==="initSegment"?this._loadInitSegment(i,u):this.bitrateTest?(this.log("Fragment "+i.sn+" of level "+i.level+" is being downloaded to test bitrate and will not be buffered"),this._loadBitrateTestFrag(i,u)):(this.startFragRequested=!0,v.prototype.loadFragment.call(this,i,u,p)):y===et.APPENDING?this.reduceMaxBufferLength(i.duration)&&this.fragmentTracker.removeFragment(i):((g=this.media)===null||g===void 0?void 0:g.buffered.length)===0&&this.fragmentTracker.removeAllFragments()},c.getAppendedFrag=function(i){var u=this.fragmentTracker.getAppendedFrag(i,ue.PlaylistLevelType.MAIN);return u&&"fragment"in u?u.fragment:u},c.getBufferedFrag=function(i){return this.fragmentTracker.getBufferedFrag(i,ue.PlaylistLevelType.MAIN)},c.followingBufferedFrag=function(i){return i?this.getBufferedFrag(i.end+.5):null},c.immediateLevelSwitch=function(){this.abortCurrentFrag(),this.flushMainBuffer(0,Number.POSITIVE_INFINITY)},c.nextLevelSwitch=function(){var i=this.levels,u=this.media;if(u!=null&&u.readyState){var p,g=this.getAppendedFrag(u.currentTime);if(g&&g.start>1&&this.flushMainBuffer(0,g.start-1),!u.paused&&i){var y=i[this.hls.nextLoadLevel],b=this.fragLastKbps;p=b&&this.fragCurrent?this.fragCurrent.duration*y.maxBitrate/(1e3*b)+1:0}else p=0;var D=this.getBufferedFrag(u.currentTime+p);if(D){var F=this.followingBufferedFrag(D);if(F){this.abortCurrentFrag();var G=F.maxStartPTS?F.maxStartPTS:F.start,ee=F.duration,J=Math.max(D.end,G+Math.min(Math.max(ee-this.config.maxFragLookUpTolerance,.5*ee),.75*ee));this.flushMainBuffer(J,Number.POSITIVE_INFINITY)}}}},c.abortCurrentFrag=function(){var i=this.fragCurrent;switch(this.fragCurrent=null,this.backtrackFragment=null,i&&i.abortRequests(),this.state){case Cs:case fi:case di:case nn:case hi:this.state=Nt}this.nextLoadPosition=this.getLoadPosition()},c.flushMainBuffer=function(i,u){v.prototype.flushMainBuffer.call(this,i,u,this.altAudio?"video":null)},c.onMediaAttached=function(i,u){v.prototype.onMediaAttached.call(this,i,u);var p=u.media;this.onvplaying=this.onMediaPlaying.bind(this),this.onvseeked=this.onMediaSeeked.bind(this),p.addEventListener("playing",this.onvplaying),p.addEventListener("seeked",this.onvseeked),this.gapController=new Fa(this.config,p,this.fragmentTracker,this.hls)},c.onMediaDetaching=function(){var i=this.media;i&&this.onvplaying&&this.onvseeked&&(i.removeEventListener("playing",this.onvplaying),i.removeEventListener("seeked",this.onvseeked),this.onvplaying=this.onvseeked=null,this.videoBuffer=null),this.fragPlaying=null,this.gapController&&(this.gapController.destroy(),this.gapController=null),v.prototype.onMediaDetaching.call(this)},c.onMediaPlaying=function(){this.tick()},c.onMediaSeeked=function(){var i=this.media,u=i?i.currentTime:null;(0,O.isFiniteNumber)(u)&&this.log("Media seeked to "+u.toFixed(3)),this.tick()},c.onManifestLoading=function(){this.log("Trigger BUFFER_RESET"),this.hls.trigger(E.Events.BUFFER_RESET,void 0),this.fragmentTracker.removeAllFragments(),this.couldBacktrack=!1,this.startPosition=this.lastCurrentTime=0,this.fragPlaying=null,this.backtrackFragment=null},c.onManifestParsed=function(i,u){var p,g,y,b=!1,D=!1;u.levels.forEach(function(F){(p=F.audioCodec)&&(p.indexOf("mp4a.40.2")!==-1&&(b=!0),p.indexOf("mp4a.40.5")!==-1&&(D=!0))}),this.audioCodecSwitch=b&&D&&typeof((y=Ps())==null||(g=y.prototype)===null||g===void 0?void 0:g.changeType)!="function",this.audioCodecSwitch&&this.log("Both AAC/HE-AAC audio found in levels; declaring level codec as HE-AAC"),this.levels=u.levels,this.startFragRequested=!1},c.onLevelLoading=function(i,u){var p=this.levels;if(p&&this.state===Nt){var g=p[u.level];(!g.details||g.details.live&&this.levelLastLoaded!==u.level||this.waitForCdnTuneIn(g.details))&&(this.state=_n)}},c.onLevelLoaded=function(i,u){var p,g=this.levels,y=u.level,b=u.details,D=b.totalduration;if(g){this.log("Level "+y+" loaded ["+b.startSN+","+b.endSN+"], cc ["+b.startCC+", "+b.endCC+"] duration:"+D);var F=this.fragCurrent;!F||this.state!==fi&&this.state!==di||F.level!==u.level&&F.loader&&(this.state=Nt,this.backtrackFragment=null,F.abortRequests());var G=g[y],ee=0;if(b.live||(p=G.details)!==null&&p!==void 0&&p.live){if(b.fragments[0]||(b.deltaUpdateFailed=!0),b.deltaUpdateFailed)return;ee=this.alignPlaylists(b,G.details)}if(G.details=b,this.levelLastLoaded=y,this.hls.trigger(E.Events.LEVEL_UPDATED,{details:b,level:y}),this.state===_n){if(this.waitForCdnTuneIn(b))return;this.state=Nt}this.startFragRequested?b.live&&this.synchronizeToLiveEdge(b):this.setStartPosition(b,ee),this.tick()}else this.warn("Levels were reset while loading level "+y)},c._handleFragmentLoadProgress=function(i){var u,p=i.frag,g=i.part,y=i.payload,b=this.levels;if(b){var D=b[p.level],F=D.details;if(F){var G=D.videoCodec,ee=F.PTSKnown||!F.live,J=(u=p.initSegment)===null||u===void 0?void 0:u.data,le=this._getAudioCodec(D),Se=this.transmuxer=this.transmuxer||new xs(this.hls,ue.PlaylistLevelType.MAIN,this._handleTransmuxComplete.bind(this),this._handleTransmuxerFlush.bind(this)),we=g?g.index:-1,be=we!==-1,Pe=new Ds(p.level,p.sn,p.stats.chunkCount,y.byteLength,we,be),tt=this.initPTS[p.cc];Se.push(y,J,le,G,p,g,F.totalduration,ee,Pe,tt)}else this.warn("Dropping fragment "+p.sn+" of level "+p.level+" after level details were reset")}else this.warn("Levels were reset while fragment load was in progress. Fragment "+p.sn+" of level "+p.level+" will not be buffered")},c.onAudioTrackSwitching=function(i,u){var p=this.altAudio,g=!!u.url,y=u.id;if(!g){if(this.mediaBuffer!==this.media){this.log("Switching on main audio, use media.buffered to schedule main fragment loading"),this.mediaBuffer=this.media;var b=this.fragCurrent;b&&(this.log("Switching to main audio track, cancel main fragment load"),b.abortRequests()),this.resetTransmuxer(),this.resetLoadingState()}else this.audioOnly&&this.resetTransmuxer();var D=this.hls;p&&D.trigger(E.Events.BUFFER_FLUSHING,{startOffset:0,endOffset:Number.POSITIVE_INFINITY,type:"audio"}),D.trigger(E.Events.AUDIO_TRACK_SWITCHED,{id:y})}},c.onAudioTrackSwitched=function(i,u){var p=u.id,g=!!this.hls.audioTracks[p].url;if(g){var y=this.videoBuffer;y&&this.mediaBuffer!==y&&(this.log("Switching on alternate audio, use video.buffered to schedule main fragment loading"),this.mediaBuffer=y)}this.altAudio=g,this.tick()},c.onBufferCreated=function(i,u){var p,g,y=u.tracks,b=!1;for(var D in y){var F=y[D];if(F.id==="main"){if(g=D,p=F,D==="video"){var G=y[D];G&&(this.videoBuffer=G.buffer)}}else b=!0}b&&p?(this.log("Alternate track found, use "+g+".buffered to schedule main fragment loading"),this.mediaBuffer=p.buffer):this.mediaBuffer=this.media},c.onFragBuffered=function(i,u){var p=u.frag,g=u.part;if(!p||p.type===ue.PlaylistLevelType.MAIN){if(this.fragContextChanged(p))return this.warn("Fragment "+p.sn+(g?" p: "+g.index:"")+" of level "+p.level+" finished buffering, but was aborted. state: "+this.state),void(this.state===hi&&(this.state=Nt));var y=g?g.stats:p.stats;this.fragLastKbps=Math.round(8*y.total/(y.buffering.end-y.loading.first)),p.sn!=="initSegment"&&(this.fragPrevious=p),this.fragBufferedComplete(p,g)}},c.onError=function(i,u){if(u.type!==A.ErrorTypes.KEY_SYSTEM_ERROR)switch(u.details){case A.ErrorDetails.FRAG_LOAD_ERROR:case A.ErrorDetails.FRAG_LOAD_TIMEOUT:case A.ErrorDetails.FRAG_PARSING_ERROR:case A.ErrorDetails.KEY_LOAD_ERROR:case A.ErrorDetails.KEY_LOAD_TIMEOUT:this.onFragmentOrKeyLoadError(ue.PlaylistLevelType.MAIN,u);break;case A.ErrorDetails.LEVEL_LOAD_ERROR:case A.ErrorDetails.LEVEL_LOAD_TIMEOUT:this.state!==En&&(u.fatal?(this.warn(""+u.details),this.state=En):u.levelRetry||this.state!==_n||(this.state=Nt));break;case A.ErrorDetails.BUFFER_FULL_ERROR:if(u.parent==="main"&&(this.state===nn||this.state===hi)){var p=!0,g=this.getFwdBufferInfo(this.media,ue.PlaylistLevelType.MAIN);g&&g.len>.5&&(p=!this.reduceMaxBufferLength(g.len)),p&&(this.warn("buffer full error also media.currentTime is not buffered, flush main"),this.immediateLevelSwitch()),this.resetLoadingState()}}else this.onFragmentOrKeyLoadError(ue.PlaylistLevelType.MAIN,u)},c.checkBuffer=function(){var i=this.media,u=this.gapController;if(i&&u&&i.readyState){if(this.loadedmetadata||!or.getBuffered(i).length){var p=this.state!==Nt?this.fragCurrent:null;u.poll(this.lastCurrentTime,p)}this.lastCurrentTime=i.currentTime}},c.onFragLoadEmergencyAborted=function(){this.state=Nt,this.loadedmetadata||(this.startFragRequested=!1,this.nextLoadPosition=this.startPosition),this.tickImmediate()},c.onBufferFlushed=function(i,u){var p=u.type;if(p!==ie.ElementaryStreamTypes.AUDIO||this.audioOnly&&!this.altAudio){var g=(p===ie.ElementaryStreamTypes.VIDEO?this.videoBuffer:this.mediaBuffer)||this.media;this.afterBufferFlushed(g,p,ue.PlaylistLevelType.MAIN)}},c.onLevelsUpdated=function(i,u){this.levels=u.levels},c.swapAudioCodec=function(){this.audioCodecSwap=!this.audioCodecSwap},c.seekToStartPos=function(){var i=this.media;if(i){var u=i.currentTime,p=this.startPosition;if(p>=0&&u<p){if(i.seeking)return void this.log("could not seek to "+p+", already seeking at "+u);var g=or.getBuffered(i),y=(g.length?g.start(0):0)-p;y>0&&(y<this.config.maxBufferHole||y<this.config.maxFragLookUpTolerance)&&(this.log("adjusting start position by "+y+" to match buffer start"),p+=y,this.startPosition=p),this.log("seek to target start position "+p+" from current time "+u),i.currentTime=p}}},c._getAudioCodec=function(i){var u=this.config.defaultAudioCodec||i.audioCodec;return this.audioCodecSwap&&u&&(this.log("Swapping audio codec"),u=u.indexOf("mp4a.40.5")!==-1?"mp4a.40.2":"mp4a.40.5"),u},c._loadBitrateTestFrag=function(i,u){var p=this;i.bitrateTest=!0,this._doFragLoad(i,u).then(function(g){var y=p.hls;if(g&&!p.fragContextChanged(i)){p.fragLoadError=0,p.state=Nt,p.startFragRequested=!1,p.bitrateTest=!1;var b=i.stats;b.parsing.start=b.parsing.end=b.buffering.start=b.buffering.end=self.performance.now(),y.trigger(E.Events.FRAG_LOADED,g),i.bitrateTest=!1}})},c._handleTransmuxComplete=function(i){var u,p="main",g=this.hls,y=i.remuxResult,b=i.chunkMeta,D=this.getCurrentContext(b);if(!D)return this.warn("The loading context changed while buffering fragment "+b.sn+" of level "+b.level+". This chunk will not be buffered."),void this.resetStartWhenNotLoaded(b.level);var F=D.frag,G=D.part,ee=D.level,J=y.video,le=y.text,Se=y.id3,we=y.initSegment,be=ee.details,Pe=this.altAudio?void 0:y.audio;if(!this.fragContextChanged(F)){if(this.state=nn,we){we.tracks&&(this._bufferInitSegment(ee,we.tracks,F,b),g.trigger(E.Events.FRAG_PARSING_INIT_SEGMENT,{frag:F,id:p,tracks:we.tracks}));var tt=we.initPTS,rt=we.timescale;(0,O.isFiniteNumber)(tt)&&(this.initPTS[F.cc]=tt,g.trigger(E.Events.INIT_PTS_FOUND,{frag:F,id:p,initPTS:tt,timescale:rt}))}if(J&&y.independent!==!1){if(be){var Ge=J.startPTS,Je=J.endPTS,Qe=J.startDTS,Dt=J.endDTS;if(G)G.elementaryStreams[J.type]={startPTS:Ge,endPTS:Je,startDTS:Qe,endDTS:Dt};else if(J.firstKeyFrame&&J.independent&&b.id===1&&(this.couldBacktrack=!0),J.dropped&&J.independent){var Vt=this.getMainFwdBufferInfo();if((Vt?Vt.end:this.getLoadPosition())+this.config.maxBufferHole<(J.firstKeyFramePTS?J.firstKeyFramePTS:Ge)-this.config.maxBufferHole)return void this.backtrack(F);F.setElementaryStreamInfo(J.type,F.start,Je,F.start,Dt,!0)}F.setElementaryStreamInfo(J.type,Ge,Je,Qe,Dt),this.backtrackFragment&&(this.backtrackFragment=F),this.bufferFragmentData(J,F,G,b)}}else if(y.independent===!1)return void this.backtrack(F);if(Pe){var St=Pe.startPTS,wt=Pe.endPTS,Mt=Pe.startDTS,pr=Pe.endDTS;G&&(G.elementaryStreams[ie.ElementaryStreamTypes.AUDIO]={startPTS:St,endPTS:wt,startDTS:Mt,endDTS:pr}),F.setElementaryStreamInfo(ie.ElementaryStreamTypes.AUDIO,St,wt,Mt,pr),this.bufferFragmentData(Pe,F,G,b)}if(be&&Se!=null&&(u=Se.samples)!==null&&u!==void 0&&u.length){var gr={id:p,frag:F,details:be,samples:Se.samples};g.trigger(E.Events.FRAG_PARSING_METADATA,gr)}if(be&&le){var lr={id:p,frag:F,details:be,samples:le.samples};g.trigger(E.Events.FRAG_PARSING_USERDATA,lr)}}},c._bufferInitSegment=function(i,u,p,g){var y=this;if(this.state===nn){this.audioOnly=!!u.audio&&!u.video,this.altAudio&&!this.audioOnly&&delete u.audio;var b=u.audio,D=u.video,F=u.audiovideo;if(b){var G=i.audioCodec,ee=navigator.userAgent.toLowerCase();this.audioCodecSwitch&&(G&&(G=G.indexOf("mp4a.40.5")!==-1?"mp4a.40.2":"mp4a.40.5"),b.metadata.channelCount!==1&&ee.indexOf("firefox")===-1&&(G="mp4a.40.5")),ee.indexOf("android")!==-1&&b.container!=="audio/mpeg"&&(G="mp4a.40.2",this.log("Android: force audio codec to "+G)),i.audioCodec&&i.audioCodec!==G&&this.log('Swapping manifest audio codec "'+i.audioCodec+'" for "'+G+'"'),b.levelCodec=G,b.id="main",this.log("Init audio buffer, container:"+b.container+", codecs[selected/level/parsed]=["+(G||"")+"/"+(i.audioCodec||"")+"/"+b.codec+"]")}D&&(D.levelCodec=i.videoCodec,D.id="main",this.log("Init video buffer, container:"+D.container+", codecs[level/parsed]=["+(i.videoCodec||"")+"/"+D.codec+"]")),F&&this.log("Init audiovideo buffer, container:"+F.container+", codecs[level/parsed]=["+(i.attrs.CODECS||"")+"/"+F.codec+"]"),this.hls.trigger(E.Events.BUFFER_CODECS,u),Object.keys(u).forEach(function(J){var le=u[J].initSegment;le!=null&&le.byteLength&&y.hls.trigger(E.Events.BUFFER_APPENDING,{type:J,data:le,frag:p,part:null,chunkMeta:g,parent:p.type})}),this.tick()}},c.getMainFwdBufferInfo=function(){return this.getFwdBufferInfo(this.mediaBuffer?this.mediaBuffer:this.media,ue.PlaylistLevelType.MAIN)},c.backtrack=function(i){this.couldBacktrack=!0,this.backtrackFragment=i,this.resetTransmuxer(),this.flushBufferGap(i),this.fragmentTracker.removeFragment(i),this.fragPrevious=null,this.nextLoadPosition=i.start,this.state=Nt},c.checkFragmentChanged=function(){var i=this.media,u=null;if(i&&i.readyState>1&&i.seeking===!1){var p=i.currentTime;if(or.isBuffered(i,p)?u=this.getAppendedFrag(p):or.isBuffered(i,p+.1)&&(u=this.getAppendedFrag(p+.1)),u){this.backtrackFragment=null;var g=this.fragPlaying,y=u.level;g&&u.sn===g.sn&&g.level===y&&u.urlId===g.urlId||(this.fragPlaying=u,this.hls.trigger(E.Events.FRAG_CHANGED,{frag:u}),g&&g.level===y||this.hls.trigger(E.Events.LEVEL_SWITCHED,{level:y}))}}},s=n,(o=[{key:"nextLevel",get:function(){var i=this.nextBufferedFrag;return i?i.level:-1}},{key:"currentFrag",get:function(){var i=this.media;return i?this.fragPlaying||this.getAppendedFrag(i.currentTime):null}},{key:"currentProgramDateTime",get:function(){var i=this.media;if(i){var u=i.currentTime,p=this.currentFrag;if(p&&(0,O.isFiniteNumber)(u)&&(0,O.isFiniteNumber)(p.programDateTime)){var g=p.programDateTime+1e3*(u-p.start);return new Date(g)}}return null}},{key:"currentLevel",get:function(){var i=this.currentFrag;return i?i.level:-1}},{key:"nextBufferedFrag",get:function(){var i=this.currentFrag;return i?this.followingBufferedFrag(i):null}},{key:"forceStartLoad",get:function(){return this._forceStartLoad}}])&&Ma(s.prototype,o),Object.defineProperty(s,"prototype",{writable:!1}),n}(Ji);const is=function(){function v(t,n,s){n===void 0&&(n=0),s===void 0&&(s=0),this.halfLife=void 0,this.alpha_=void 0,this.estimate_=void 0,this.totalWeight_=void 0,this.halfLife=t,this.alpha_=t?Math.exp(Math.log(.5)/t):0,this.estimate_=n,this.totalWeight_=s}var h=v.prototype;return h.sample=function(t,n){var s=Math.pow(this.alpha_,t);this.estimate_=n*(1-s)+s*this.estimate_,this.totalWeight_+=t},h.getTotalWeight=function(){return this.totalWeight_},h.getEstimate=function(){if(this.alpha_){var t=1-Math.pow(this.alpha_,this.totalWeight_);if(t)return this.estimate_/t}return this.estimate_},v}(),Jo=function(){function v(t,n,s){this.defaultEstimate_=void 0,this.minWeight_=void 0,this.minDelayMs_=void 0,this.slow_=void 0,this.fast_=void 0,this.defaultEstimate_=s,this.minWeight_=.001,this.minDelayMs_=50,this.slow_=new is(t),this.fast_=new is(n)}var h=v.prototype;return h.update=function(t,n){var s=this.slow_,o=this.fast_;this.slow_.halfLife!==t&&(this.slow_=new is(t,s.getEstimate(),s.getTotalWeight())),this.fast_.halfLife!==n&&(this.fast_=new is(n,o.getEstimate(),o.getTotalWeight()))},h.sample=function(t,n){var s=(t=Math.max(t,this.minDelayMs_))/1e3,o=8*n/s;this.fast_.sample(s,o),this.slow_.sample(s,o)},h.canEstimate=function(){var t=this.fast_;return t&&t.getTotalWeight()>=this.minWeight_},h.getEstimate=function(){return this.canEstimate()?Math.min(this.fast_.getEstimate(),this.slow_.getEstimate()):this.defaultEstimate_},h.destroy=function(){},v}();function xa(v,h){for(var t=0;t<h.length;t++){var n=h[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(v,typeof(s=function(o,c){if(typeof o!="object"||o===null)return o;var i=o[Symbol.toPrimitive];if(i!==void 0){var u=i.call(o,c);if(typeof u!="object")return u;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(o)}(n.key,"string"))=="symbol"?s:String(s),n)}var s}const $o=function(){function v(s){this.hls=void 0,this.lastLoadedFragLevel=0,this._nextAutoLevel=-1,this.timer=void 0,this.onCheck=this._abandonRulesCheck.bind(this),this.fragCurrent=null,this.partCurrent=null,this.bitrateTestDelay=0,this.bwEstimator=void 0,this.hls=s;var o=s.config;this.bwEstimator=new Jo(o.abrEwmaSlowVoD,o.abrEwmaFastVoD,o.abrEwmaDefaultEstimate),this.registerListeners()}var h,t,n=v.prototype;return n.registerListeners=function(){var s=this.hls;s.on(E.Events.FRAG_LOADING,this.onFragLoading,this),s.on(E.Events.FRAG_LOADED,this.onFragLoaded,this),s.on(E.Events.FRAG_BUFFERED,this.onFragBuffered,this),s.on(E.Events.LEVEL_LOADED,this.onLevelLoaded,this),s.on(E.Events.ERROR,this.onError,this)},n.unregisterListeners=function(){var s=this.hls;s.off(E.Events.FRAG_LOADING,this.onFragLoading,this),s.off(E.Events.FRAG_LOADED,this.onFragLoaded,this),s.off(E.Events.FRAG_BUFFERED,this.onFragBuffered,this),s.off(E.Events.LEVEL_LOADED,this.onLevelLoaded,this),s.off(E.Events.ERROR,this.onError,this)},n.destroy=function(){this.unregisterListeners(),this.clearTimer(),this.hls=this.onCheck=null,this.fragCurrent=this.partCurrent=null},n.onFragLoading=function(s,o){var c,i=o.frag;i.type===ue.PlaylistLevelType.MAIN&&(this.timer||(this.fragCurrent=i,this.partCurrent=(c=o.part)!=null?c:null,this.timer=self.setInterval(this.onCheck,100)))},n.onLevelLoaded=function(s,o){var c=this.hls.config;o.details.live?this.bwEstimator.update(c.abrEwmaSlowLive,c.abrEwmaFastLive):this.bwEstimator.update(c.abrEwmaSlowVoD,c.abrEwmaFastVoD)},n._abandonRulesCheck=function(){var s=this.fragCurrent,o=this.partCurrent,c=this.hls,i=c.autoLevelEnabled,u=c.media;if(s&&u){var p=o?o.stats:s.stats,g=o?o.duration:s.duration;if(p.aborted||p.loaded&&p.loaded===p.total||s.level===0)return this.clearTimer(),void(this._nextAutoLevel=-1);if(i&&!u.paused&&u.playbackRate&&u.readyState){var y=c.mainForwardBufferInfo;if(y!==null){var b=performance.now()-p.loading.start,D=Math.abs(u.playbackRate);if(!(b<=500*g/D)){var F=p.loaded&&p.loading.first,G=this.bwEstimator.getEstimate(),ee=c.levels,J=c.minAutoLevel,le=ee[s.level],Se=p.total||Math.max(p.loaded,Math.round(g*le.maxBitrate/8)),we=F?1e3*p.loaded/b:0,be=we?(Se-p.loaded)/we:8*Se/G,Pe=y.len/D;if(!(be<=Pe)){var tt,rt=Number.POSITIVE_INFINITY;for(tt=s.level-1;tt>J;tt--){var Ge=ee[tt].maxBitrate;if((rt=we?g*Ge/(6.4*we):g*Ge/G)<Pe)break}rt>=be||(w.logger.warn("Fragment "+s.sn+(o?" part "+o.index:"")+" of level "+s.level+" is loading too slowly and will cause an underbuffer; aborting and switching to level "+tt+`
      Current BW estimate: `+((0,O.isFiniteNumber)(G)?(G/1024).toFixed(3):"Unknown")+` Kb/s
      Estimated load time for current fragment: `+be.toFixed(3)+` s
      Estimated load time for the next fragment: `+rt.toFixed(3)+` s
      Time to underbuffer: `+Pe.toFixed(3)+" s"),c.nextLoadLevel=tt,F&&this.bwEstimator.sample(b,p.loaded),this.clearTimer(),(s.loader||s.keyLoader)&&(this.fragCurrent=this.partCurrent=null,s.abortRequests()),c.trigger(E.Events.FRAG_LOAD_EMERGENCY_ABORTED,{frag:s,part:o,stats:p}))}}}}}},n.onFragLoaded=function(s,o){var c=o.frag,i=o.part;if(c.type===ue.PlaylistLevelType.MAIN&&(0,O.isFiniteNumber)(c.sn)){var u=i?i.stats:c.stats,p=i?i.duration:c.duration;if(this.clearTimer(),this.lastLoadedFragLevel=c.level,this._nextAutoLevel=-1,this.hls.config.abrMaxWithRealBitrate){var g=this.hls.levels[c.level],y=(g.loaded?g.loaded.bytes:0)+u.loaded,b=(g.loaded?g.loaded.duration:0)+p;g.loaded={bytes:y,duration:b},g.realBitrate=Math.round(8*y/b)}if(c.bitrateTest){var D={stats:u,frag:c,part:i,id:c.type};this.onFragBuffered(E.Events.FRAG_BUFFERED,D)}}},n.onFragBuffered=function(s,o){var c=o.frag,i=o.part,u=i?i.stats:c.stats;if(!u.aborted&&c.type===ue.PlaylistLevelType.MAIN&&c.sn!=="initSegment"){var p=u.parsing.end-u.loading.start;this.bwEstimator.sample(p,u.loaded),u.bwEstimate=this.bwEstimator.getEstimate(),c.bitrateTest?this.bitrateTestDelay=p/1e3:this.bitrateTestDelay=0}},n.onError=function(s,o){var c;if(((c=o.frag)===null||c===void 0?void 0:c.type)===ue.PlaylistLevelType.MAIN){if(o.type===A.ErrorTypes.KEY_SYSTEM_ERROR)return void this.clearTimer();switch(o.details){case A.ErrorDetails.FRAG_LOAD_ERROR:case A.ErrorDetails.FRAG_LOAD_TIMEOUT:case A.ErrorDetails.KEY_LOAD_ERROR:case A.ErrorDetails.KEY_LOAD_TIMEOUT:this.clearTimer()}}},n.clearTimer=function(){self.clearInterval(this.timer),this.timer=void 0},n.getNextABRAutoLevel=function(){var s=this.fragCurrent,o=this.partCurrent,c=this.hls,i=c.maxAutoLevel,u=c.config,p=c.minAutoLevel,g=c.media,y=o?o.duration:s?s.duration:0,b=g&&g.playbackRate!==0?Math.abs(g.playbackRate):1,D=this.bwEstimator?this.bwEstimator.getEstimate():u.abrEwmaDefaultEstimate,F=c.mainForwardBufferInfo,G=(F?F.len:0)/b,ee=this.findBestLevel(D,p,i,G,u.abrBandWidthFactor,u.abrBandWidthUpFactor);if(ee>=0)return ee;w.logger.trace((G?"rebuffering expected":"buffer is empty")+", finding optimal quality level");var J=y?Math.min(y,u.maxStarvationDelay):u.maxStarvationDelay,le=u.abrBandWidthFactor,Se=u.abrBandWidthUpFactor;if(!G){var we=this.bitrateTestDelay;we&&(J=(y?Math.min(y,u.maxLoadingDelay):u.maxLoadingDelay)-we,w.logger.trace("bitrate test took "+Math.round(1e3*we)+"ms, set first fragment max fetchDuration to "+Math.round(1e3*J)+" ms"),le=Se=1)}return ee=this.findBestLevel(D,p,i,G+J,le,Se),Math.max(ee,0)},n.findBestLevel=function(s,o,c,i,u,p){for(var g,y=this.fragCurrent,b=this.partCurrent,D=this.lastLoadedFragLevel,F=this.hls.levels,G=F[D],ee=!(G==null||(g=G.details)===null||g===void 0||!g.live),J=G==null?void 0:G.codecSet,le=b?b.duration:y?y.duration:0,Se=c;Se>=o;Se--){var we=F[Se];if(we&&(!J||we.codecSet===J)){var be,Pe=we.details,tt=(b?Pe==null?void 0:Pe.partTarget:Pe==null?void 0:Pe.averagetargetduration)||le;be=Se<=D?u*s:p*s;var rt=F[Se].maxBitrate,Ge=rt*tt/be;if(w.logger.trace("level/adjustedbw/bitrate/avgDuration/maxFetchDuration/fetchDuration: "+Se+"/"+Math.round(be)+"/"+rt+"/"+tt+"/"+i+"/"+Ge),be>rt&&(Ge===0||!(0,O.isFiniteNumber)(Ge)||ee&&!this.bitrateTestDelay||Ge<i))return Se}}return-1},h=v,(t=[{key:"nextAutoLevel",get:function(){var s=this._nextAutoLevel,o=this.bwEstimator;if(s!==-1&&!o.canEstimate())return s;var c=this.getNextABRAutoLevel();return s!==-1&&this.hls.levels[c].loadError?s:(s!==-1&&(c=Math.min(s,c)),c)},set:function(s){this._nextAutoLevel=s}}])&&xa(h.prototype,t),Object.defineProperty(h,"prototype",{writable:!1}),v}();var Na=function(){function v(){this.chunks=[],this.dataLength=0}var h=v.prototype;return h.push=function(t){this.chunks.push(t),this.dataLength+=t.length},h.flush=function(){var t,n=this.chunks,s=this.dataLength;return n.length?(t=n.length===1?n[0]:function(o,c){for(var i=new Uint8Array(c),u=0,p=0;p<o.length;p++){var g=o[p];i.set(g,u),u+=g.length}return i}(n,s),this.reset(),t):new Uint8Array(0)},h.reset=function(){this.chunks.length=0,this.dataLength=0},v}();function ss(){return ss=Object.assign?Object.assign.bind():function(v){for(var h=1;h<arguments.length;h++){var t=arguments[h];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(v[n]=t[n])}return v},ss.apply(this,arguments)}function Ns(v,h){return Ns=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,n){return t.__proto__=n,t},Ns(v,h)}var Us=function(v){var h,t;function n(o,c,i){var u;return(u=v.call(this,o,c,i,"[audio-stream-controller]")||this).videoBuffer=null,u.videoTrackCC=-1,u.waitingVideoCC=-1,u.audioSwitch=!1,u.trackId=-1,u.waitingData=null,u.mainDetails=null,u.bufferFlushed=!1,u.cachedTrackLoadedData=null,u._registerListeners(),u}t=v,(h=n).prototype=Object.create(t.prototype),h.prototype.constructor=h,Ns(h,t);var s=n.prototype;return s.onHandlerDestroying=function(){this._unregisterListeners(),this.mainDetails=null},s._registerListeners=function(){var o=this.hls;o.on(E.Events.MEDIA_ATTACHED,this.onMediaAttached,this),o.on(E.Events.MEDIA_DETACHING,this.onMediaDetaching,this),o.on(E.Events.MANIFEST_LOADING,this.onManifestLoading,this),o.on(E.Events.LEVEL_LOADED,this.onLevelLoaded,this),o.on(E.Events.AUDIO_TRACKS_UPDATED,this.onAudioTracksUpdated,this),o.on(E.Events.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),o.on(E.Events.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),o.on(E.Events.ERROR,this.onError,this),o.on(E.Events.BUFFER_RESET,this.onBufferReset,this),o.on(E.Events.BUFFER_CREATED,this.onBufferCreated,this),o.on(E.Events.BUFFER_FLUSHED,this.onBufferFlushed,this),o.on(E.Events.INIT_PTS_FOUND,this.onInitPtsFound,this),o.on(E.Events.FRAG_BUFFERED,this.onFragBuffered,this)},s._unregisterListeners=function(){var o=this.hls;o.off(E.Events.MEDIA_ATTACHED,this.onMediaAttached,this),o.off(E.Events.MEDIA_DETACHING,this.onMediaDetaching,this),o.off(E.Events.MANIFEST_LOADING,this.onManifestLoading,this),o.off(E.Events.LEVEL_LOADED,this.onLevelLoaded,this),o.off(E.Events.AUDIO_TRACKS_UPDATED,this.onAudioTracksUpdated,this),o.off(E.Events.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),o.off(E.Events.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),o.off(E.Events.ERROR,this.onError,this),o.off(E.Events.BUFFER_RESET,this.onBufferReset,this),o.off(E.Events.BUFFER_CREATED,this.onBufferCreated,this),o.off(E.Events.BUFFER_FLUSHED,this.onBufferFlushed,this),o.off(E.Events.INIT_PTS_FOUND,this.onInitPtsFound,this),o.off(E.Events.FRAG_BUFFERED,this.onFragBuffered,this)},s.onInitPtsFound=function(o,c){var i=c.frag,u=c.id,p=c.initPTS;if(u==="main"){var g=i.cc;this.initPTS[i.cc]=p,this.log("InitPTS for cc: "+g+" found from main: "+p),this.videoTrackCC=g,this.state===pi&&this.tick()}},s.startLoad=function(o){if(!this.levels)return this.startPosition=o,void(this.state=zr);var c=this.lastCurrentTime;this.stopLoad(),this.setInterval(100),this.fragLoadError=0,c>0&&o===-1?(this.log("Override startPosition with lastCurrentTime @"+c.toFixed(3)),o=c,this.state=Nt):(this.loadedmetadata=!1,this.state=Pi),this.nextLoadPosition=this.startPosition=this.lastCurrentTime=o,this.tick()},s.doTick=function(){switch(this.state){case Nt:this.doTickIdle();break;case Pi:var o,c=this.levels,i=this.trackId,u=c==null||(o=c[i])===null||o===void 0?void 0:o.details;if(u){if(this.waitForCdnTuneIn(u))break;this.state=pi}break;case di:var p,g=performance.now(),y=this.retryDate;(!y||g>=y||(p=this.media)!==null&&p!==void 0&&p.seeking)&&(this.log("RetryDate reached, switch back to IDLE state"),this.resetStartWhenNotLoaded(this.trackId),this.state=Nt);break;case pi:var b=this.waitingData;if(b){var D=b.frag,F=b.part,G=b.cache,ee=b.complete;if(this.initPTS[D.cc]!==void 0){this.waitingData=null,this.waitingVideoCC=-1,this.state=fi;var J={frag:D,part:F,payload:G.flush(),networkDetails:null};this._handleFragmentLoadProgress(J),ee&&v.prototype._handleFragmentLoadComplete.call(this,J)}else if(this.videoTrackCC!==this.waitingVideoCC)this.log("Waiting fragment cc ("+D.cc+") cancelled because video is at cc "+this.videoTrackCC),this.clearWaitingFragment();else{var le=this.getLoadPosition(),Se=or.bufferInfo(this.mediaBuffer,le,this.config.maxBufferHole);ci(Se.end,this.config.maxFragLookUpTolerance,D)<0&&(this.log("Waiting fragment cc ("+D.cc+") @ "+D.start+" cancelled because another fragment at "+Se.end+" is needed"),this.clearWaitingFragment())}}else this.state=Nt}this.onTickEnd()},s.clearWaitingFragment=function(){var o=this.waitingData;o&&(this.fragmentTracker.removeFragment(o.frag),this.waitingData=null,this.waitingVideoCC=-1,this.state=Nt)},s.resetLoadingState=function(){this.clearWaitingFragment(),v.prototype.resetLoadingState.call(this)},s.onTickEnd=function(){var o=this.media;o&&o.readyState&&(this.lastCurrentTime=o.currentTime)},s.doTickIdle=function(){var o=this.hls,c=this.levels,i=this.media,u=this.trackId,p=o.config;if(c&&c[u]&&(i||!this.startFragRequested&&p.startFragPrefetch)){var g=c[u].details;if(!g||g.live&&this.levelLastLoaded!==u||this.waitForCdnTuneIn(g))this.state=Pi;else{var y=this.mediaBuffer?this.mediaBuffer:this.media;this.bufferFlushed&&y&&(this.bufferFlushed=!1,this.afterBufferFlushed(y,ie.ElementaryStreamTypes.AUDIO,ue.PlaylistLevelType.AUDIO));var b=this.getFwdBufferInfo(y,ue.PlaylistLevelType.AUDIO);if(b!==null){var D=this.audioSwitch;if(!D&&this._streamEnded(b,g))return o.trigger(E.Events.BUFFER_EOS,{type:"audio"}),void(this.state=jn);var F=this.getFwdBufferInfo(this.videoBuffer?this.videoBuffer:this.media,ue.PlaylistLevelType.MAIN);if(!(b.len>=this.getMaxBufferLength(F==null?void 0:F.len))||D){var G=g.fragments[0].start,ee=b.end;if(D&&i){var J=this.getLoadPosition();ee=J,g.PTSKnown&&J<G&&(b.end>G||b.nextStart)&&(this.log("Alt audio track ahead of main track, seek to start of alt audio track"),i.currentTime=G+.05)}if(!(F&&ee>F.end+g.targetduration)&&(F&&F.len||!b.len)){var le=this.getNextFragment(ee,g);le?this.loadFragment(le,g,ee):this.bufferFlushed=!0}}}}}},s.getMaxBufferLength=function(o){var c=v.prototype.getMaxBufferLength.call(this);return o?Math.max(c,o):c},s.onMediaDetaching=function(){this.videoBuffer=null,v.prototype.onMediaDetaching.call(this)},s.onAudioTracksUpdated=function(o,c){var i=c.audioTracks;this.resetTransmuxer(),this.levels=i.map(function(u){return new $(u)})},s.onAudioTrackSwitching=function(o,c){var i=!!c.url;this.trackId=c.id;var u=this.fragCurrent;u&&u.abortRequests(),this.fragCurrent=null,this.clearWaitingFragment(),i?this.setInterval(100):this.resetTransmuxer(),i?(this.audioSwitch=!0,this.state=Nt):this.state=zr,this.tick()},s.onManifestLoading=function(){this.mainDetails=null,this.fragmentTracker.removeAllFragments(),this.startPosition=this.lastCurrentTime=0,this.bufferFlushed=!1},s.onLevelLoaded=function(o,c){this.mainDetails=c.details,this.cachedTrackLoadedData!==null&&(this.hls.trigger(E.Events.AUDIO_TRACK_LOADED,this.cachedTrackLoadedData),this.cachedTrackLoadedData=null)},s.onAudioTrackLoaded=function(o,c){var i;if(this.mainDetails!=null){var u=this.levels,p=c.details,g=c.id;if(u){this.log("Track "+g+" loaded ["+p.startSN+","+p.endSN+"],duration:"+p.totalduration);var y=u[g],b=0;if(p.live||(i=y.details)!==null&&i!==void 0&&i.live){var D=this.mainDetails;if(p.fragments[0]||(p.deltaUpdateFailed=!0),p.deltaUpdateFailed||!D)return;!y.details&&p.hasProgramDateTime&&D.hasProgramDateTime?(Ia(p,D),b=p.fragments[0].start):b=this.alignPlaylists(p,y.details)}y.details=p,this.levelLastLoaded=g,this.startFragRequested||!this.mainDetails&&p.live||this.setStartPosition(y.details,b),this.state!==Pi||this.waitForCdnTuneIn(p)||(this.state=Nt),this.tick()}else this.warn("Audio tracks were reset while loading level "+g)}else this.cachedTrackLoadedData=c},s._handleFragmentLoadProgress=function(o){var c,i=o.frag,u=o.part,p=o.payload,g=this.config,y=this.trackId,b=this.levels;if(b){var D=b[y],F=D.details,G=g.defaultAudioCodec||D.audioCodec||"mp4a.40.2",ee=this.transmuxer;ee||(ee=this.transmuxer=new xs(this.hls,ue.PlaylistLevelType.AUDIO,this._handleTransmuxComplete.bind(this),this._handleTransmuxerFlush.bind(this)));var J=this.initPTS[i.cc],le=(c=i.initSegment)===null||c===void 0?void 0:c.data;if(J!==void 0){var Se=u?u.index:-1,we=Se!==-1,be=new Ds(i.level,i.sn,i.stats.chunkCount,p.byteLength,Se,we);ee.push(p,le,G,"",i,u,F.totalduration,!1,be,J)}else this.log("Unknown video PTS for cc "+i.cc+", waiting for video PTS before demuxing audio frag "+i.sn+" of ["+F.startSN+" ,"+F.endSN+"],track "+y),(this.waitingData=this.waitingData||{frag:i,part:u,cache:new Na,complete:!1}).cache.push(new Uint8Array(p)),this.waitingVideoCC=this.videoTrackCC,this.state=pi}else this.warn("Audio tracks were reset while fragment load was in progress. Fragment "+i.sn+" of level "+i.level+" will not be buffered")},s._handleFragmentLoadComplete=function(o){this.waitingData?this.waitingData.complete=!0:v.prototype._handleFragmentLoadComplete.call(this,o)},s.onBufferReset=function(){this.mediaBuffer=this.videoBuffer=null,this.loadedmetadata=!1},s.onBufferCreated=function(o,c){var i=c.tracks.audio;i&&(this.mediaBuffer=i.buffer||null),c.tracks.video&&(this.videoBuffer=c.tracks.video.buffer||null)},s.onFragBuffered=function(o,c){var i,u=c.frag,p=c.part;u.type===ue.PlaylistLevelType.AUDIO?this.fragContextChanged(u)?this.warn("Fragment "+u.sn+(p?" p: "+p.index:"")+" of level "+u.level+" finished buffering, but was aborted. state: "+this.state+", audioSwitch: "+this.audioSwitch):(u.sn!=="initSegment"&&(this.fragPrevious=u,this.audioSwitch&&(this.audioSwitch=!1,this.hls.trigger(E.Events.AUDIO_TRACK_SWITCHED,{id:this.trackId}))),this.fragBufferedComplete(u,p)):this.loadedmetadata||u.type!==ue.PlaylistLevelType.MAIN||(i=this.videoBuffer||this.media)!==null&&i!==void 0&&i.buffered.length&&(this.loadedmetadata=!0)},s.onError=function(o,c){if(c.type!==A.ErrorTypes.KEY_SYSTEM_ERROR)switch(c.details){case A.ErrorDetails.FRAG_LOAD_ERROR:case A.ErrorDetails.FRAG_LOAD_TIMEOUT:case A.ErrorDetails.FRAG_PARSING_ERROR:case A.ErrorDetails.KEY_LOAD_ERROR:case A.ErrorDetails.KEY_LOAD_TIMEOUT:this.onFragmentOrKeyLoadError(ue.PlaylistLevelType.AUDIO,c);break;case A.ErrorDetails.AUDIO_TRACK_LOAD_ERROR:case A.ErrorDetails.AUDIO_TRACK_LOAD_TIMEOUT:this.state!==En&&this.state!==zr&&(this.state=c.fatal?En:Nt,this.warn(c.details+" while loading frag, switching to "+this.state+" state"));break;case A.ErrorDetails.BUFFER_FULL_ERROR:if(c.parent==="audio"&&(this.state===nn||this.state===hi)){var i=!0,u=this.getFwdBufferInfo(this.mediaBuffer,ue.PlaylistLevelType.AUDIO);u&&u.len>.5&&(i=!this.reduceMaxBufferLength(u.len)),i&&(this.warn("Buffer full error also media.currentTime is not buffered, flush audio buffer"),this.fragCurrent=null,v.prototype.flushMainBuffer.call(this,0,Number.POSITIVE_INFINITY,"audio")),this.resetLoadingState()}}else this.onFragmentOrKeyLoadError(ue.PlaylistLevelType.AUDIO,c)},s.onBufferFlushed=function(o,c){c.type===ie.ElementaryStreamTypes.AUDIO&&(this.bufferFlushed=!0,this.state===jn&&(this.state=Nt))},s._handleTransmuxComplete=function(o){var c,i="audio",u=this.hls,p=o.remuxResult,g=o.chunkMeta,y=this.getCurrentContext(g);if(!y)return this.warn("The loading context changed while buffering fragment "+g.sn+" of level "+g.level+". This chunk will not be buffered."),void this.resetStartWhenNotLoaded(g.level);var b=y.frag,D=y.part,F=y.level.details,G=p.audio,ee=p.text,J=p.id3,le=p.initSegment;if(!this.fragContextChanged(b)&&F){if(this.state=nn,this.audioSwitch&&G&&this.completeAudioSwitch(),le!=null&&le.tracks&&(this._bufferInitSegment(le.tracks,b,g),u.trigger(E.Events.FRAG_PARSING_INIT_SEGMENT,{frag:b,id:i,tracks:le.tracks})),G){var Se=G.startPTS,we=G.endPTS,be=G.startDTS,Pe=G.endDTS;D&&(D.elementaryStreams[ie.ElementaryStreamTypes.AUDIO]={startPTS:Se,endPTS:we,startDTS:be,endDTS:Pe}),b.setElementaryStreamInfo(ie.ElementaryStreamTypes.AUDIO,Se,we,be,Pe),this.bufferFragmentData(G,b,D,g)}if(J!=null&&(c=J.samples)!==null&&c!==void 0&&c.length){var tt=ss({id:i,frag:b,details:F},J);u.trigger(E.Events.FRAG_PARSING_METADATA,tt)}if(ee){var rt=ss({id:i,frag:b,details:F},ee);u.trigger(E.Events.FRAG_PARSING_USERDATA,rt)}}},s._bufferInitSegment=function(o,c,i){if(this.state===nn){o.video&&delete o.video;var u=o.audio;if(u){u.levelCodec=u.codec,u.id="audio",this.log("Init audio buffer, container:"+u.container+", codecs[parsed]=["+u.codec+"]"),this.hls.trigger(E.Events.BUFFER_CODECS,o);var p=u.initSegment;if(p!=null&&p.byteLength){var g={type:"audio",frag:c,part:null,chunkMeta:i,parent:c.type,data:p};this.hls.trigger(E.Events.BUFFER_APPENDING,g)}this.tick()}}},s.loadFragment=function(o,c,i){var u=this.fragmentTracker.getState(o);this.fragCurrent=o,(this.audioSwitch||u===et.NOT_LOADED||u===et.PARTIAL)&&(o.sn==="initSegment"?this._loadInitSegment(o,c):c.live&&!(0,O.isFiniteNumber)(this.initPTS[o.cc])?(this.log("Waiting for video PTS in continuity counter "+o.cc+" of live stream before loading audio fragment "+o.sn+" of level "+this.trackId),this.state=pi):(this.startFragRequested=!0,v.prototype.loadFragment.call(this,o,c,i)))},s.completeAudioSwitch=function(){var o=this.hls,c=this.media,i=this.trackId;c&&(this.log("Switching audio track : flushing all audio"),v.prototype.flushMainBuffer.call(this,0,Number.POSITIVE_INFINITY,"audio")),this.audioSwitch=!1,o.trigger(E.Events.AUDIO_TRACK_SWITCHED,{id:i})},n}(Ji);const el=Us;function tl(v,h){for(var t=0;t<h.length;t++){var n=h[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(v,typeof(s=function(o,c){if(typeof o!="object"||o===null)return o;var i=o[Symbol.toPrimitive];if(i!==void 0){var u=i.call(o,c);if(typeof u!="object")return u;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(o)}(n.key,"string"))=="symbol"?s:String(s),n)}var s}function Bs(v,h){return Bs=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,n){return t.__proto__=n,t},Bs(v,h)}const rl=function(v){var h,t;function n(i){var u;return(u=v.call(this,i,"[audio-track-controller]")||this).tracks=[],u.groupId=null,u.tracksInGroup=[],u.trackId=-1,u.trackName="",u.selectDefaultTrack=!0,u.registerListeners(),u}t=v,(h=n).prototype=Object.create(t.prototype),h.prototype.constructor=h,Bs(h,t);var s,o,c=n.prototype;return c.registerListeners=function(){var i=this.hls;i.on(E.Events.MANIFEST_LOADING,this.onManifestLoading,this),i.on(E.Events.MANIFEST_PARSED,this.onManifestParsed,this),i.on(E.Events.LEVEL_LOADING,this.onLevelLoading,this),i.on(E.Events.LEVEL_SWITCHING,this.onLevelSwitching,this),i.on(E.Events.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),i.on(E.Events.ERROR,this.onError,this)},c.unregisterListeners=function(){var i=this.hls;i.off(E.Events.MANIFEST_LOADING,this.onManifestLoading,this),i.off(E.Events.MANIFEST_PARSED,this.onManifestParsed,this),i.off(E.Events.LEVEL_LOADING,this.onLevelLoading,this),i.off(E.Events.LEVEL_SWITCHING,this.onLevelSwitching,this),i.off(E.Events.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),i.off(E.Events.ERROR,this.onError,this)},c.destroy=function(){this.unregisterListeners(),this.tracks.length=0,this.tracksInGroup.length=0,v.prototype.destroy.call(this)},c.onManifestLoading=function(){this.tracks=[],this.groupId=null,this.tracksInGroup=[],this.trackId=-1,this.trackName="",this.selectDefaultTrack=!0},c.onManifestParsed=function(i,u){this.tracks=u.audioTracks||[]},c.onAudioTrackLoaded=function(i,u){var p=u.id,g=u.details,y=this.tracksInGroup[p];if(y){var b=y.details;y.details=u.details,this.log("audioTrack "+p+" loaded ["+g.startSN+"-"+g.endSN+"]"),p===this.trackId&&(this.retryCount=0,this.playlistLoaded(p,u,b))}else this.warn("Invalid audio track id "+p)},c.onLevelLoading=function(i,u){this.switchLevel(u.level)},c.onLevelSwitching=function(i,u){this.switchLevel(u.level)},c.switchLevel=function(i){var u=this.hls.levels[i];if(u!=null&&u.audioGroupIds){var p=u.audioGroupIds[u.urlId];if(this.groupId!==p){this.groupId=p;var g=this.tracks.filter(function(b){return!p||b.groupId===p});this.selectDefaultTrack&&!g.some(function(b){return b.default})&&(this.selectDefaultTrack=!1),this.tracksInGroup=g;var y={audioTracks:g};this.log("Updating audio tracks, "+g.length+' track(s) found in "'+p+'" group-id'),this.hls.trigger(E.Events.AUDIO_TRACKS_UPDATED,y),this.selectInitialTrack()}}},c.onError=function(i,u){v.prototype.onError.call(this,i,u),!u.fatal&&u.context&&u.context.type===ue.PlaylistContextType.AUDIO_TRACK&&u.context.id===this.trackId&&u.context.groupId===this.groupId&&this.retryLoadingOrFail(u)},c.setAudioTrack=function(i){var u=this.tracksInGroup;if(i<0||i>=u.length)this.warn("Invalid id passed to audio-track controller");else{this.clearTimer();var p=u[this.trackId];this.log("Now switching to audio-track index "+i);var g=u[i],y=g.id,b=g.groupId,D=b===void 0?"":b,F=g.name,G=g.type,ee=g.url;if(this.trackId=i,this.trackName=F,this.selectDefaultTrack=!1,this.hls.trigger(E.Events.AUDIO_TRACK_SWITCHING,{id:y,groupId:D,name:F,type:G,url:ee}),!g.details||g.details.live){var J=this.switchParams(g.url,p==null?void 0:p.details);this.loadPlaylist(J)}}},c.selectInitialTrack=function(){this.tracksInGroup;var i=this.trackName,u=this.findTrackId(i)||this.findTrackId();u!==-1?this.setAudioTrack(u):(this.warn("No track found for running audio group-ID: "+this.groupId),this.hls.trigger(E.Events.ERROR,{type:A.ErrorTypes.MEDIA_ERROR,details:A.ErrorDetails.AUDIO_TRACK_LOAD_ERROR,fatal:!0}))},c.findTrackId=function(i){for(var u=this.tracksInGroup,p=0;p<u.length;p++){var g=u[p];if((!this.selectDefaultTrack||g.default)&&(!i||i===g.name))return g.id}return-1},c.loadPlaylist=function(i){v.prototype.loadPlaylist.call(this);var u=this.tracksInGroup[this.trackId];if(this.shouldLoadTrack(u)){var p=u.id,g=u.groupId,y=u.url;if(i)try{y=i.addDirectives(y)}catch(b){this.warn("Could not construct new URL with HLS Delivery Directives: "+b)}this.log("loading audio-track playlist for id: "+p),this.clearTimer(),this.hls.trigger(E.Events.AUDIO_TRACK_LOADING,{url:y,id:p,groupId:g,deliveryDirectives:i||null})}},s=n,(o=[{key:"audioTracks",get:function(){return this.tracksInGroup}},{key:"audioTrack",get:function(){return this.trackId},set:function(i){this.selectDefaultTrack=!1,this.setAudioTrack(i)}}])&&tl(s.prototype,o),Object.defineProperty(s,"prototype",{writable:!1}),n}(Me);function nl(v,h){for(var t=0;t<h.length;t++){var n=h[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(v,typeof(s=function(o,c){if(typeof o!="object"||o===null)return o;var i=o[Symbol.toPrimitive];if(i!==void 0){var u=i.call(o,c);if(typeof u!="object")return u;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(o)}(n.key,"string"))=="symbol"?s:String(s),n)}var s}function rr(v,h){return rr=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,n){return t.__proto__=n,t},rr(v,h)}var ir=function(v){var h,t;function n(i,u,p){var g;return(g=v.call(this,i,u,p,"[subtitle-stream-controller]")||this).levels=[],g.currentTrackId=-1,g.tracksBuffered=[],g.mainDetails=null,g._registerListeners(),g}t=v,(h=n).prototype=Object.create(t.prototype),h.prototype.constructor=h,rr(h,t);var s,o,c=n.prototype;return c.onHandlerDestroying=function(){this._unregisterListeners(),this.mainDetails=null},c._registerListeners=function(){var i=this.hls;i.on(E.Events.MEDIA_ATTACHED,this.onMediaAttached,this),i.on(E.Events.MEDIA_DETACHING,this.onMediaDetaching,this),i.on(E.Events.MANIFEST_LOADING,this.onManifestLoading,this),i.on(E.Events.LEVEL_LOADED,this.onLevelLoaded,this),i.on(E.Events.ERROR,this.onError,this),i.on(E.Events.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),i.on(E.Events.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),i.on(E.Events.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),i.on(E.Events.SUBTITLE_FRAG_PROCESSED,this.onSubtitleFragProcessed,this),i.on(E.Events.BUFFER_FLUSHING,this.onBufferFlushing,this),i.on(E.Events.FRAG_BUFFERED,this.onFragBuffered,this)},c._unregisterListeners=function(){var i=this.hls;i.off(E.Events.MEDIA_ATTACHED,this.onMediaAttached,this),i.off(E.Events.MEDIA_DETACHING,this.onMediaDetaching,this),i.off(E.Events.MANIFEST_LOADING,this.onManifestLoading,this),i.off(E.Events.LEVEL_LOADED,this.onLevelLoaded,this),i.off(E.Events.ERROR,this.onError,this),i.off(E.Events.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),i.off(E.Events.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),i.off(E.Events.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),i.off(E.Events.SUBTITLE_FRAG_PROCESSED,this.onSubtitleFragProcessed,this),i.off(E.Events.BUFFER_FLUSHING,this.onBufferFlushing,this),i.off(E.Events.FRAG_BUFFERED,this.onFragBuffered,this)},c.startLoad=function(i){this.stopLoad(),this.state=Nt,this.setInterval(500),this.nextLoadPosition=this.startPosition=this.lastCurrentTime=i,this.tick()},c.onManifestLoading=function(){this.mainDetails=null,this.fragmentTracker.removeAllFragments()},c.onLevelLoaded=function(i,u){this.mainDetails=u.details},c.onSubtitleFragProcessed=function(i,u){var p=u.frag,g=u.success;if(this.fragPrevious=p,this.state=Nt,g){var y=this.tracksBuffered[this.currentTrackId];if(y){for(var b,D=p.start,F=0;F<y.length;F++)if(D>=y[F].start&&D<=y[F].end){b=y[F];break}var G=p.start+p.duration;b?b.end=G:(b={start:D,end:G},y.push(b)),this.fragmentTracker.fragBuffered(p)}}},c.onBufferFlushing=function(i,u){var p=u.startOffset,g=u.endOffset;if(p===0&&g!==Number.POSITIVE_INFINITY){var y=this.currentTrackId,b=this.levels;if(!b.length||!b[y]||!b[y].details)return;var D=g-b[y].details.targetduration;if(D<=0)return;u.endOffsetSubtitles=Math.max(0,D),this.tracksBuffered.forEach(function(F){for(var G=0;G<F.length;)if(F[G].end<=D)F.shift();else{if(!(F[G].start<D))break;F[G].start=D,G++}}),this.fragmentTracker.removeFragmentsInRange(p,D,ue.PlaylistLevelType.SUBTITLE)}},c.onFragBuffered=function(i,u){var p;this.loadedmetadata||u.frag.type!==ue.PlaylistLevelType.MAIN||(p=this.media)!==null&&p!==void 0&&p.buffered.length&&(this.loadedmetadata=!0)},c.onError=function(i,u){var p=u.frag;p&&p.type===ue.PlaylistLevelType.SUBTITLE&&(this.fragCurrent&&this.fragCurrent.abortRequests(),this.state=Nt)},c.onSubtitleTracksUpdated=function(i,u){var p=this,g=u.subtitleTracks;this.tracksBuffered=[],this.levels=g.map(function(y){return new $(y)}),this.fragmentTracker.removeAllFragments(),this.fragPrevious=null,this.levels.forEach(function(y){p.tracksBuffered[y.id]=[]}),this.mediaBuffer=null},c.onSubtitleTrackSwitch=function(i,u){if(this.currentTrackId=u.id,this.levels.length&&this.currentTrackId!==-1){var p=this.levels[this.currentTrackId];p!=null&&p.details?this.mediaBuffer=this.mediaBufferTimeRanges:this.mediaBuffer=null,p&&this.setInterval(500)}else this.clearInterval()},c.onSubtitleTrackLoaded=function(i,u){var p,g=u.details,y=u.id,b=this.currentTrackId,D=this.levels;if(D.length){var F=D[b];if(!(y>=D.length||y!==b)&&F){this.mediaBuffer=this.mediaBufferTimeRanges;var G=0;if(g.live||(p=F.details)!==null&&p!==void 0&&p.live){var ee=this.mainDetails;if(g.deltaUpdateFailed||!ee)return;var J=ee.fragments[0];F.details?(G=this.alignPlaylists(g,F.details))===0&&J&&Ce(g,G=J.start):g.hasProgramDateTime&&ee.hasProgramDateTime?(Ia(g,ee),G=g.fragments[0].start):J&&Ce(g,G=J.start)}F.details=g,this.levelLastLoaded=y,this.startFragRequested||!this.mainDetails&&g.live||this.setStartPosition(F.details,G),this.tick(),g.live&&!this.fragCurrent&&this.media&&this.state===Nt&&(ks(null,g.fragments,this.media.currentTime,0)||(this.warn("Subtitle playlist not aligned with playback"),F.details=void 0))}}},c._handleFragmentLoadComplete=function(i){var u=this,p=i.frag,g=i.payload,y=p.decryptdata,b=this.hls;if(!this.fragContextChanged(p)&&g&&g.byteLength>0&&y&&y.key&&y.iv&&y.method==="AES-128"){var D=performance.now();this.decrypter.decrypt(new Uint8Array(g),y.key.buffer,y.iv.buffer).then(function(F){var G=performance.now();b.trigger(E.Events.FRAG_DECRYPTED,{frag:p,payload:F,stats:{tstart:D,tdecrypt:G}})}).catch(function(F){u.warn(F.name+": "+F.message),u.state=Nt})}},c.doTick=function(){if(this.media){if(this.state===Nt){var i=this.currentTrackId,u=this.levels;if(!u.length||!u[i]||!u[i].details)return;var p=u[i].details,g=p.targetduration,y=this.config,b=this.getLoadPosition(),D=or.bufferedInfo(this.tracksBuffered[this.currentTrackId]||[],b-g,y.maxBufferHole),F=D.end,G=D.len,ee=this.getFwdBufferInfo(this.media,ue.PlaylistLevelType.MAIN);if(G>this.getMaxBufferLength(ee==null?void 0:ee.len)+g)return;var J=p.fragments,le=J.length,Se=p.edge,we=null,be=this.fragPrevious;if(F<Se){var Pe=y.maxFragLookUpTolerance;!(we=ks(be,J,Math.max(J[0].start,F),Pe))&&be&&be.start<J[0].start&&(we=J[0])}else we=J[le-1];if(!we)return;we=this.mapToInitFragWhenRequired(we),this.fragmentTracker.getState(we)===et.NOT_LOADED&&this.loadFragment(we,p,F)}}else this.state=Nt},c.getMaxBufferLength=function(i){var u=v.prototype.getMaxBufferLength.call(this);return i?Math.max(u,i):u},c.loadFragment=function(i,u,p){this.fragCurrent=i,i.sn==="initSegment"?this._loadInitSegment(i,u):(this.startFragRequested=!0,v.prototype.loadFragment.call(this,i,u,p))},s=n,(o=[{key:"mediaBufferTimeRanges",get:function(){return new il(this.tracksBuffered[this.currentTrackId]||[])}}])&&nl(s.prototype,o),Object.defineProperty(s,"prototype",{writable:!1}),n}(Ji),il=function(v){this.buffered=void 0;var h=function(t,n,s){if((n>>>=0)>s-1)throw new DOMException("Failed to execute '"+t+"' on 'TimeRanges': The index provided ("+n+") is greater than the maximum bound ("+s+")");return v[n][t]};this.buffered={get length(){return v.length},end:function(t){return h("end",t,v.length)},start:function(t){return h("start",t,v.length)}}};function sl(v,h){for(var t=0;t<h.length;t++){var n=h[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(v,typeof(s=function(o,c){if(typeof o!="object"||o===null)return o;var i=o[Symbol.toPrimitive];if(i!==void 0){var u=i.call(o,c);if(typeof u!="object")return u;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(o)}(n.key,"string"))=="symbol"?s:String(s),n)}var s}function Gs(v,h){return Gs=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,n){return t.__proto__=n,t},Gs(v,h)}function Ks(v){for(var h=[],t=0;t<v.length;t++){var n=v[t];n.kind!=="subtitles"&&n.kind!=="captions"||!n.label||h.push(v[t])}return h}const al=function(v){var h,t;function n(i){var u;return(u=v.call(this,i,"[subtitle-track-controller]")||this).media=null,u.tracks=[],u.groupId=null,u.tracksInGroup=[],u.trackId=-1,u.selectDefaultTrack=!0,u.queuedDefaultTrack=-1,u.trackChangeListener=function(){return u.onTextTracksChanged()},u.asyncPollTrackChange=function(){return u.pollTrackChange(0)},u.useTextTrackPolling=!1,u.subtitlePollingInterval=-1,u._subtitleDisplay=!0,u.registerListeners(),u}t=v,(h=n).prototype=Object.create(t.prototype),h.prototype.constructor=h,Gs(h,t);var s,o,c=n.prototype;return c.destroy=function(){this.unregisterListeners(),this.tracks.length=0,this.tracksInGroup.length=0,this.trackChangeListener=this.asyncPollTrackChange=null,v.prototype.destroy.call(this)},c.registerListeners=function(){var i=this.hls;i.on(E.Events.MEDIA_ATTACHED,this.onMediaAttached,this),i.on(E.Events.MEDIA_DETACHING,this.onMediaDetaching,this),i.on(E.Events.MANIFEST_LOADING,this.onManifestLoading,this),i.on(E.Events.MANIFEST_PARSED,this.onManifestParsed,this),i.on(E.Events.LEVEL_LOADING,this.onLevelLoading,this),i.on(E.Events.LEVEL_SWITCHING,this.onLevelSwitching,this),i.on(E.Events.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),i.on(E.Events.ERROR,this.onError,this)},c.unregisterListeners=function(){var i=this.hls;i.off(E.Events.MEDIA_ATTACHED,this.onMediaAttached,this),i.off(E.Events.MEDIA_DETACHING,this.onMediaDetaching,this),i.off(E.Events.MANIFEST_LOADING,this.onManifestLoading,this),i.off(E.Events.MANIFEST_PARSED,this.onManifestParsed,this),i.off(E.Events.LEVEL_LOADING,this.onLevelLoading,this),i.off(E.Events.LEVEL_SWITCHING,this.onLevelSwitching,this),i.off(E.Events.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),i.off(E.Events.ERROR,this.onError,this)},c.onMediaAttached=function(i,u){this.media=u.media,this.media&&(this.queuedDefaultTrack>-1&&(this.subtitleTrack=this.queuedDefaultTrack,this.queuedDefaultTrack=-1),this.useTextTrackPolling=!(this.media.textTracks&&"onchange"in this.media.textTracks),this.useTextTrackPolling?this.pollTrackChange(500):this.media.textTracks.addEventListener("change",this.asyncPollTrackChange))},c.pollTrackChange=function(i){self.clearInterval(this.subtitlePollingInterval),this.subtitlePollingInterval=self.setInterval(this.trackChangeListener,i)},c.onMediaDetaching=function(){this.media&&(self.clearInterval(this.subtitlePollingInterval),this.useTextTrackPolling||this.media.textTracks.removeEventListener("change",this.asyncPollTrackChange),this.trackId>-1&&(this.queuedDefaultTrack=this.trackId),Ks(this.media.textTracks).forEach(function(i){Pt(i)}),this.subtitleTrack=-1,this.media=null)},c.onManifestLoading=function(){this.tracks=[],this.groupId=null,this.tracksInGroup=[],this.trackId=-1,this.selectDefaultTrack=!0},c.onManifestParsed=function(i,u){this.tracks=u.subtitleTracks},c.onSubtitleTrackLoaded=function(i,u){var p=u.id,g=u.details,y=this.trackId,b=this.tracksInGroup[y];if(b){var D=b.details;b.details=u.details,this.log("subtitle track "+p+" loaded ["+g.startSN+"-"+g.endSN+"]"),p===this.trackId&&(this.retryCount=0,this.playlistLoaded(p,u,D))}else this.warn("Invalid subtitle track id "+p)},c.onLevelLoading=function(i,u){this.switchLevel(u.level)},c.onLevelSwitching=function(i,u){this.switchLevel(u.level)},c.switchLevel=function(i){var u=this.hls.levels[i];if(u!=null&&u.textGroupIds){var p=u.textGroupIds[u.urlId];if(this.groupId!==p){var g=this.tracksInGroup?this.tracksInGroup[this.trackId]:void 0,y=this.tracks.filter(function(F){return!p||F.groupId===p});this.tracksInGroup=y;var b=this.findTrackId(g==null?void 0:g.name)||this.findTrackId();this.groupId=p;var D={subtitleTracks:y};this.log("Updating subtitle tracks, "+y.length+' track(s) found in "'+p+'" group-id'),this.hls.trigger(E.Events.SUBTITLE_TRACKS_UPDATED,D),b!==-1&&this.setSubtitleTrack(b,g)}}},c.findTrackId=function(i){for(var u=this.tracksInGroup,p=0;p<u.length;p++){var g=u[p];if((!this.selectDefaultTrack||g.default)&&(!i||i===g.name))return g.id}return-1},c.onError=function(i,u){v.prototype.onError.call(this,i,u),!u.fatal&&u.context&&u.context.type===ue.PlaylistContextType.SUBTITLE_TRACK&&u.context.id===this.trackId&&u.context.groupId===this.groupId&&this.retryLoadingOrFail(u)},c.loadPlaylist=function(i){v.prototype.loadPlaylist.call(this);var u=this.tracksInGroup[this.trackId];if(this.shouldLoadTrack(u)){var p=u.id,g=u.groupId,y=u.url;if(i)try{y=i.addDirectives(y)}catch(b){this.warn("Could not construct new URL with HLS Delivery Directives: "+b)}this.log("Loading subtitle playlist for id "+p),this.hls.trigger(E.Events.SUBTITLE_TRACK_LOADING,{url:y,id:p,groupId:g,deliveryDirectives:i||null})}},c.toggleTrackModes=function(i){var u=this,p=this.media,g=this.trackId;if(p){var y=Ks(p.textTracks),b=y.filter(function(G){return G.groupId===u.groupId});if(i===-1)[].slice.call(y).forEach(function(G){G.mode="disabled"});else{var D=b[g];D&&(D.mode="disabled")}var F=b[i];F&&(F.mode=this.subtitleDisplay?"showing":"hidden")}},c.setSubtitleTrack=function(i,u){var p,g=this.tracksInGroup;if(this.media){if(this.trackId!==i&&this.toggleTrackModes(i),!(this.trackId===i&&(i===-1||(p=g[i])!==null&&p!==void 0&&p.details)||i<-1||i>=g.length)){this.clearTimer();var y=g[i];if(this.log("Switching to subtitle track "+i),this.trackId=i,y){var b=y.id,D=y.groupId,F=D===void 0?"":D,G=y.name,ee=y.type,J=y.url;this.hls.trigger(E.Events.SUBTITLE_TRACK_SWITCH,{id:b,groupId:F,name:G,type:ee,url:J});var le=this.switchParams(y.url,u==null?void 0:u.details);this.loadPlaylist(le)}else this.hls.trigger(E.Events.SUBTITLE_TRACK_SWITCH,{id:i})}}else this.queuedDefaultTrack=i},c.onTextTracksChanged=function(){if(this.useTextTrackPolling||self.clearInterval(this.subtitlePollingInterval),this.media&&this.hls.config.renderTextTracksNatively){for(var i=-1,u=Ks(this.media.textTracks),p=0;p<u.length;p++)if(u[p].mode==="hidden")i=p;else if(u[p].mode==="showing"){i=p;break}this.subtitleTrack!==i&&(this.subtitleTrack=i)}},s=n,(o=[{key:"subtitleDisplay",get:function(){return this._subtitleDisplay},set:function(i){this._subtitleDisplay=i,this.trackId>-1&&this.toggleTrackModes(this.trackId)}},{key:"subtitleTracks",get:function(){return this.tracksInGroup}},{key:"subtitleTrack",get:function(){return this.trackId},set:function(i){this.selectDefaultTrack=!1;var u=this.tracksInGroup?this.tracksInGroup[this.trackId]:void 0;this.setSubtitleTrack(i,u)}}])&&sl(s.prototype,o),Object.defineProperty(s,"prototype",{writable:!1}),n}(Me);var Ut,Ua=function(){function v(t){this.buffers=void 0,this.queues={video:[],audio:[],audiovideo:[]},this.buffers=t}var h=v.prototype;return h.append=function(t,n){var s=this.queues[n];s.push(t),s.length===1&&this.buffers[n]&&this.executeNext(n)},h.insertAbort=function(t,n){this.queues[n].unshift(t),this.executeNext(n)},h.appendBlocker=function(t){var n,s=new Promise(function(c){n=c}),o={execute:n,onStart:function(){},onComplete:function(){},onError:function(){}};return this.append(o,t),s},h.executeNext=function(t){var n=this.buffers,s=this.queues,o=n[t],c=s[t];if(c.length){var i=c[0];try{i.execute()}catch(u){w.logger.warn("[buffer-operation-queue]: Unhandled exception executing the current operation"),i.onError(u),o&&o.updating||(c.shift(),this.executeNext(t))}}},h.shiftAndExecuteNext=function(t){this.queues[t].shift(),this.executeNext(t)},h.current=function(t){return this.queues[t][0]},v}(),Ba=Os(),Or=/([ha]vc.)(?:\.[^.,]+)+/,Hs=function(){function v(t){var n=this;this.details=null,this._objectUrl=null,this.operationQueue=void 0,this.listeners=void 0,this.hls=void 0,this.bufferCodecEventsExpected=0,this._bufferCodecEventsTotal=0,this.media=null,this.mediaSource=null,this.lastMpegAudioChunk=null,this.appendError=0,this.tracks={},this.pendingTracks={},this.sourceBuffer=void 0,this._onMediaSourceOpen=function(){var s=n.media,o=n.mediaSource;w.logger.log("[buffer-controller]: Media source opened"),s&&(s.removeEventListener("emptied",n._onMediaEmptied),n.updateMediaElementDuration(),n.hls.trigger(E.Events.MEDIA_ATTACHED,{media:s})),o&&o.removeEventListener("sourceopen",n._onMediaSourceOpen),n.checkPendingTracks()},this._onMediaSourceClose=function(){w.logger.log("[buffer-controller]: Media source closed")},this._onMediaSourceEnded=function(){w.logger.log("[buffer-controller]: Media source ended")},this._onMediaEmptied=function(){var s=n.media,o=n._objectUrl;s&&s.src!==o&&w.logger.error("Media element src was set while attaching MediaSource ("+o+" > "+s.src+")")},this.hls=t,this._initSourceBuffer(),this.registerListeners()}var h=v.prototype;return h.hasSourceTypes=function(){return this.getSourceBufferTypes().length>0||Object.keys(this.pendingTracks).length>0},h.destroy=function(){this.unregisterListeners(),this.details=null,this.lastMpegAudioChunk=null},h.registerListeners=function(){var t=this.hls;t.on(E.Events.MEDIA_ATTACHING,this.onMediaAttaching,this),t.on(E.Events.MEDIA_DETACHING,this.onMediaDetaching,this),t.on(E.Events.MANIFEST_PARSED,this.onManifestParsed,this),t.on(E.Events.BUFFER_RESET,this.onBufferReset,this),t.on(E.Events.BUFFER_APPENDING,this.onBufferAppending,this),t.on(E.Events.BUFFER_CODECS,this.onBufferCodecs,this),t.on(E.Events.BUFFER_EOS,this.onBufferEos,this),t.on(E.Events.BUFFER_FLUSHING,this.onBufferFlushing,this),t.on(E.Events.LEVEL_UPDATED,this.onLevelUpdated,this),t.on(E.Events.FRAG_PARSED,this.onFragParsed,this),t.on(E.Events.FRAG_CHANGED,this.onFragChanged,this)},h.unregisterListeners=function(){var t=this.hls;t.off(E.Events.MEDIA_ATTACHING,this.onMediaAttaching,this),t.off(E.Events.MEDIA_DETACHING,this.onMediaDetaching,this),t.off(E.Events.MANIFEST_PARSED,this.onManifestParsed,this),t.off(E.Events.BUFFER_RESET,this.onBufferReset,this),t.off(E.Events.BUFFER_APPENDING,this.onBufferAppending,this),t.off(E.Events.BUFFER_CODECS,this.onBufferCodecs,this),t.off(E.Events.BUFFER_EOS,this.onBufferEos,this),t.off(E.Events.BUFFER_FLUSHING,this.onBufferFlushing,this),t.off(E.Events.LEVEL_UPDATED,this.onLevelUpdated,this),t.off(E.Events.FRAG_PARSED,this.onFragParsed,this),t.off(E.Events.FRAG_CHANGED,this.onFragChanged,this)},h._initSourceBuffer=function(){this.sourceBuffer={},this.operationQueue=new Ua(this.sourceBuffer),this.listeners={audio:[],video:[],audiovideo:[]},this.lastMpegAudioChunk=null},h.onManifestParsed=function(t,n){var s=2;(n.audio&&!n.video||!n.altAudio)&&(s=1),this.bufferCodecEventsExpected=this._bufferCodecEventsTotal=s,this.details=null,w.logger.log(this.bufferCodecEventsExpected+" bufferCodec event(s) expected")},h.onMediaAttaching=function(t,n){var s=this.media=n.media;if(s&&Ba){var o=this.mediaSource=new Ba;o.addEventListener("sourceopen",this._onMediaSourceOpen),o.addEventListener("sourceended",this._onMediaSourceEnded),o.addEventListener("sourceclose",this._onMediaSourceClose),s.src=self.URL.createObjectURL(o),this._objectUrl=s.src,s.addEventListener("emptied",this._onMediaEmptied)}},h.onMediaDetaching=function(){var t=this.media,n=this.mediaSource,s=this._objectUrl;if(n){if(w.logger.log("[buffer-controller]: media source detaching"),n.readyState==="open")try{n.endOfStream()}catch(o){w.logger.warn("[buffer-controller]: onMediaDetaching: "+o.message+" while calling endOfStream")}this.onBufferReset(),n.removeEventListener("sourceopen",this._onMediaSourceOpen),n.removeEventListener("sourceended",this._onMediaSourceEnded),n.removeEventListener("sourceclose",this._onMediaSourceClose),t&&(t.removeEventListener("emptied",this._onMediaEmptied),s&&self.URL.revokeObjectURL(s),t.src===s?(t.removeAttribute("src"),t.load()):w.logger.warn("[buffer-controller]: media.src was changed by a third party - skip cleanup")),this.mediaSource=null,this.media=null,this._objectUrl=null,this.bufferCodecEventsExpected=this._bufferCodecEventsTotal,this.pendingTracks={},this.tracks={}}this.hls.trigger(E.Events.MEDIA_DETACHED,void 0)},h.onBufferReset=function(){var t=this;this.getSourceBufferTypes().forEach(function(n){var s=t.sourceBuffer[n];try{s&&(t.removeBufferListeners(n),t.mediaSource&&t.mediaSource.removeSourceBuffer(s),t.sourceBuffer[n]=void 0)}catch(o){w.logger.warn("[buffer-controller]: Failed to reset the "+n+" buffer",o)}}),this._initSourceBuffer()},h.onBufferCodecs=function(t,n){var s=this,o=this.getSourceBufferTypes().length;Object.keys(n).forEach(function(c){if(o){var i=s.tracks[c];if(i&&typeof i.buffer.changeType=="function"){var u=n[c],p=u.id,g=u.codec,y=u.levelCodec,b=u.container,D=u.metadata,F=(i.levelCodec||i.codec).replace(Or,"$1"),G=(y||g).replace(Or,"$1");if(F!==G){var ee=b+";codecs="+(y||g);s.appendChangeType(c,ee),w.logger.log("[buffer-controller]: switching codec "+F+" to "+G),s.tracks[c]={buffer:i.buffer,codec:g,container:b,levelCodec:y,metadata:D,id:p}}}}else s.pendingTracks[c]=n[c]}),o||(this.bufferCodecEventsExpected=Math.max(this.bufferCodecEventsExpected-1,0),this.mediaSource&&this.mediaSource.readyState==="open"&&this.checkPendingTracks())},h.appendChangeType=function(t,n){var s=this,o=this.operationQueue,c={execute:function(){var i=s.sourceBuffer[t];i&&(w.logger.log("[buffer-controller]: changing "+t+" sourceBuffer type to "+n),i.changeType(n)),o.shiftAndExecuteNext(t)},onStart:function(){},onComplete:function(){},onError:function(i){w.logger.warn("[buffer-controller]: Failed to change "+t+" SourceBuffer type",i)}};o.append(c,t)},h.onBufferAppending=function(t,n){var s=this,o=this.hls,c=this.operationQueue,i=this.tracks,u=n.data,p=n.type,g=n.frag,y=n.part,b=n.chunkMeta,D=b.buffering[p],F=self.performance.now();D.start=F;var G=g.stats.buffering,ee=y?y.stats.buffering:null;G.start===0&&(G.start=F),ee&&ee.start===0&&(ee.start=F);var J=i.audio,le=!1;p==="audio"&&(J==null?void 0:J.container)==="audio/mpeg"&&(le=!this.lastMpegAudioChunk||b.id===1||this.lastMpegAudioChunk.sn!==b.sn,this.lastMpegAudioChunk=b);var Se=g.start,we={execute:function(){if(D.executeStart=self.performance.now(),le){var be=s.sourceBuffer[p];if(be){var Pe=Se-be.timestampOffset;Math.abs(Pe)>=.1&&(w.logger.log("[buffer-controller]: Updating audio SourceBuffer timestampOffset to "+Se+" (delta: "+Pe+") sn: "+g.sn+")"),be.timestampOffset=Se)}}s.appendExecutor(u,p)},onStart:function(){},onComplete:function(){var be=self.performance.now();D.executeEnd=D.end=be,G.first===0&&(G.first=be),ee&&ee.first===0&&(ee.first=be);var Pe=s.sourceBuffer,tt={};for(var rt in Pe)tt[rt]=or.getBuffered(Pe[rt]);s.appendError=0,s.hls.trigger(E.Events.BUFFER_APPENDED,{type:p,frag:g,part:y,chunkMeta:b,parent:g.type,timeRanges:tt})},onError:function(be){w.logger.error("[buffer-controller]: Error encountered while trying to append to the "+p+" SourceBuffer",be);var Pe={type:A.ErrorTypes.MEDIA_ERROR,parent:g.type,details:A.ErrorDetails.BUFFER_APPEND_ERROR,err:be,fatal:!1};be.code===DOMException.QUOTA_EXCEEDED_ERR?Pe.details=A.ErrorDetails.BUFFER_FULL_ERROR:(s.appendError++,Pe.details=A.ErrorDetails.BUFFER_APPEND_ERROR,s.appendError>o.config.appendErrorMaxRetry&&(w.logger.error("[buffer-controller]: Failed "+o.config.appendErrorMaxRetry+" times to append segment in sourceBuffer"),Pe.fatal=!0,o.stopLoad())),o.trigger(E.Events.ERROR,Pe)}};c.append(we,p)},h.onBufferFlushing=function(t,n){var s=this,o=this.operationQueue,c=function(i){return{execute:s.removeExecutor.bind(s,i,n.startOffset,n.endOffset),onStart:function(){},onComplete:function(){s.hls.trigger(E.Events.BUFFER_FLUSHED,{type:i})},onError:function(u){w.logger.warn("[buffer-controller]: Failed to remove from "+i+" SourceBuffer",u)}}};n.type?o.append(c(n.type),n.type):this.getSourceBufferTypes().forEach(function(i){o.append(c(i),i)})},h.onFragParsed=function(t,n){var s=this,o=n.frag,c=n.part,i=[],u=c?c.elementaryStreams:o.elementaryStreams;u[ie.ElementaryStreamTypes.AUDIOVIDEO]?i.push("audiovideo"):(u[ie.ElementaryStreamTypes.AUDIO]&&i.push("audio"),u[ie.ElementaryStreamTypes.VIDEO]&&i.push("video")),i.length===0&&w.logger.warn("Fragments must have at least one ElementaryStreamType set. type: "+o.type+" level: "+o.level+" sn: "+o.sn),this.blockBuffers(function(){var p=self.performance.now();o.stats.buffering.end=p,c&&(c.stats.buffering.end=p);var g=c?c.stats:o.stats;s.hls.trigger(E.Events.FRAG_BUFFERED,{frag:o,part:c,stats:g,id:o.type})},i)},h.onFragChanged=function(t,n){this.flushBackBuffer()},h.onBufferEos=function(t,n){var s=this;this.getSourceBufferTypes().reduce(function(o,c){var i=s.sourceBuffer[c];return!i||n.type&&n.type!==c||(i.ending=!0,i.ended||(i.ended=!0,w.logger.log("[buffer-controller]: "+c+" sourceBuffer now EOS"))),o&&!(i&&!i.ended)},!0)&&(w.logger.log("[buffer-controller]: Queueing mediaSource.endOfStream()"),this.blockBuffers(function(){s.getSourceBufferTypes().forEach(function(c){var i=s.sourceBuffer[c];i&&(i.ending=!1)});var o=s.mediaSource;o&&o.readyState==="open"?(w.logger.log("[buffer-controller]: Calling mediaSource.endOfStream()"),o.endOfStream()):o&&w.logger.info("[buffer-controller]: Could not call mediaSource.endOfStream(). mediaSource.readyState: "+o.readyState)}))},h.onLevelUpdated=function(t,n){var s=n.details;s.fragments.length&&(this.details=s,this.getSourceBufferTypes().length?this.blockBuffers(this.updateMediaElementDuration.bind(this)):this.updateMediaElementDuration())},h.flushBackBuffer=function(){var t=this.hls,n=this.details,s=this.media,o=this.sourceBuffer;if(s&&n!==null){var c=this.getSourceBufferTypes();if(c.length){var i=n.live&&t.config.liveBackBufferLength!==null?t.config.liveBackBufferLength:t.config.backBufferLength;if((0,O.isFiniteNumber)(i)&&!(i<0)){var u=s.currentTime,p=n.levelTargetDuration,g=Math.max(i,p),y=Math.floor(u/p)*p-g;c.forEach(function(b){var D=o[b];if(D){var F=or.getBuffered(D);if(F.length>0&&y>F.start(0)){if(t.trigger(E.Events.BACK_BUFFER_REACHED,{bufferEnd:y}),n.live)t.trigger(E.Events.LIVE_BACK_BUFFER_REACHED,{bufferEnd:y});else if(D.ended&&F.end(F.length-1)-u<2*p)return void w.logger.info("[buffer-controller]: Cannot flush "+b+" back buffer while SourceBuffer is in ended state");t.trigger(E.Events.BUFFER_FLUSHING,{startOffset:0,endOffset:y,type:b})}}})}}}},h.updateMediaElementDuration=function(){if(this.details&&this.media&&this.mediaSource&&this.mediaSource.readyState==="open"){var t=this.details,n=this.hls,s=this.media,o=this.mediaSource,c=t.fragments[0].start+t.totalduration,i=s.duration,u=(0,O.isFiniteNumber)(o.duration)?o.duration:0;t.live&&n.config.liveDurationInfinity?(w.logger.log("[buffer-controller]: Media Source duration is set to Infinity"),o.duration=1/0,this.updateSeekableRange(t)):(c>u&&c>i||!(0,O.isFiniteNumber)(i))&&(w.logger.log("[buffer-controller]: Updating Media Source duration to "+c.toFixed(3)),o.duration=c)}},h.updateSeekableRange=function(t){var n=this.mediaSource,s=t.fragments;if(s.length&&t.live&&n!=null&&n.setLiveSeekableRange){var o=Math.max(0,s[0].start),c=Math.max(o,o+t.totalduration);n.setLiveSeekableRange(o,c)}},h.checkPendingTracks=function(){var t=this.bufferCodecEventsExpected,n=this.operationQueue,s=this.pendingTracks,o=Object.keys(s).length;if(o&&!t||o===2){this.createSourceBuffers(s),this.pendingTracks={};var c=this.getSourceBufferTypes();if(c.length===0)return void this.hls.trigger(E.Events.ERROR,{type:A.ErrorTypes.MEDIA_ERROR,details:A.ErrorDetails.BUFFER_INCOMPATIBLE_CODECS_ERROR,fatal:!0,reason:"could not create source buffer for media codec(s)"});c.forEach(function(i){n.executeNext(i)})}},h.createSourceBuffers=function(t){var n=this.sourceBuffer,s=this.mediaSource;if(!s)throw Error("createSourceBuffers called when mediaSource was null");var o=0;for(var c in t)if(!n[c]){var i=t[c];if(!i)throw Error("source buffer exists for track "+c+", however track does not");var u=i.levelCodec||i.codec,p=i.container+";codecs="+u;w.logger.log("[buffer-controller]: creating sourceBuffer("+p+")");try{var g=n[c]=s.addSourceBuffer(p),y=c;this.addBufferListener(y,"updatestart",this._onSBUpdateStart),this.addBufferListener(y,"updateend",this._onSBUpdateEnd),this.addBufferListener(y,"error",this._onSBUpdateError),this.tracks[c]={buffer:g,codec:u,container:i.container,levelCodec:i.levelCodec,metadata:i.metadata,id:i.id},o++}catch(b){w.logger.error("[buffer-controller]: error while trying to add sourceBuffer: "+b.message),this.hls.trigger(E.Events.ERROR,{type:A.ErrorTypes.MEDIA_ERROR,details:A.ErrorDetails.BUFFER_ADD_CODEC_ERROR,fatal:!1,error:b,mimeType:p})}}o&&this.hls.trigger(E.Events.BUFFER_CREATED,{tracks:this.tracks})},h._onSBUpdateStart=function(t){this.operationQueue.current(t).onStart()},h._onSBUpdateEnd=function(t){var n=this.operationQueue;n.current(t).onComplete(),n.shiftAndExecuteNext(t)},h._onSBUpdateError=function(t,n){w.logger.error("[buffer-controller]: "+t+" SourceBuffer error",n),this.hls.trigger(E.Events.ERROR,{type:A.ErrorTypes.MEDIA_ERROR,details:A.ErrorDetails.BUFFER_APPENDING_ERROR,fatal:!1});var s=this.operationQueue.current(t);s&&s.onError(n)},h.removeExecutor=function(t,n,s){var o=this.media,c=this.mediaSource,i=this.operationQueue,u=this.sourceBuffer[t];if(!o||!c||!u)return w.logger.warn("[buffer-controller]: Attempting to remove from the "+t+" SourceBuffer, but it does not exist"),void i.shiftAndExecuteNext(t);var p=(0,O.isFiniteNumber)(o.duration)?o.duration:1/0,g=(0,O.isFiniteNumber)(c.duration)?c.duration:1/0,y=Math.max(0,n),b=Math.min(s,p,g);b>y&&!u.ending?(u.ended=!1,w.logger.log("[buffer-controller]: Removing ["+y+","+b+"] from the "+t+" SourceBuffer"),u.remove(y,b)):i.shiftAndExecuteNext(t)},h.appendExecutor=function(t,n){var s=this.operationQueue,o=this.sourceBuffer[n];if(!o)return w.logger.warn("[buffer-controller]: Attempting to append to the "+n+" SourceBuffer, but it does not exist"),void s.shiftAndExecuteNext(n);o.ended=!1,o.appendBuffer(t)},h.blockBuffers=function(t,n){var s=this;if(n===void 0&&(n=this.getSourceBufferTypes()),!n.length)return w.logger.log("[buffer-controller]: Blocking operation requested, but no SourceBuffers exist"),void Promise.resolve().then(t);var o=this.operationQueue,c=n.map(function(i){return o.appendBlocker(i)});Promise.all(c).then(function(){t(),n.forEach(function(i){var u=s.sourceBuffer[i];u&&u.updating||o.shiftAndExecuteNext(i)})})},h.getSourceBufferTypes=function(){return Object.keys(this.sourceBuffer)},h.addBufferListener=function(t,n,s){var o=this.sourceBuffer[t];if(o){var c=s.bind(this,t);this.listeners[t].push({event:n,listener:c}),o.addEventListener(n,c)}},h.removeBufferListeners=function(t){var n=this.sourceBuffer[t];n&&this.listeners[t].forEach(function(s){n.removeEventListener(s.event,s.listener)})},v}(),Fn={42:225,92:233,94:237,95:243,96:250,123:231,124:247,125:209,126:241,127:9608,128:174,129:176,130:189,131:191,132:8482,133:162,134:163,135:9834,136:224,137:32,138:232,139:226,140:234,141:238,142:244,143:251,144:193,145:201,146:211,147:218,148:220,149:252,150:8216,151:161,152:42,153:8217,154:9473,155:169,156:8480,157:8226,158:8220,159:8221,160:192,161:194,162:199,163:200,164:202,165:203,166:235,167:206,168:207,169:239,170:212,171:217,172:249,173:219,174:171,175:187,176:195,177:227,178:205,179:204,180:236,181:210,182:242,183:213,184:245,185:123,186:125,187:92,188:94,189:95,190:124,191:8764,192:196,193:228,194:214,195:246,196:223,197:165,198:164,199:9475,200:197,201:229,202:216,203:248,204:9487,205:9491,206:9495,207:9499},qs=function(v){var h=v;return Fn.hasOwnProperty(v)&&(h=Fn[v]),String.fromCharCode(h)},Tn=15,Tr=100,Ga={17:1,18:3,21:5,22:7,23:9,16:11,19:12,20:14},Ka={17:2,18:4,21:6,22:8,23:10,19:13,20:15},Ha={25:1,26:3,29:5,30:7,31:9,24:11,27:12,28:14},qa={25:2,26:4,29:6,30:8,31:10,27:13,28:15},Va=["white","green","blue","cyan","red","yellow","magenta","black","transparent"];(function(v){v[v.ERROR=0]="ERROR",v[v.TEXT=1]="TEXT",v[v.WARNING=2]="WARNING",v[v.INFO=2]="INFO",v[v.DEBUG=3]="DEBUG",v[v.DATA=3]="DATA"})(Ut||(Ut={}));var Wa=function(){function v(){this.time=null,this.verboseLevel=Ut.ERROR}return v.prototype.log=function(h,t){if(this.verboseLevel>=h){var n=typeof t=="function"?t():t;w.logger.log(this.time+" ["+h+"] "+n)}},v}(),Rr=function(v){for(var h=[],t=0;t<v.length;t++)h.push(v[t].toString(16));return h},ja=function(){function v(t,n,s,o,c){this.foreground=void 0,this.underline=void 0,this.italics=void 0,this.background=void 0,this.flash=void 0,this.foreground=t||"white",this.underline=n||!1,this.italics=s||!1,this.background=o||"black",this.flash=c||!1}var h=v.prototype;return h.reset=function(){this.foreground="white",this.underline=!1,this.italics=!1,this.background="black",this.flash=!1},h.setStyles=function(t){for(var n=["foreground","underline","italics","background","flash"],s=0;s<n.length;s++){var o=n[s];t.hasOwnProperty(o)&&(this[o]=t[o])}},h.isDefault=function(){return this.foreground==="white"&&!this.underline&&!this.italics&&this.background==="black"&&!this.flash},h.equals=function(t){return this.foreground===t.foreground&&this.underline===t.underline&&this.italics===t.italics&&this.background===t.background&&this.flash===t.flash},h.copy=function(t){this.foreground=t.foreground,this.underline=t.underline,this.italics=t.italics,this.background=t.background,this.flash=t.flash},h.toString=function(){return"color="+this.foreground+", underline="+this.underline+", italics="+this.italics+", background="+this.background+", flash="+this.flash},v}(),Xr=function(){function v(t,n,s,o,c,i){this.uchar=void 0,this.penState=void 0,this.uchar=t||" ",this.penState=new ja(n,s,o,c,i)}var h=v.prototype;return h.reset=function(){this.uchar=" ",this.penState.reset()},h.setChar=function(t,n){this.uchar=t,this.penState.copy(n)},h.setPenState=function(t){this.penState.copy(t)},h.equals=function(t){return this.uchar===t.uchar&&this.penState.equals(t.penState)},h.copy=function(t){this.uchar=t.uchar,this.penState.copy(t.penState)},h.isEmpty=function(){return this.uchar===" "&&this.penState.isDefault()},v}(),ol=function(){function v(t){this.chars=void 0,this.pos=void 0,this.currPenState=void 0,this.cueStartTime=void 0,this.logger=void 0,this.chars=[];for(var n=0;n<Tr;n++)this.chars.push(new Xr);this.logger=t,this.pos=0,this.currPenState=new ja}var h=v.prototype;return h.equals=function(t){for(var n=!0,s=0;s<Tr;s++)if(!this.chars[s].equals(t.chars[s])){n=!1;break}return n},h.copy=function(t){for(var n=0;n<Tr;n++)this.chars[n].copy(t.chars[n])},h.isEmpty=function(){for(var t=!0,n=0;n<Tr;n++)if(!this.chars[n].isEmpty()){t=!1;break}return t},h.setCursor=function(t){this.pos!==t&&(this.pos=t),this.pos<0?(this.logger.log(Ut.DEBUG,"Negative cursor position "+this.pos),this.pos=0):this.pos>Tr&&(this.logger.log(Ut.DEBUG,"Too large cursor position "+this.pos),this.pos=Tr)},h.moveCursor=function(t){var n=this.pos+t;if(t>1)for(var s=this.pos+1;s<n+1;s++)this.chars[s].setPenState(this.currPenState);this.setCursor(n)},h.backSpace=function(){this.moveCursor(-1),this.chars[this.pos].setChar(" ",this.currPenState)},h.insertChar=function(t){var n=this;t>=144&&this.backSpace();var s=qs(t);this.pos>=Tr?this.logger.log(Ut.ERROR,function(){return"Cannot insert "+t.toString(16)+" ("+s+") at position "+n.pos+". Skipping it!"}):(this.chars[this.pos].setChar(s,this.currPenState),this.moveCursor(1))},h.clearFromPos=function(t){var n;for(n=t;n<Tr;n++)this.chars[n].reset()},h.clear=function(){this.clearFromPos(0),this.pos=0,this.currPenState.reset()},h.clearToEndOfRow=function(){this.clearFromPos(this.pos)},h.getTextString=function(){for(var t=[],n=!0,s=0;s<Tr;s++){var o=this.chars[s].uchar;o!==" "&&(n=!1),t.push(o)}return n?"":t.join("")},h.setPenStyles=function(t){this.currPenState.setStyles(t),this.chars[this.pos].setPenState(this.currPenState)},v}(),as=function(){function v(t){this.rows=void 0,this.currRow=void 0,this.nrRollUpRows=void 0,this.lastOutputScreen=void 0,this.logger=void 0,this.rows=[];for(var n=0;n<Tn;n++)this.rows.push(new ol(t));this.logger=t,this.currRow=14,this.nrRollUpRows=null,this.lastOutputScreen=null,this.reset()}var h=v.prototype;return h.reset=function(){for(var t=0;t<Tn;t++)this.rows[t].clear();this.currRow=14},h.equals=function(t){for(var n=!0,s=0;s<Tn;s++)if(!this.rows[s].equals(t.rows[s])){n=!1;break}return n},h.copy=function(t){for(var n=0;n<Tn;n++)this.rows[n].copy(t.rows[n])},h.isEmpty=function(){for(var t=!0,n=0;n<Tn;n++)if(!this.rows[n].isEmpty()){t=!1;break}return t},h.backSpace=function(){this.rows[this.currRow].backSpace()},h.clearToEndOfRow=function(){this.rows[this.currRow].clearToEndOfRow()},h.insertChar=function(t){this.rows[this.currRow].insertChar(t)},h.setPen=function(t){this.rows[this.currRow].setPenStyles(t)},h.moveCursor=function(t){this.rows[this.currRow].moveCursor(t)},h.setCursor=function(t){this.logger.log(Ut.INFO,"setCursor: "+t),this.rows[this.currRow].setCursor(t)},h.setPAC=function(t){this.logger.log(Ut.INFO,function(){return"pacData = "+JSON.stringify(t)});var n=t.row-1;if(this.nrRollUpRows&&n<this.nrRollUpRows-1&&(n=this.nrRollUpRows-1),this.nrRollUpRows&&this.currRow!==n){for(var s=0;s<Tn;s++)this.rows[s].clear();var o=this.currRow+1-this.nrRollUpRows,c=this.lastOutputScreen;if(c){var i=c.rows[o].cueStartTime,u=this.logger.time;if(i&&u!==null&&i<u)for(var p=0;p<this.nrRollUpRows;p++)this.rows[n-this.nrRollUpRows+p+1].copy(c.rows[o+p])}}this.currRow=n;var g=this.rows[this.currRow];if(t.indent!==null){var y=t.indent,b=Math.max(y-1,0);g.setCursor(t.indent),t.color=g.chars[b].penState.foreground}var D={foreground:t.color,underline:t.underline,italics:t.italics,background:"black",flash:!1};this.setPen(D)},h.setBkgData=function(t){this.logger.log(Ut.INFO,function(){return"bkgData = "+JSON.stringify(t)}),this.backSpace(),this.setPen(t),this.insertChar(32)},h.setRollUpRows=function(t){this.nrRollUpRows=t},h.rollUp=function(){var t=this;if(this.nrRollUpRows!==null){this.logger.log(Ut.TEXT,function(){return t.getDisplayText()});var n=this.currRow+1-this.nrRollUpRows,s=this.rows.splice(n,1)[0];s.clear(),this.rows.splice(this.currRow,0,s),this.logger.log(Ut.INFO,"Rolling up")}else this.logger.log(Ut.DEBUG,"roll_up but nrRollUpRows not set yet")},h.getDisplayText=function(t){t=t||!1;for(var n=[],s="",o=-1,c=0;c<Tn;c++){var i=this.rows[c].getTextString();i&&(o=c+1,t?n.push("Row "+o+": '"+i+"'"):n.push(i.trim()))}return n.length>0&&(s=t?"["+n.join(" | ")+"]":n.join(`
`)),s},h.getTextAndFormat=function(){return this.rows},v}(),bn=function(){function v(t,n,s){this.chNr=void 0,this.outputFilter=void 0,this.mode=void 0,this.verbose=void 0,this.displayedMemory=void 0,this.nonDisplayedMemory=void 0,this.lastOutputScreen=void 0,this.currRollUpRow=void 0,this.writeScreen=void 0,this.cueStartTime=void 0,this.logger=void 0,this.chNr=t,this.outputFilter=n,this.mode=null,this.verbose=0,this.displayedMemory=new as(s),this.nonDisplayedMemory=new as(s),this.lastOutputScreen=new as(s),this.currRollUpRow=this.displayedMemory.rows[14],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null,this.logger=s}var h=v.prototype;return h.reset=function(){this.mode=null,this.displayedMemory.reset(),this.nonDisplayedMemory.reset(),this.lastOutputScreen.reset(),this.outputFilter.reset(),this.currRollUpRow=this.displayedMemory.rows[14],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null},h.getHandler=function(){return this.outputFilter},h.setHandler=function(t){this.outputFilter=t},h.setPAC=function(t){this.writeScreen.setPAC(t)},h.setBkgData=function(t){this.writeScreen.setBkgData(t)},h.setMode=function(t){t!==this.mode&&(this.mode=t,this.logger.log(Ut.INFO,function(){return"MODE="+t}),this.mode==="MODE_POP-ON"?this.writeScreen=this.nonDisplayedMemory:(this.writeScreen=this.displayedMemory,this.writeScreen.reset()),this.mode!=="MODE_ROLL-UP"&&(this.displayedMemory.nrRollUpRows=null,this.nonDisplayedMemory.nrRollUpRows=null),this.mode=t)},h.insertChars=function(t){for(var n=this,s=0;s<t.length;s++)this.writeScreen.insertChar(t[s]);var o=this.writeScreen===this.displayedMemory?"DISP":"NON_DISP";this.logger.log(Ut.INFO,function(){return o+": "+n.writeScreen.getDisplayText(!0)}),this.mode!=="MODE_PAINT-ON"&&this.mode!=="MODE_ROLL-UP"||(this.logger.log(Ut.TEXT,function(){return"DISPLAYED: "+n.displayedMemory.getDisplayText(!0)}),this.outputDataUpdate())},h.ccRCL=function(){this.logger.log(Ut.INFO,"RCL - Resume Caption Loading"),this.setMode("MODE_POP-ON")},h.ccBS=function(){this.logger.log(Ut.INFO,"BS - BackSpace"),this.mode!=="MODE_TEXT"&&(this.writeScreen.backSpace(),this.writeScreen===this.displayedMemory&&this.outputDataUpdate())},h.ccAOF=function(){},h.ccAON=function(){},h.ccDER=function(){this.logger.log(Ut.INFO,"DER- Delete to End of Row"),this.writeScreen.clearToEndOfRow(),this.outputDataUpdate()},h.ccRU=function(t){this.logger.log(Ut.INFO,"RU("+t+") - Roll Up"),this.writeScreen=this.displayedMemory,this.setMode("MODE_ROLL-UP"),this.writeScreen.setRollUpRows(t)},h.ccFON=function(){this.logger.log(Ut.INFO,"FON - Flash On"),this.writeScreen.setPen({flash:!0})},h.ccRDC=function(){this.logger.log(Ut.INFO,"RDC - Resume Direct Captioning"),this.setMode("MODE_PAINT-ON")},h.ccTR=function(){this.logger.log(Ut.INFO,"TR"),this.setMode("MODE_TEXT")},h.ccRTD=function(){this.logger.log(Ut.INFO,"RTD"),this.setMode("MODE_TEXT")},h.ccEDM=function(){this.logger.log(Ut.INFO,"EDM - Erase Displayed Memory"),this.displayedMemory.reset(),this.outputDataUpdate(!0)},h.ccCR=function(){this.logger.log(Ut.INFO,"CR - Carriage Return"),this.writeScreen.rollUp(),this.outputDataUpdate(!0)},h.ccENM=function(){this.logger.log(Ut.INFO,"ENM - Erase Non-displayed Memory"),this.nonDisplayedMemory.reset()},h.ccEOC=function(){var t=this;if(this.logger.log(Ut.INFO,"EOC - End Of Caption"),this.mode==="MODE_POP-ON"){var n=this.displayedMemory;this.displayedMemory=this.nonDisplayedMemory,this.nonDisplayedMemory=n,this.writeScreen=this.nonDisplayedMemory,this.logger.log(Ut.TEXT,function(){return"DISP: "+t.displayedMemory.getDisplayText()})}this.outputDataUpdate(!0)},h.ccTO=function(t){this.logger.log(Ut.INFO,"TO("+t+") - Tab Offset"),this.writeScreen.moveCursor(t)},h.ccMIDROW=function(t){var n={flash:!1};if(n.underline=t%2==1,n.italics=t>=46,n.italics)n.foreground="white";else{var s=Math.floor(t/2)-16;n.foreground=["white","green","blue","cyan","red","yellow","magenta"][s]}this.logger.log(Ut.INFO,"MIDROW: "+JSON.stringify(n)),this.writeScreen.setPen(n)},h.outputDataUpdate=function(t){t===void 0&&(t=!1);var n=this.logger.time;n!==null&&this.outputFilter&&(this.cueStartTime!==null||this.displayedMemory.isEmpty()?this.displayedMemory.equals(this.lastOutputScreen)||(this.outputFilter.newCue(this.cueStartTime,n,this.lastOutputScreen),t&&this.outputFilter.dispatchCue&&this.outputFilter.dispatchCue(),this.cueStartTime=this.displayedMemory.isEmpty()?null:n):this.cueStartTime=n,this.lastOutputScreen.copy(this.displayedMemory))},h.cueSplitAtTime=function(t){this.outputFilter&&(this.displayedMemory.isEmpty()||(this.outputFilter.newCue&&this.outputFilter.newCue(this.cueStartTime,t,this.displayedMemory),this.cueStartTime=t))},v}(),os=function(){function v(t,n,s){this.channels=void 0,this.currentChannel=0,this.cmdHistory=void 0,this.logger=void 0;var o=new Wa;this.channels=[null,new bn(t,n,o),new bn(t+1,s,o)],this.cmdHistory={a:null,b:null},this.logger=o}var h=v.prototype;return h.getHandler=function(t){return this.channels[t].getHandler()},h.setHandler=function(t,n){this.channels[t].setHandler(n)},h.addData=function(t,n){var s,o,c,i=!1;this.logger.time=t;for(var u=0;u<n.length;u+=2)if(o=127&n[u],c=127&n[u+1],o!==0||c!==0){if(this.logger.log(Ut.DATA,"["+Rr([n[u],n[u+1]])+"] -> ("+Rr([o,c])+")"),(s=this.parseCmd(o,c))||(s=this.parseMidrow(o,c)),s||(s=this.parsePAC(o,c)),s||(s=this.parseBackgroundAttributes(o,c)),!s&&(i=this.parseChars(o,c))){var p=this.currentChannel;p&&p>0?this.channels[p].insertChars(i):this.logger.log(Ut.WARNING,"No channel found yet. TEXT-MODE?")}s||i||this.logger.log(Ut.WARNING,"Couldn't parse cleaned data "+Rr([o,c])+" orig: "+Rr([n[u],n[u+1]]))}},h.parseCmd=function(t,n){var s=this.cmdHistory;if(!((t===20||t===28||t===21||t===29)&&n>=32&&n<=47||(t===23||t===31)&&n>=33&&n<=35))return!1;if(ar(t,n,s))return Mn(null,null,s),this.logger.log(Ut.DEBUG,"Repeated command ("+Rr([t,n])+") is dropped"),!0;var o=t===20||t===21||t===23?1:2,c=this.channels[o];return t===20||t===21||t===28||t===29?n===32?c.ccRCL():n===33?c.ccBS():n===34?c.ccAOF():n===35?c.ccAON():n===36?c.ccDER():n===37?c.ccRU(2):n===38?c.ccRU(3):n===39?c.ccRU(4):n===40?c.ccFON():n===41?c.ccRDC():n===42?c.ccTR():n===43?c.ccRTD():n===44?c.ccEDM():n===45?c.ccCR():n===46?c.ccENM():n===47&&c.ccEOC():c.ccTO(n-32),Mn(t,n,s),this.currentChannel=o,!0},h.parseMidrow=function(t,n){var s=0;if((t===17||t===25)&&n>=32&&n<=47){if((s=t===17?1:2)!==this.currentChannel)return this.logger.log(Ut.ERROR,"Mismatch channel in midrow parsing"),!1;var o=this.channels[s];return!!o&&(o.ccMIDROW(n),this.logger.log(Ut.DEBUG,"MIDROW ("+Rr([t,n])+")"),!0)}return!1},h.parsePAC=function(t,n){var s,o=this.cmdHistory;if(!((t>=17&&t<=23||t>=25&&t<=31)&&n>=64&&n<=127||(t===16||t===24)&&n>=64&&n<=95))return!1;if(ar(t,n,o))return Mn(null,null,o),!0;var c=t<=23?1:2;s=n>=64&&n<=95?c===1?Ga[t]:Ha[t]:c===1?Ka[t]:qa[t];var i=this.channels[c];return!!i&&(i.setPAC(this.interpretPAC(s,n)),Mn(t,n,o),this.currentChannel=c,!0)},h.interpretPAC=function(t,n){var s,o={color:null,italics:!1,indent:null,underline:!1,row:t};return s=n>95?n-96:n-64,o.underline=(1&s)==1,s<=13?o.color=["white","green","blue","cyan","red","yellow","magenta","white"][Math.floor(s/2)]:s<=15?(o.italics=!0,o.color="white"):o.indent=4*Math.floor((s-16)/2),o},h.parseChars=function(t,n){var s,o,c=null,i=null;if(t>=25?(s=2,i=t-8):(s=1,i=t),i>=17&&i<=19?(o=i===17?n+80:i===18?n+112:n+144,this.logger.log(Ut.INFO,"Special char '"+qs(o)+"' in channel "+s),c=[o]):t>=32&&t<=127&&(c=n===0?[t]:[t,n]),c){var u=Rr(c);this.logger.log(Ut.DEBUG,"Char codes =  "+u.join(",")),Mn(t,n,this.cmdHistory)}return c},h.parseBackgroundAttributes=function(t,n){var s;if(!((t===16||t===24)&&n>=32&&n<=47||(t===23||t===31)&&n>=45&&n<=47))return!1;var o={};t===16||t===24?(s=Math.floor((n-32)/2),o.background=Va[s],n%2==1&&(o.background=o.background+"_semi")):n===45?o.background="transparent":(o.foreground="black",n===47&&(o.underline=!0));var c=t<=23?1:2;return this.channels[c].setBkgData(o),Mn(t,n,this.cmdHistory),!0},h.reset=function(){for(var t=0;t<Object.keys(this.channels).length;t++){var n=this.channels[t];n&&n.reset()}this.cmdHistory={a:null,b:null}},h.cueSplitAtTime=function(t){for(var n=0;n<this.channels.length;n++){var s=this.channels[n];s&&s.cueSplitAtTime(t)}},v}();function Mn(v,h,t){t.a=v,t.b=h}function ar(v,h,t){return t.a===v&&t.b===h}const Sn=os;var gi=function(){function v(t,n){this.timelineController=void 0,this.cueRanges=[],this.trackName=void 0,this.startTime=null,this.endTime=null,this.screen=null,this.timelineController=t,this.trackName=n}var h=v.prototype;return h.dispatchCue=function(){this.startTime!==null&&(this.timelineController.addCues(this.trackName,this.startTime,this.endTime,this.screen,this.cueRanges),this.startTime=null)},h.newCue=function(t,n,s){(this.startTime===null||this.startTime>t)&&(this.startTime=t),this.endTime=n,this.screen=s,this.timelineController.createCaptionsTrack(this.trackName)},h.reset=function(){this.cueRanges=[],this.startTime=null},v}();const Vs=function(){if(typeof self<"u"&&self.VTTCue)return self.VTTCue;var v=["","lr","rl"],h=["start","middle","end","left","right"];function t(c,i){if(typeof i!="string"||!Array.isArray(c))return!1;var u=i.toLowerCase();return!!~c.indexOf(u)&&u}function n(c){return t(h,c)}function s(c){for(var i=arguments.length,u=new Array(i>1?i-1:0),p=1;p<i;p++)u[p-1]=arguments[p];for(var g=1;g<arguments.length;g++){var y=arguments[g];for(var b in y)c[b]=y[b]}return c}function o(c,i,u){var p=this,g={enumerable:!0};p.hasBeenReset=!1;var y="",b=!1,D=c,F=i,G=u,ee=null,J="",le=!0,Se="auto",we="start",be=50,Pe="middle",tt=50,rt="middle";Object.defineProperty(p,"id",s({},g,{get:function(){return y},set:function(Ge){y=""+Ge}})),Object.defineProperty(p,"pauseOnExit",s({},g,{get:function(){return b},set:function(Ge){b=!!Ge}})),Object.defineProperty(p,"startTime",s({},g,{get:function(){return D},set:function(Ge){if(typeof Ge!="number")throw new TypeError("Start time must be set to a number.");D=Ge,this.hasBeenReset=!0}})),Object.defineProperty(p,"endTime",s({},g,{get:function(){return F},set:function(Ge){if(typeof Ge!="number")throw new TypeError("End time must be set to a number.");F=Ge,this.hasBeenReset=!0}})),Object.defineProperty(p,"text",s({},g,{get:function(){return G},set:function(Ge){G=""+Ge,this.hasBeenReset=!0}})),Object.defineProperty(p,"region",s({},g,{get:function(){return ee},set:function(Ge){ee=Ge,this.hasBeenReset=!0}})),Object.defineProperty(p,"vertical",s({},g,{get:function(){return J},set:function(Ge){var Je=function(Qe){return t(v,Qe)}(Ge);if(Je===!1)throw new SyntaxError("An invalid or illegal string was specified.");J=Je,this.hasBeenReset=!0}})),Object.defineProperty(p,"snapToLines",s({},g,{get:function(){return le},set:function(Ge){le=!!Ge,this.hasBeenReset=!0}})),Object.defineProperty(p,"line",s({},g,{get:function(){return Se},set:function(Ge){if(typeof Ge!="number"&&Ge!=="auto")throw new SyntaxError("An invalid number or illegal string was specified.");Se=Ge,this.hasBeenReset=!0}})),Object.defineProperty(p,"lineAlign",s({},g,{get:function(){return we},set:function(Ge){var Je=n(Ge);if(!Je)throw new SyntaxError("An invalid or illegal string was specified.");we=Je,this.hasBeenReset=!0}})),Object.defineProperty(p,"position",s({},g,{get:function(){return be},set:function(Ge){if(Ge<0||Ge>100)throw new Error("Position must be between 0 and 100.");be=Ge,this.hasBeenReset=!0}})),Object.defineProperty(p,"positionAlign",s({},g,{get:function(){return Pe},set:function(Ge){var Je=n(Ge);if(!Je)throw new SyntaxError("An invalid or illegal string was specified.");Pe=Je,this.hasBeenReset=!0}})),Object.defineProperty(p,"size",s({},g,{get:function(){return tt},set:function(Ge){if(Ge<0||Ge>100)throw new Error("Size must be between 0 and 100.");tt=Ge,this.hasBeenReset=!0}})),Object.defineProperty(p,"align",s({},g,{get:function(){return rt},set:function(Ge){var Je=n(Ge);if(!Je)throw new SyntaxError("An invalid or illegal string was specified.");rt=Je,this.hasBeenReset=!0}})),p.displayState=void 0}return o.prototype.getCueAsHTML=function(){return self.WebVTT.convertCueToDOMTree(self,this.text)},o}();var Ws=function(){function v(){}return v.prototype.decode=function(h,t){if(!h)return"";if(typeof h!="string")throw new Error("Error - expected string data.");return decodeURIComponent(encodeURIComponent(h))},v}();function Ya(v){function h(n,s,o,c){return 3600*(0|n)+60*(0|s)+(0|o)+parseFloat(c||0)}var t=v.match(/^(?:(\d+):)?(\d{2}):(\d{2})(\.\d+)?/);return t?parseFloat(t[2])>59?h(t[2],t[3],0,t[4]):h(t[1],t[2],t[3],t[4]):null}var ll=function(){function v(){this.values=Object.create(null)}var h=v.prototype;return h.set=function(t,n){this.get(t)||n===""||(this.values[t]=n)},h.get=function(t,n,s){return s?this.has(t)?this.values[t]:n[s]:this.has(t)?this.values[t]:n},h.has=function(t){return t in this.values},h.alt=function(t,n,s){for(var o=0;o<s.length;++o)if(n===s[o]){this.set(t,n);break}},h.integer=function(t,n){/^-?\d+$/.test(n)&&this.set(t,parseInt(n,10))},h.percent=function(t,n){if(/^([\d]{1,3})(\.[\d]*)?%$/.test(n)){var s=parseFloat(n);if(s>=0&&s<=100)return this.set(t,s),!0}return!1},v}();function za(v,h,t,n){var s=n?v.split(n):[v];for(var o in s)if(typeof s[o]=="string"){var c=s[o].split(t);c.length===2&&h(c[0],c[1])}}var ls=new Vs(0,0,""),Yn=ls.align==="middle"?"middle":"center";function vi(v,h,t){var n=v;function s(){var c=Ya(v);if(c===null)throw new Error("Malformed timestamp: "+n);return v=v.replace(/^[^\sa-zA-Z-]+/,""),c}function o(){v=v.replace(/^\s+/,"")}if(o(),h.startTime=s(),o(),v.slice(0,3)!=="-->")throw new Error("Malformed time stamp (time stamps must be separated by '-->'): "+n);v=v.slice(3),o(),h.endTime=s(),o(),function(c,i){var u=new ll;za(c,function(y,b){var D;switch(y){case"region":for(var F=t.length-1;F>=0;F--)if(t[F].id===b){u.set(y,t[F].region);break}break;case"vertical":u.alt(y,b,["rl","lr"]);break;case"line":D=b.split(","),u.integer(y,D[0]),u.percent(y,D[0])&&u.set("snapToLines",!1),u.alt(y,D[0],["auto"]),D.length===2&&u.alt("lineAlign",D[1],["start",Yn,"end"]);break;case"position":D=b.split(","),u.percent(y,D[0]),D.length===2&&u.alt("positionAlign",D[1],["start",Yn,"end","line-left","line-right","auto"]);break;case"size":u.percent(y,b);break;case"align":u.alt(y,b,["start",Yn,"end","left","right"])}},/:/,/\s/),i.region=u.get("region",null),i.vertical=u.get("vertical","");var p=u.get("line","auto");p==="auto"&&ls.line===-1&&(p=-1),i.line=p,i.lineAlign=u.get("lineAlign","start"),i.snapToLines=u.get("snapToLines",!0),i.size=u.get("size",100),i.align=u.get("align",Yn);var g=u.get("position","auto");g==="auto"&&ls.position===50&&(g=i.align==="start"||i.align==="left"?0:i.align==="end"||i.align==="right"?100:50),i.position=g}(v,h)}function Qa(v){return v.replace(/<br(?: \/)?>/gi,`
`)}var Xa=function(){function v(){this.state="INITIAL",this.buffer="",this.decoder=new Ws,this.regionList=[],this.cue=null,this.oncue=void 0,this.onparsingerror=void 0,this.onflush=void 0}var h=v.prototype;return h.parse=function(t){var n=this;function s(){var p=n.buffer,g=0;for(p=Qa(p);g<p.length&&p[g]!=="\r"&&p[g]!==`
`;)++g;var y=p.slice(0,g);return p[g]==="\r"&&++g,p[g]===`
`&&++g,n.buffer=p.slice(g),y}t&&(n.buffer+=n.decoder.decode(t,{stream:!0}));try{var o="";if(n.state==="INITIAL"){if(!/\r\n|\n/.test(n.buffer))return this;var c=(o=s()).match(/^(ï»¿)?WEBVTT([ \t].*)?$/);if(!c||!c[0])throw new Error("Malformed WebVTT signature.");n.state="HEADER"}for(var i=!1;n.buffer;){if(!/\r\n|\n/.test(n.buffer))return this;switch(i?i=!1:o=s(),n.state){case"HEADER":/:/.test(o)?za(o,function(p,g){},/:/):o||(n.state="ID");continue;case"NOTE":o||(n.state="ID");continue;case"ID":if(/^NOTE($|[ \t])/.test(o)){n.state="NOTE";break}if(!o)continue;if(n.cue=new Vs(0,0,""),n.state="CUE",o.indexOf("-->")===-1){n.cue.id=o;continue}case"CUE":if(!n.cue){n.state="BADCUE";continue}try{vi(o,n.cue,n.regionList)}catch{n.cue=null,n.state="BADCUE";continue}n.state="CUETEXT";continue;case"CUETEXT":var u=o.indexOf("-->")!==-1;if(!o||u&&(i=!0)){n.oncue&&n.cue&&n.oncue(n.cue),n.cue=null,n.state="ID";continue}if(n.cue===null)continue;n.cue.text&&(n.cue.text+=`
`),n.cue.text+=o;continue;case"BADCUE":o||(n.state="ID")}}}catch{n.state==="CUETEXT"&&n.cue&&n.oncue&&n.oncue(n.cue),n.cue=null,n.state=n.state==="INITIAL"?"BADWEBVTT":"BADCUE"}return this},h.flush=function(){var t=this;try{if((t.cue||t.state==="HEADER")&&(t.buffer+=`

`,t.parse()),t.state==="INITIAL"||t.state==="BADWEBVTT")throw new Error("Malformed WebVTT signature.")}catch(n){t.onparsingerror&&t.onparsingerror(n)}return t.onflush&&t.onflush(),this},v}(),js=k(673),Ys=k(524),zs=/\r\n|\n\r|\n|\r/g,us=function(v,h,t){return t===void 0&&(t=0),v.slice(t,t+h.length)===h},Qs=function(v){for(var h=5381,t=v.length;t;)h=33*h^v.charCodeAt(--t);return(h>>>0).toString()};function Fi(v,h,t){return Qs(v.toString())+Qs(h.toString())+Qs(t)}function Mi(){return Mi=Object.assign?Object.assign.bind():function(v){for(var h=1;h<arguments.length;h++){var t=arguments[h];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(v[n]=t[n])}return v},Mi.apply(this,arguments)}var Xs="stpp.ttml.im1t",Zs=/^(\d{2,}):(\d{2}):(\d{2}):(\d{2})\.?(\d+)?$/,Hr=/^(\d*(?:\.\d*)?)(h|m|s|ms|f|t)$/,Js={left:"start",center:"center",right:"end",start:"start",end:"end"};function mi(v,h,t,n,s){var o=(0,Ee.findBox)(new Uint8Array(v),["mdat"]);if(o.length!==0){var c=o.map(function(u){return(0,Rt.utf8ArrayToStr)(u)}),i=(0,js.toTimescaleFromScale)(h,1,t);try{c.forEach(function(u){return n(function(p,g){var y=new DOMParser().parseFromString(p,"text/xml").getElementsByTagName("tt")[0];if(!y)throw new Error("Invalid ttml");var b={frameRate:30,subFrameRate:1,frameRateMultiplier:0,tickRate:0},D=Object.keys(b).reduce(function(le,Se){return le[Se]=y.getAttribute("ttp:"+Se)||b[Se],le},{}),F=y.getAttribute("xml:space")!=="preserve",G=$s(cs(y,"styling","style")),ee=$s(cs(y,"layout","region")),J=cs(y,"body","[begin]");return[].map.call(J,function(le){var Se=Za(le,F);if(!Se||!le.hasAttribute("begin"))return null;var we=ta(le.getAttribute("begin"),D),be=ta(le.getAttribute("dur"),D),Pe=ta(le.getAttribute("end"),D);if(we===null)throw Ja(le);if(Pe===null){if(be===null)throw Ja(le);Pe=we+be}var tt=new Vs(we-g,Pe-g,Se);tt.id=Fi(tt.startTime,tt.endTime,tt.text);var rt=function(Qe,Dt,Vt){var St="http://www.w3.org/ns/ttml#styling",wt=null,Mt=Qe!=null&&Qe.hasAttribute("style")?Qe.getAttribute("style"):null;return Mt&&Vt.hasOwnProperty(Mt)&&(wt=Vt[Mt]),["displayAlign","textAlign","color","backgroundColor","fontSize","fontFamily"].reduce(function(pr,gr){var lr=ea(Dt,St,gr)||ea(Qe,St,gr)||ea(wt,St,gr);return lr&&(pr[gr]=lr),pr},{})}(ee[le.getAttribute("region")],G[le.getAttribute("style")],G),Ge=rt.textAlign;if(Ge){var Je=Js[Ge];Je&&(tt.lineAlign=Je),tt.align=Ge}return Mi(tt,rt),tt}).filter(function(le){return le!==null})}(u,i))})}catch(u){s(u)}}else s(new Error("Could not parse IMSC1 mdat"))}function cs(v,h,t){var n=v.getElementsByTagName(h)[0];return n?[].slice.call(n.querySelectorAll(t)):[]}function $s(v){return v.reduce(function(h,t){var n=t.getAttribute("xml:id");return n&&(h[n]=t),h},{})}function Za(v,h){return[].slice.call(v.childNodes).reduce(function(t,n,s){var o;return n.nodeName==="br"&&s?t+`
`:(o=n.childNodes)!==null&&o!==void 0&&o.length?Za(n,h):h?t+n.textContent.trim().replace(/\s+/g," "):t+n.textContent},"")}function ea(v,h,t){return v&&v.hasAttributeNS(h,t)?v.getAttributeNS(h,t):null}function Ja(v){return new Error("Could not parse ttml timestamp "+v)}function ta(v,h){if(!v)return null;var t=Ya(v);return t===null&&(Zs.test(v)?t=function(n,s){var o=Zs.exec(n),c=(0|o[4])+(0|o[5])/s.subFrameRate;return 3600*(0|o[1])+60*(0|o[2])+(0|o[3])+c/s.frameRate}(v,h):Hr.test(v)&&(t=function(n,s){var o=Hr.exec(n),c=Number(o[1]);switch(o[2]){case"h":return 3600*c;case"m":return 60*c;case"ms":return 1e3*c;case"f":return c/s.frameRate;case"t":return c/s.tickRate}return c}(v,h))),t}var ul=function(){function v(t){if(this.hls=void 0,this.media=null,this.config=void 0,this.enabled=!0,this.Cues=void 0,this.textTracks=[],this.tracks=[],this.initPTS=[],this.timescale=[],this.unparsedVttFrags=[],this.captionsTracks={},this.nonNativeCaptionsTracks={},this.cea608Parser1=void 0,this.cea608Parser2=void 0,this.lastSn=-1,this.lastPartIndex=-1,this.prevCC=-1,this.vttCCs={ccOffset:0,presentationOffset:0,0:{start:0,prevCC:-1,new:!0}},this.captionsProperties=void 0,this.hls=t,this.config=t.config,this.Cues=t.config.cueHandler,this.captionsProperties={textTrack1:{label:this.config.captionsTextTrack1Label,languageCode:this.config.captionsTextTrack1LanguageCode},textTrack2:{label:this.config.captionsTextTrack2Label,languageCode:this.config.captionsTextTrack2LanguageCode},textTrack3:{label:this.config.captionsTextTrack3Label,languageCode:this.config.captionsTextTrack3LanguageCode},textTrack4:{label:this.config.captionsTextTrack4Label,languageCode:this.config.captionsTextTrack4LanguageCode}},this.config.enableCEA708Captions){var n=new gi(this,"textTrack1"),s=new gi(this,"textTrack2"),o=new gi(this,"textTrack3"),c=new gi(this,"textTrack4");this.cea608Parser1=new Sn(1,n,s),this.cea608Parser2=new Sn(3,o,c)}t.on(E.Events.MEDIA_ATTACHING,this.onMediaAttaching,this),t.on(E.Events.MEDIA_DETACHING,this.onMediaDetaching,this),t.on(E.Events.MANIFEST_LOADING,this.onManifestLoading,this),t.on(E.Events.MANIFEST_LOADED,this.onManifestLoaded,this),t.on(E.Events.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),t.on(E.Events.FRAG_LOADING,this.onFragLoading,this),t.on(E.Events.FRAG_LOADED,this.onFragLoaded,this),t.on(E.Events.FRAG_PARSING_USERDATA,this.onFragParsingUserdata,this),t.on(E.Events.FRAG_DECRYPTED,this.onFragDecrypted,this),t.on(E.Events.INIT_PTS_FOUND,this.onInitPtsFound,this),t.on(E.Events.SUBTITLE_TRACKS_CLEARED,this.onSubtitleTracksCleared,this),t.on(E.Events.BUFFER_FLUSHING,this.onBufferFlushing,this)}var h=v.prototype;return h.destroy=function(){var t=this.hls;t.off(E.Events.MEDIA_ATTACHING,this.onMediaAttaching,this),t.off(E.Events.MEDIA_DETACHING,this.onMediaDetaching,this),t.off(E.Events.MANIFEST_LOADING,this.onManifestLoading,this),t.off(E.Events.MANIFEST_LOADED,this.onManifestLoaded,this),t.off(E.Events.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),t.off(E.Events.FRAG_LOADING,this.onFragLoading,this),t.off(E.Events.FRAG_LOADED,this.onFragLoaded,this),t.off(E.Events.FRAG_PARSING_USERDATA,this.onFragParsingUserdata,this),t.off(E.Events.FRAG_DECRYPTED,this.onFragDecrypted,this),t.off(E.Events.INIT_PTS_FOUND,this.onInitPtsFound,this),t.off(E.Events.SUBTITLE_TRACKS_CLEARED,this.onSubtitleTracksCleared,this),t.off(E.Events.BUFFER_FLUSHING,this.onBufferFlushing,this),this.hls=this.config=this.cea608Parser1=this.cea608Parser2=null},h.addCues=function(t,n,s,o,c){for(var i,u,p,g,y=!1,b=c.length;b--;){var D=c[b],F=(i=D[0],u=D[1],p=n,g=s,Math.min(u,g)-Math.max(i,p));if(F>=0&&(D[0]=Math.min(D[0],n),D[1]=Math.max(D[1],s),y=!0,F/(s-n)>.5))return}if(y||c.push([n,s]),this.config.renderTextTracksNatively){var G=this.captionsTracks[t];this.Cues.newCue(G,n,s,o)}else{var ee=this.Cues.newCue(null,n,s,o);this.hls.trigger(E.Events.CUES_PARSED,{type:"captions",cues:ee,track:t})}},h.onInitPtsFound=function(t,n){var s=this,o=n.frag,c=n.id,i=n.initPTS,u=n.timescale,p=this.unparsedVttFrags;c==="main"&&(this.initPTS[o.cc]=i,this.timescale[o.cc]=u),p.length&&(this.unparsedVttFrags=[],p.forEach(function(g){s.onFragLoaded(E.Events.FRAG_LOADED,g)}))},h.getExistingTrack=function(t){var n=this.media;if(n)for(var s=0;s<n.textTracks.length;s++){var o=n.textTracks[s];if(o[t])return o}return null},h.createCaptionsTrack=function(t){this.config.renderTextTracksNatively?this.createNativeTrack(t):this.createNonNativeTrack(t)},h.createNativeTrack=function(t){if(!this.captionsTracks[t]){var n=this.captionsProperties,s=this.captionsTracks,o=this.media,c=n[t],i=c.label,u=c.languageCode,p=this.getExistingTrack(t);if(p)s[t]=p,Pt(s[t]),nt(s[t],o);else{var g=this.createTextTrack("captions",i,u);g&&(g[t]=!0,s[t]=g)}}},h.createNonNativeTrack=function(t){if(!this.nonNativeCaptionsTracks[t]){var n=this.captionsProperties[t];if(n){var s={_id:t,label:n.label,kind:"captions",default:!!n.media&&!!n.media.default,closedCaptions:n.media};this.nonNativeCaptionsTracks[t]=s,this.hls.trigger(E.Events.NON_NATIVE_TEXT_TRACKS_FOUND,{tracks:[s]})}}},h.createTextTrack=function(t,n,s){var o=this.media;if(o)return o.addTextTrack(t,n,s)},h.onMediaAttaching=function(t,n){this.media=n.media,this._cleanTracks()},h.onMediaDetaching=function(){var t=this.captionsTracks;Object.keys(t).forEach(function(n){Pt(t[n]),delete t[n]}),this.nonNativeCaptionsTracks={}},h.onManifestLoading=function(){this.lastSn=-1,this.lastPartIndex=-1,this.prevCC=-1,this.vttCCs={ccOffset:0,presentationOffset:0,0:{start:0,prevCC:-1,new:!0}},this._cleanTracks(),this.tracks=[],this.captionsTracks={},this.nonNativeCaptionsTracks={},this.textTracks=[],this.unparsedVttFrags=this.unparsedVttFrags||[],this.initPTS=[],this.timescale=[],this.cea608Parser1&&this.cea608Parser2&&(this.cea608Parser1.reset(),this.cea608Parser2.reset())},h._cleanTracks=function(){var t=this.media;if(t){var n=t.textTracks;if(n)for(var s=0;s<n.length;s++)Pt(n[s])}},h.onSubtitleTracksUpdated=function(t,n){var s=this;this.textTracks=[];var o=n.subtitleTracks||[],c=o.some(function(g){return g.textCodec===Xs});if(this.config.enableWebVTT||c&&this.config.enableIMSC1){var i=this.tracks&&o&&this.tracks.length===o.length;if(this.tracks=o||[],this.config.renderTextTracksNatively){var u=this.media?this.media.textTracks:[];this.tracks.forEach(function(g,y){var b;if(y<u.length){for(var D=null,F=0;F<u.length;F++)if(yi(u[F],g)){D=u[F];break}D&&(b=D)}if(b)Pt(b);else{var G=s._captionsOrSubtitlesFromCharacteristics(g);(b=s.createTextTrack(G,g.name,g.lang))&&(b.mode="disabled")}b&&(b.groupId=g.groupId,s.textTracks.push(b))})}else if(!i&&this.tracks&&this.tracks.length){var p=this.tracks.map(function(g){return{label:g.name,kind:g.type.toLowerCase(),default:g.default,subtitleTrack:g}});this.hls.trigger(E.Events.NON_NATIVE_TEXT_TRACKS_FOUND,{tracks:p})}}},h._captionsOrSubtitlesFromCharacteristics=function(t){var n;if((n=t.attrs)!==null&&n!==void 0&&n.CHARACTERISTICS){var s=/transcribes-spoken-dialog/gi.test(t.attrs.CHARACTERISTICS),o=/describes-music-and-sound/gi.test(t.attrs.CHARACTERISTICS);if(s&&o)return"captions"}return"subtitles"},h.onManifestLoaded=function(t,n){var s=this;this.config.enableCEA708Captions&&n.captions&&n.captions.forEach(function(o){var c=/(?:CC|SERVICE)([1-4])/.exec(o.instreamId);if(c){var i="textTrack"+c[1],u=s.captionsProperties[i];u&&(u.label=o.name,o.lang&&(u.languageCode=o.lang),u.media=o)}})},h.closedCaptionsForLevel=function(t){var n=this.hls.levels[t.level];return n==null?void 0:n.attrs["CLOSED-CAPTIONS"]},h.onFragLoading=function(t,n){var s=this.cea608Parser1,o=this.cea608Parser2,c=this.lastSn,i=this.lastPartIndex;if(this.enabled&&s&&o&&n.frag.type===ue.PlaylistLevelType.MAIN){var u,p,g=n.frag.sn,y=(u=n==null||(p=n.part)===null||p===void 0?void 0:p.index)!=null?u:-1;g===c+1||g===c&&y===i+1||(s.reset(),o.reset()),this.lastSn=g,this.lastPartIndex=y}},h.onFragLoaded=function(t,n){var s=n.frag,o=n.payload,c=this.initPTS,i=this.unparsedVttFrags;if(s.type===ue.PlaylistLevelType.SUBTITLE)if(o.byteLength){if(!(0,O.isFiniteNumber)(c[s.cc]))return i.push(n),void(c.length&&this.hls.trigger(E.Events.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:s,error:new Error("Missing initial subtitle PTS")}));var u=s.decryptdata,p="stats"in n;if(u==null||!u.encrypted||p){var g=this.tracks[s.level],y=this.vttCCs;y[s.cc]||(y[s.cc]={start:s.start,prevCC:this.prevCC,new:!0},this.prevCC=s.cc),g&&g.textCodec===Xs?this._parseIMSC1(s,o):this._parseVTTs(s,o,y)}}else this.hls.trigger(E.Events.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:s,error:new Error("Empty subtitle payload")})},h._parseIMSC1=function(t,n){var s=this,o=this.hls;mi(n,this.initPTS[t.cc],this.timescale[t.cc],function(c){s._appendCues(c,t.level),o.trigger(E.Events.SUBTITLE_FRAG_PROCESSED,{success:!0,frag:t})},function(c){w.logger.log("Failed to parse IMSC1: "+c),o.trigger(E.Events.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:t,error:c})})},h._parseVTTs=function(t,n,s){var o,c=this,i=this.hls;(function(u,p,g,y,b,D,F,G){var ee,J=new Xa,le=(0,Rt.utf8ArrayToStr)(new Uint8Array(u)).trim().replace(zs,`
`).split(`
`),Se=[],we=(0,js.toMpegTsClockFromTimescale)(p,g),be="00:00.000",Pe=0,tt=0,rt=!0;J.oncue=function(Ge){var Je=y[b],Qe=y.ccOffset,Dt=(Pe-we)/9e4;Je!=null&&Je.new&&(tt!==void 0?Qe=y.ccOffset=Je.start:function(Mt,pr,gr){var lr=Mt[pr],dr=Mt[lr.prevCC];if(!dr||!dr.new&&lr.new)return Mt.ccOffset=Mt.presentationOffset=lr.start,void(lr.new=!1);for(;(wn=dr)!==null&&wn!==void 0&&wn.new;){var wn;Mt.ccOffset+=lr.start-dr.start,lr.new=!1,dr=Mt[(lr=dr).prevCC]}Mt.presentationOffset=gr}(y,b,Dt)),Dt&&(Qe=Dt-y.presentationOffset);var Vt=Ge.endTime-Ge.startTime,St=(0,Ys.normalizePts)(9e4*(Ge.startTime+Qe-tt),9e4*D)/9e4;Ge.startTime=Math.max(St,0),Ge.endTime=Math.max(St+Vt,0);var wt=Ge.text.trim();Ge.text=decodeURIComponent(encodeURIComponent(wt)),Ge.id||(Ge.id=Fi(Ge.startTime,Ge.endTime,wt)),Ge.endTime>0&&Se.push(Ge)},J.onparsingerror=function(Ge){ee=Ge},J.onflush=function(){ee?G(ee):F(Se)},le.forEach(function(Ge){if(rt){if(us(Ge,"X-TIMESTAMP-MAP=")){rt=!1,Ge.slice(16).split(",").forEach(function(Je){us(Je,"LOCAL:")?be=Je.slice(6):us(Je,"MPEGTS:")&&(Pe=parseInt(Je.slice(7)))});try{tt=function(Je){var Qe=parseInt(Je.slice(-3)),Dt=parseInt(Je.slice(-6,-4)),Vt=parseInt(Je.slice(-9,-7)),St=Je.length>9?parseInt(Je.substring(0,Je.indexOf(":"))):0;if(!((0,O.isFiniteNumber)(Qe)&&(0,O.isFiniteNumber)(Dt)&&(0,O.isFiniteNumber)(Vt)&&(0,O.isFiniteNumber)(St)))throw Error("Malformed X-TIMESTAMP-MAP: Local:"+Je);return Qe+=1e3*Dt,(Qe+=6e4*Vt)+36e5*St}(be)/1e3}catch(Je){ee=Je}return}Ge===""&&(rt=!1)}J.parse(Ge+`
`)}),J.flush()})((o=t.initSegment)!==null&&o!==void 0&&o.data?(0,Ee.appendUint8Array)(t.initSegment.data,new Uint8Array(n)):n,this.initPTS[t.cc],this.timescale[t.cc],s,t.cc,t.start,function(u){c._appendCues(u,t.level),i.trigger(E.Events.SUBTITLE_FRAG_PROCESSED,{success:!0,frag:t})},function(u){c._fallbackToIMSC1(t,n),w.logger.log("Failed to parse VTT cue: "+u),i.trigger(E.Events.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:t,error:u})})},h._fallbackToIMSC1=function(t,n){var s=this,o=this.tracks[t.level];o.textCodec||mi(n,this.initPTS[t.cc],this.timescale[t.cc],function(){o.textCodec=Xs,s._parseIMSC1(t,n)},function(){o.textCodec="wvtt"})},h._appendCues=function(t,n){var s=this.hls;if(this.config.renderTextTracksNatively){var o=this.textTracks[n];if(!o||o.mode==="disabled")return;t.forEach(function(u){return ht(o,u)})}else{var c=this.tracks[n];if(!c)return;var i=c.default?"default":"subtitles"+n;s.trigger(E.Events.CUES_PARSED,{type:"subtitles",cues:t,track:i})}},h.onFragDecrypted=function(t,n){var s=n.frag;if(s.type===ue.PlaylistLevelType.SUBTITLE){if(!(0,O.isFiniteNumber)(this.initPTS[s.cc]))return void this.unparsedVttFrags.push(n);this.onFragLoaded(E.Events.FRAG_LOADED,n)}},h.onSubtitleTracksCleared=function(){this.tracks=[],this.captionsTracks={}},h.onFragParsingUserdata=function(t,n){var s=this.cea608Parser1,o=this.cea608Parser2;if(this.enabled&&s&&o){var c=n.frag,i=n.samples;if(c.type!==ue.PlaylistLevelType.MAIN||this.closedCaptionsForLevel(c)!=="NONE")for(var u=0;u<i.length;u++){var p=i[u].bytes;if(p){var g=this.extractCea608Data(p);s.addData(i[u].pts,g[0]),o.addData(i[u].pts,g[1])}}}},h.onBufferFlushing=function(t,n){var s=n.startOffset,o=n.endOffset,c=n.endOffsetSubtitles,i=n.type,u=this.media;if(u&&!(u.currentTime<o)){if(!i||i==="video"){var p=this.captionsTracks;Object.keys(p).forEach(function(y){return jt(p[y],s,o)})}if(this.config.renderTextTracksNatively&&s===0&&c!==void 0){var g=this.textTracks;Object.keys(g).forEach(function(y){return jt(g[y],s,c)})}}},h.extractCea608Data=function(t){for(var n=[[],[]],s=31&t[0],o=2,c=0;c<s;c++){var i=t[o++],u=127&t[o++],p=127&t[o++];if((u!==0||p!==0)&&4&i){var g=3&i;g!==0&&g!==1||(n[g].push(u),n[g].push(p))}}return n},v}();function yi(v,h){return v&&v.label===h.name&&!(v.textTrack1||v.textTrack2)}function cl(v,h){for(var t=0;t<h.length;t++){var n=h[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(v,typeof(s=function(o,c){if(typeof o!="object"||o===null)return o;var i=o[Symbol.toPrimitive];if(i!==void 0){var u=i.call(o,c);if(typeof u!="object")return u;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(o)}(n.key,"string"))=="symbol"?s:String(s),n)}var s}const fl=function(){function v(s){this.autoLevelCapping=void 0,this.firstLevel=void 0,this.media=void 0,this.restrictedLevels=void 0,this.timer=void 0,this.hls=void 0,this.streamController=void 0,this.clientRect=void 0,this.hls=s,this.autoLevelCapping=Number.POSITIVE_INFINITY,this.firstLevel=-1,this.media=null,this.restrictedLevels=[],this.timer=void 0,this.clientRect=null,this.registerListeners()}var h,t,n=v.prototype;return n.setStreamController=function(s){this.streamController=s},n.destroy=function(){this.unregisterListener(),this.hls.config.capLevelToPlayerSize&&this.stopCapping(),this.media=null,this.clientRect=null,this.hls=this.streamController=null},n.registerListeners=function(){var s=this.hls;s.on(E.Events.FPS_DROP_LEVEL_CAPPING,this.onFpsDropLevelCapping,this),s.on(E.Events.MEDIA_ATTACHING,this.onMediaAttaching,this),s.on(E.Events.MANIFEST_PARSED,this.onManifestParsed,this),s.on(E.Events.BUFFER_CODECS,this.onBufferCodecs,this),s.on(E.Events.MEDIA_DETACHING,this.onMediaDetaching,this)},n.unregisterListener=function(){var s=this.hls;s.off(E.Events.FPS_DROP_LEVEL_CAPPING,this.onFpsDropLevelCapping,this),s.off(E.Events.MEDIA_ATTACHING,this.onMediaAttaching,this),s.off(E.Events.MANIFEST_PARSED,this.onManifestParsed,this),s.off(E.Events.BUFFER_CODECS,this.onBufferCodecs,this),s.off(E.Events.MEDIA_DETACHING,this.onMediaDetaching,this)},n.onFpsDropLevelCapping=function(s,o){v.isLevelAllowed(o.droppedLevel,this.restrictedLevels)&&this.restrictedLevels.push(o.droppedLevel)},n.onMediaAttaching=function(s,o){this.media=o.media instanceof HTMLVideoElement?o.media:null,this.clientRect=null},n.onManifestParsed=function(s,o){var c=this.hls;this.restrictedLevels=[],this.firstLevel=o.firstLevel,c.config.capLevelToPlayerSize&&o.video&&this.startCapping()},n.onBufferCodecs=function(s,o){this.hls.config.capLevelToPlayerSize&&o.video&&this.startCapping()},n.onMediaDetaching=function(){this.stopCapping()},n.detectPlayerSize=function(){if(this.media&&this.mediaHeight>0&&this.mediaWidth>0){var s=this.hls.levels;if(s.length){var o=this.hls;o.autoLevelCapping=this.getMaxLevel(s.length-1),o.autoLevelCapping>this.autoLevelCapping&&this.streamController&&this.streamController.nextLevelSwitch(),this.autoLevelCapping=o.autoLevelCapping}}},n.getMaxLevel=function(s){var o=this,c=this.hls.levels;if(!c.length)return-1;var i=c.filter(function(u,p){return v.isLevelAllowed(p,o.restrictedLevels)&&p<=s});return this.clientRect=null,v.getMaxLevelByMediaSize(i,this.mediaWidth,this.mediaHeight)},n.startCapping=function(){this.timer||(this.autoLevelCapping=Number.POSITIVE_INFINITY,this.hls.firstLevel=this.getMaxLevel(this.firstLevel),self.clearInterval(this.timer),this.timer=self.setInterval(this.detectPlayerSize.bind(this),1e3),this.detectPlayerSize())},n.stopCapping=function(){this.restrictedLevels=[],this.firstLevel=-1,this.autoLevelCapping=Number.POSITIVE_INFINITY,this.timer&&(self.clearInterval(this.timer),this.timer=void 0)},n.getDimensions=function(){if(this.clientRect)return this.clientRect;var s=this.media,o={width:0,height:0};if(s){var c=s.getBoundingClientRect();o.width=c.width,o.height=c.height,o.width||o.height||(o.width=c.right-c.left||s.width||0,o.height=c.bottom-c.top||s.height||0)}return this.clientRect=o,o},v.isLevelAllowed=function(s,o){return o===void 0&&(o=[]),o.indexOf(s)===-1},v.getMaxLevelByMediaSize=function(s,o,c){if(!s||!s.length)return-1;for(var i,u,p=s.length-1,g=0;g<s.length;g+=1){var y=s[g];if((y.width>=o||y.height>=c)&&(i=y,!(u=s[g+1])||i.width!==u.width||i.height!==u.height)){p=g;break}}return p},h=v,(t=[{key:"mediaWidth",get:function(){return this.getDimensions().width*this.contentScaleFactor}},{key:"mediaHeight",get:function(){return this.getDimensions().height*this.contentScaleFactor}},{key:"contentScaleFactor",get:function(){var s=1;if(!this.hls.config.ignoreDevicePixelRatio)try{s=self.devicePixelRatio}catch{}return s}}])&&cl(h.prototype,t),Object.defineProperty(h,"prototype",{writable:!1}),v}(),ra=function(){function v(t){this.hls=void 0,this.isVideoPlaybackQualityAvailable=!1,this.timer=void 0,this.media=null,this.lastTime=void 0,this.lastDroppedFrames=0,this.lastDecodedFrames=0,this.streamController=void 0,this.hls=t,this.registerListeners()}var h=v.prototype;return h.setStreamController=function(t){this.streamController=t},h.registerListeners=function(){this.hls.on(E.Events.MEDIA_ATTACHING,this.onMediaAttaching,this)},h.unregisterListeners=function(){this.hls.off(E.Events.MEDIA_ATTACHING,this.onMediaAttaching)},h.destroy=function(){this.timer&&clearInterval(this.timer),this.unregisterListeners(),this.isVideoPlaybackQualityAvailable=!1,this.media=null},h.onMediaAttaching=function(t,n){var s=this.hls.config;if(s.capLevelOnFPSDrop){var o=n.media instanceof self.HTMLVideoElement?n.media:null;this.media=o,o&&typeof o.getVideoPlaybackQuality=="function"&&(this.isVideoPlaybackQualityAvailable=!0),self.clearInterval(this.timer),this.timer=self.setInterval(this.checkFPSInterval.bind(this),s.fpsDroppedMonitoringPeriod)}},h.checkFPS=function(t,n,s){var o=performance.now();if(n){if(this.lastTime){var c=o-this.lastTime,i=s-this.lastDroppedFrames,u=n-this.lastDecodedFrames,p=1e3*i/c,g=this.hls;if(g.trigger(E.Events.FPS_DROP,{currentDropped:i,currentDecoded:u,totalDroppedFrames:s}),p>0&&i>g.config.fpsDroppedMonitoringThreshold*u){var y=g.currentLevel;w.logger.warn("drop FPS ratio greater than max allowed value for currentLevel: "+y),y>0&&(g.autoLevelCapping===-1||g.autoLevelCapping>=y)&&(y-=1,g.trigger(E.Events.FPS_DROP_LEVEL_CAPPING,{level:y,droppedLevel:g.currentLevel}),g.autoLevelCapping=y,this.streamController.nextLevelSwitch())}}this.lastTime=o,this.lastDroppedFrames=s,this.lastDecodedFrames=n}},h.checkFPSInterval=function(){var t=this.media;if(t)if(this.isVideoPlaybackQualityAvailable){var n=t.getVideoPlaybackQuality();this.checkFPS(t,n.totalVideoFrames,n.droppedVideoFrames)}else this.checkFPS(t,t.webkitDecodedFrameCount,t.webkitDroppedFrameCount)},v}();var xn=k(300);function dn(v){var h=typeof Map=="function"?new Map:void 0;return dn=function(t){if(t===null||(n=t,Function.toString.call(n).indexOf("[native code]")===-1))return t;var n;if(typeof t!="function")throw new TypeError("Super expression must either be null or a function");if(h!==void 0){if(h.has(t))return h.get(t);h.set(t,s)}function s(){return Ei(t,arguments,na(this).constructor)}return s.prototype=Object.create(t.prototype,{constructor:{value:s,enumerable:!1,writable:!0,configurable:!0}}),xi(s,t)},dn(v)}function Ei(v,h,t){return Ei=dl()?Reflect.construct.bind():function(n,s,o){var c=[null];c.push.apply(c,s);var i=new(Function.bind.apply(n,c));return o&&xi(i,o.prototype),i},Ei.apply(null,arguments)}function dl(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function xi(v,h){return xi=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,n){return t.__proto__=n,t},xi(v,h)}function na(v){return na=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(h){return h.__proto__||Object.getPrototypeOf(h)},na(v)}var Ln="[eme]",Zr=function(){function v(t){this.hls=void 0,this.config=void 0,this.media=null,this.keyFormatPromise=null,this.keySystemAccessPromises={},this._requestLicenseFailureCount=0,this.mediaKeySessions=[],this.keyIdToKeySessionPromise={},this.setMediaKeysQueue=v.CDMCleanupPromise?[v.CDMCleanupPromise]:[],this.onMediaEncrypted=this._onMediaEncrypted.bind(this),this.onWaitingForKey=this._onWaitingForKey.bind(this),this.debug=w.logger.debug.bind(w.logger,Ln),this.log=w.logger.log.bind(w.logger,Ln),this.warn=w.logger.warn.bind(w.logger,Ln),this.error=w.logger.error.bind(w.logger,Ln),this.hls=t,this.config=t.config,this.registerListeners()}var h=v.prototype;return h.destroy=function(){this.unregisterListeners(),this.onMediaDetached(),this.hls=this.onMediaEncrypted=this.onWaitingForKey=this.keyIdToKeySessionPromise=null},h.registerListeners=function(){this.hls.on(E.Events.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.on(E.Events.MEDIA_DETACHED,this.onMediaDetached,this),this.hls.on(E.Events.MANIFEST_LOADED,this.onManifestLoaded,this)},h.unregisterListeners=function(){this.hls.off(E.Events.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.off(E.Events.MEDIA_DETACHED,this.onMediaDetached,this),this.hls.off(E.Events.MANIFEST_LOADED,this.onManifestLoaded,this)},h.getLicenseServerUrl=function(t){var n=this.config,s=n.drmSystems,o=n.widevineLicenseUrl,c=s[t];if(c)return c.licenseUrl;if(t===N.WIDEVINE&&o)return o;throw new Error('no license server URL configured for key-system "'+t+'"')},h.getServerCertificateUrl=function(t){var n=this.config.drmSystems[t];if(n)return n.serverCertificateUrl;this.log('No Server Certificate in config.drmSystems["'+t+'"]')},h.attemptKeySystemAccess=function(t){var n=this,s=this.hls.levels,o=function(u,p,g){return!!u&&g.indexOf(u)===p},c=s.map(function(u){return u.audioCodec}).filter(o),i=s.map(function(u){return u.videoCodec}).filter(o);return c.length+i.length===0&&i.push("avc1.42e01e"),new Promise(function(u,p){(function g(y){var b=y.shift();n.getMediaKeysPromise(b,c,i).then(function(D){return u({keySystem:b,mediaKeys:D})}).catch(function(D){y.length?g(y):p(D instanceof Jr?D:new Jr({type:A.ErrorTypes.KEY_SYSTEM_ERROR,details:A.ErrorDetails.KEY_SYSTEM_NO_ACCESS,error:D,fatal:!0},D.message))})})(t)})},h.requestMediaKeySystemAccess=function(t,n){var s=this.config.requestMediaKeySystemAccessFunc;if(typeof s!="function"){var o="Configured requestMediaKeySystemAccess is not a function "+s;return he===null&&self.location.protocol==="http:"&&(o="navigator.requestMediaKeySystemAccess is not available over insecure protocol "+location.protocol),Promise.reject(new Error(o))}return s(t,n)},h.getMediaKeysPromise=function(t,n,s){var o=this,c=function(g,y,b,D){var F;switch(g){case N.FAIRPLAY:F=["cenc","sinf"];break;case N.WIDEVINE:case N.PLAYREADY:F=["cenc"];break;case N.CLEARKEY:F=["cenc","keyids"];break;default:throw new Error("Unknown key-system: "+g)}return function(G,ee,J,le){return[{initDataTypes:G,persistentState:le.persistentState||"not-allowed",distinctiveIdentifier:le.distinctiveIdentifier||"not-allowed",sessionTypes:le.sessionTypes||[le.sessionType||"temporary"],audioCapabilities:ee.map(function(Se){return{contentType:'audio/mp4; codecs="'+Se+'"',robustness:le.audioRobustness||"",encryptionScheme:le.audioEncryptionScheme||null}}),videoCapabilities:J.map(function(Se){return{contentType:'video/mp4; codecs="'+Se+'"',robustness:le.videoRobustness||"",encryptionScheme:le.videoEncryptionScheme||null}})}]}(F,y,b,D)}(t,n,s,this.config.drmSystemOptions),i=this.keySystemAccessPromises[t],u=i==null?void 0:i.keySystemAccess;if(!u){this.log('Requesting encrypted media "'+t+'" key-system access with config: '+JSON.stringify(c)),u=this.requestMediaKeySystemAccess(t,c);var p=this.keySystemAccessPromises[t]={keySystemAccess:u};return u.catch(function(g){o.log('Failed to obtain access to key-system "'+t+'": '+g)}),u.then(function(g){o.log('Access for key-system "'+g.keySystem+'" obtained');var y=o.fetchServerCertificate(t);return o.log('Create media-keys for "'+t+'"'),p.mediaKeys=g.createMediaKeys().then(function(b){return o.log('Media-keys created for "'+t+'"'),y.then(function(D){return D?o.setMediaKeysServerCertificate(b,t,D):b})}),p.mediaKeys.catch(function(b){o.error('Failed to create media-keys for "'+t+'"}: '+b)}),p.mediaKeys})}return u.then(function(){return i.mediaKeys})},h.createMediaKeySessionContext=function(t){var n=t.decryptdata,s=t.keySystem,o=t.mediaKeys;this.log('Creating key-system session "'+s+'" keyId: '+xn.default.hexDump(n.keyId||[]));var c=o.createSession(),i={decryptdata:n,keySystem:s,mediaKeys:o,mediaKeysSession:c,keyStatus:"status-pending"};return this.mediaKeySessions.push(i),i},h.renewKeySession=function(t){var n=t.decryptdata;if(n.pssh){var s=this.createMediaKeySessionContext(t),o=this.getKeyIdString(n);this.keyIdToKeySessionPromise[o]=this.generateRequestWithPreferredKeySession(s,"cenc",n.pssh,"expired")}else this.warn("Could not renew expired session. Missing pssh initData.");this.removeSession(t)},h.getKeyIdString=function(t){if(!t)throw new Error("Could not read keyId of undefined decryptdata");if(t.keyId===null)throw new Error("keyId is null");return xn.default.hexDump(t.keyId)},h.updateKeySession=function(t,n){var s,o=t.mediaKeysSession;return this.log('Updating key-session "'+o.sessionId+'" for keyID '+xn.default.hexDump(((s=t.decryptdata)===null||s===void 0?void 0:s.keyId)||[])+`
      } (data length: `+(n&&n.byteLength)+")"),o.update(n)},h.selectKeySystemFormat=function(t){var n=Object.keys(t.levelkeys||{});return this.keyFormatPromise||(this.log("Selecting key-system from fragment (sn: "+t.sn+" "+t.type+": "+t.level+") key formats "+n.join(", ")),this.keyFormatPromise=this.getKeyFormatPromise(n)),this.keyFormatPromise},h.getKeyFormatPromise=function(t){var n=this;return new Promise(function(s,o){var c=ye(n.config),i=t.map(q).filter(function(u){return!!u&&c.indexOf(u)!==-1});return n.getKeySystemSelectionPromise(i).then(function(u){var p=u.keySystem,g=H(p);g?s(g):o(new Error('Unable to find format for key-system "'+p+'"'))}).catch(o)})},h.loadKey=function(t){var n=this,s=t.keyInfo.decryptdata,o=this.getKeyIdString(s),c="(keyId: "+o+' format: "'+s.keyFormat+'" method: '+s.method+" uri: "+s.uri+")";this.log("Starting session for key "+c);var i=this.keyIdToKeySessionPromise[o];return i||(i=this.keyIdToKeySessionPromise[o]=this.getKeySystemForKeyPromise(s).then(function(u){var p=u.keySystem,g=u.mediaKeys;return n.throwIfDestroyed(),n.log("Handle encrypted media sn: "+t.frag.sn+" "+t.frag.type+": "+t.frag.level+" using key "+c),n.attemptSetMediaKeys(p,g).then(function(){n.throwIfDestroyed();var y=n.createMediaKeySessionContext({keySystem:p,mediaKeys:g,decryptdata:s});return n.generateRequestWithPreferredKeySession(y,"cenc",s.pssh,"playlist-key")})})).catch(function(u){return n.handleError(u)}),i},h.throwIfDestroyed=function(t){if(!this.hls)throw new Error("invalid state")},h.handleError=function(t){this.hls&&(this.error(t.message),t instanceof Jr?this.hls.trigger(E.Events.ERROR,t.data):this.hls.trigger(E.Events.ERROR,{type:A.ErrorTypes.KEY_SYSTEM_ERROR,details:A.ErrorDetails.KEY_SYSTEM_NO_KEYS,error:t,fatal:!0}))},h.getKeySystemForKeyPromise=function(t){var n=this.getKeyIdString(t),s=this.keyIdToKeySessionPromise[n];if(!s){var o=q(t.keyFormat),c=o?[o]:ye(this.config);return this.attemptKeySystemAccess(c)}return s},h.getKeySystemSelectionPromise=function(t){if(t.length||(t=ye(this.config)),t.length===0)throw new Jr({type:A.ErrorTypes.KEY_SYSTEM_ERROR,details:A.ErrorDetails.KEY_SYSTEM_NO_CONFIGURED_LICENSE,fatal:!0},"Missing key-system license configuration options "+JSON.stringify({drmSystems:this.config.drmSystems}));return this.attemptKeySystemAccess(t)},h._onMediaEncrypted=function(t){var n=this,s=t.initDataType,o=t.initData;if(this.debug('"'+t.type+'" event: init data type: "'+s+'"'),o!==null){var c,i;if(s==="sinf"&&this.config.drmSystems[N.FAIRPLAY]){var u=(0,Ee.bin2str)(new Uint8Array(o));try{var p=j(JSON.parse(u).sinf),g=(0,Ee.parseSinf)(new Uint8Array(p));if(!g)return;c=g.subarray(8,24),i=N.FAIRPLAY}catch{return void this.warn('Failed to parse sinf "encrypted" event message initData')}}else{var y=(0,Ee.parsePssh)(o);if(y===null)return;y.version===0&&y.systemId===me.WIDEVINE&&y.data&&(c=y.data.subarray(8,24)),i=function(Se){if(Se===me.WIDEVINE)return N.WIDEVINE}(y.systemId)}if(i&&c){for(var b=xn.default.hexDump(c),D=this.keyIdToKeySessionPromise,F=this.mediaKeySessions,G=D[b],ee=function(Se){var we=F[Se],be=we.decryptdata;if(be.pssh||!be.keyId)return"continue";var Pe=xn.default.hexDump(be.keyId);return b===Pe||be.uri.replace(/-/g,"").indexOf(b)!==-1?(G=D[Pe],delete D[Pe],be.pssh=new Uint8Array(o),be.keyId=c,G=D[b]=G.then(function(){return n.generateRequestWithPreferredKeySession(we,s,o,"encrypted-event-key-match")}),"break"):void 0},J=0;J<F.length;J++){var le=ee(J);if(le!=="continue"&&le==="break")break}G||(G=D[b]=this.getKeySystemSelectionPromise([i]).then(function(Se){var we,be=Se.keySystem,Pe=Se.mediaKeys;n.throwIfDestroyed();var tt=new qe("ISO-23001-7",b,(we=H(be))!=null?we:"");return tt.pssh=new Uint8Array(o),tt.keyId=c,n.attemptSetMediaKeys(be,Pe).then(function(){n.throwIfDestroyed();var rt=n.createMediaKeySessionContext({decryptdata:tt,keySystem:be,mediaKeys:Pe});return n.generateRequestWithPreferredKeySession(rt,s,o,"encrypted-event-no-match")})})),G.catch(function(Se){return n.handleError(Se)})}}},h._onWaitingForKey=function(t){this.log('"'+t.type+'" event')},h.attemptSetMediaKeys=function(t,n){var s=this,o=this.setMediaKeysQueue.slice();this.log('Setting media-keys for "'+t+'"');var c=Promise.all(o).then(function(){if(!s.media)throw new Error("Attempted to set mediaKeys without media element attached");return s.media.setMediaKeys(n)});return this.setMediaKeysQueue.push(c),c.then(function(){s.log('Media-keys set for "'+t+'"'),o.push(c),s.setMediaKeysQueue=s.setMediaKeysQueue.filter(function(i){return o.indexOf(i)===-1})})},h.generateRequestWithPreferredKeySession=function(t,n,s,o){var c,i,u=this,p=(c=this.config.drmSystems)===null||c===void 0||(i=c[t.keySystem])===null||i===void 0?void 0:i.generateRequest;if(p)try{var g=p.call(this.hls,n,s,t);if(!g)throw new Error("Invalid response from configured generateRequest filter");n=g.initDataType,s=t.decryptdata.pssh=g.initData?new Uint8Array(g.initData):null}catch(G){var y;if(this.warn(G.message),(y=this.hls)!==null&&y!==void 0&&y.config.debug)throw G}if(s===null)return this.log('Skipping key-session request for "'+o+'" (no initData)'),Promise.resolve(t);var b=this.getKeyIdString(t.decryptdata);this.log('Generating key-session request for "'+o+'": '+b+" (init data type: "+n+" length: "+(s?s.byteLength:null)+")");var D=new(Pa());t.mediaKeysSession.onmessage=function(G){var ee=t.mediaKeysSession;if(ee){var J=G.messageType,le=G.message;u.log('"'+J+'" message event for session "'+ee.sessionId+'" message size: '+le.byteLength),J==="license-request"||J==="license-renewal"?u.renewLicense(t,le).catch(function(Se){u.handleError(Se),D.emit("error",Se)}):J==="license-release"?t.keySystem===N.FAIRPLAY&&(u.updateKeySession(t,C("acknowledged")),u.removeSession(t)):u.warn('unhandled media key message type "'+J+'"')}else D.emit("error",new Error("invalid state"))},t.mediaKeysSession.onkeystatuseschange=function(G){if(t.mediaKeysSession){u.onKeyStatusChange(t);var ee=t.keyStatus;D.emit("keyStatus",ee),ee==="expired"&&(u.warn(t.keySystem+" expired for key "+b),u.renewKeySession(t))}else D.emit("error",new Error("invalid state"))};var F=new Promise(function(G,ee){D.on("error",ee),D.on("keyStatus",function(J){J.startsWith("usable")?G():J==="output-restricted"?ee(new Jr({type:A.ErrorTypes.KEY_SYSTEM_ERROR,details:A.ErrorDetails.KEY_SYSTEM_STATUS_OUTPUT_RESTRICTED,fatal:!1},"HDCP level output restricted")):J==="internal-error"?ee(new Jr({type:A.ErrorTypes.KEY_SYSTEM_ERROR,details:A.ErrorDetails.KEY_SYSTEM_STATUS_INTERNAL_ERROR,fatal:!0},'key status changed to "'+J+'"')):J==="expired"?ee(new Error("key expired while generating request")):u.warn('unhandled key status change "'+J+'"')})});return t.mediaKeysSession.generateRequest(n,s).then(function(){var G;u.log('Request generated for key-session "'+((G=t.mediaKeysSession)===null||G===void 0?void 0:G.sessionId)+'" keyId: '+b)}).catch(function(G){throw new Jr({type:A.ErrorTypes.KEY_SYSTEM_ERROR,details:A.ErrorDetails.KEY_SYSTEM_NO_SESSION,error:G,fatal:!1},"Error generating key-session request: "+G)}).then(function(){return F}).catch(function(G){throw D.removeAllListeners(),u.removeSession(t),G}).then(function(){return D.removeAllListeners(),t})},h.onKeyStatusChange=function(t){var n=this;t.mediaKeysSession.keyStatuses.forEach(function(s,o){n.log('key status change "'+s+'" for keyStatuses keyId: '+xn.default.hexDump("buffer"in o?new Uint8Array(o.buffer,o.byteOffset,o.byteLength):new Uint8Array(o))+" session keyId: "+xn.default.hexDump(new Uint8Array(t.decryptdata.keyId||[]))+" uri: "+t.decryptdata.uri),t.keyStatus=s})},h.fetchServerCertificate=function(t){var n=this;return new Promise(function(s,o){var c=n.getServerCertificateUrl(t);if(!c)return s();n.log('Fetching serverCertificate for "'+t+'"');var i=new XMLHttpRequest;i.open("GET",c,!0),i.responseType="arraybuffer",i.onreadystatechange=function(){i.readyState===XMLHttpRequest.DONE&&(i.status===200?s(i.response):o(new Jr({type:A.ErrorTypes.KEY_SYSTEM_ERROR,details:A.ErrorDetails.KEY_SYSTEM_SERVER_CERTIFICATE_REQUEST_FAILED,fatal:!0,networkDetails:i},'"'+t+'" certificate request XHR failed ('+c+"). Status: "+i.status+" ("+i.statusText+")")))},i.send()})},h.setMediaKeysServerCertificate=function(t,n,s){var o=this;return new Promise(function(c,i){t.setServerCertificate(s).then(function(u){o.log("setServerCertificate "+(u?"success":"not supported by CDM")+" ("+(s==null?void 0:s.byteLength)+') on "'+n+'"'),c(t)}).catch(function(u){i(new Jr({type:A.ErrorTypes.KEY_SYSTEM_ERROR,details:A.ErrorDetails.KEY_SYSTEM_SERVER_CERTIFICATE_UPDATE_FAILED,error:u,fatal:!0},u.message))})})},h.renewLicense=function(t,n){var s=this;return this.requestLicense(t,new Uint8Array(n)).then(function(o){return s.updateKeySession(t,new Uint8Array(o)).catch(function(c){throw new Jr({type:A.ErrorTypes.KEY_SYSTEM_ERROR,details:A.ErrorDetails.KEY_SYSTEM_SESSION_UPDATE_FAILED,error:c,fatal:!0},c.message)})})},h.setupLicenseXHR=function(t,n,s,o){var c=this,i=this.config.licenseXhrSetup;return i?Promise.resolve().then(function(){if(!s.decryptdata)throw new Error("Key removed");return i.call(c.hls,t,n,s,o)}).catch(function(u){if(!s.decryptdata)throw u;return t.open("POST",n,!0),i.call(c.hls,t,n,s,o)}).then(function(u){return t.readyState||t.open("POST",n,!0),{xhr:t,licenseChallenge:u||o}}):(t.open("POST",n,!0),Promise.resolve({xhr:t,licenseChallenge:o}))},h.requestLicense=function(t,n){var s=this;return new Promise(function(o,c){var i=s.getLicenseServerUrl(t.keySystem);s.log("Sending license request to URL: "+i);var u=new XMLHttpRequest;u.responseType="arraybuffer",u.onreadystatechange=function(){if(!s.hls||!t.mediaKeysSession)return c(new Error("invalid state"));if(u.readyState===4)if(u.status===200){s._requestLicenseFailureCount=0;var p=u.response;s.log("License received "+(p instanceof ArrayBuffer?p.byteLength:p));var g=s.config.licenseResponseCallback;if(g)try{p=g.call(s.hls,u,i,t)}catch(b){s.error(b)}o(p)}else if(s._requestLicenseFailureCount++,s._requestLicenseFailureCount>3||u.status>=400&&u.status<500)c(new Jr({type:A.ErrorTypes.KEY_SYSTEM_ERROR,details:A.ErrorDetails.KEY_SYSTEM_LICENSE_REQUEST_FAILED,fatal:!0,networkDetails:u},"License Request XHR failed ("+i+"). Status: "+u.status+" ("+u.statusText+")"));else{var y=3-s._requestLicenseFailureCount+1;s.warn("Retrying license request, "+y+" attempts left"),s.requestLicense(t,n).then(o,c)}},t.licenseXhr&&t.licenseXhr.readyState!==XMLHttpRequest.DONE&&t.licenseXhr.abort(),t.licenseXhr=u,s.setupLicenseXHR(u,i,t,n).then(function(p){var g=p.xhr,y=p.licenseChallenge;g.send(y)})})},h.onMediaAttached=function(t,n){if(this.config.emeEnabled){var s=n.media;this.media=s,s.addEventListener("encrypted",this.onMediaEncrypted),s.addEventListener("waitingforkey",this.onWaitingForKey)}},h.onMediaDetached=function(){var t=this,n=this.media,s=this.mediaKeySessions;n&&(n.removeEventListener("encrypted",this.onMediaEncrypted),n.removeEventListener("waitingforkey",this.onWaitingForKey),this.media=null),this._requestLicenseFailureCount=0,this.setMediaKeysQueue=[],this.mediaKeySessions=[],this.keyIdToKeySessionPromise={},qe.clearKeyUriToKeyIdMap();var o=s.length;v.CDMCleanupPromise=Promise.all(s.map(function(c){return t.removeSession(c)}).concat(n==null?void 0:n.setMediaKeys(null).catch(function(c){t.log("Could not clear media keys: "+c+". media.src: "+(n==null?void 0:n.src))}))).then(function(){o&&(t.log("finished closing key sessions and clearing media keys"),s.length=0)}).catch(function(c){t.log("Could not close sessions and clear media keys: "+c+". media.src: "+(n==null?void 0:n.src))})},h.onManifestLoaded=function(t,n){var s=n.sessionKeys;if(s&&this.config.emeEnabled&&!this.keyFormatPromise){var o=s.reduce(function(c,i){return c.indexOf(i.keyFormat)===-1&&c.push(i.keyFormat),c},[]);this.log("Selecting key-system from session-keys "+o.join(", ")),this.keyFormatPromise=this.getKeyFormatPromise(o)}},h.removeSession=function(t){var n=this,s=t.mediaKeysSession,o=t.licenseXhr;if(s){this.log("Remove licenses and keys and close session "+s.sessionId),s.onmessage=null,s.onkeystatuseschange=null,o&&o.readyState!==XMLHttpRequest.DONE&&o.abort(),t.mediaKeysSession=t.decryptdata=t.licenseXhr=void 0;var c=this.mediaKeySessions.indexOf(t);return c>-1&&this.mediaKeySessions.splice(c,1),s.remove().catch(function(i){n.log("Could not remove session: "+i)}).then(function(){return s.close()}).catch(function(i){n.log("Could not close session: "+i)})}},v}();Zr.CDMCleanupPromise=void 0;var Jr=function(v){var h,t;function n(s,o){var c;return(c=v.call(this,o)||this).data=void 0,c.data=s,s.err=s.error,c}return t=v,(h=n).prototype=Object.create(t.prototype),h.prototype.constructor=h,xi(h,t),n}(dn(Error));const hl=Zr;var Mr,ia,$a;function eo(v,h){for(var t=0;t<h.length;t++){var n=h[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(v,typeof(s=function(o,c){if(typeof o!="object"||o===null)return o;var i=o[Symbol.toPrimitive];if(i!==void 0){var u=i.call(o,c);if(typeof u!="object")return u;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(o)}(n.key,"string"))=="symbol"?s:String(s),n)}var s}function zn(v,h,t){return h&&eo(v.prototype,h),t&&eo(v,t),Object.defineProperty(v,"prototype",{writable:!1}),v}function fe(v,h){var t=typeof Symbol<"u"&&v[Symbol.iterator]||v["@@iterator"];if(t)return(t=t.call(v)).next.bind(t);if(Array.isArray(v)||(t=function(s,o){if(s){if(typeof s=="string")return ke(s,o);var c=Object.prototype.toString.call(s).slice(8,-1);return c==="Object"&&s.constructor&&(c=s.constructor.name),c==="Map"||c==="Set"?Array.from(s):c==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(c)?ke(s,o):void 0}}(v))||h&&v&&typeof v.length=="number"){t&&(v=t);var n=0;return function(){return n>=v.length?{done:!0}:{done:!1,value:v[n++]}}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function ke(v,h){(h==null||h>v.length)&&(h=v.length);for(var t=0,n=new Array(h);t<h;t++)n[t]=v[t];return n}function Re(){return Re=Object.assign?Object.assign.bind():function(v){for(var h=1;h<arguments.length;h++){var t=arguments[h];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(v[n]=t[n])}return v},Re.apply(this,arguments)}(function(v){v.MANIFEST="m",v.AUDIO="a",v.VIDEO="v",v.MUXED="av",v.INIT="i",v.CAPTION="c",v.TIMED_TEXT="tt",v.KEY="k",v.OTHER="o"})(Mr||(Mr={})),function(v){v.DASH="d",v.HLS="h",v.SMOOTH="s",v.OTHER="o"}(ia||(ia={})),function(v){v.VOD="v",v.LIVE="l"}($a||($a={}));var ut=function(){function v(t){var n=this;this.hls=void 0,this.config=void 0,this.media=void 0,this.sid=void 0,this.cid=void 0,this.useHeaders=!1,this.initialized=!1,this.starved=!1,this.buffering=!0,this.audioBuffer=void 0,this.videoBuffer=void 0,this.onWaiting=function(){n.initialized&&(n.starved=!0),n.buffering=!0},this.onPlaying=function(){n.initialized||(n.initialized=!0),n.buffering=!1},this.applyPlaylistData=function(c){try{n.apply(c,{ot:Mr.MANIFEST,su:!n.initialized})}catch(i){w.logger.warn("Could not generate manifest CMCD data.",i)}},this.applyFragmentData=function(c){try{var i=c.frag,u=n.hls.levels[i.level],p=n.getObjectType(i),g={d:1e3*i.duration,ot:p};p!==Mr.VIDEO&&p!==Mr.AUDIO&&p!=Mr.MUXED||(g.br=u.bitrate/1e3,g.tb=n.getTopBandwidth(p)/1e3,g.bl=n.getBufferLength(p)),n.apply(c,g)}catch(y){w.logger.warn("Could not generate segment CMCD data.",y)}},this.hls=t;var s=this.config=t.config,o=s.cmcd;o!=null&&(s.pLoader=this.createPlaylistLoader(),s.fLoader=this.createFragmentLoader(),this.sid=o.sessionId||v.uuid(),this.cid=o.contentId,this.useHeaders=o.useHeaders===!0,this.registerListeners())}var h=v.prototype;return h.registerListeners=function(){var t=this.hls;t.on(E.Events.MEDIA_ATTACHED,this.onMediaAttached,this),t.on(E.Events.MEDIA_DETACHED,this.onMediaDetached,this),t.on(E.Events.BUFFER_CREATED,this.onBufferCreated,this)},h.unregisterListeners=function(){var t=this.hls;t.off(E.Events.MEDIA_ATTACHED,this.onMediaAttached,this),t.off(E.Events.MEDIA_DETACHED,this.onMediaDetached,this),t.off(E.Events.BUFFER_CREATED,this.onBufferCreated,this),this.onMediaDetached()},h.destroy=function(){this.unregisterListeners(),this.hls=this.config=this.audioBuffer=this.videoBuffer=null},h.onMediaAttached=function(t,n){this.media=n.media,this.media.addEventListener("waiting",this.onWaiting),this.media.addEventListener("playing",this.onPlaying)},h.onMediaDetached=function(){this.media&&(this.media.removeEventListener("waiting",this.onWaiting),this.media.removeEventListener("playing",this.onPlaying),this.media=null)},h.onBufferCreated=function(t,n){var s,o;this.audioBuffer=(s=n.tracks.audio)===null||s===void 0?void 0:s.buffer,this.videoBuffer=(o=n.tracks.video)===null||o===void 0?void 0:o.buffer},h.createData=function(){var t;return{v:1,sf:ia.HLS,sid:this.sid,cid:this.cid,pr:(t=this.media)===null||t===void 0?void 0:t.playbackRate,mtp:this.hls.bandwidthEstimate/1e3}},h.apply=function(t,n){n===void 0&&(n={}),Re(n,this.createData());var s=n.ot===Mr.INIT||n.ot===Mr.VIDEO||n.ot===Mr.MUXED;if(this.starved&&s&&(n.bs=!0,n.su=!0,this.starved=!1),n.su==null&&(n.su=this.buffering),this.useHeaders){var o=v.toHeaders(n);if(!Object.keys(o).length)return;t.headers||(t.headers={}),Re(t.headers,o)}else{var c=v.toQuery(n);if(!c)return;t.url=v.appendQueryToUri(t.url,c)}},h.getObjectType=function(t){var n=t.type;return n==="subtitle"?Mr.TIMED_TEXT:t.sn==="initSegment"?Mr.INIT:n==="audio"?Mr.AUDIO:n==="main"?this.hls.audioTracks.length?Mr.VIDEO:Mr.MUXED:void 0},h.getTopBandwidth=function(t){var n,s=0,o=this.hls;if(t===Mr.AUDIO)n=o.audioTracks;else{var c=o.maxAutoLevel,i=c>-1?c+1:o.levels.length;n=o.levels.slice(0,i)}for(var u,p=fe(n);!(u=p()).done;){var g=u.value;g.bitrate>s&&(s=g.bitrate)}return s>0?s:NaN},h.getBufferLength=function(t){var n=this.hls.media,s=t===Mr.AUDIO?this.audioBuffer:this.videoBuffer;return s&&n?1e3*or.bufferInfo(s,n.currentTime,this.config.maxBufferHole).len:NaN},h.createPlaylistLoader=function(){var t=this.config.pLoader,n=this.applyPlaylistData,s=t||this.config.loader;return function(){function o(i){this.loader=void 0,this.loader=new s(i)}var c=o.prototype;return c.destroy=function(){this.loader.destroy()},c.abort=function(){this.loader.abort()},c.load=function(i,u,p){n(i),this.loader.load(i,u,p)},zn(o,[{key:"stats",get:function(){return this.loader.stats}},{key:"context",get:function(){return this.loader.context}}]),o}()},h.createFragmentLoader=function(){var t=this.config.fLoader,n=this.applyFragmentData,s=t||this.config.loader;return function(){function o(i){this.loader=void 0,this.loader=new s(i)}var c=o.prototype;return c.destroy=function(){this.loader.destroy()},c.abort=function(){this.loader.abort()},c.load=function(i,u,p){n(i),this.loader.load(i,u,p)},zn(o,[{key:"stats",get:function(){return this.loader.stats}},{key:"context",get:function(){return this.loader.context}}]),o}()},v.uuid=function(){var t=URL.createObjectURL(new Blob),n=t.toString();return URL.revokeObjectURL(t),n.slice(n.lastIndexOf("/")+1)},v.serialize=function(t){for(var n,s=[],o=function(G){return!Number.isNaN(G)&&G!=null&&G!==""&&G!==!1},c=function(G){return Math.round(G)},i=function(G){return 100*c(G/100)},u={br:c,d:c,bl:i,dl:i,mtp:i,nor:function(G){return encodeURIComponent(G)},rtp:i,tb:c},p=fe(Object.keys(t||{}).sort());!(n=p()).done;){var g=n.value,y=t[g];if(o(y)&&!(g==="v"&&y===1||g=="pr"&&y===1)){var b=u[g];b&&(y=b(y));var D,F=typeof y;D=g==="ot"||g==="sf"||g==="st"?g+"="+y:F==="boolean"?g:F==="number"?g+"="+y:g+"="+JSON.stringify(y),s.push(D)}}return s.join(",")},v.toHeaders=function(t){for(var n={},s=["Object","Request","Session","Status"],o=[{},{},{},{}],c={br:0,d:0,ot:0,tb:0,bl:1,dl:1,mtp:1,nor:1,nrr:1,su:1,cid:2,pr:2,sf:2,sid:2,st:2,v:2,bs:3,rtp:3},i=0,u=Object.keys(t);i<u.length;i++){var p=u[i];o[c[p]!=null?c[p]:1][p]=t[p]}for(var g=0;g<o.length;g++){var y=v.serialize(o[g]);y&&(n["CMCD-"+s[g]]=y)}return n},v.toQuery=function(t){return"CMCD="+encodeURIComponent(v.serialize(t))},v.appendQueryToUri=function(t,n){if(!n)return t;var s=t.includes("?")?"&":"?";return""+t+s+n},v}(),Lt=k(408),Xt=/^age:\s*[\d.]+\s*$/m;const br=function(){function v(t){this.xhrSetup=void 0,this.requestTimeout=void 0,this.retryTimeout=void 0,this.retryDelay=void 0,this.config=null,this.callbacks=null,this.context=void 0,this.loader=null,this.stats=void 0,this.xhrSetup=t?t.xhrSetup:null,this.stats=new Lt.LoadStats,this.retryDelay=0}var h=v.prototype;return h.destroy=function(){this.callbacks=null,this.abortInternal(),this.loader=null,this.config=null},h.abortInternal=function(){var t=this.loader;self.clearTimeout(this.requestTimeout),self.clearTimeout(this.retryTimeout),t&&(t.onreadystatechange=null,t.onprogress=null,t.readyState!==4&&(this.stats.aborted=!0,t.abort()))},h.abort=function(){var t;this.abortInternal(),(t=this.callbacks)!==null&&t!==void 0&&t.onAbort&&this.callbacks.onAbort(this.stats,this.context,this.loader)},h.load=function(t,n,s){if(this.stats.loading.start)throw new Error("Loader can only be used once.");this.stats.loading.start=self.performance.now(),this.context=t,this.config=n,this.callbacks=s,this.retryDelay=n.retryDelay,this.loadInternal()},h.loadInternal=function(){var t=this.config,n=this.context;if(t){var s=this.loader=new self.XMLHttpRequest,o=this.stats;o.loading.first=0,o.loaded=0;var c=this.xhrSetup;try{if(c)try{c(s,n.url)}catch{s.open("GET",n.url,!0),c(s,n.url)}s.readyState||s.open("GET",n.url,!0);var i=this.context.headers;if(i)for(var u in i)s.setRequestHeader(u,i[u])}catch(p){return void this.callbacks.onError({code:s.status,text:p.message},n,s)}n.rangeEnd&&s.setRequestHeader("Range","bytes="+n.rangeStart+"-"+(n.rangeEnd-1)),s.onreadystatechange=this.readystatechange.bind(this),s.onprogress=this.loadprogress.bind(this),s.responseType=n.responseType,self.clearTimeout(this.requestTimeout),this.requestTimeout=self.setTimeout(this.loadtimeout.bind(this),t.timeout),s.send()}},h.readystatechange=function(){var t=this.context,n=this.loader,s=this.stats;if(t&&n){var o=n.readyState,c=this.config;if(!s.aborted&&o>=2)if(self.clearTimeout(this.requestTimeout),s.loading.first===0&&(s.loading.first=Math.max(self.performance.now(),s.loading.start)),o===4){n.onreadystatechange=null,n.onprogress=null;var i=n.status,u=n.responseType==="arraybuffer";if(i>=200&&i<300&&(u&&n.response||n.responseText!==null)){var p,g;if(s.loading.end=Math.max(self.performance.now(),s.loading.first),g=u?(p=n.response).byteLength:(p=n.responseText).length,s.loaded=s.total=g,!this.callbacks)return;var y=this.callbacks.onProgress;if(y&&y(s,t,p,n),!this.callbacks)return;var b={url:n.responseURL,data:p};this.callbacks.onSuccess(b,s,t,n)}else s.retry>=c.maxRetry||i>=400&&i<499?(w.logger.error(i+" while loading "+t.url),this.callbacks.onError({code:i,text:n.statusText},t,n)):(w.logger.warn(i+" while loading "+t.url+", retrying in "+this.retryDelay+"..."),this.abortInternal(),this.loader=null,self.clearTimeout(this.retryTimeout),this.retryTimeout=self.setTimeout(this.loadInternal.bind(this),this.retryDelay),this.retryDelay=Math.min(2*this.retryDelay,c.maxRetryDelay),s.retry++)}else self.clearTimeout(this.requestTimeout),this.requestTimeout=self.setTimeout(this.loadtimeout.bind(this),c.timeout)}},h.loadtimeout=function(){w.logger.warn("timeout while loading "+this.context.url);var t=this.callbacks;t&&(this.abortInternal(),t.onTimeout(this.stats,this.context,this.loader))},h.loadprogress=function(t){var n=this.stats;n.loaded=t.loaded,t.lengthComputable&&(n.total=t.total)},h.getCacheAge=function(){var t=null;if(this.loader&&Xt.test(this.loader.getAllResponseHeaders())){var n=this.loader.getResponseHeader("age");t=n?parseFloat(n):null}return t},v}();function $t(v){var h=typeof Map=="function"?new Map:void 0;return $t=function(t){if(t===null||(n=t,Function.toString.call(n).indexOf("[native code]")===-1))return t;var n;if(typeof t!="function")throw new TypeError("Super expression must either be null or a function");if(h!==void 0){if(h.has(t))return h.get(t);h.set(t,s)}function s(){return Ni(t,arguments,_i(this).constructor)}return s.prototype=Object.create(t.prototype,{constructor:{value:s,enumerable:!1,writable:!0,configurable:!0}}),xr(s,t)},$t(v)}function Ni(v,h,t){return Ni=pl()?Reflect.construct.bind():function(n,s,o){var c=[null];c.push.apply(c,s);var i=new(Function.bind.apply(n,c));return o&&xr(i,o.prototype),i},Ni.apply(null,arguments)}function pl(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function xr(v,h){return xr=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,n){return t.__proto__=n,t},xr(v,h)}function _i(v){return _i=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(h){return h.__proto__||Object.getPrototypeOf(h)},_i(v)}function sa(){return sa=Object.assign?Object.assign.bind():function(v){for(var h=1;h<arguments.length;h++){var t=arguments[h];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(v[n]=t[n])}return v},sa.apply(this,arguments)}var Ti=function(){function v(t){this.fetchSetup=void 0,this.requestTimeout=void 0,this.request=void 0,this.response=void 0,this.controller=void 0,this.context=void 0,this.config=null,this.callbacks=null,this.stats=void 0,this.loader=null,this.fetchSetup=t.fetchSetup||fs,this.controller=new self.AbortController,this.stats=new Lt.LoadStats}var h=v.prototype;return h.destroy=function(){this.loader=this.callbacks=null,this.abortInternal()},h.abortInternal=function(){var t=this.response;t&&t.ok||(this.stats.aborted=!0,this.controller.abort())},h.abort=function(){var t;this.abortInternal(),(t=this.callbacks)!==null&&t!==void 0&&t.onAbort&&this.callbacks.onAbort(this.stats,this.context,this.response)},h.load=function(t,n,s){var o=this,c=this.stats;if(c.loading.start)throw new Error("Loader can only be used once.");c.loading.start=self.performance.now();var i=function(y,b){var D={method:"GET",mode:"cors",credentials:"same-origin",signal:b,headers:new self.Headers(sa({},y.headers))};return y.rangeEnd&&D.headers.set("Range","bytes="+y.rangeStart+"-"+String(y.rangeEnd-1)),D}(t,this.controller.signal),u=s.onProgress,p=t.responseType==="arraybuffer",g=p?"byteLength":"length";this.context=t,this.config=n,this.callbacks=s,this.request=this.fetchSetup(t,i),self.clearTimeout(this.requestTimeout),this.requestTimeout=self.setTimeout(function(){o.abortInternal(),s.onTimeout(c,t,o.response)},n.timeout),self.fetch(this.request).then(function(y){if(o.response=o.loader=y,!y.ok){var b=y.status,D=y.statusText;throw new ds(D||"fetch, bad network response",b,y)}return c.loading.first=Math.max(self.performance.now(),c.loading.start),c.total=parseInt(y.headers.get("Content-Length")||"0"),u&&(0,O.isFiniteNumber)(n.highWaterMark)?o.loadProgressively(y,c,t,n.highWaterMark,u):p?y.arrayBuffer():y.text()}).then(function(y){var b=o.response;self.clearTimeout(o.requestTimeout),c.loading.end=Math.max(self.performance.now(),c.loading.first);var D=y[g];D&&(c.loaded=c.total=D);var F={url:b.url,data:y};u&&!(0,O.isFiniteNumber)(n.highWaterMark)&&u(c,t,y,b),s.onSuccess(F,c,t,b)}).catch(function(y){if(self.clearTimeout(o.requestTimeout),!c.aborted){var b=y&&y.code||0,D=y?y.message:null;s.onError({code:b,text:D},t,y?y.details:null)}})},h.getCacheAge=function(){var t=null;if(this.response){var n=this.response.headers.get("age");t=n?parseFloat(n):null}return t},h.loadProgressively=function(t,n,s,o,c){o===void 0&&(o=0);var i=new Na,u=t.body.getReader();return function p(){return u.read().then(function(g){if(g.done)return i.dataLength&&c(n,s,i.flush(),t),Promise.resolve(new ArrayBuffer(0));var y=g.value,b=y.length;return n.loaded+=b,b<o||i.dataLength?(i.push(y),i.dataLength>=o&&c(n,s,i.flush(),t)):c(n,s,y,t),p()}).catch(function(){return Promise.reject()})}()},v}();function fs(v,h){return new self.Request(v.url,h)}var ds=function(v){var h,t;function n(s,o,c){var i;return(i=v.call(this,s)||this).code=void 0,i.details=void 0,i.code=o,i.details=c,i}return t=v,(h=n).prototype=Object.create(t.prototype),h.prototype.constructor=h,xr(h,t),n}($t(Error));const Jt=Ti;var gl=/\s/;function hs(){return hs=Object.assign?Object.assign.bind():function(v){for(var h=1;h<arguments.length;h++){var t=arguments[h];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(v[n]=t[n])}return v},hs.apply(this,arguments)}function Ui(v,h){var t=Object.keys(v);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(v);h&&(n=n.filter(function(s){return Object.getOwnPropertyDescriptor(v,s).enumerable})),t.push.apply(t,n)}return t}function to(v){for(var h=1;h<arguments.length;h++){var t=arguments[h]!=null?arguments[h]:{};h%2?Ui(Object(t),!0).forEach(function(n){vl(v,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(v,Object.getOwnPropertyDescriptors(t)):Ui(Object(t)).forEach(function(n){Object.defineProperty(v,n,Object.getOwnPropertyDescriptor(t,n))})}return v}function vl(v,h,t){return(h=function(n){var s=function(o,c){if(typeof o!="object"||o===null)return o;var i=o[Symbol.toPrimitive];if(i!==void 0){var u=i.call(o,c);if(typeof u!="object")return u;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(o)}(n,"string");return typeof s=="symbol"?s:String(s)}(h))in v?Object.defineProperty(v,h,{value:t,enumerable:!0,configurable:!0,writable:!0}):v[h]=t,v}var ml=to(to({autoStartLoad:!0,startPosition:-1,defaultAudioCodec:void 0,debug:!1,capLevelOnFPSDrop:!1,capLevelToPlayerSize:!1,ignoreDevicePixelRatio:!1,initialLiveManifestSize:1,maxBufferLength:30,backBufferLength:1/0,maxBufferSize:6e7,maxBufferHole:.1,highBufferWatchdogPeriod:2,nudgeOffset:.1,nudgeMaxRetry:3,maxFragLookUpTolerance:.25,liveSyncDurationCount:3,liveMaxLatencyDurationCount:1/0,liveSyncDuration:void 0,liveMaxLatencyDuration:void 0,maxLiveSyncPlaybackRate:1,liveDurationInfinity:!1,liveBackBufferLength:null,maxMaxBufferLength:600,enableWorker:!0,enableSoftwareAES:!0,manifestLoadingTimeOut:1e4,manifestLoadingMaxRetry:1,manifestLoadingRetryDelay:1e3,manifestLoadingMaxRetryTimeout:64e3,startLevel:void 0,levelLoadingTimeOut:1e4,levelLoadingMaxRetry:4,levelLoadingRetryDelay:1e3,levelLoadingMaxRetryTimeout:64e3,fragLoadingTimeOut:2e4,fragLoadingMaxRetry:6,fragLoadingRetryDelay:1e3,fragLoadingMaxRetryTimeout:64e3,startFragPrefetch:!1,fpsDroppedMonitoringPeriod:5e3,fpsDroppedMonitoringThreshold:.2,appendErrorMaxRetry:3,loader:br,fLoader:void 0,pLoader:void 0,xhrSetup:void 0,licenseXhrSetup:void 0,licenseResponseCallback:void 0,abrController:$o,bufferController:Hs,capLevelController:fl,fpsController:ra,stretchShortVideoTrack:!1,maxAudioFramesDrift:1,forceKeyFrameOnDiscontinuity:!0,abrEwmaFastLive:3,abrEwmaSlowLive:9,abrEwmaFastVoD:3,abrEwmaSlowVoD:9,abrEwmaDefaultEstimate:5e5,abrBandWidthFactor:.95,abrBandWidthUpFactor:.7,abrMaxWithRealBitrate:!1,maxStarvationDelay:4,maxLoadingDelay:4,minAutoBitrate:0,emeEnabled:!1,widevineLicenseUrl:void 0,drmSystems:{},drmSystemOptions:{},requestMediaKeySystemAccessFunc:he,testBandwidth:!0,progressive:!1,lowLatencyMode:!0,cmcd:void 0,enableDateRangeMetadataCues:!0,enableEmsgMetadataCues:!0,enableID3MetadataCues:!0},{cueHandler:{newCue:function(v,h,t,n){for(var s,o,c,i,u,p=[],g=self.VTTCue||self.TextTrackCue,y=0;y<n.rows.length;y++)if(c=!0,i=0,u="",!(s=n.rows[y]).isEmpty()){for(var b=0;b<s.chars.length;b++)gl.test(s.chars[b].uchar)&&c?i++:(u+=s.chars[b].uchar,c=!1);s.cueStartTime=h,h===t&&(t+=1e-4),i>=16?i--:i++;var D=Qa(u.trim()),F=Fi(h,t,D);v&&v.cues&&v.cues.getCueById(F)||((o=new g(h,t,D)).id=F,o.line=y+1,o.align="left",o.position=10+Math.min(80,10*Math.floor(8*i/32)),p.push(o))}return v&&p.length&&(p.sort(function(G,ee){return G.line==="auto"||ee.line==="auto"?0:G.line>8&&ee.line>8?ee.line-G.line:G.line-ee.line}),p.forEach(function(G){return ht(v,G)})),p}},enableWebVTT:!0,enableIMSC1:!0,enableCEA708Captions:!0,captionsTextTrack1Label:"English",captionsTextTrack1LanguageCode:"en",captionsTextTrack2Label:"Spanish",captionsTextTrack2LanguageCode:"es",captionsTextTrack3Label:"Unknown CC",captionsTextTrack3LanguageCode:"",captionsTextTrack4Label:"Unknown CC",captionsTextTrack4LanguageCode:"",renderTextTracksNatively:!0}),{},{subtitleStreamController:ir,subtitleTrackController:al,timelineController:ul,audioStreamController:el,audioTrackController:rl,emeController:hl,cmcdController:ut});function Bi(v,h){for(var t=0;t<h.length;t++){var n=h[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(v,typeof(s=function(o,c){if(typeof o!="object"||o===null)return o;var i=o[Symbol.toPrimitive];if(i!==void 0){var u=i.call(o,c);if(typeof u!="object")return u;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(o)}(n.key,"string"))=="symbol"?s:String(s),n)}var s}var An=function(){function v(o){o===void 0&&(o={}),this.config=void 0,this.userConfig=void 0,this.coreComponents=void 0,this.networkControllers=void 0,this._emitter=new rs.EventEmitter,this._autoLevelCapping=void 0,this._maxHdcpLevel=null,this.abrController=void 0,this.bufferController=void 0,this.capLevelController=void 0,this.latencyController=void 0,this.levelController=void 0,this.streamController=void 0,this.audioTrackController=void 0,this.subtitleTrackController=void 0,this.emeController=void 0,this.cmcdController=void 0,this._media=null,this.url=null;var c=this.config=function(Ge,Je){if((Je.liveSyncDurationCount||Je.liveMaxLatencyDurationCount)&&(Je.liveSyncDuration||Je.liveMaxLatencyDuration))throw new Error("Illegal hls.js config: don't mix up liveSyncDurationCount/liveMaxLatencyDurationCount and liveSyncDuration/liveMaxLatencyDuration");if(Je.liveMaxLatencyDurationCount!==void 0&&(Je.liveSyncDurationCount===void 0||Je.liveMaxLatencyDurationCount<=Je.liveSyncDurationCount))throw new Error('Illegal hls.js config: "liveMaxLatencyDurationCount" must be greater than "liveSyncDurationCount"');if(Je.liveMaxLatencyDuration!==void 0&&(Je.liveSyncDuration===void 0||Je.liveMaxLatencyDuration<=Je.liveSyncDuration))throw new Error('Illegal hls.js config: "liveMaxLatencyDuration" must be greater than "liveSyncDuration"');return hs({},Ge,Je)}(v.DefaultConfig,o);this.userConfig=o,(0,w.enableLogs)(c.debug,"Hls instance"),this._autoLevelCapping=-1,c.progressive&&function(Ge){var Je=Ge.loader;Je!==Jt&&Je!==br?(w.logger.log("[config]: Custom loader detected, cannot enable progressive streaming"),Ge.progressive=!1):function(){if(self.fetch&&self.AbortController&&self.ReadableStream&&self.Request)try{return new self.ReadableStream({}),!0}catch{}return!1}()&&(Ge.loader=Jt,Ge.progressive=!0,Ge.enableSoftwareAES=!0,w.logger.log("[config]: Progressive streaming enabled, using FetchLoader"))}(c);var i=c.abrController,u=c.bufferController,p=c.capLevelController,g=c.fpsController,y=this.abrController=new i(this),b=this.bufferController=new u(this),D=this.capLevelController=new p(this),F=new g(this),G=new Fe(this),ee=new Zt(this),J=this.levelController=new kt(this),le=new Ht(this),Se=new cn(this.config),we=this.streamController=new Zo(this,le,Se);D.setStreamController(we),F.setStreamController(we);var be=[G,J,we];this.networkControllers=be;var Pe=[y,b,D,F,ee,le];this.audioTrackController=this.createController(c.audioTrackController,be);var tt=c.audioStreamController;tt&&be.push(new tt(this,le,Se)),this.subtitleTrackController=this.createController(c.subtitleTrackController,be);var rt=c.subtitleStreamController;rt&&be.push(new rt(this,le,Se)),this.createController(c.timelineController,Pe),Se.emeController=this.emeController=this.createController(c.emeController,Pe),this.cmcdController=this.createController(c.cmcdController,Pe),this.latencyController=this.createController(fr,Pe),this.coreComponents=Pe}v.isSupported=function(){return function(){var o=Os();if(!o)return!1;var c=Ps(),i=o&&typeof o.isTypeSupported=="function"&&o.isTypeSupported('video/mp4; codecs="avc1.42E01E,mp4a.40.2"'),u=!c||c.prototype&&typeof c.prototype.appendBuffer=="function"&&typeof c.prototype.remove=="function";return!!i&&!!u}()};var h,t,n,s=v.prototype;return s.createController=function(o,c){if(o){var i=new o(this);return c&&c.push(i),i}return null},s.on=function(o,c,i){i===void 0&&(i=this),this._emitter.on(o,c,i)},s.once=function(o,c,i){i===void 0&&(i=this),this._emitter.once(o,c,i)},s.removeAllListeners=function(o){this._emitter.removeAllListeners(o)},s.off=function(o,c,i,u){i===void 0&&(i=this),this._emitter.off(o,c,i,u)},s.listeners=function(o){return this._emitter.listeners(o)},s.emit=function(o,c,i){return this._emitter.emit(o,c,i)},s.trigger=function(o,c){if(this.config.debug)return this.emit(o,o,c);try{return this.emit(o,o,c)}catch(i){w.logger.error("An internal error happened while handling event "+o+'. Error message: "'+i.message+'". Here is a stacktrace:',i),this.trigger(E.Events.ERROR,{type:A.ErrorTypes.OTHER_ERROR,details:A.ErrorDetails.INTERNAL_EXCEPTION,fatal:!1,event:o,error:i})}return!1},s.listenerCount=function(o){return this._emitter.listenerCount(o)},s.destroy=function(){w.logger.log("destroy"),this.trigger(E.Events.DESTROYING,void 0),this.detachMedia(),this.removeAllListeners(),this._autoLevelCapping=-1,this.url=null,this.networkControllers.forEach(function(o){return o.destroy()}),this.networkControllers.length=0,this.coreComponents.forEach(function(o){return o.destroy()}),this.coreComponents.length=0},s.attachMedia=function(o){w.logger.log("attachMedia"),this._media=o,this.trigger(E.Events.MEDIA_ATTACHING,{media:o})},s.detachMedia=function(){w.logger.log("detachMedia"),this.trigger(E.Events.MEDIA_DETACHING,void 0),this._media=null},s.loadSource=function(o){this.stopLoad();var c=this.media,i=this.url,u=this.url=U.buildAbsoluteURL(self.location.href,o,{alwaysNormalize:!0});w.logger.log("loadSource:"+u),c&&i&&i!==u&&this.bufferController.hasSourceTypes()&&(this.detachMedia(),this.attachMedia(c)),this.trigger(E.Events.MANIFEST_LOADING,{url:o})},s.startLoad=function(o){o===void 0&&(o=-1),w.logger.log("startLoad("+o+")"),this.networkControllers.forEach(function(c){c.startLoad(o)})},s.stopLoad=function(){w.logger.log("stopLoad"),this.networkControllers.forEach(function(o){o.stopLoad()})},s.swapAudioCodec=function(){w.logger.log("swapAudioCodec"),this.streamController.swapAudioCodec()},s.recoverMediaError=function(){w.logger.log("recoverMediaError");var o=this._media;this.detachMedia(),o&&this.attachMedia(o)},s.removeLevel=function(o,c){c===void 0&&(c=0),this.levelController.removeLevel(o,c)},h=v,n=[{key:"version",get:function(){return"1.3.5"}},{key:"Events",get:function(){return E.Events}},{key:"ErrorTypes",get:function(){return A.ErrorTypes}},{key:"ErrorDetails",get:function(){return A.ErrorDetails}},{key:"DefaultConfig",get:function(){return v.defaultConfig?v.defaultConfig:ml},set:function(o){v.defaultConfig=o}}],(t=[{key:"levels",get:function(){return this.levelController.levels||[]}},{key:"currentLevel",get:function(){return this.streamController.currentLevel},set:function(o){w.logger.log("set currentLevel:"+o),this.loadLevel=o,this.abrController.clearTimer(),this.streamController.immediateLevelSwitch()}},{key:"nextLevel",get:function(){return this.streamController.nextLevel},set:function(o){w.logger.log("set nextLevel:"+o),this.levelController.manualLevel=o,this.streamController.nextLevelSwitch()}},{key:"loadLevel",get:function(){return this.levelController.level},set:function(o){w.logger.log("set loadLevel:"+o),this.levelController.manualLevel=o}},{key:"nextLoadLevel",get:function(){return this.levelController.nextLoadLevel},set:function(o){this.levelController.nextLoadLevel=o}},{key:"firstLevel",get:function(){return Math.max(this.levelController.firstLevel,this.minAutoLevel)},set:function(o){w.logger.log("set firstLevel:"+o),this.levelController.firstLevel=o}},{key:"startLevel",get:function(){return this.levelController.startLevel},set:function(o){w.logger.log("set startLevel:"+o),o!==-1&&(o=Math.max(o,this.minAutoLevel)),this.levelController.startLevel=o}},{key:"capLevelToPlayerSize",get:function(){return this.config.capLevelToPlayerSize},set:function(o){var c=!!o;c!==this.config.capLevelToPlayerSize&&(c?this.capLevelController.startCapping():(this.capLevelController.stopCapping(),this.autoLevelCapping=-1,this.streamController.nextLevelSwitch()),this.config.capLevelToPlayerSize=c)}},{key:"autoLevelCapping",get:function(){return this._autoLevelCapping},set:function(o){this._autoLevelCapping!==o&&(w.logger.log("set autoLevelCapping:"+o),this._autoLevelCapping=o)}},{key:"bandwidthEstimate",get:function(){var o=this.abrController.bwEstimator;return o?o.getEstimate():NaN}},{key:"maxHdcpLevel",get:function(){return this._maxHdcpLevel},set:function(o){yr.indexOf(o)>-1&&(this._maxHdcpLevel=o)}},{key:"autoLevelEnabled",get:function(){return this.levelController.manualLevel===-1}},{key:"manualLevel",get:function(){return this.levelController.manualLevel}},{key:"minAutoLevel",get:function(){var o=this.levels,c=this.config.minAutoBitrate;if(!o)return 0;for(var i=o.length,u=0;u<i;u++)if(o[u].maxBitrate>=c)return u;return 0}},{key:"maxAutoLevel",get:function(){var o,c=this.levels,i=this.autoLevelCapping,u=this.maxHdcpLevel;if(o=i===-1&&c&&c.length?c.length-1:i,u)for(var p=o;p--;){var g=c[p].attrs["HDCP-LEVEL"];if(g&&g<=u)return p}return o}},{key:"nextAutoLevel",get:function(){return Math.min(Math.max(this.abrController.nextAutoLevel,this.minAutoLevel),this.maxAutoLevel)},set:function(o){this.abrController.nextAutoLevel=Math.max(this.minAutoLevel,o)}},{key:"playingDate",get:function(){return this.streamController.currentProgramDateTime}},{key:"mainForwardBufferInfo",get:function(){return this.streamController.getMainFwdBufferInfo()}},{key:"audioTracks",get:function(){var o=this.audioTrackController;return o?o.audioTracks:[]}},{key:"audioTrack",get:function(){var o=this.audioTrackController;return o?o.audioTrack:-1},set:function(o){var c=this.audioTrackController;c&&(c.audioTrack=o)}},{key:"subtitleTracks",get:function(){var o=this.subtitleTrackController;return o?o.subtitleTracks:[]}},{key:"subtitleTrack",get:function(){var o=this.subtitleTrackController;return o?o.subtitleTrack:-1},set:function(o){var c=this.subtitleTrackController;c&&(c.subtitleTrack=o)}},{key:"media",get:function(){return this._media}},{key:"subtitleDisplay",get:function(){var o=this.subtitleTrackController;return!!o&&o.subtitleDisplay},set:function(o){var c=this.subtitleTrackController;c&&(c.subtitleDisplay=o)}},{key:"lowLatencyMode",get:function(){return this.config.lowLatencyMode},set:function(o){this.config.lowLatencyMode=o}},{key:"liveSyncPosition",get:function(){return this.latencyController.liveSyncPosition}},{key:"latency",get:function(){return this.latencyController.latency}},{key:"maxLatency",get:function(){return this.latencyController.maxLatency}},{key:"targetLatency",get:function(){return this.latencyController.targetLatency}},{key:"drift",get:function(){return this.latencyController.drift}},{key:"forceStartLoad",get:function(){return this.streamController.forceStartLoad}}])&&Bi(h.prototype,t),n&&Bi(h,n),Object.defineProperty(h,"prototype",{writable:!1}),v}();An.defaultConfig=void 0},923:(L,I,k)=>{k.r(I),k.d(I,{BaseSegment:()=>V,ElementaryStreamTypes:()=>x,Fragment:()=>ne,Part:()=>Y});var x,U=k(965),O=k(945),E=k(408);function A(re,ie){re.prototype=Object.create(ie.prototype),re.prototype.constructor=re,w(re,ie)}function w(re,ie){return w=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(Z,N){return Z.__proto__=N,Z},w(re,ie)}function te(re,ie){for(var Z=0;Z<ie.length;Z++){var N=ie[Z];N.enumerable=N.enumerable||!1,N.configurable=!0,"value"in N&&(N.writable=!0),Object.defineProperty(re,typeof(W=function(me,xe){if(typeof me!="object"||me===null)return me;var j=me[Symbol.toPrimitive];if(j!==void 0){var C=j.call(me,xe);if(typeof C!="object")return C;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(me)}(N.key,"string"))=="symbol"?W:String(W),N)}var W}function K(re,ie,Z){return ie&&te(re.prototype,ie),Z&&te(re,Z),Object.defineProperty(re,"prototype",{writable:!1}),re}(function(re){re.AUDIO="audio",re.VIDEO="video",re.AUDIOVIDEO="audiovideo"})(x||(x={}));var V=function(){function re(ie){var Z;this._byteRange=null,this._url=null,this.baseurl=void 0,this.relurl=void 0,this.elementaryStreams=((Z={})[x.AUDIO]=null,Z[x.VIDEO]=null,Z[x.AUDIOVIDEO]=null,Z),this.baseurl=ie}return re.prototype.setByteRange=function(ie,Z){var N=ie.split("@",2),W=[];N.length===1?W[0]=Z?Z.byteRangeEndOffset:0:W[0]=parseInt(N[1]),W[1]=parseInt(N[0])+W[0],this._byteRange=W},K(re,[{key:"byteRange",get:function(){return this._byteRange?this._byteRange:[]}},{key:"byteRangeStartOffset",get:function(){return this.byteRange[0]}},{key:"byteRangeEndOffset",get:function(){return this.byteRange[1]}},{key:"url",get:function(){return!this._url&&this.baseurl&&this.relurl&&(this._url=(0,O.buildAbsoluteURL)(this.baseurl,this.relurl,{alwaysNormalize:!0})),this._url||""},set:function(ie){this._url=ie}}]),re}(),ne=function(re){function ie(N,W){var me;return(me=re.call(this,W)||this)._decryptdata=null,me.rawProgramDateTime=null,me.programDateTime=null,me.tagList=[],me.duration=0,me.sn=0,me.levelkeys=void 0,me.type=void 0,me.loader=null,me.keyLoader=null,me.level=-1,me.cc=0,me.startPTS=void 0,me.endPTS=void 0,me.appendedPTS=void 0,me.startDTS=void 0,me.endDTS=void 0,me.start=0,me.deltaPTS=void 0,me.maxStartPTS=void 0,me.minEndPTS=void 0,me.stats=new E.LoadStats,me.urlId=0,me.data=void 0,me.bitrateTest=!1,me.title=null,me.initSegment=null,me.endList=void 0,me.type=N,me}A(ie,re);var Z=ie.prototype;return Z.setKeyFormat=function(N){if(this.levelkeys){var W=this.levelkeys[N];W&&!this._decryptdata&&(this._decryptdata=W.getDecryptData(this.sn))}},Z.abortRequests=function(){var N,W;(N=this.loader)===null||N===void 0||N.abort(),(W=this.keyLoader)===null||W===void 0||W.abort()},Z.setElementaryStreamInfo=function(N,W,me,xe,j,C){C===void 0&&(C=!1);var q=this.elementaryStreams,H=q[N];H?(H.startPTS=Math.min(H.startPTS,W),H.endPTS=Math.max(H.endPTS,me),H.startDTS=Math.min(H.startDTS,xe),H.endDTS=Math.max(H.endDTS,j)):q[N]={startPTS:W,endPTS:me,startDTS:xe,endDTS:j,partial:C}},Z.clearElementaryStreamInfo=function(){var N=this.elementaryStreams;N[x.AUDIO]=null,N[x.VIDEO]=null,N[x.AUDIOVIDEO]=null},K(ie,[{key:"decryptdata",get:function(){if(!this.levelkeys&&!this._decryptdata)return null;if(!this._decryptdata&&this.levelkeys&&!this.levelkeys.NONE){var N=this.levelkeys.identity;if(N)this._decryptdata=N.getDecryptData(this.sn);else{var W=Object.keys(this.levelkeys);if(W.length===1)return this._decryptdata=this.levelkeys[W[0]].getDecryptData(this.sn)}}return this._decryptdata}},{key:"end",get:function(){return this.start+this.duration}},{key:"endProgramDateTime",get:function(){if(this.programDateTime===null||!(0,U.isFiniteNumber)(this.programDateTime))return null;var N=(0,U.isFiniteNumber)(this.duration)?this.duration:0;return this.programDateTime+1e3*N}},{key:"encrypted",get:function(){var N;if((N=this._decryptdata)!==null&&N!==void 0&&N.encrypted)return!0;if(this.levelkeys){var W=Object.keys(this.levelkeys),me=W.length;if(me>1||me===1&&this.levelkeys[W[0]].encrypted)return!0}return!1}}]),ie}(V),Y=function(re){function ie(Z,N,W,me,xe){var j;(j=re.call(this,W)||this).fragOffset=0,j.duration=0,j.gap=!1,j.independent=!1,j.relurl=void 0,j.fragment=void 0,j.index=void 0,j.stats=new E.LoadStats,j.duration=Z.decimalFloatingPoint("DURATION"),j.gap=Z.bool("GAP"),j.independent=Z.bool("INDEPENDENT"),j.relurl=Z.enumeratedString("URI"),j.fragment=N,j.index=me;var C=Z.enumeratedString("BYTERANGE");return C&&j.setByteRange(C,xe),xe&&(j.fragOffset=xe.fragOffset+xe.duration),j}return A(ie,re),K(ie,[{key:"start",get:function(){return this.fragment.start+this.fragOffset}},{key:"end",get:function(){return this.start+this.duration}},{key:"loaded",get:function(){var Z=this.elementaryStreams;return!!(Z.audio||Z.video||Z.audiovideo)}}]),ie}(V)},408:(L,I,k)=>{k.r(I),k.d(I,{LoadStats:()=>x});var x=function(){this.aborted=!1,this.loaded=0,this.retry=0,this.total=0,this.chunkCount=0,this.bwEstimate=0,this.loading={start:0,first:0,end:0},this.parsing={start:0,end:0},this.buffering={start:0,first:0,end:0}}},965:(L,I,k)=>{k.r(I),k.d(I,{MAX_SAFE_INTEGER:()=>U,isFiniteNumber:()=>x});var x=Number.isFinite||function(O){return typeof O=="number"&&isFinite(O)},U=Number.MAX_SAFE_INTEGER||9007199254740991},524:(L,I,k)=>{k.r(I),k.d(I,{default:()=>Z,flushTextTrackMetadataCueSamples:()=>W,flushTextTrackUserdataCueSamples:()=>me,normalizePts:()=>N});var x=k(965);const U=function(){function C(){}return C.getSilentFrame=function(q,H){if(q==="mp4a.40.2"){if(H===1)return new Uint8Array([0,200,0,128,35,128]);if(H===2)return new Uint8Array([33,0,73,144,2,25,0,35,128]);if(H===3)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,142]);if(H===4)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,128,44,128,8,2,56]);if(H===5)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,56]);if(H===6)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,0,178,0,32,8,224])}else{if(H===1)return new Uint8Array([1,64,34,128,163,78,230,128,186,8,0,0,0,28,6,241,193,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(H===2)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(H===3)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94])}},C}();var O=Math.pow(2,32)-1,E=function(){function C(){}return C.init=function(){var q;for(q in C.types={avc1:[],avcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],".mp3":[],mvex:[],mvhd:[],pasp:[],sdtp:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[],smhd:[]},C.types)C.types.hasOwnProperty(q)&&(C.types[q]=[q.charCodeAt(0),q.charCodeAt(1),q.charCodeAt(2),q.charCodeAt(3)]);var H=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]),ye=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]);C.HDLR_TYPES={video:H,audio:ye};var he=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]),Ee=new Uint8Array([0,0,0,0,0,0,0,0]);C.STTS=C.STSC=C.STCO=Ee,C.STSZ=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]),C.VMHD=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0]),C.SMHD=new Uint8Array([0,0,0,0,0,0,0,0]),C.STSD=new Uint8Array([0,0,0,0,0,0,0,1]);var Ae=new Uint8Array([105,115,111,109]),qe=new Uint8Array([97,118,99,49]),je=new Uint8Array([0,0,0,1]);C.FTYP=C.box(C.types.ftyp,Ae,je,Ae,qe),C.DINF=C.box(C.types.dinf,C.box(C.types.dref,he))},C.box=function(q){for(var H=8,ye=arguments.length,he=new Array(ye>1?ye-1:0),Ee=1;Ee<ye;Ee++)he[Ee-1]=arguments[Ee];for(var Ae=he.length,qe=Ae;Ae--;)H+=he[Ae].byteLength;var je=new Uint8Array(H);for(je[0]=H>>24&255,je[1]=H>>16&255,je[2]=H>>8&255,je[3]=255&H,je.set(q,4),Ae=0,H=8;Ae<qe;Ae++)je.set(he[Ae],H),H+=he[Ae].byteLength;return je},C.hdlr=function(q){return C.box(C.types.hdlr,C.HDLR_TYPES[q])},C.mdat=function(q){return C.box(C.types.mdat,q)},C.mdhd=function(q,H){H*=q;var ye=Math.floor(H/(O+1)),he=Math.floor(H%(O+1));return C.box(C.types.mdhd,new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,q>>24&255,q>>16&255,q>>8&255,255&q,ye>>24,ye>>16&255,ye>>8&255,255&ye,he>>24,he>>16&255,he>>8&255,255&he,85,196,0,0]))},C.mdia=function(q){return C.box(C.types.mdia,C.mdhd(q.timescale,q.duration),C.hdlr(q.type),C.minf(q))},C.mfhd=function(q){return C.box(C.types.mfhd,new Uint8Array([0,0,0,0,q>>24,q>>16&255,q>>8&255,255&q]))},C.minf=function(q){return q.type==="audio"?C.box(C.types.minf,C.box(C.types.smhd,C.SMHD),C.DINF,C.stbl(q)):C.box(C.types.minf,C.box(C.types.vmhd,C.VMHD),C.DINF,C.stbl(q))},C.moof=function(q,H,ye){return C.box(C.types.moof,C.mfhd(q),C.traf(ye,H))},C.moov=function(q){for(var H=q.length,ye=[];H--;)ye[H]=C.trak(q[H]);return C.box.apply(null,[C.types.moov,C.mvhd(q[0].timescale,q[0].duration)].concat(ye).concat(C.mvex(q)))},C.mvex=function(q){for(var H=q.length,ye=[];H--;)ye[H]=C.trex(q[H]);return C.box.apply(null,[C.types.mvex].concat(ye))},C.mvhd=function(q,H){H*=q;var ye=Math.floor(H/(O+1)),he=Math.floor(H%(O+1)),Ee=new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,q>>24&255,q>>16&255,q>>8&255,255&q,ye>>24,ye>>16&255,ye>>8&255,255&ye,he>>24,he>>16&255,he>>8&255,255&he,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]);return C.box(C.types.mvhd,Ee)},C.sdtp=function(q){var H,ye,he=q.samples||[],Ee=new Uint8Array(4+he.length);for(H=0;H<he.length;H++)ye=he[H].flags,Ee[H+4]=ye.dependsOn<<4|ye.isDependedOn<<2|ye.hasRedundancy;return C.box(C.types.sdtp,Ee)},C.stbl=function(q){return C.box(C.types.stbl,C.stsd(q),C.box(C.types.stts,C.STTS),C.box(C.types.stsc,C.STSC),C.box(C.types.stsz,C.STSZ),C.box(C.types.stco,C.STCO))},C.avc1=function(q){var H,ye,he,Ee=[],Ae=[];for(H=0;H<q.sps.length;H++)he=(ye=q.sps[H]).byteLength,Ee.push(he>>>8&255),Ee.push(255&he),Ee=Ee.concat(Array.prototype.slice.call(ye));for(H=0;H<q.pps.length;H++)he=(ye=q.pps[H]).byteLength,Ae.push(he>>>8&255),Ae.push(255&he),Ae=Ae.concat(Array.prototype.slice.call(ye));var qe=C.box(C.types.avcC,new Uint8Array([1,Ee[3],Ee[4],Ee[5],255,224|q.sps.length].concat(Ee).concat([q.pps.length]).concat(Ae))),je=q.width,Xe=q.height,Ve=q.pixelRatio[0],Ie=q.pixelRatio[1];return C.box(C.types.avc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,je>>8&255,255&je,Xe>>8&255,255&Xe,0,72,0,0,0,72,0,0,0,0,0,0,0,1,18,100,97,105,108,121,109,111,116,105,111,110,47,104,108,115,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),qe,C.box(C.types.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192])),C.box(C.types.pasp,new Uint8Array([Ve>>24,Ve>>16&255,Ve>>8&255,255&Ve,Ie>>24,Ie>>16&255,Ie>>8&255,255&Ie])))},C.esds=function(q){var H=q.config.length;return new Uint8Array([0,0,0,0,3,23+H,0,1,0,4,15+H,64,21,0,0,0,0,0,0,0,0,0,0,0,5].concat([H]).concat(q.config).concat([6,1,2]))},C.mp4a=function(q){var H=q.samplerate;return C.box(C.types.mp4a,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,q.channelCount,0,16,0,0,0,0,H>>8&255,255&H,0,0]),C.box(C.types.esds,C.esds(q)))},C.mp3=function(q){var H=q.samplerate;return C.box(C.types[".mp3"],new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,q.channelCount,0,16,0,0,0,0,H>>8&255,255&H,0,0]))},C.stsd=function(q){return q.type==="audio"?q.segmentCodec==="mp3"&&q.codec==="mp3"?C.box(C.types.stsd,C.STSD,C.mp3(q)):C.box(C.types.stsd,C.STSD,C.mp4a(q)):C.box(C.types.stsd,C.STSD,C.avc1(q))},C.tkhd=function(q){var H=q.id,ye=q.duration*q.timescale,he=q.width,Ee=q.height,Ae=Math.floor(ye/(O+1)),qe=Math.floor(ye%(O+1));return C.box(C.types.tkhd,new Uint8Array([1,0,0,7,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,H>>24&255,H>>16&255,H>>8&255,255&H,0,0,0,0,Ae>>24,Ae>>16&255,Ae>>8&255,255&Ae,qe>>24,qe>>16&255,qe>>8&255,255&qe,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,he>>8&255,255&he,0,0,Ee>>8&255,255&Ee,0,0]))},C.traf=function(q,H){var ye=C.sdtp(q),he=q.id,Ee=Math.floor(H/(O+1)),Ae=Math.floor(H%(O+1));return C.box(C.types.traf,C.box(C.types.tfhd,new Uint8Array([0,0,0,0,he>>24,he>>16&255,he>>8&255,255&he])),C.box(C.types.tfdt,new Uint8Array([1,0,0,0,Ee>>24,Ee>>16&255,Ee>>8&255,255&Ee,Ae>>24,Ae>>16&255,Ae>>8&255,255&Ae])),C.trun(q,ye.length+16+20+8+16+8+8),ye)},C.trak=function(q){return q.duration=q.duration||4294967295,C.box(C.types.trak,C.tkhd(q),C.mdia(q))},C.trex=function(q){var H=q.id;return C.box(C.types.trex,new Uint8Array([0,0,0,0,H>>24,H>>16&255,H>>8&255,255&H,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]))},C.trun=function(q,H){var ye,he,Ee,Ae,qe,je,Xe=q.samples||[],Ve=Xe.length,Ie=12+16*Ve,He=new Uint8Array(Ie);for(H+=8+Ie,He.set([q.type==="video"?1:0,0,15,1,Ve>>>24&255,Ve>>>16&255,Ve>>>8&255,255&Ve,H>>>24&255,H>>>16&255,H>>>8&255,255&H],0),ye=0;ye<Ve;ye++)Ee=(he=Xe[ye]).duration,Ae=he.size,qe=he.flags,je=he.cts,He.set([Ee>>>24&255,Ee>>>16&255,Ee>>>8&255,255&Ee,Ae>>>24&255,Ae>>>16&255,Ae>>>8&255,255&Ae,qe.isLeading<<2|qe.dependsOn,qe.isDependedOn<<6|qe.hasRedundancy<<4|qe.paddingValue<<1|qe.isNonSync,61440&qe.degradPrio,15&qe.degradPrio,je>>>24&255,je>>>16&255,je>>>8&255,255&je],12+16*ye);return C.box(C.types.trun,He)},C.initSegment=function(q){C.types||C.init();var H=C.moov(q),ye=new Uint8Array(C.FTYP.byteLength+H.byteLength);return ye.set(C.FTYP),ye.set(H,C.FTYP.byteLength),ye},C}();E.types=void 0,E.HDLR_TYPES=void 0,E.STTS=void 0,E.STSC=void 0,E.STCO=void 0,E.STSZ=void 0,E.VMHD=void 0,E.SMHD=void 0,E.STSD=void 0,E.FTYP=void 0,E.DINF=void 0;const A=E;var w=k(851),te=k(973),K=k(93),V=k(308),ne=k(673);function Y(){return Y=Object.assign?Object.assign.bind():function(C){for(var q=1;q<arguments.length;q++){var H=arguments[q];for(var ye in H)Object.prototype.hasOwnProperty.call(H,ye)&&(C[ye]=H[ye])}return C},Y.apply(this,arguments)}var re=null,ie=null,Z=function(){function C(H,ye,he,Ee){if(this.observer=void 0,this.config=void 0,this.typeSupported=void 0,this.ISGenerated=!1,this._initPTS=void 0,this._initDTS=void 0,this.nextAvcDts=null,this.nextAudioPts=null,this.videoSampleDuration=null,this.isAudioContiguous=!1,this.isVideoContiguous=!1,this.observer=H,this.config=ye,this.typeSupported=he,this.ISGenerated=!1,re===null){var Ae=(navigator.userAgent||"").match(/Chrome\/(\d+)/i);re=Ae?parseInt(Ae[1]):0}if(ie===null){var qe=navigator.userAgent.match(/Safari\/(\d+)/i);ie=qe?parseInt(qe[1]):0}}var q=C.prototype;return q.destroy=function(){},q.resetTimeStamp=function(H){K.logger.log("[mp4-remuxer]: initPTS & initDTS reset"),this._initPTS=this._initDTS=H},q.resetNextTimestamp=function(){K.logger.log("[mp4-remuxer]: reset next timestamp"),this.isVideoContiguous=!1,this.isAudioContiguous=!1},q.resetInitSegment=function(){K.logger.log("[mp4-remuxer]: ISGenerated flag reset"),this.ISGenerated=!1},q.getVideoStartPts=function(H){var ye=!1,he=H.reduce(function(Ee,Ae){var qe=Ae.pts-Ee;return qe<-4294967296?(ye=!0,N(Ee,Ae.pts)):qe>0?Ee:Ae.pts},H[0].pts);return ye&&K.logger.debug("PTS rollover detected"),he},q.remux=function(H,ye,he,Ee,Ae,qe,je,Xe){var Ve,Ie,He,ce,De,ve,Be=Ae,Te=Ae,ze=H.pid>-1,We=ye.pid>-1,$e=ye.samples.length,it=H.samples.length>0,ue=je&&$e>0||$e>1;if((!ze||it)&&(!We||ue)||this.ISGenerated||je){this.ISGenerated||(He=this.generateIS(H,ye,Ae));var ot,Fe=this.isVideoContiguous,nt=-1;if(ue&&(nt=function(Ct){for(var Ft=0;Ft<Ct.length;Ft++)if(Ct[Ft].key)return Ft;return-1}(ye.samples),!Fe&&this.config.forceKeyFrameOnDiscontinuity))if(ve=!0,nt>0){K.logger.warn("[mp4-remuxer]: Dropped "+nt+" out of "+$e+" video samples due to a missing keyframe");var ht=this.getVideoStartPts(ye.samples);ye.samples=ye.samples.slice(nt),ye.dropped+=nt,ot=Te+=(ye.samples[0].pts-ht)/ye.inputTimeScale}else nt===-1&&(K.logger.warn("[mp4-remuxer]: No keyframe found out of "+$e+" video samples"),ve=!1);if(this.ISGenerated){if(it&&ue){var Pt=this.getVideoStartPts(ye.samples),jt=(N(H.samples[0].pts,Pt)-Pt)/ye.inputTimeScale;Be+=Math.max(0,jt),Te+=Math.max(0,-jt)}if(it){if(H.samplerate||(K.logger.warn("[mp4-remuxer]: regenerate InitSegment as audio detected"),He=this.generateIS(H,ye,Ae)),Ie=this.remuxAudio(H,Be,this.isAudioContiguous,qe,We||ue||Xe===V.PlaylistLevelType.AUDIO?Te:void 0),ue){var Rt=Ie?Ie.endPTS-Ie.startPTS:0;ye.inputTimeScale||(K.logger.warn("[mp4-remuxer]: regenerate InitSegment as video detected"),He=this.generateIS(H,ye,Ae)),Ve=this.remuxVideo(ye,Te,Fe,Rt)}}else ue&&(Ve=this.remuxVideo(ye,Te,Fe,0));Ve&&(Ve.firstKeyFrame=nt,Ve.independent=nt!==-1,Ve.firstKeyFramePTS=ot)}}return this.ISGenerated&&(he.samples.length&&(De=W(he,Ae,this._initPTS,this._initDTS)),Ee.samples.length&&(ce=me(Ee,Ae,this._initPTS))),{audio:Ie,video:Ve,initSegment:He,independent:ve,text:ce,id3:De}},q.generateIS=function(H,ye,he){var Ee,Ae,qe,je=H.samples,Xe=ye.samples,Ve=this.typeSupported,Ie={},He=!(0,x.isFiniteNumber)(this._initPTS),ce="audio/mp4";if(He&&(Ee=Ae=1/0),H.config&&je.length&&(H.timescale=H.samplerate,H.segmentCodec==="mp3"&&(Ve.mpeg?(ce="audio/mpeg",H.codec=""):Ve.mp3&&(H.codec="mp3")),Ie.audio={id:"audio",container:ce,codec:H.codec,initSegment:H.segmentCodec==="mp3"&&Ve.mpeg?new Uint8Array(0):A.initSegment([H]),metadata:{channelCount:H.channelCount}},He&&(qe=H.inputTimeScale,Ee=Ae=je[0].pts-Math.round(qe*he))),ye.sps&&ye.pps&&Xe.length&&(ye.timescale=ye.inputTimeScale,Ie.video={id:"main",container:"video/mp4",codec:ye.codec,initSegment:A.initSegment([ye]),metadata:{width:ye.width,height:ye.height}},He)){qe=ye.inputTimeScale;var De=this.getVideoStartPts(Xe),ve=Math.round(qe*he);Ae=Math.min(Ae,N(Xe[0].dts,De)-ve),Ee=Math.min(Ee,De-ve)}if(Object.keys(Ie).length)return this.ISGenerated=!0,He&&(this._initPTS=Ee,this._initDTS=Ae),{tracks:Ie,initPTS:Ee,timescale:qe}},q.remuxVideo=function(H,ye,he,Ee){var Ae,qe,je=H.inputTimeScale,Xe=H.samples,Ve=[],Ie=Xe.length,He=this._initPTS,ce=this.nextAvcDts,De=8,ve=this.videoSampleDuration,Be=Number.POSITIVE_INFINITY,Te=Number.NEGATIVE_INFINITY,ze=!1;he&&ce!==null||(ce=ye*je-(Xe[0].pts-N(Xe[0].dts,Xe[0].pts)));for(var We=0;We<Ie;We++){var $e=Xe[We];$e.pts=N($e.pts-He,ce),$e.dts=N($e.dts-He,ce),$e.dts<Xe[We>0?We-1:We].dts&&(ze=!0)}ze&&Xe.sort(function(sr,Cr){var cn=sr.dts-Cr.dts,Wn=sr.pts-Cr.pts;return cn||Wn}),Ae=Xe[0].dts;var it=Xe[Xe.length-1].dts-Ae,ue=it?Math.round(it/(Ie-1)):ve||H.inputTimeScale/30;if(he){var ot=Ae-ce,Fe=ot>ue,nt=ot<-1;if((Fe||nt)&&(Fe?K.logger.warn("AVC: "+(0,ne.toMsFromMpegTsClock)(ot,!0)+" ms ("+ot+"dts) hole between fragments detected, filling it"):K.logger.warn("AVC: "+(0,ne.toMsFromMpegTsClock)(-ot,!0)+" ms ("+ot+"dts) overlapping between fragments detected"),!nt||ce>Xe[0].pts)){Ae=ce;var ht=Xe[0].pts-ot;Xe[0].dts=Ae,Xe[0].pts=ht,K.logger.log("Video: First PTS/DTS adjusted: "+(0,ne.toMsFromMpegTsClock)(ht,!0)+"/"+(0,ne.toMsFromMpegTsClock)(Ae,!0)+", delta: "+(0,ne.toMsFromMpegTsClock)(ot,!0)+" ms")}}Ae=Math.max(0,Ae);for(var Pt=0,jt=0,Rt=0;Rt<Ie;Rt++){for(var Ct=Xe[Rt],Ft=Ct.units,Kt=Ft.length,It=0,Zt=0;Zt<Kt;Zt++)It+=Ft[Zt].data.length;jt+=It,Pt+=Kt,Ct.length=It,Ct.dts=Math.max(Ct.dts,Ae),Be=Math.min(Ct.pts,Be),Te=Math.max(Ct.pts,Te)}qe=Xe[Ie-1].dts;var cr,fr=jt+4*Pt+8;try{cr=new Uint8Array(fr)}catch{return void this.observer.emit(w.Events.ERROR,w.Events.ERROR,{type:te.ErrorTypes.MUX_ERROR,details:te.ErrorDetails.REMUX_ALLOC_ERROR,fatal:!1,bytes:fr,reason:"fail allocating video mdat "+fr})}var kr=new DataView(cr.buffer);kr.setUint32(0,fr),cr.set(A.types.mdat,4);for(var wr=!1,yr=Number.POSITIVE_INFINITY,pe=Number.POSITIVE_INFINITY,$=Number.NEGATIVE_INFINITY,M=Number.NEGATIVE_INFINITY,z=0;z<Ie;z++){for(var Q=Xe[z],se=Q.units,oe=0,de=0,Ce=se.length;de<Ce;de++){var Me=se[de],Ne=Me.data,Ze=Me.data.byteLength;kr.setUint32(De,Ze),De+=4,cr.set(Ne,De),De+=Ze,oe+=4+Ze}var at=void 0;if(z<Ie-1)ve=Xe[z+1].dts-Q.dts,at=Xe[z+1].pts-Q.pts;else{var et=this.config,ft=z>0?Q.dts-Xe[z-1].dts:ue;if(at=z>0?Q.pts-Xe[z-1].pts:ue,et.stretchShortVideoTrack&&this.nextAudioPts!==null){var kt=Math.floor(et.maxBufferHole*je),Ht=(Ee?Be+Ee*je:this.nextAudioPts)-Q.pts;Ht>kt?((ve=Ht-ft)<0?ve=ft:wr=!0,K.logger.log("[mp4-remuxer]: It is approximately "+Ht/90+" ms to the next segment; using duration "+ve/90+" ms for the last video frame.")):ve=ft}else ve=ft}var ct=Math.round(Q.pts-Q.dts);yr=Math.min(yr,ve),$=Math.max($,ve),pe=Math.min(pe,at),M=Math.max(M,at),Ve.push(new xe(Q.key,ve,oe,ct))}if(Ve.length){if(re){if(re<70){var zt=Ve[0].flags;zt.dependsOn=2,zt.isNonSync=0}}else if(ie&&M-pe<$-yr&&ue/$<.025&&Ve[0].cts===0){K.logger.warn("Found irregular gaps in sample duration. Using PTS instead of DTS to determine MP4 sample duration.");for(var Er=Ae,Qt=0,_r=Ve.length;Qt<_r;Qt++){var hr=Er+Ve[Qt].duration,mt=Er+Ve[Qt].cts;if(Qt<_r-1){var Br=hr+Ve[Qt+1].cts;Ve[Qt].duration=Br-mt}else Ve[Qt].duration=Qt?Ve[Qt-1].duration:ue;Ve[Qt].cts=0,Er=hr}}}ve=wr||!ve?ue:ve,this.nextAvcDts=ce=qe+ve,this.videoSampleDuration=ve,this.isVideoContiguous=!0;var un={data1:A.moof(H.sequenceNumber++,Ae,Y({},H,{samples:Ve})),data2:cr,startPTS:Be/je,endPTS:(Te+ve)/je,startDTS:Ae/je,endDTS:ce/je,type:"video",hasAudio:!1,hasVideo:!0,nb:Ve.length,dropped:H.dropped};return H.samples=[],H.dropped=0,un},q.remuxAudio=function(H,ye,he,Ee,Ae){var qe=H.inputTimeScale,je=qe/(H.samplerate?H.samplerate:qe),Xe=H.segmentCodec==="aac"?1024:1152,Ve=Xe*je,Ie=this._initPTS,He=H.segmentCodec==="mp3"&&this.typeSupported.mpeg,ce=[],De=Ae!==void 0,ve=H.samples,Be=He?0:8,Te=this.nextAudioPts||-1,ze=ye*qe;if(this.isAudioContiguous=he=he||ve.length&&Te>0&&(Ee&&Math.abs(ze-Te)<9e3||Math.abs(N(ve[0].pts-Ie,ze)-Te)<20*Ve),ve.forEach(function(de){de.pts=N(de.pts-Ie,ze)}),!he||Te<0){if(ve=ve.filter(function(de){return de.pts>=0}),!ve.length)return;Te=Ae===0?0:Ee&&!De?Math.max(0,ze):ve[0].pts}if(H.segmentCodec==="aac")for(var We=this.config.maxAudioFramesDrift,$e=0,it=Te;$e<ve.length;$e++){var ue=ve[$e],ot=ue.pts,Fe=ot-it,nt=Math.abs(1e3*Fe/qe);if(Fe<=-We*Ve&&De)$e===0&&(K.logger.warn("Audio frame @ "+(ot/qe).toFixed(3)+"s overlaps nextAudioPts by "+Math.round(1e3*Fe/qe)+" ms."),this.nextAudioPts=Te=it=ot);else if(Fe>=We*Ve&&nt<1e4&&De){var ht=Math.round(Fe/Ve);(it=ot-ht*Ve)<0&&(ht--,it+=Ve),$e===0&&(this.nextAudioPts=Te=it),K.logger.warn("[mp4-remuxer]: Injecting "+ht+" audio frame @ "+(it/qe).toFixed(3)+"s due to "+Math.round(1e3*Fe/qe)+" ms gap.");for(var Pt=0;Pt<ht;Pt++){var jt=Math.max(it,0),Rt=U.getSilentFrame(H.manifestCodec||H.codec,H.channelCount);Rt||(K.logger.log("[mp4-remuxer]: Unable to get silent frame for given audio codec; duplicating last frame instead."),Rt=ue.unit.subarray()),ve.splice($e,0,{unit:Rt,pts:jt}),it+=Ve,$e++}}ue.pts=it,it+=Ve}for(var Ct,Ft=null,Kt=null,It=0,Zt=ve.length;Zt--;)It+=ve[Zt].unit.byteLength;for(var cr=0,fr=ve.length;cr<fr;cr++){var kr=ve[cr],wr=kr.unit,yr=kr.pts;if(Kt!==null)ce[cr-1].duration=Math.round((yr-Kt)/je);else{if(he&&H.segmentCodec==="aac"&&(yr=Te),Ft=yr,!(It>0))return;It+=Be;try{Ct=new Uint8Array(It)}catch{return void this.observer.emit(w.Events.ERROR,w.Events.ERROR,{type:te.ErrorTypes.MUX_ERROR,details:te.ErrorDetails.REMUX_ALLOC_ERROR,fatal:!1,bytes:It,reason:"fail allocating audio mdat "+It})}He||(new DataView(Ct.buffer).setUint32(0,It),Ct.set(A.types.mdat,4))}Ct.set(wr,Be);var pe=wr.byteLength;Be+=pe,ce.push(new xe(!0,Xe,pe,0)),Kt=yr}var $=ce.length;if($){var M=ce[ce.length-1];this.nextAudioPts=Te=Kt+je*M.duration;var z=He?new Uint8Array(0):A.moof(H.sequenceNumber++,Ft/je,Y({},H,{samples:ce}));H.samples=[];var Q=Ft/qe,se=Te/qe,oe={data1:z,data2:Ct,startPTS:Q,endPTS:se,startDTS:Q,endDTS:se,type:"audio",hasAudio:!0,hasVideo:!1,nb:$};return this.isAudioContiguous=!0,oe}},q.remuxEmptyAudio=function(H,ye,he,Ee){var Ae=H.inputTimeScale,qe=Ae/(H.samplerate?H.samplerate:Ae),je=this.nextAudioPts,Xe=(je!==null?je:Ee.startDTS*Ae)+this._initDTS,Ve=Ee.endDTS*Ae+this._initDTS,Ie=1024*qe,He=Math.ceil((Ve-Xe)/Ie),ce=U.getSilentFrame(H.manifestCodec||H.codec,H.channelCount);if(K.logger.warn("[mp4-remuxer]: remux empty Audio"),ce){for(var De=[],ve=0;ve<He;ve++){var Be=Xe+ve*Ie;De.push({unit:ce,pts:Be,dts:Be})}return H.samples=De,this.remuxAudio(H,ye,he,!1)}K.logger.trace("[mp4-remuxer]: Unable to remuxEmptyAudio since we were unable to get a silent frame for given audio codec")},C}();function N(C,q){var H;if(q===null)return C;for(H=q<C?-8589934592:8589934592;Math.abs(C-q)>4294967296;)C+=H;return C}function W(C,q,H,ye){var he=C.samples.length;if(he){for(var Ee=C.inputTimeScale,Ae=0;Ae<he;Ae++){var qe=C.samples[Ae];qe.pts=N(qe.pts-H,q*Ee)/Ee,qe.dts=N(qe.dts-ye,q*Ee)/Ee}var je=C.samples;return C.samples=[],{samples:je}}}function me(C,q,H){var ye=C.samples.length;if(ye){for(var he=C.inputTimeScale,Ee=0;Ee<ye;Ee++){var Ae=C.samples[Ee];Ae.pts=N(Ae.pts-H,q*he)/he}C.samples.sort(function(je,Xe){return je.pts-Xe.pts});var qe=C.samples;return C.samples=[],{samples:qe}}}var xe=function(C,q,H,ye){this.size=void 0,this.duration=void 0,this.cts=void 0,this.flags=void 0,this.duration=q,this.size=H,this.cts=ye,this.flags=new j(C)},j=function(C){this.isLeading=0,this.isDependedOn=0,this.hasRedundancy=0,this.degradPrio=0,this.dependsOn=1,this.isNonSync=1,this.dependsOn=C?2:1,this.isNonSync=C?0:1}},856:(L,I,k)=>{var x;k.r(I),k.d(I,{MetadataSchema:()=>x}),function(U){U.audioId3="org.id3",U.dateRange="com.apple.quicktime.HLS",U.emsg="https://aomedia.org/emsg/ID3"}(x||(x={}))},308:(L,I,k)=>{var x,U;k.r(I),k.d(I,{PlaylistContextType:()=>x,PlaylistLevelType:()=>U}),function(O){O.MANIFEST="manifest",O.LEVEL="level",O.AUDIO_TRACK="audioTrack",O.SUBTITLE_TRACK="subtitleTrack"}(x||(x={})),function(O){O.MAIN="main",O.AUDIO="audio",O.SUBTITLE="subtitle"}(U||(U={}))},300:(L,I,k)=>{k.r(I),k.d(I,{default:()=>x});const x={hexDump:function(U){for(var O="",E=0;E<U.length;E++){var A=U[E].toString(16);A.length<2&&(A="0"+A),O+=A}return O}}},93:(L,I,k)=>{k.r(I),k.d(I,{enableLogs:()=>A,logger:()=>w});var x=function(){},U={trace:x,debug:x,log:x,warn:x,info:x,error:x},O=U;function E(te){var K=self.console[te];return K?K.bind(self.console,"["+te+"] >"):x}function A(te,K){if(self.console&&te===!0||typeof te=="object"){(function(V){for(var ne=arguments.length,Y=new Array(ne>1?ne-1:0),re=1;re<ne;re++)Y[re-1]=arguments[re];Y.forEach(function(ie){O[ie]=V[ie]?V[ie].bind(V):E(ie)})})(te,"debug","log","info","warn","error");try{O.log('Debug logs enabled for "'+K+'"')}catch{O=U}}else O=U}var w=U},63:(L,I,k)=>{k.r(I),k.d(I,{RemuxerTrackIdConfig:()=>K,appendUint8Array:()=>he,bin2str:()=>V,computeRawDurationFromSamples:()=>q,discardEPB:()=>je,findBox:()=>Z,getDuration:()=>C,getStartDTS:()=>j,mp4Box:()=>Ve,mp4pssh:()=>Ie,offsetStartDTS:()=>H,parseEmsg:()=>Xe,parseInitSegment:()=>W,parsePssh:()=>He,parseSEIMessageFromNALu:()=>qe,parseSamples:()=>Ee,parseSegmentIndex:()=>N,parseSinf:()=>xe,patchEncyptionData:()=>me,readSint32:()=>re,readUint16:()=>ne,readUint32:()=>Y,segmentValidRange:()=>ye,writeUint32:()=>ie});var x=k(923),U=k(145),O=k(181),E=k(93),A=k(300),w=Math.pow(2,32)-1,te=[].push,K={video:1,audio:2,id3:3,text:4};function V(ce){return String.fromCharCode.apply(null,ce)}function ne(ce,De){var ve=ce[De]<<8|ce[De+1];return ve<0?65536+ve:ve}function Y(ce,De){var ve=re(ce,De);return ve<0?4294967296+ve:ve}function re(ce,De){return ce[De]<<24|ce[De+1]<<16|ce[De+2]<<8|ce[De+3]}function ie(ce,De,ve){ce[De]=ve>>24,ce[De+1]=ve>>16&255,ce[De+2]=ve>>8&255,ce[De+3]=255&ve}function Z(ce,De){var ve=[];if(!De.length)return ve;for(var Be=ce.byteLength,Te=0;Te<Be;){var ze=Y(ce,Te),We=ze>1?Te+ze:Be;if(V(ce.subarray(Te+4,Te+8))===De[0])if(De.length===1)ve.push(ce.subarray(Te+8,We));else{var $e=Z(ce.subarray(Te+8,We),De.slice(1));$e.length&&te.apply(ve,$e)}Te=We}return ve}function N(ce){var De=[],ve=ce[0],Be=8,Te=Y(ce,Be);Be+=4,Be+=ve===0?8:16,Be+=2;var ze=ce.length+0,We=ne(ce,Be);Be+=2;for(var $e=0;$e<We;$e++){var it=Be,ue=Y(ce,it);it+=4;var ot=2147483647&ue;if((2147483648&ue)>>>31==1)return console.warn("SIDX has hierarchical references (not supported)"),null;var Fe=Y(ce,it);it+=4,De.push({referenceSize:ot,subsegmentDuration:Fe,info:{duration:Fe/Te,start:ze,end:ze+ot-1}}),ze+=ot,Be=it+=4}return{earliestPresentationTime:0,timescale:Te,version:ve,referencesCount:We,references:De}}function W(ce){for(var De=[],ve=Z(ce,["moov","trak"]),Be=0;Be<ve.length;Be++){var Te=ve[Be],ze=Z(Te,["tkhd"])[0];if(ze){var We=ze[0],$e=We===0?12:20,it=Y(ze,$e),ue=Z(Te,["mdia","mdhd"])[0];if(ue){var ot=Y(ue,$e=(We=ue[0])===0?12:20),Fe=Z(Te,["mdia","hdlr"])[0];if(Fe){var nt=V(Fe.subarray(8,12)),ht={soun:x.ElementaryStreamTypes.AUDIO,vide:x.ElementaryStreamTypes.VIDEO}[nt];if(ht){var Pt=Z(Te,["mdia","minf","stbl","stsd"])[0],jt=void 0;Pt&&(jt=V(Pt.subarray(12,16))),De[it]={timescale:ot,type:ht},De[ht]={timescale:ot,id:it,codec:jt}}}}}}return Z(ce,["moov","mvex","trex"]).forEach(function(Rt){var Ct=Y(Rt,4),Ft=De[Ct];Ft&&(Ft.default={duration:Y(Rt,12),flags:Y(Rt,20)})}),De}function me(ce,De){if(!ce||!De)return ce;var ve=De.keyId;return ve&&De.isCommonEncryption&&Z(ce,["moov","trak"]).forEach(function(Be){var Te=Z(Be,["mdia","minf","stbl","stsd"])[0].subarray(8),ze=Z(Te,["enca"]),We=ze.length>0;We||(ze=Z(Te,["encv"])),ze.forEach(function($e){Z(We?$e.subarray(28):$e.subarray(78),["sinf"]).forEach(function(it){var ue=xe(it);if(ue){var ot=ue.subarray(8,24);ot.some(function(Fe){return Fe!==0})||(E.logger.log("[eme] Patching keyId in 'enc"+(We?"a":"v")+">sinf>>tenc' box: "+A.default.hexDump(ot)+" -> "+A.default.hexDump(ve)),ue.set(ve,8))}})})}),ce}function xe(ce){var De=Z(ce,["schm"])[0];if(De){var ve=V(De.subarray(4,8));if(ve==="cbcs"||ve==="cenc")return Z(ce,["schi","tenc"])[0]}return E.logger.error("[eme] missing 'schm' box"),null}function j(ce,De){return Z(De,["moof","traf"]).reduce(function(ve,Be){var Te=Z(Be,["tfdt"])[0],ze=Te[0],We=Z(Be,["tfhd"]).reduce(function($e,it){var ue=Y(it,4),ot=ce[ue];if(ot){var Fe=Y(Te,4);ze===1&&(Fe*=Math.pow(2,32),Fe+=Y(Te,8));var nt=Fe/(ot.timescale||9e4);if(isFinite(nt)&&($e===null||nt<$e))return nt}return $e},null);return We!==null&&isFinite(We)&&(ve===null||We<ve)?We:ve},null)||0}function C(ce,De){for(var ve=0,Be=0,Te=0,ze=Z(ce,["moof","traf"]),We=0;We<ze.length;We++){var $e=ze[We],it=Z($e,["tfhd"])[0],ue=De[Y(it,4)];if(ue){var ot=ue.default,Fe=Y(it,0)|(ot==null?void 0:ot.flags),nt=ot==null?void 0:ot.duration;8&Fe&&(nt=Y(it,2&Fe?12:8));for(var ht=ue.timescale||9e4,Pt=Z($e,["trun"]),jt=0;jt<Pt.length;jt++)!(ve=q(Pt[jt]))&&nt&&(ve=nt*Y(Pt[jt],4)),ue.type===x.ElementaryStreamTypes.VIDEO?Be+=ve/ht:ue.type===x.ElementaryStreamTypes.AUDIO&&(Te+=ve/ht)}}if(Be===0&&Te===0){for(var Rt=0,Ct=Z(ce,["sidx"]),Ft=0;Ft<Ct.length;Ft++){var Kt=N(Ct[Ft]);Kt!=null&&Kt.references&&(Rt+=Kt.references.reduce(function(It,Zt){return It+Zt.info.duration||0},0))}return Rt}return Be||Te}function q(ce){var De=Y(ce,0),ve=8;1&De&&(ve+=4),4&De&&(ve+=4);for(var Be=0,Te=Y(ce,4),ze=0;ze<Te;ze++)256&De&&(Be+=Y(ce,ve),ve+=4),512&De&&(ve+=4),1024&De&&(ve+=4),2048&De&&(ve+=4);return Be}function H(ce,De,ve){Z(De,["moof","traf"]).forEach(function(Be){Z(Be,["tfhd"]).forEach(function(Te){var ze=Y(Te,4),We=ce[ze];if(We){var $e=We.timescale||9e4;Z(Be,["tfdt"]).forEach(function(it){var ue=it[0],ot=Y(it,4);if(ue===0)ot-=ve*$e,ie(it,4,ot=Math.max(ot,0));else{ot*=Math.pow(2,32),ot+=Y(it,8),ot-=ve*$e,ot=Math.max(ot,0);var Fe=Math.floor(ot/(w+1)),nt=Math.floor(ot%(w+1));ie(it,4,Fe),ie(it,8,nt)}})}})})}function ye(ce){var De={valid:null,remainder:null},ve=Z(ce,["moof"]);if(!ve)return De;if(ve.length<2)return De.remainder=ce,De;var Be=ve[ve.length-1];return De.valid=(0,U.sliceUint8)(ce,0,Be.byteOffset-8),De.remainder=(0,U.sliceUint8)(ce,Be.byteOffset-8),De}function he(ce,De){var ve=new Uint8Array(ce.length+De.length);return ve.set(ce),ve.set(De,ce.length),ve}function Ee(ce,De){var ve=[],Be=De.samples,Te=De.timescale,ze=De.id,We=!1;return Z(Be,["moof"]).map(function($e){var it=$e.byteOffset-8;Z($e,["traf"]).map(function(ue){var ot=Z(ue,["tfdt"]).map(function(Fe){var nt=Fe[0],ht=Y(Fe,4);return nt===1&&(ht*=Math.pow(2,32),ht+=Y(Fe,8)),ht/Te})[0];return ot!==void 0&&(ce=ot),Z(ue,["tfhd"]).map(function(Fe){var nt=Y(Fe,4),ht=16777215&Y(Fe,0),Pt=0,jt=(16&ht)!=0,Rt=0,Ct=(32&ht)!=0,Ft=8;nt===ze&&(1&ht&&(Ft+=8),2&ht&&(Ft+=4),8&ht&&(Pt=Y(Fe,Ft),Ft+=4),jt&&(Rt=Y(Fe,Ft),Ft+=4),Ct&&(Ft+=4),De.type==="video"&&(We=function(Kt){if(!Kt)return!1;var It=Kt.indexOf("."),Zt=It<0?Kt:Kt.substring(0,It);return Zt==="hvc1"||Zt==="hev1"||Zt==="dvh1"||Zt==="dvhe"}(De.codec)),Z(ue,["trun"]).map(function(Kt){var It=Kt[0],Zt=16777215&Y(Kt,0),cr=(1&Zt)!=0,fr=0,kr=(4&Zt)!=0,wr=(256&Zt)!=0,yr=0,pe=(512&Zt)!=0,$=0,M=(1024&Zt)!=0,z=(2048&Zt)!=0,Q=0,se=Y(Kt,4),oe=8;cr&&(fr=Y(Kt,oe),oe+=4),kr&&(oe+=4);for(var de=fr+it,Ce=0;Ce<se;Ce++){if(wr?(yr=Y(Kt,oe),oe+=4):yr=Pt,pe?($=Y(Kt,oe),oe+=4):$=Rt,M&&(oe+=4),z&&(Q=It===0?Y(Kt,oe):re(Kt,oe),oe+=4),De.type===x.ElementaryStreamTypes.VIDEO)for(var Me=0;Me<$;){var Ne=Y(Be,de);Ae(We,Be[de+=4])&&qe(Be.subarray(de,de+Ne),We?2:1,ce+Q/Te,ve),de+=Ne,Me+=Ne+4}ce+=yr/Te}}))})})}),ve}function Ae(ce,De){if(ce){var ve=De>>1&63;return ve===39||ve===40}return(31&De)==6}function qe(ce,De,ve,Be){var Te=je(ce),ze=0;ze+=De;for(var We=0,$e=0,it=!1,ue=0;ze<Te.length;){We=0;do{if(ze>=Te.length)break;We+=ue=Te[ze++]}while(ue===255);$e=0;do{if(ze>=Te.length)break;$e+=ue=Te[ze++]}while(ue===255);var ot=Te.length-ze;if(!it&&We===4&&ze<Te.length){if(it=!0,Te[ze++]===181){var Fe=ne(Te,ze);if(ze+=2,Fe===49){var nt=Y(Te,ze);if(ze+=4,nt===1195456820){var ht=Te[ze++];if(ht===3){var Pt=Te[ze++],jt=64&Pt,Rt=jt?2+3*(31&Pt):0,Ct=new Uint8Array(Rt);if(jt){Ct[0]=Pt;for(var Ft=1;Ft<Rt;Ft++)Ct[Ft]=Te[ze++]}Be.push({type:ht,payloadType:We,pts:ve,bytes:Ct})}}}}}else if(We===5&&$e<ot){if(it=!0,$e>16){for(var Kt=[],It=0;It<16;It++){var Zt=Te[ze++].toString(16);Kt.push(Zt.length==1?"0"+Zt:Zt),It!==3&&It!==5&&It!==7&&It!==9||Kt.push("-")}for(var cr=$e-16,fr=new Uint8Array(cr),kr=0;kr<cr;kr++)fr[kr]=Te[ze++];Be.push({payloadType:We,pts:ve,uuid:Kt.join(""),userData:(0,O.utf8ArrayToStr)(fr),userDataBytes:fr})}}else if($e<ot)ze+=$e;else if($e>ot)break}}function je(ce){for(var De=ce.byteLength,ve=[],Be=1;Be<De-2;)ce[Be]===0&&ce[Be+1]===0&&ce[Be+2]===3?(ve.push(Be+2),Be+=2):Be++;if(ve.length===0)return ce;var Te=De-ve.length,ze=new Uint8Array(Te),We=0;for(Be=0;Be<Te;We++,Be++)We===ve[0]&&(We++,ve.shift()),ze[Be]=ce[We];return ze}function Xe(ce){var De=ce[0],ve="",Be="",Te=0,ze=0,We=0,$e=0,it=0,ue=0;if(De===0){for(;V(ce.subarray(ue,ue+1))!=="\0";)ve+=V(ce.subarray(ue,ue+1)),ue+=1;for(ve+=V(ce.subarray(ue,ue+1)),ue+=1;V(ce.subarray(ue,ue+1))!=="\0";)Be+=V(ce.subarray(ue,ue+1)),ue+=1;Be+=V(ce.subarray(ue,ue+1)),ue+=1,Te=Y(ce,12),ze=Y(ce,16),$e=Y(ce,20),it=Y(ce,24),ue=28}else if(De===1){Te=Y(ce,ue+=4);var ot=Y(ce,ue+=4),Fe=Y(ce,ue+=4);for(ue+=4,We=Math.pow(2,32)*ot+Fe,Number.isSafeInteger(We)||(We=Number.MAX_SAFE_INTEGER,console.warn("Presentation time exceeds safe integer limit and wrapped to max safe integer in parsing emsg box")),$e=Y(ce,ue),it=Y(ce,ue+=4),ue+=4;V(ce.subarray(ue,ue+1))!=="\0";)ve+=V(ce.subarray(ue,ue+1)),ue+=1;for(ve+=V(ce.subarray(ue,ue+1)),ue+=1;V(ce.subarray(ue,ue+1))!=="\0";)Be+=V(ce.subarray(ue,ue+1)),ue+=1;Be+=V(ce.subarray(ue,ue+1)),ue+=1}return{schemeIdUri:ve,value:Be,timeScale:Te,presentationTime:We,presentationTimeDelta:ze,eventDuration:$e,id:it,payload:ce.subarray(ue,ce.byteLength)}}function Ve(ce){for(var De=arguments.length,ve=new Array(De>1?De-1:0),Be=1;Be<De;Be++)ve[Be-1]=arguments[Be];for(var Te=ve.length,ze=8,We=Te;We--;)ze+=ve[We].byteLength;var $e=new Uint8Array(ze);for($e[0]=ze>>24&255,$e[1]=ze>>16&255,$e[2]=ze>>8&255,$e[3]=255&ze,$e.set(ce,4),We=0,ze=8;We<Te;We++)$e.set(ve[We],ze),ze+=ve[We].byteLength;return $e}function Ie(ce,De,ve){if(ce.byteLength!==16)throw new RangeError("Invalid system id");var Be,Te,ze;if(De){Be=1,Te=new Uint8Array(16*De.length);for(var We=0;We<De.length;We++){var $e=De[We];if($e.byteLength!==16)throw new RangeError("Invalid key");Te.set($e,16*We)}}else Be=0,Te=new Uint8Array;Be>0?(ze=new Uint8Array(4),De.length>0&&new DataView(ze.buffer).setUint32(0,De.length,!1)):ze=new Uint8Array;var it=new Uint8Array(4);return ve&&ve.byteLength>0&&new DataView(it.buffer).setUint32(0,ve.byteLength,!1),Ve([112,115,115,104],new Uint8Array([Be,0,0,0]),ce,ze,Te,it,ve||new Uint8Array)}function He(ce){if(!(ce instanceof ArrayBuffer)||ce.byteLength<32)return null;var De={version:0,systemId:"",kids:null,data:null},ve=new DataView(ce),Be=ve.getUint32(0);if(ce.byteLength!==Be&&Be>44||ve.getUint32(4)!==1886614376||(De.version=ve.getUint32(8)>>>24,De.version>1))return null;De.systemId=A.default.hexDump(new Uint8Array(ce,12,16));var Te=ve.getUint32(28);if(De.version===0){if(Be-32<Te)return null;De.data=new Uint8Array(ce,32,Te)}else if(De.version===1){De.kids=[];for(var ze=0;ze<Te;ze++)De.kids.push(new Uint8Array(ce,32+16*ze,16))}return De}},673:(L,I,k)=>{function x(A,w,te,K){te===void 0&&(te=1),K===void 0&&(K=!1);var V=A*w*te;return K?Math.round(V):V}function U(A,w,te,K){return te===void 0&&(te=1),K===void 0&&(K=!1),x(A,w,1/te,K)}function O(A,w){return w===void 0&&(w=!1),x(A,1e3,11111111111111112e-21,w)}function E(A,w){return w===void 0&&(w=1),x(A,9e4,1/w)}k.r(I),k.d(I,{toMpegTsClockFromTimescale:()=>E,toMsFromMpegTsClock:()=>O,toTimescaleFromBase:()=>x,toTimescaleFromScale:()=>U})},145:(L,I,k)=>{function x(U,O,E){return Uint8Array.prototype.slice?U.slice(O,E):new Uint8Array(Array.prototype.slice.call(U,O,E))}k.r(I),k.d(I,{sliceUint8:()=>x})},729:L=>{var I=Object.prototype.hasOwnProperty,k="~";function x(){}function U(w,te,K){this.fn=w,this.context=te,this.once=K||!1}function O(w,te,K,V,ne){if(typeof K!="function")throw new TypeError("The listener must be a function");var Y=new U(K,V||w,ne),re=k?k+te:te;return w._events[re]?w._events[re].fn?w._events[re]=[w._events[re],Y]:w._events[re].push(Y):(w._events[re]=Y,w._eventsCount++),w}function E(w,te){--w._eventsCount==0?w._events=new x:delete w._events[te]}function A(){this._events=new x,this._eventsCount=0}Object.create&&(x.prototype=Object.create(null),new x().__proto__||(k=!1)),A.prototype.eventNames=function(){var w,te,K=[];if(this._eventsCount===0)return K;for(te in w=this._events)I.call(w,te)&&K.push(k?te.slice(1):te);return Object.getOwnPropertySymbols?K.concat(Object.getOwnPropertySymbols(w)):K},A.prototype.listeners=function(w){var te=k?k+w:w,K=this._events[te];if(!K)return[];if(K.fn)return[K.fn];for(var V=0,ne=K.length,Y=new Array(ne);V<ne;V++)Y[V]=K[V].fn;return Y},A.prototype.listenerCount=function(w){var te=k?k+w:w,K=this._events[te];return K?K.fn?1:K.length:0},A.prototype.emit=function(w,te,K,V,ne,Y){var re=k?k+w:w;if(!this._events[re])return!1;var ie,Z,N=this._events[re],W=arguments.length;if(N.fn){switch(N.once&&this.removeListener(w,N.fn,void 0,!0),W){case 1:return N.fn.call(N.context),!0;case 2:return N.fn.call(N.context,te),!0;case 3:return N.fn.call(N.context,te,K),!0;case 4:return N.fn.call(N.context,te,K,V),!0;case 5:return N.fn.call(N.context,te,K,V,ne),!0;case 6:return N.fn.call(N.context,te,K,V,ne,Y),!0}for(Z=1,ie=new Array(W-1);Z<W;Z++)ie[Z-1]=arguments[Z];N.fn.apply(N.context,ie)}else{var me,xe=N.length;for(Z=0;Z<xe;Z++)switch(N[Z].once&&this.removeListener(w,N[Z].fn,void 0,!0),W){case 1:N[Z].fn.call(N[Z].context);break;case 2:N[Z].fn.call(N[Z].context,te);break;case 3:N[Z].fn.call(N[Z].context,te,K);break;case 4:N[Z].fn.call(N[Z].context,te,K,V);break;default:if(!ie)for(me=1,ie=new Array(W-1);me<W;me++)ie[me-1]=arguments[me];N[Z].fn.apply(N[Z].context,ie)}}return!0},A.prototype.on=function(w,te,K){return O(this,w,te,K,!1)},A.prototype.once=function(w,te,K){return O(this,w,te,K,!0)},A.prototype.removeListener=function(w,te,K,V){var ne=k?k+w:w;if(!this._events[ne])return this;if(!te)return E(this,ne),this;var Y=this._events[ne];if(Y.fn)Y.fn!==te||V&&!Y.once||K&&Y.context!==K||E(this,ne);else{for(var re=0,ie=[],Z=Y.length;re<Z;re++)(Y[re].fn!==te||V&&!Y[re].once||K&&Y[re].context!==K)&&ie.push(Y[re]);ie.length?this._events[ne]=ie.length===1?ie[0]:ie:E(this,ne)}return this},A.prototype.removeAllListeners=function(w){var te;return w?(te=k?k+w:w,this._events[te]&&E(this,te)):(this._events=new x,this._eventsCount=0),this},A.prototype.off=A.prototype.removeListener,A.prototype.addListener=A.prototype.on,A.prefixed=k,A.EventEmitter=A,L.exports=A},945:function(L){var I,k,x,U,O;I=/^(?=((?:[a-zA-Z0-9+\-.]+:)?))\1(?=((?:\/\/[^\/?#]*)?))\2(?=((?:(?:[^?#\/]*\/)*[^;?#\/]*)?))\3((?:;[^?#]*)?)(\?[^#]*)?(#[^]*)?$/,k=/^(?=([^\/?#]*))\1([^]*)$/,x=/(?:\/|^)\.(?=\/)/g,U=/(?:\/|^)\.\.\/(?!\.\.\/)[^\/]*(?=\/)/g,O={buildAbsoluteURL:function(E,A,w){if(w=w||{},E=E.trim(),!(A=A.trim())){if(!w.alwaysNormalize)return E;var te=O.parseURL(E);if(!te)throw new Error("Error trying to parse base URL.");return te.path=O.normalizePath(te.path),O.buildURLFromParts(te)}var K=O.parseURL(A);if(!K)throw new Error("Error trying to parse relative URL.");if(K.scheme)return w.alwaysNormalize?(K.path=O.normalizePath(K.path),O.buildURLFromParts(K)):A;var V=O.parseURL(E);if(!V)throw new Error("Error trying to parse base URL.");if(!V.netLoc&&V.path&&V.path[0]!=="/"){var ne=k.exec(V.path);V.netLoc=ne[1],V.path=ne[2]}V.netLoc&&!V.path&&(V.path="/");var Y={scheme:V.scheme,netLoc:K.netLoc,path:null,params:K.params,query:K.query,fragment:K.fragment};if(!K.netLoc&&(Y.netLoc=V.netLoc,K.path[0]!=="/"))if(K.path){var re=V.path,ie=re.substring(0,re.lastIndexOf("/")+1)+K.path;Y.path=O.normalizePath(ie)}else Y.path=V.path,K.params||(Y.params=V.params,K.query||(Y.query=V.query));return Y.path===null&&(Y.path=w.alwaysNormalize?O.normalizePath(K.path):K.path),O.buildURLFromParts(Y)},parseURL:function(E){var A=I.exec(E);return A?{scheme:A[1]||"",netLoc:A[2]||"",path:A[3]||"",params:A[4]||"",query:A[5]||"",fragment:A[6]||""}:null},normalizePath:function(E){for(E=E.split("").reverse().join("").replace(x,"");E.length!==(E=E.replace(U,"")).length;);return E.split("").reverse().join("")},buildURLFromParts:function(E){return E.scheme+E.netLoc+E.path+E.params+E.query+E.fragment}},L.exports=O}},m={};function T(L){var I=m[L];if(I!==void 0)return I.exports;var k=m[L]={exports:{}};return l[L].call(k.exports,k,k.exports,T),k.exports}T.m=l,T.n=L=>{var I=L&&L.__esModule?()=>L.default:()=>L;return T.d(I,{a:I}),I},T.d=(L,I)=>{for(var k in I)T.o(I,k)&&!T.o(L,k)&&Object.defineProperty(L,k,{enumerable:!0,get:I[k]})},T.o=(L,I)=>Object.prototype.hasOwnProperty.call(L,I),T.r=L=>{typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(L,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(L,"__esModule",{value:!0})};var S=T(76);return S.default})())})(N0);const ai=x0(du);function U0(f){let a;return{c(){a=Oe("span"),a.innerHTML='<svg width="24" height="24" viewBox="0 0 32 32" fill="none"><path d="M2 10H7.81818L17 3V29L7.81818 22H2V10ZM8.49361 12L15 7.03968V24.9603L8.49361 20H4V12H8.49361Z" fill="white"></path><path d="M20.8219 10.4325C20.4314 10.042 19.7982 10.042 19.4077 10.4325C19.0172 10.8231 19.0172 11.4562 19.4077 11.8468L23.643 16.0821L19.4077 20.3174C19.0172 20.708 19.0172 21.3411 19.4077 21.7316C19.7982 22.1222 20.4314 22.1222 20.8219 21.7316L25.0573 17.4963L29.2926 21.7316C29.6831 22.1222 30.3163 22.1222 30.7068 21.7316C31.0973 21.3411 31.0973 20.708 30.7068 20.3174L26.4715 16.0821L30.7068 11.8468C31.0973 11.4562 31.0973 10.8231 30.7068 10.4325C30.3163 10.042 29.6831 10.042 29.2926 10.4325L25.0573 14.6679L20.8219 10.4325Z" fill="white"></path></svg>',_e(a,"class","icon_sound")},m(l,m){vt(l,a,m)},d(l){l&&pt(a)}}}function B0(f){let a;return{c(){a=Oe("span"),a.innerHTML='<svg width="24" height="24" viewBox="0 0 32 32" fill="none"><path d="M7.81818 10H2V22H7.81818L17 29V3L7.81818 10Z" fill="white"></path><path d="M21.8642 15.3638C21.8642 13.7454 21.0183 12.3245 19.7446 11.5191C19.1424 11.1383 18.7963 10.3527 19.1446 9.73111C19.4028 9.27025 19.9605 9.05403 20.4304 9.29546C22.6312 10.4263 24.1369 12.7192 24.1369 15.3638C24.1369 18.0084 22.6312 20.3014 20.4304 21.4322C19.9605 21.6736 19.4028 21.4574 19.1446 20.9965C18.7963 20.375 19.1424 19.5893 19.7446 19.2085C21.0183 18.4031 21.8642 16.9822 21.8642 15.3638Z" fill="white"></path><path d="M23.3875 8.37237C25.8645 9.72016 27.5457 12.3459 27.5457 15.3643C27.5457 18.3826 25.8645 21.0084 23.3875 22.3562C22.8014 22.6751 22.4991 23.3888 22.7871 23.9907C23.0394 24.518 23.6578 24.7694 24.18 24.5067C27.524 22.825 29.8184 19.3626 29.8184 15.3643C29.8184 11.366 27.524 7.90355 24.18 6.2218C23.6578 5.95916 23.0394 6.21054 22.7871 6.73783C22.4991 7.3397 22.8014 8.05347 23.3875 8.37237Z" fill="white"></path></svg>',_e(a,"class","icon_sound")},m(l,m){vt(l,a,m)},d(l){l&&pt(a)}}}function yf(f){let a,l,m;return{c(){a=Oe("div"),l=Oe("img"),_e(l,"class","vimonial_slider_image"),_e(l,"alt","product_image"),Vn(l.src,m=f[1].product.featuredImage+"&width=200")||_e(l,"src",m),_e(a,"class","vimonial_slider_featured_image")},m(T,S){vt(T,a,S),Le(a,l)},p(T,S){S[0]&2&&!Vn(l.src,m=T[1].product.featuredImage+"&width=200")&&_e(l,"src",m)},d(T){T&&pt(a)}}}function Ef(f){let a,l,m,T=Math.ceil((1-parseFloat(f[1].product.price)/parseFloat(f[1].product.compareAtPrice))*100)+"",S,L,I,k;return{c(){a=Oe("div"),l=Oe("div"),m=Oe("span"),S=ur(T),L=ur("%"),I=yt(),k=Oe("span"),k.textContent="OFF",_e(m,"class","vimonial_discount_badge_text"),lt(m,"color","rgb(255, 255, 255)"),_e(k,"class","vimonial_discount_price"),_e(l,"class","vimonial_discount_badge"),_e(a,"class","vimonial_discount_badge_wrapper")},m(x,U){vt(x,a,U),Le(a,l),Le(l,m),Le(m,S),Le(m,L),Le(l,I),Le(l,k)},p(x,U){U[0]&2&&T!==(T=Math.ceil((1-parseFloat(x[1].product.price)/parseFloat(x[1].product.compareAtPrice))*100)+"")&&Ar(S,T)},d(x){x&&pt(a)}}}function _f(f){let a,l,m=f[1].highlightQuote+"",T;return{c(){a=Oe("div"),l=Oe("p"),T=ur(m),_e(a,"class","vimonial_callout")},m(S,L){vt(S,a,L),Le(a,l),Le(l,T)},p(S,L){L[0]&2&&m!==(m=S[1].highlightQuote+"")&&Ar(T,m)},d(S){S&&pt(a)}}}function Tf(f){var te;let a,l,m=f[1].product.title+"",T,S,L,I,k,x,U=Lr(f[1].product.price,f[13])+"",O,E,A=f[2].displayReviews&&bf(),w=((te=f[1].product)==null?void 0:te.compareAtPrice)&&f[1].product.compareAtPrice!="0.00"&&Sf(f);return{c(){a=Oe("div"),l=Oe("p"),T=ur(m),S=yt(),A&&A.c(),L=yt(),I=Oe("div"),k=Oe("div"),x=Oe("span"),O=ur(U),E=yt(),w&&w.c(),_e(l,"class","vimonial_slider_title"),lt(l,"color","rgb(15, 15, 15)"),lt(l,"font-weight","500"),lt(l,"font-size","15px"),_e(x,"class","money"),_e(k,"class","vimonial_slider_sale_price"),lt(k,"color","rgb(179, 0, 0)"),_e(I,"class","vimonial_slider_price"),_e(a,"class","vimonial_slider_content")},m(K,V){vt(K,a,V),Le(a,l),Le(l,T),Le(a,S),A&&A.m(a,null),Le(a,L),Le(a,I),Le(I,k),Le(k,x),Le(x,O),Le(I,E),w&&w.m(I,null)},p(K,V){var ne;V[0]&2&&m!==(m=K[1].product.title+"")&&Ar(T,m),K[2].displayReviews?A||(A=bf(),A.c(),A.m(a,L)):A&&(A.d(1),A=null),V[0]&2&&U!==(U=Lr(K[1].product.price,K[13])+"")&&Ar(O,U),(ne=K[1].product)!=null&&ne.compareAtPrice&&K[1].product.compareAtPrice!="0.00"?w?w.p(K,V):(w=Sf(K),w.c(),w.m(I,null)):w&&(w.d(1),w=null)},d(K){K&&pt(a),A&&A.d(),w&&w.d()}}}function bf(f){let a;return{c(){a=Oe("span"),a.innerHTML='<div style="display:none" class="jdgm-prev-badge" data-average-rating="5.00" data-number-of-reviews="5" data-number-of-questions="0"><span class="jdgm-prev-badge__stars" data-score="5.00" tabindex="0" aria-label="5.00 stars" role="button"><span class="jdgm-star jdgm--on"></span><span class="jdgm-star jdgm--on"></span><span class="jdgm-star jdgm--on"></span><span class="jdgm-star jdgm--on"></span><span class="jdgm-star jdgm--on"></span></span>  <span class="jdgm-prev-badge__text">5 reviews</span></div>',_e(a,"class","vimonial_rating_widget")},m(l,m){vt(l,a,m)},d(l){l&&pt(a)}}}function Sf(f){let a,l,m=Lr(f[1].product.compareAtPrice,f[13])+"",T;return{c(){a=Oe("div"),l=Oe("span"),T=ur(m),_e(l,"class","money"),_e(a,"class","vimonial_slider_regular_price line_through"),lt(a,"color","rgb(114, 114, 114)")},m(S,L){vt(S,a,L),Le(a,l),Le(l,T)},p(S,L){L[0]&2&&m!==(m=Lr(S[1].product.compareAtPrice,S[13])+"")&&Ar(T,m)},d(S){S&&pt(a)}}}function Lf(f){let a,l,m=f[2].buyNowText+"",T,S,L;return{c(){a=Oe("div"),l=Oe("button"),T=ur(m),_e(l,"name","add"),_e(l,"class","vimonial_atc_button svelte-1v0to3z"),_e(a,"class","vimonial_slide_atc")},m(I,k){vt(I,a,k),Le(a,l),Le(l,T),S||(L=nr(l,"click",f[35]),S=!0)},p(I,k){k[0]&4&&m!==(m=I[2].buyNowText+"")&&Ar(T,m)},d(I){I&&pt(a),S=!1,L()}}}function G0(f){let a,l,m,T,S,L,I,k,x,U,O,E,A,w,te,K,V,ne,Y,re,ie,Z,N;function W(he,Ee){return he[9]?U0:B0}let me=W(f),xe=me(f),j=f[2].displayCard&&f[1].product&&f[1].product.featuredImage&&yf(f),C=f[2].displayDiscount&&f[1].product&&f[1].product.compareAtPrice&&f[1].product.compareAtPrice!="0.00"&&Ef(f),q=f[2].displayQuote&&f[1].highlightQuote&&_f(f),H=f[2].displayCard&&f[1].product&&Tf(f),ye=f[2].displayCard&&f[1].product&&f[2].displayATCSlide&&Lf(f);return{c(){a=Oe("div"),l=Oe("div"),m=Oe("div"),T=Oe("div"),S=Oe("video"),k=yt(),x=Oe("div"),U=Oe("span"),U.innerHTML='<svg width="100%" height="100%" viewBox="0 0 80 80" fill="none"><circle opacity="0.7" cx="40" cy="40" r="40" fill="black"></circle><path d="M31.25 25.5162C31.25 24.7389 32.098 24.2588 32.7645 24.6587L57.6188 39.5713C57.9424 39.7655 57.9424 40.2345 57.6188 40.4287L32.7645 55.3413C32.098 55.7412 31.25 55.2611 31.25 54.4838V25.5162Z" fill="white"></path></svg>',O=yt(),E=Oe("div"),A=Oe("div"),A.innerHTML='<div class="vimonial_player_controls_progress_curr_future" style="position: absolute;"></div>',w=yt(),te=Oe("div"),xe.c(),K=yt(),j&&j.c(),V=yt(),C&&C.c(),ne=yt(),Y=Oe("div"),q&&q.c(),re=yt(),H&&H.c(),ie=yt(),ye&&ye.c(),_e(S,"class","vimonial_video svelte-1v0to3z"),_e(S,"poster",L=f[1].previewImg),_e(S,"preload","none"),S.autoplay=I=f[2].autoplay,S.loop="loop",S.muted="true",S.playsInline="true",_e(S,"webkit-playsinline","true"),_e(S,"x5-playsinline","true"),lt(S,"width","100%",1),lt(S,"height","100%",1),lt(S,"border-radius","10px"),lt(S,"background-image","url("+f[1].previewImg+")"),lt(S,"background-color",f[2].videoLoadingColor),_e(U,"class","vimonial_player_controls_play_icon"),_e(A,"class","vimonial_player_controls_progress_curr"),lt(A,"left","0%"),lt(A,"width","0%"),_e(E,"class","vimonial_player_controls_progress"),lt(E,"display","none"),_e(te,"class","vimonial_player_sound"),lt(te,"display","none"),_e(x,"class","vimonial_player_controls"),_e(T,"class","vimonial_card_video"),lt(T,"height",(f[2].isMobile?f[2].cardWidthMobile/9*16:f[2].cardWidth/9*16)+"px"),_e(m,"class","vimonial_video_wrapper"),_e(Y,"class","vimonial_card_details"),_e(l,"class","vimonial_card"),lt(l,"background",f[2].borderSize>0?f[2].displayCard?"linear-gradient(180deg, "+f[2].borderColor+" 5%, transparent 5%)":f[2].borderColor:f[2].displayCard?"linear-gradient(0deg,white 30%, transparent 30%);":"transparent"),_e(a,"class","vimonial_slide"),lt(a,"transform",f[11]),lt(a,"z-index",f[10])},m(he,Ee){vt(he,a,Ee),Le(a,l),Le(l,m),Le(m,T),Le(T,S),f[29](S),Le(T,k),Le(T,x),Le(x,U),f[30](U),Le(x,O),Le(x,E),Le(E,A),f[31](A),Le(x,w),Le(x,te),xe.m(te,null),f[32](te),f[33](T),Le(m,K),j&&j.m(m,null),Le(m,V),C&&C.m(m,null),f[34](m),Le(l,ne),Le(l,Y),q&&q.m(Y,null),Le(Y,re),H&&H.m(Y,null),Le(l,ie),ye&&ye.m(l,null),Z||(N=[nr(S,"pause",f[3]),nr(S,"click",f[3]),nr(S,"loadedmetadata",f[16]),nr(S,"timeupdate",f[18]),nr(U,"click",f[15]),nr(U,"timeupdate",f[18]),nr(A,"click",f[17]),nr(te,"click",f[19]),nr(a,"click",f[36])],Z=!0)},p(he,Ee){Ee[0]&2&&L!==(L=he[1].previewImg)&&_e(S,"poster",L),Ee[0]&4&&I!==(I=he[2].autoplay)&&(S.autoplay=I),Ee[0]&2&&lt(S,"background-image","url("+he[1].previewImg+")"),(Ee[0]&2||Ee[0]&6)&&lt(S,"background-color",he[2].videoLoadingColor),me!==(me=W(he))&&(xe.d(1),xe=me(he),xe&&(xe.c(),xe.m(te,null))),Ee[0]&4&&lt(T,"height",(he[2].isMobile?he[2].cardWidthMobile/9*16:he[2].cardWidth/9*16)+"px"),he[2].displayCard&&he[1].product&&he[1].product.featuredImage?j?j.p(he,Ee):(j=yf(he),j.c(),j.m(m,V)):j&&(j.d(1),j=null),he[2].displayDiscount&&he[1].product&&he[1].product.compareAtPrice&&he[1].product.compareAtPrice!="0.00"?C?C.p(he,Ee):(C=Ef(he),C.c(),C.m(m,null)):C&&(C.d(1),C=null),he[2].displayQuote&&he[1].highlightQuote?q?q.p(he,Ee):(q=_f(he),q.c(),q.m(Y,re)):q&&(q.d(1),q=null),he[2].displayCard&&he[1].product?H?H.p(he,Ee):(H=Tf(he),H.c(),H.m(Y,null)):H&&(H.d(1),H=null),he[2].displayCard&&he[1].product&&he[2].displayATCSlide?ye?ye.p(he,Ee):(ye=Lf(he),ye.c(),ye.m(l,null)):ye&&(ye.d(1),ye=null),Ee[0]&4&&lt(l,"background",he[2].borderSize>0?he[2].displayCard?"linear-gradient(180deg, "+he[2].borderColor+" 5%, transparent 5%)":he[2].borderColor:he[2].displayCard?"linear-gradient(0deg,white 30%, transparent 30%);":"transparent"),Ee[0]&2048&&lt(a,"transform",he[11]),Ee[0]&1024&&lt(a,"z-index",he[10])},i:mr,o:mr,d(he){he&&pt(a),f[29](null),f[30](null),f[31](null),xe.d(),f[32](null),f[33](null),j&&j.d(),C&&C.d(),f[34](null),q&&q.d(),H&&H.d(),ye&&ye.d(),Z=!1,yn(N)}}}function K0(f,a,l){var Be;let m;const T=Au();let S=((Be=window.Shopify)==null?void 0:Be.currency)||{active:"USD"},L=ws("vimonialViewedStore");oi(f,L,Te=>l(40,m=Te));let{shopId:I}=a,{index:k}=a,{point:x}=a,{totalSlides:U}=a,{loaded:O}=a,{data:E={id:"123",src:"https://test-streams.mux.dev/x36xhzz/x36xhzz.m3u8",highlightQuote:"For the small price I pay, it’s 3X’d conversions with such a massive ROI!"}}=a,{options:A={displayProduct:!1,displayDiscount:!1,displayReviews:!1,displayQuote:!1,displayCard:!1,autoplay:!0,videoLoadingColor:"black",currencySymbol:"$"}}=a,{video:w}=a,te,K,V,ne,Y,re,ie=!0;var Z=!0;function N(Te){if(O||H(!0),T("playVid"),m.includes(E.id)||(Bo("V",I,E.id,null,null),m.push(E.id)),A.popup){T("open");return}l(8,re.style.display="block",re),Z=!1,l(4,te.style.display="none",te),w.play(),l(0,w.muted=!1,w),l(9,ie=w.muted),l(5,K.parentNode.style.display="block",K)}function W(){w.duration}function me(Te){w.pause(),l(4,te.style.display="inline-block",te),l(0,w.muted=!0,w),l(9,ie=!0),Z=!0}function xe(){l(4,te.style.display="inline-block",te),l(0,w.muted=!0,w),l(9,ie=!0),Z=!0,A.autoplay||w.pause()}function j(Te){var ze=(Te.pageX-(this.offsetLeft+this.offsetParent.offsetLeft+w.offsetLeft))/w.offsetWidth;l(0,w.currentTime=ze*w.duration,w)}function C(){Z&&w.currentTime>=5&&l(0,w.currentTime=0,w),l(5,K.style.width=Math.floor(w.currentTime/w.duration*100)+"%",K)}function q(){l(0,w.muted=!w.muted,w),l(9,ie=w.muted)}function H(Te=!1){ai.isSupported()?(V=new ai({debug:!1,capLevelToPlayerSize:!0,maxBufferLength:3,maxBufferSize:60,startLevel:A.isMobile?void 0:0}),V.loadSource(E.src),V.on(ai.Events.MANIFEST_LOADED,function(){l(0,w.muted=!0,w),A.autoplay&&w.play(),Te&&(l(21,O=!0),N()),l(9,ie=w.muted)}),V.attachMedia(w)):w.canPlayType("application/vnd.apple.mpegurl")&&(l(0,w.src=E.src,w),w.addEventListener("loadedmetadata",function(){l(0,w.muted=!0,w),A.autoplay&&w.play(),Te&&(l(21,O=!0),N()),l(9,ie=w.muted)})),l(21,O=!0)}function ye(){const Te=Y.getBoundingClientRect();return Te.left>=-parseInt(A.isMobile?A.cardWidthMobile:A.cardWidth)&&Te.right<=(window.innerWidth||document.documentElement.clientWidth)+parseInt(A.isMobile?A.cardWidthMobile:A.cardWidth)?(O?A.autoplay&&w.play():H(),!0):(me(),!1)}Aa(()=>{ye(),w.addEventListener("resize",function(Te){Y.style.setProperty("height",this.videoHeight*ne.offsetWidth/this.videoWidth+"px")},!1)});let he=0,Ee="";const Ae=(Te,ze)=>{if(!A.coverflow)return;let We=Te-ze;l(10,he=U-Math.abs(We));let it=1/(Math.floor(A.innerWidth/(A.isMobile?A.cardWidthMobile:A.cardWidth))+.2);console.log(it);let ue=it*We,ot=-(100/100)*(parseInt(A.isMobile?A.cardWidthMobile:A.cardWidth)+parseInt(A.slideGap));console.log(ot);let Fe=-30*ue,nt=-100*Math.abs(ue),ht=ot*ue,Pt=1-(1-.7)*Math.abs(ue);Math.abs(ht)<.001&&(ht=0),Math.abs(nt)<.001&&(nt=0),Math.abs(Pt)<.001&&(Pt=0),l(11,Ee=`translate3d(${ht}px,0px,${nt}px)  rotateX(0deg) rotateY(${Fe}deg) scale(${Pt})`),console.log(Ee)},qe=Te=>{let ze={items:[{id:E.product.selectedVariantId,quantity:1}]};Bo("A",I,E.id,E.product.selectedVariantId,E.product.price),fetch(window.Shopify.routes.root+"cart/add.js",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(ze)}).then(We=>{We.json(),We.status==200&&(window.location.href="/cart")}).catch(We=>{console.error("Error:",We)})};function je(Te){Fr[Te?"unshift":"push"](()=>{w=Te,l(0,w)})}function Xe(Te){Fr[Te?"unshift":"push"](()=>{te=Te,l(4,te)})}function Ve(Te){Fr[Te?"unshift":"push"](()=>{K=Te,l(5,K)})}function Ie(Te){Fr[Te?"unshift":"push"](()=>{re=Te,l(8,re)})}function He(Te){Fr[Te?"unshift":"push"](()=>{Y=Te,l(7,Y)})}function ce(Te){Fr[Te?"unshift":"push"](()=>{ne=Te,l(6,ne)})}const De=()=>{qe()},ve=()=>{T("selectslide")};return f.$$set=Te=>{"shopId"in Te&&l(22,I=Te.shopId),"index"in Te&&l(23,k=Te.index),"point"in Te&&l(24,x=Te.point),"totalSlides"in Te&&l(25,U=Te.totalSlides),"loaded"in Te&&l(21,O=Te.loaded),"data"in Te&&l(1,E=Te.data),"options"in Te&&l(2,A=Te.options),"video"in Te&&l(0,w=Te.video)},f.$$.update=()=>{f.$$.dirty[0]&25165824&&Ae(k,x)},[w,E,A,me,te,K,ne,Y,re,ie,he,Ee,T,S,L,N,W,j,C,q,qe,O,I,k,x,U,xe,H,ye,je,Xe,Ve,Ie,He,ce,De,ve]}class H0 extends Xi{constructor(a){super(),Qi(this,a,K0,G0,Ii,{shopId:22,index:23,point:24,totalSlides:25,loaded:21,data:1,options:2,video:0,showPlayButton:3,muteVideoDisplayPlayButton:26,loadVideo:27,checkViewport:28},null,[-1,-1])}get shopId(){return this.$$.ctx[22]}set shopId(a){this.$$set({shopId:a}),Kn()}get index(){return this.$$.ctx[23]}set index(a){this.$$set({index:a}),Kn()}get point(){return this.$$.ctx[24]}set point(a){this.$$set({point:a}),Kn()}get totalSlides(){return this.$$.ctx[25]}set totalSlides(a){this.$$set({totalSlides:a}),Kn()}get loaded(){return this.$$.ctx[21]}set loaded(a){this.$$set({loaded:a}),Kn()}get data(){return this.$$.ctx[1]}set data(a){this.$$set({data:a}),Kn()}get options(){return this.$$.ctx[2]}set options(a){this.$$set({options:a}),Kn()}get video(){return this.$$.ctx[0]}set video(a){this.$$set({video:a}),Kn()}get showPlayButton(){return this.$$.ctx[3]}get muteVideoDisplayPlayButton(){return this.$$.ctx[26]}get loadVideo(){return this.$$.ctx[27]}get checkViewport(){return this.$$.ctx[28]}}function q0(f){let a;return{c(){a=Oe("i"),_e(a,"class","loading-default svelte-1qddvh4")},m(l,m){vt(l,a,m)},d(l){l&&pt(a)}}}function V0(f){let a;return{c(){a=Oe("span"),a.innerHTML=`<span class="wave-item svelte-1qddvh4"></span> 
		<span class="wave-item svelte-1qddvh4"></span> 
		<span class="wave-item svelte-1qddvh4"></span> 
		<span class="wave-item svelte-1qddvh4"></span> 
		<span class="wave-item svelte-1qddvh4"></span>`,_e(a,"class","loading-wave-dots svelte-1qddvh4")},m(l,m){vt(l,a,m)},d(l){l&&pt(a)}}}function W0(f){let a;return{c(){a=Oe("i"),_e(a,"class","loading-spiral svelte-1qddvh4")},m(l,m){vt(l,a,m)},d(l){l&&pt(a)}}}function j0(f){let a;return{c(){a=Oe("span"),a.innerHTML=`<span class="circle-item svelte-1qddvh4"></span> 
		<span class="circle-item svelte-1qddvh4"></span> 
		<span class="circle-item svelte-1qddvh4"></span> 
		<span class="circle-item svelte-1qddvh4"></span> 
		<span class="circle-item svelte-1qddvh4"></span> 
		<span class="circle-item svelte-1qddvh4"></span> 
		<span class="circle-item svelte-1qddvh4"></span> 
		<span class="circle-item svelte-1qddvh4"></span>`,_e(a,"class","loading-circles svelte-1qddvh4")},m(l,m){vt(l,a,m)},d(l){l&&pt(a)}}}function Y0(f){let a;return{c(){a=Oe("span"),a.innerHTML=`<span class="bubble-item svelte-1qddvh4"></span> 
		<span class="bubble-item svelte-1qddvh4"></span> 
		<span class="bubble-item svelte-1qddvh4"></span> 
		<span class="bubble-item svelte-1qddvh4"></span> 
		<span class="bubble-item svelte-1qddvh4"></span> 
		<span class="bubble-item svelte-1qddvh4"></span> 
		<span class="bubble-item svelte-1qddvh4"></span> 
		<span class="bubble-item svelte-1qddvh4"></span>`,_e(a,"class","loading-bubbles svelte-1qddvh4")},m(l,m){vt(l,a,m)},d(l){l&&pt(a)}}}function z0(f){let a;function l(S,L){return S[0]==="bubbles"?Y0:S[0]==="circles"?j0:S[0]==="spiral"?W0:S[0]==="wavedots"?V0:q0}let m=l(f),T=m(f);return{c(){T.c(),a=Wo()},m(S,L){T.m(S,L),vt(S,a,L)},p(S,[L]){m!==(m=l(S))&&(T.d(1),T=m(S),T&&(T.c(),T.m(a.parentNode,a)))},i:mr,o:mr,d(S){T.d(S),S&&pt(a)}}}function Q0(f,a,l){let{spinner:m=""}=a;return f.$$set=T=>{"spinner"in T&&l(0,m=T.spinner)},[m]}class X0 extends Xi{constructor(a){super(),Qi(this,a,Q0,z0,Ii,{spinner:0})}}const Z0=f=>({}),Af=f=>({attemptLoad:f[6]}),J0=f=>({isFirstLoad:f&4}),wf=f=>({isFirstLoad:f[2]});function Rf(f){let a,l;const m=f[15].spinner,T=_u(m,f,f[14],wf),S=T||$0(f);return{c(){a=Oe("div"),S&&S.c(),_e(a,"class","infinite-status-prompt")},m(L,I){vt(L,a,I),S&&S.m(a,null),l=!0},p(L,I){T?T.p&&(!l||I&16388)&&bu(T,m,L,L[14],l?Tu(m,L[14],I,J0):Su(L[14]),wf):S&&S.p&&(!l||I&1)&&S.p(L,l?I:-1)},i(L){l||(Gt(S,L),l=!0)},o(L){tr(S,L),l=!1},d(L){L&&pt(a),S&&S.d(L)}}}function $0(f){let a,l;return a=new X0({props:{spinner:f[0]}}),{c(){zi(a.$$.fragment)},m(m,T){ki(a,m,T),l=!0},p(m,T){const S={};T&1&&(S.spinner=m[0]),a.$set(S)},i(m){l||(Gt(a.$$.fragment,m),l=!0)},o(m){tr(a.$$.fragment,m),l=!1},d(m){Ci(a,m)}}}function Df(f){let a,l;const m=f[15].error,T=_u(m,f,f[14],Af),S=T||ey(f);return{c(){a=Oe("div"),S&&S.c(),_e(a,"class","infinite-status-prompt")},m(L,I){vt(L,a,I),S&&S.m(a,null),l=!0},p(L,I){T&&T.p&&(!l||I&16384)&&bu(T,m,L,L[14],l?Tu(m,L[14],I,Z0):Su(L[14]),Af)},i(L){l||(Gt(S,L),l=!0)},o(L){tr(S,L),l=!1},d(L){L&&pt(a),S&&S.d(L)}}}function ey(f){let a,l,m,T,S,L;return{c(){a=ur(`Oops, something went wrong :(
				`),l=Oe("br"),m=yt(),T=Oe("button"),T.textContent="Retry",_e(T,"class","btn-try-infinite")},m(I,k){vt(I,a,k),vt(I,l,k),vt(I,m,k),vt(I,T,k),S||(L=nr(T,"click",f[6]),S=!0)},p:mr,d(I){I&&pt(a),I&&pt(l),I&&pt(m),I&&pt(T),S=!1,L()}}}function ty(f){let a,l,m,T=f[1]&&f[5]&&Rf(f),S=f[4]&&Df(f);return{c(){a=Oe("div"),T&&T.c(),l=yt(),S&&S.c(),_e(a,"class","infinite-loading-container")},m(L,I){vt(L,a,I),T&&T.m(a,null),Le(a,l),S&&S.m(a,null),f[16](a),m=!0},p(L,[I]){L[1]&&L[5]?T?(T.p(L,I),I&34&&Gt(T,1)):(T=Rf(L),T.c(),Gt(T,1),T.m(a,l)):T&&(Hn(),tr(T,1,1,()=>{T=null}),qn()),L[4]?S?(S.p(L,I),I&16&&Gt(S,1)):(S=Df(L),S.c(),Gt(S,1),S.m(a,null)):S&&(Hn(),tr(S,1,1,()=>{S=null}),qn())},i(L){m||(Gt(T),Gt(S),m=!0)},o(L){tr(T),tr(S),m=!1},d(L){L&&pt(a),T&&T.d(),S&&S.d(),f[16](null)}}}const ry=50,ny=1e3,Rd=10,iy=[`executed the callback function more than ${Rd} times for a short time, it looks like searched a wrong scroll wrapper that doest not has fixed height or maximum height, please check it. If you want to force to set a element as scroll wrapper rather than automatic searching, you can do this:`,"<!-- add a special attribute for the real scroll wrapper (can also be data-infinite-wrapper) -->","<div infinite-wrapper>","  ...","  <!-- set forceUseInfiniteWrapper -->","  <InfiniteLoading forceUseInfiniteWrapper>","</div>","or",'<div class="infinite-wrapper">',"  ...","  <!-- set forceUseInfiniteWrapper as css selector of the real scroll wrapper -->",'  <InfiniteLoading forceUseInfiniteWrapper=".infinite-wrapper" />',"</div>"].join(`
`),Ro=(()=>{let f=!1;try{const a=Object.defineProperty({},"passive",{get(){return f={passive:!0},!0}});window.addEventListener("testPassive",null,a),window.removeEventListener("testPassive",null,a)}catch{}return f})(),Do={timers:[],caches:[],throttle(f){this.caches.indexOf(f)===-1&&(this.caches.push(f),this.timers.push(setTimeout(()=>{f(),this.caches.splice(this.caches.indexOf(f),1),this.timers.shift()},ry)))},reset(){this.timers.forEach(f=>{clearTimeout(f)}),this.timers.length=0,this.caches=[]}},If={isChecked:!1,timer:null,times:0,track(){this.times+=1,clearTimeout(this.timer),this.timer=setTimeout(()=>{this.isChecked=!0},ny),this.times>Rd&&(console.error(iy),this.isChecked=!0)}},Io={key:"_infiniteScrollHeight",getScrollElement(f){return f===window?document.documentElement:f},save(f){const a=this.getScrollElement(f);a[this.key]=a.scrollHeight},restore(f){const a=this.getScrollElement(f);typeof a[this.key]=="number"&&(a.scrollTop=a.scrollHeight-a[this.key]+a.scrollTop),this.remove(a)},remove(f){f[this.key]!==void 0&&delete f[this.key]}};function kf(f){return!0}function sy(f,a,l){let m,T,{$$slots:S={},$$scope:L}=a;const I=Au(),k={READY:0,LOADING:1,COMPLETE:2,ERROR:3};let{distance:x=100}=a,{spinner:U="default"}=a,{displaySpinner:O=!0}=a,{direction:E="bottom"}=a,{forceUseInfiniteWrapper:A=!1}=a,{identifier:w=+new Date}=a,{isAdmin:te=!1}=a,K=!0,V=k.READY,ne=!1,Y,re;const ie={loaded:async()=>{l(2,K=!1),E==="top"&&(await wo(),Io.restore(re)),V===k.LOADING&&(await wo(),await N(!0))},complete:async()=>{l(12,V=k.COMPLETE),await wo(),re.removeEventListener("scroll",Z,Ro)},reset:()=>{l(12,V=k.READY),l(2,K=!0),Io.remove(re),re.addEventListener("scroll",Z,Ro),setTimeout(()=>{Do.reset(),Z()},1)},error:()=>{l(12,V=k.ERROR),Do.reset()}};function Z(q){V===k.READY&&(q&&q.constructor===Event&&kf()?Do.throttle(N):N())}async function N(q){V!==k.COMPLETE&&kf()&&W()<=x?(l(12,V=k.LOADING),E==="top"&&(await wo(),Io.save(re)),I("infinite",ie),q&&!A&&!If.isChecked&&If.track()):V===k.LOADING&&l(12,V=k.READY)}function W(){let q;if(E==="top")q=typeof re.scrollTop=="number"?re.scrollTop:re.pageYOffset;else{const H=Y.getBoundingClientRect().top,ye=re===window?window.innerHeight:re.getBoundingClientRect().bottom;q=H-ye}return q}function me(q=Y){let H;return typeof A=="string"&&(H=document.querySelector(A)),H||(q.tagName==="BODY"?H=window:(!A&&["scroll","auto"].indexOf(getComputedStyle(q).overflowY)>-1||q.hasAttribute("infinite-wrapper")||q.hasAttribute("data-infinite-wrapper"))&&(H=q)),H||me(q.parentNode)}function xe(){ne&&(re=me())}function j(){ne&&ie.reset()}Aa(async()=>{l(13,ne=!0),setTimeout(()=>{Z(),re.addEventListener("scroll",Z,Ro)},1)}),bd(()=>{ne&&V!==k.COMPLETE&&(Do.reset(),Io.remove(re),re.removeEventListener("scroll",Z,Ro))});function C(q){Fr[q?"unshift":"push"](()=>{Y=q,l(3,Y)})}return f.$$set=q=>{"distance"in q&&l(7,x=q.distance),"spinner"in q&&l(0,U=q.spinner),"displaySpinner"in q&&l(1,O=q.displaySpinner),"direction"in q&&l(8,E=q.direction),"forceUseInfiniteWrapper"in q&&l(9,A=q.forceUseInfiniteWrapper),"identifier"in q&&l(10,w=q.identifier),"isAdmin"in q&&l(11,te=q.isAdmin),"$$scope"in q&&l(14,L=q.$$scope)},f.$$.update=()=>{f.$$.dirty&4096&&l(5,m=V===k.LOADING),f.$$.dirty&4096&&l(4,T=V===k.ERROR),f.$$.dirty&4100,f.$$.dirty&4100,f.$$.dirty&8704&&xe(),f.$$.dirty&9216&&j()},[U,O,K,Y,T,m,N,x,E,A,w,te,V,ne,L,S,C]}class ay extends Xi{constructor(a){super(),Qi(this,a,sy,ty,Ii,{distance:7,spinner:0,displaySpinner:1,direction:8,forceUseInfiniteWrapper:9,identifier:10,isAdmin:11})}}var hu={},oy={get exports(){return hu},set exports(f){hu=f}};/**
 * @license
 * Lodash <https://lodash.com/>
 * Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
 * Released under MIT license <https://lodash.com/license>
 * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
 * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
 */(function(f,a){(function(){var l,m="4.17.21",T=200,S="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",L="Expected a function",I="Invalid `variable` option passed into `_.template`",k="__lodash_hash_undefined__",x=500,U="__lodash_placeholder__",O=1,E=2,A=4,w=1,te=2,K=1,V=2,ne=4,Y=8,re=16,ie=32,Z=64,N=128,W=256,me=512,xe=30,j="...",C=800,q=16,H=1,ye=2,he=3,Ee=1/0,Ae=9007199254740991,qe=17976931348623157e292,je=0/0,Xe=4294967295,Ve=Xe-1,Ie=Xe>>>1,He=[["ary",N],["bind",K],["bindKey",V],["curry",Y],["curryRight",re],["flip",me],["partial",ie],["partialRight",Z],["rearg",W]],ce="[object Arguments]",De="[object Array]",ve="[object AsyncFunction]",Be="[object Boolean]",Te="[object Date]",ze="[object DOMException]",We="[object Error]",$e="[object Function]",it="[object GeneratorFunction]",ue="[object Map]",ot="[object Number]",Fe="[object Null]",nt="[object Object]",ht="[object Promise]",Pt="[object Proxy]",jt="[object RegExp]",Rt="[object Set]",Ct="[object String]",Ft="[object Symbol]",Kt="[object Undefined]",It="[object WeakMap]",Zt="[object WeakSet]",cr="[object ArrayBuffer]",fr="[object DataView]",kr="[object Float32Array]",wr="[object Float64Array]",yr="[object Int8Array]",pe="[object Int16Array]",$="[object Int32Array]",M="[object Uint8Array]",z="[object Uint8ClampedArray]",Q="[object Uint16Array]",se="[object Uint32Array]",oe=/\b__p \+= '';/g,de=/\b(__p \+=) '' \+/g,Ce=/(__e\(.*?\)|\b__t\)) \+\n'';/g,Me=/&(?:amp|lt|gt|quot|#39);/g,Ne=/[&<>"']/g,Ze=RegExp(Me.source),at=RegExp(Ne.source),et=/<%-([\s\S]+?)%>/g,ft=/<%([\s\S]+?)%>/g,kt=/<%=([\s\S]+?)%>/g,Ht=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,ct=/^\w*$/,zt=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Er=/[\\^$.*+?()[\]{}|]/g,Qt=RegExp(Er.source),_r=/^\s+/,hr=/\s/,mt=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,Br=/\{\n\/\* \[wrapped with (.+)\] \*/,un=/,? & /,sr=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,Cr=/[()=,{}\[\]\/\s]/,cn=/\\(\\)?/g,Wn=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,fn=/\w*$/,or=/^[-+]0x[0-9a-f]+$/i,Ds=/^0b[01]+$/i,Ra=/^\[object .+?Constructor\]$/,Da=/^0o[0-7]+$/i,Is=/^(?:0|[1-9]\d*)$/,Ia=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,Oi=/($^)/,ks=/['\n\r\u2028\u2029\\]/g,ci="\\ud800-\\udfff",zo="\\u0300-\\u036f",Qo="\\ufe20-\\ufe2f",Xo="\\u20d0-\\u20ff",ka=zo+Qo+Xo,Zi="\\u2700-\\u27bf",zr="a-z\\xdf-\\xf6\\xf8-\\xff",Nt="\\xac\\xb1\\xd7\\xf7",Cs="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",fi="\\u2000-\\u206f",di=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",Pi="A-Z\\xc0-\\xd6\\xd8-\\xde",nn="\\ufe0e\\ufe0f",hi=Nt+Cs+fi+di,jn="['’]",En="["+ci+"]",pi="["+hi+"]",_n="["+ka+"]",Ji="\\d+",Os="["+Zi+"]",Ps="["+zr+"]",$i="[^"+ci+hi+Ji+Zi+zr+Pi+"]",es="\\ud83c[\\udffb-\\udfff]",Ca="(?:"+_n+"|"+es+")",Oa="[^"+ci+"]",Fs="(?:\\ud83c[\\udde6-\\uddff]){2}",ts="[\\ud800-\\udbff][\\udc00-\\udfff]",Qr="["+Pi+"]",rs="\\u200d",Pa="(?:"+Ps+"|"+$i+")",Ms="(?:"+Qr+"|"+$i+")",xs="(?:"+jn+"(?:d|ll|m|re|s|t|ve))?",Fa="(?:"+jn+"(?:D|LL|M|RE|S|T|VE))?",Ma=Ca+"?",ns="["+nn+"]?",Zo="(?:"+rs+"(?:"+[Oa,Fs,ts].join("|")+")"+ns+Ma+")*",is="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",Jo="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",xa=ns+Ma+Zo,$o="(?:"+[Os,Fs,ts].join("|")+")"+xa,Na="(?:"+[Oa+_n+"?",_n,Fs,ts,En].join("|")+")",ss=RegExp(jn,"g"),Ns=RegExp(_n,"g"),Us=RegExp(es+"(?="+es+")|"+Na+xa,"g"),el=RegExp([Qr+"?"+Ps+"+"+xs+"(?="+[pi,Qr,"$"].join("|")+")",Ms+"+"+Fa+"(?="+[pi,Qr+Pa,"$"].join("|")+")",Qr+"?"+Pa+"+"+xs,Qr+"+"+Fa,Jo,is,Ji,$o].join("|"),"g"),tl=RegExp("["+rs+ci+ka+nn+"]"),Bs=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,rl=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],nl=-1,rr={};rr[kr]=rr[wr]=rr[yr]=rr[pe]=rr[$]=rr[M]=rr[z]=rr[Q]=rr[se]=!0,rr[ce]=rr[De]=rr[cr]=rr[Be]=rr[fr]=rr[Te]=rr[We]=rr[$e]=rr[ue]=rr[ot]=rr[nt]=rr[jt]=rr[Rt]=rr[Ct]=rr[It]=!1;var ir={};ir[ce]=ir[De]=ir[cr]=ir[fr]=ir[Be]=ir[Te]=ir[kr]=ir[wr]=ir[yr]=ir[pe]=ir[$]=ir[ue]=ir[ot]=ir[nt]=ir[jt]=ir[Rt]=ir[Ct]=ir[Ft]=ir[M]=ir[z]=ir[Q]=ir[se]=!0,ir[We]=ir[$e]=ir[It]=!1;var il={À:"A",Á:"A",Â:"A",Ã:"A",Ä:"A",Å:"A",à:"a",á:"a",â:"a",ã:"a",ä:"a",å:"a",Ç:"C",ç:"c",Ð:"D",ð:"d",È:"E",É:"E",Ê:"E",Ë:"E",è:"e",é:"e",ê:"e",ë:"e",Ì:"I",Í:"I",Î:"I",Ï:"I",ì:"i",í:"i",î:"i",ï:"i",Ñ:"N",ñ:"n",Ò:"O",Ó:"O",Ô:"O",Õ:"O",Ö:"O",Ø:"O",ò:"o",ó:"o",ô:"o",õ:"o",ö:"o",ø:"o",Ù:"U",Ú:"U",Û:"U",Ü:"U",ù:"u",ú:"u",û:"u",ü:"u",Ý:"Y",ý:"y",ÿ:"y",Æ:"Ae",æ:"ae",Þ:"Th",þ:"th",ß:"ss",Ā:"A",Ă:"A",Ą:"A",ā:"a",ă:"a",ą:"a",Ć:"C",Ĉ:"C",Ċ:"C",Č:"C",ć:"c",ĉ:"c",ċ:"c",č:"c",Ď:"D",Đ:"D",ď:"d",đ:"d",Ē:"E",Ĕ:"E",Ė:"E",Ę:"E",Ě:"E",ē:"e",ĕ:"e",ė:"e",ę:"e",ě:"e",Ĝ:"G",Ğ:"G",Ġ:"G",Ģ:"G",ĝ:"g",ğ:"g",ġ:"g",ģ:"g",Ĥ:"H",Ħ:"H",ĥ:"h",ħ:"h",Ĩ:"I",Ī:"I",Ĭ:"I",Į:"I",İ:"I",ĩ:"i",ī:"i",ĭ:"i",į:"i",ı:"i",Ĵ:"J",ĵ:"j",Ķ:"K",ķ:"k",ĸ:"k",Ĺ:"L",Ļ:"L",Ľ:"L",Ŀ:"L",Ł:"L",ĺ:"l",ļ:"l",ľ:"l",ŀ:"l",ł:"l",Ń:"N",Ņ:"N",Ň:"N",Ŋ:"N",ń:"n",ņ:"n",ň:"n",ŋ:"n",Ō:"O",Ŏ:"O",Ő:"O",ō:"o",ŏ:"o",ő:"o",Ŕ:"R",Ŗ:"R",Ř:"R",ŕ:"r",ŗ:"r",ř:"r",Ś:"S",Ŝ:"S",Ş:"S",Š:"S",ś:"s",ŝ:"s",ş:"s",š:"s",Ţ:"T",Ť:"T",Ŧ:"T",ţ:"t",ť:"t",ŧ:"t",Ũ:"U",Ū:"U",Ŭ:"U",Ů:"U",Ű:"U",Ų:"U",ũ:"u",ū:"u",ŭ:"u",ů:"u",ű:"u",ų:"u",Ŵ:"W",ŵ:"w",Ŷ:"Y",ŷ:"y",Ÿ:"Y",Ź:"Z",Ż:"Z",Ž:"Z",ź:"z",ż:"z",ž:"z",Ĳ:"IJ",ĳ:"ij",Œ:"Oe",œ:"oe",ŉ:"'n",ſ:"s"},sl={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},Gs={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},Ks={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},al=parseFloat,Ut=parseInt,Ua=typeof Ss=="object"&&Ss&&Ss.Object===Object&&Ss,Ba=typeof self=="object"&&self&&self.Object===Object&&self,Or=Ua||Ba||Function("return this")(),Hs=a&&!a.nodeType&&a,Fn=Hs&&!0&&f&&!f.nodeType&&f,qs=Fn&&Fn.exports===Hs,Tn=qs&&Ua.process,Tr=function(){try{var fe=Fn&&Fn.require&&Fn.require("util").types;return fe||Tn&&Tn.binding&&Tn.binding("util")}catch{}}(),Ga=Tr&&Tr.isArrayBuffer,Ka=Tr&&Tr.isDate,Ha=Tr&&Tr.isMap,qa=Tr&&Tr.isRegExp,Va=Tr&&Tr.isSet,Wa=Tr&&Tr.isTypedArray;function Rr(fe,ke,Re){switch(Re.length){case 0:return fe.call(ke);case 1:return fe.call(ke,Re[0]);case 2:return fe.call(ke,Re[0],Re[1]);case 3:return fe.call(ke,Re[0],Re[1],Re[2])}return fe.apply(ke,Re)}function ja(fe,ke,Re,ut){for(var Lt=-1,Xt=fe==null?0:fe.length;++Lt<Xt;){var br=fe[Lt];ke(ut,br,Re(br),fe)}return ut}function Xr(fe,ke){for(var Re=-1,ut=fe==null?0:fe.length;++Re<ut&&ke(fe[Re],Re,fe)!==!1;);return fe}function ol(fe,ke){for(var Re=fe==null?0:fe.length;Re--&&ke(fe[Re],Re,fe)!==!1;);return fe}function as(fe,ke){for(var Re=-1,ut=fe==null?0:fe.length;++Re<ut;)if(!ke(fe[Re],Re,fe))return!1;return!0}function bn(fe,ke){for(var Re=-1,ut=fe==null?0:fe.length,Lt=0,Xt=[];++Re<ut;){var br=fe[Re];ke(br,Re,fe)&&(Xt[Lt++]=br)}return Xt}function os(fe,ke){var Re=fe==null?0:fe.length;return!!Re&&vi(fe,ke,0)>-1}function Mn(fe,ke,Re){for(var ut=-1,Lt=fe==null?0:fe.length;++ut<Lt;)if(Re(ke,fe[ut]))return!0;return!1}function ar(fe,ke){for(var Re=-1,ut=fe==null?0:fe.length,Lt=Array(ut);++Re<ut;)Lt[Re]=ke(fe[Re],Re,fe);return Lt}function Sn(fe,ke){for(var Re=-1,ut=ke.length,Lt=fe.length;++Re<ut;)fe[Lt+Re]=ke[Re];return fe}function gi(fe,ke,Re,ut){var Lt=-1,Xt=fe==null?0:fe.length;for(ut&&Xt&&(Re=fe[++Lt]);++Lt<Xt;)Re=ke(Re,fe[Lt],Lt,fe);return Re}function Vs(fe,ke,Re,ut){var Lt=fe==null?0:fe.length;for(ut&&Lt&&(Re=fe[--Lt]);Lt--;)Re=ke(Re,fe[Lt],Lt,fe);return Re}function Ws(fe,ke){for(var Re=-1,ut=fe==null?0:fe.length;++Re<ut;)if(ke(fe[Re],Re,fe))return!0;return!1}var Ya=Ys("length");function ll(fe){return fe.split("")}function za(fe){return fe.match(sr)||[]}function ls(fe,ke,Re){var ut;return Re(fe,function(Lt,Xt,br){if(ke(Lt,Xt,br))return ut=Xt,!1}),ut}function Yn(fe,ke,Re,ut){for(var Lt=fe.length,Xt=Re+(ut?1:-1);ut?Xt--:++Xt<Lt;)if(ke(fe[Xt],Xt,fe))return Xt;return-1}function vi(fe,ke,Re){return ke===ke?xi(fe,ke,Re):Yn(fe,Xa,Re)}function Qa(fe,ke,Re,ut){for(var Lt=Re-1,Xt=fe.length;++Lt<Xt;)if(ut(fe[Lt],ke))return Lt;return-1}function Xa(fe){return fe!==fe}function js(fe,ke){var Re=fe==null?0:fe.length;return Re?Fi(fe,ke)/Re:je}function Ys(fe){return function(ke){return ke==null?l:ke[fe]}}function zs(fe){return function(ke){return fe==null?l:fe[ke]}}function us(fe,ke,Re,ut,Lt){return Lt(fe,function(Xt,br,$t){Re=ut?(ut=!1,Xt):ke(Re,Xt,br,$t)}),Re}function Qs(fe,ke){var Re=fe.length;for(fe.sort(ke);Re--;)fe[Re]=fe[Re].value;return fe}function Fi(fe,ke){for(var Re,ut=-1,Lt=fe.length;++ut<Lt;){var Xt=ke(fe[ut]);Xt!==l&&(Re=Re===l?Xt:Re+Xt)}return Re}function Mi(fe,ke){for(var Re=-1,ut=Array(fe);++Re<fe;)ut[Re]=ke(Re);return ut}function Xs(fe,ke){return ar(ke,function(Re){return[Re,fe[Re]]})}function Zs(fe){return fe&&fe.slice(0,Jr(fe)+1).replace(_r,"")}function Hr(fe){return function(ke){return fe(ke)}}function Js(fe,ke){return ar(ke,function(Re){return fe[Re]})}function mi(fe,ke){return fe.has(ke)}function cs(fe,ke){for(var Re=-1,ut=fe.length;++Re<ut&&vi(ke,fe[Re],0)>-1;);return Re}function $s(fe,ke){for(var Re=fe.length;Re--&&vi(ke,fe[Re],0)>-1;);return Re}function Za(fe,ke){for(var Re=fe.length,ut=0;Re--;)fe[Re]===ke&&++ut;return ut}var ea=zs(il),Ja=zs(sl);function ta(fe){return"\\"+Ks[fe]}function ul(fe,ke){return fe==null?l:fe[ke]}function yi(fe){return tl.test(fe)}function cl(fe){return Bs.test(fe)}function fl(fe){for(var ke,Re=[];!(ke=fe.next()).done;)Re.push(ke.value);return Re}function ra(fe){var ke=-1,Re=Array(fe.size);return fe.forEach(function(ut,Lt){Re[++ke]=[Lt,ut]}),Re}function xn(fe,ke){return function(Re){return fe(ke(Re))}}function dn(fe,ke){for(var Re=-1,ut=fe.length,Lt=0,Xt=[];++Re<ut;){var br=fe[Re];(br===ke||br===U)&&(fe[Re]=U,Xt[Lt++]=Re)}return Xt}function Ei(fe){var ke=-1,Re=Array(fe.size);return fe.forEach(function(ut){Re[++ke]=ut}),Re}function dl(fe){var ke=-1,Re=Array(fe.size);return fe.forEach(function(ut){Re[++ke]=[ut,ut]}),Re}function xi(fe,ke,Re){for(var ut=Re-1,Lt=fe.length;++ut<Lt;)if(fe[ut]===ke)return ut;return-1}function na(fe,ke,Re){for(var ut=Re+1;ut--;)if(fe[ut]===ke)return ut;return ut}function Ln(fe){return yi(fe)?Mr(fe):Ya(fe)}function Zr(fe){return yi(fe)?ia(fe):ll(fe)}function Jr(fe){for(var ke=fe.length;ke--&&hr.test(fe.charAt(ke)););return ke}var hl=zs(Gs);function Mr(fe){for(var ke=Us.lastIndex=0;Us.test(fe);)++ke;return ke}function ia(fe){return fe.match(Us)||[]}function $a(fe){return fe.match(el)||[]}var eo=function fe(ke){ke=ke==null?Or:zn.defaults(Or.Object(),ke,zn.pick(Or,rl));var Re=ke.Array,ut=ke.Date,Lt=ke.Error,Xt=ke.Function,br=ke.Math,$t=ke.Object,Ni=ke.RegExp,pl=ke.String,xr=ke.TypeError,_i=Re.prototype,sa=Xt.prototype,Ti=$t.prototype,fs=ke["__core-js_shared__"],ds=sa.toString,Jt=Ti.hasOwnProperty,gl=0,hs=function(){var e=/[^.]+$/.exec(fs&&fs.keys&&fs.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}(),Ui=Ti.toString,to=ds.call($t),vl=Or._,ml=Ni("^"+ds.call(Jt).replace(Er,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Bi=qs?ke.Buffer:l,An=ke.Symbol,v=ke.Uint8Array,h=Bi?Bi.allocUnsafe:l,t=xn($t.getPrototypeOf,$t),n=$t.create,s=Ti.propertyIsEnumerable,o=_i.splice,c=An?An.isConcatSpreadable:l,i=An?An.iterator:l,u=An?An.toStringTag:l,p=function(){try{var e=qi($t,"defineProperty");return e({},"",{}),e}catch{}}(),g=ke.clearTimeout!==Or.clearTimeout&&ke.clearTimeout,y=ut&&ut.now!==Or.Date.now&&ut.now,b=ke.setTimeout!==Or.setTimeout&&ke.setTimeout,D=br.ceil,F=br.floor,G=$t.getOwnPropertySymbols,ee=Bi?Bi.isBuffer:l,J=ke.isFinite,le=_i.join,Se=xn($t.keys,$t),we=br.max,be=br.min,Pe=ut.now,tt=ke.parseInt,rt=br.random,Ge=_i.reverse,Je=qi(ke,"DataView"),Qe=qi(ke,"Map"),Dt=qi(ke,"Promise"),Vt=qi(ke,"Set"),St=qi(ke,"WeakMap"),wt=qi($t,"create"),Mt=St&&new St,pr={},gr=Vi(Je),lr=Vi(Qe),dr=Vi(Dt),wn=Vi(Vt),Qn=Vi(St),Rn=An?An.prototype:l,Dn=Rn?Rn.valueOf:l,Xn=Rn?Rn.toString:l;function P(e){if(Sr(e)&&!Ot(e)&&!(e instanceof At)){if(e instanceof Nr)return e;if(Jt.call(e,"__wrapped__"))return Ic(e)}return new Nr(e)}var gt=function(){function e(){}return function(r){if(!vr(r))return{};if(n)return n(r);e.prototype=r;var d=new e;return e.prototype=l,d}}();function bt(){}function Nr(e,r){this.__wrapped__=e,this.__actions__=[],this.__chain__=!!r,this.__index__=0,this.__values__=l}P.templateSettings={escape:et,evaluate:ft,interpolate:kt,variable:"",imports:{_:P}},P.prototype=bt.prototype,P.prototype.constructor=P,Nr.prototype=gt(bt.prototype),Nr.prototype.constructor=Nr;function At(e){this.__wrapped__=e,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=Xe,this.__views__=[]}function In(){var e=new At(this.__wrapped__);return e.__actions__=$r(this.__actions__),e.__dir__=this.__dir__,e.__filtered__=this.__filtered__,e.__iteratees__=$r(this.__iteratees__),e.__takeCount__=this.__takeCount__,e.__views__=$r(this.__views__),e}function bi(){if(this.__filtered__){var e=new At(this);e.__dir__=-1,e.__filtered__=!0}else e=this.clone(),e.__dir__*=-1;return e}function kn(){var e=this.__wrapped__.value(),r=this.__dir__,d=Ot(e),_=r<0,R=d?e.length:0,B=Yh(0,R,this.__views__),X=B.start,ae=B.end,ge=ae-X,Ue=_?ae:X-1,Ke=this.__iteratees__,Ye=Ke.length,st=0,dt=be(ge,this.__takeCount__);if(!d||!_&&R==ge&&dt==ge)return Ju(e,this.__actions__);var _t=[];e:for(;ge--&&st<dt;){Ue+=r;for(var Bt=-1,Tt=e[Ue];++Bt<Ye;){var Wt=Ke[Bt],Yt=Wt.iteratee,on=Wt.type,Yr=Yt(Tt);if(on==ye)Tt=Yr;else if(!Yr){if(on==H)continue e;break e}}_t[st++]=Tt}return _t}At.prototype=gt(bt.prototype),At.prototype.constructor=At;function Gr(e){var r=-1,d=e==null?0:e.length;for(this.clear();++r<d;){var _=e[r];this.set(_[0],_[1])}}function Nn(){this.__data__=wt?wt(null):{},this.size=0}function qr(e){var r=this.has(e)&&delete this.__data__[e];return this.size-=r?1:0,r}function aa(e){var r=this.__data__;if(wt){var d=r[e];return d===k?l:d}return Jt.call(r,e)?r[e]:l}function ps(e){var r=this.__data__;return wt?r[e]!==l:Jt.call(r,e)}function Gd(e,r){var d=this.__data__;return this.size+=this.has(e)?0:1,d[e]=wt&&r===l?k:r,this}Gr.prototype.clear=Nn,Gr.prototype.delete=qr,Gr.prototype.get=aa,Gr.prototype.has=ps,Gr.prototype.set=Gd;function Zn(e){var r=-1,d=e==null?0:e.length;for(this.clear();++r<d;){var _=e[r];this.set(_[0],_[1])}}function Kd(){this.__data__=[],this.size=0}function Hd(e){var r=this.__data__,d=ro(r,e);if(d<0)return!1;var _=r.length-1;return d==_?r.pop():o.call(r,d,1),--this.size,!0}function qd(e){var r=this.__data__,d=ro(r,e);return d<0?l:r[d][1]}function Vd(e){return ro(this.__data__,e)>-1}function Wd(e,r){var d=this.__data__,_=ro(d,e);return _<0?(++this.size,d.push([e,r])):d[_][1]=r,this}Zn.prototype.clear=Kd,Zn.prototype.delete=Hd,Zn.prototype.get=qd,Zn.prototype.has=Vd,Zn.prototype.set=Wd;function Jn(e){var r=-1,d=e==null?0:e.length;for(this.clear();++r<d;){var _=e[r];this.set(_[0],_[1])}}function jd(){this.size=0,this.__data__={hash:new Gr,map:new(Qe||Zn),string:new Gr}}function Yd(e){var r=go(this,e).delete(e);return this.size-=r?1:0,r}function zd(e){return go(this,e).get(e)}function Qd(e){return go(this,e).has(e)}function Xd(e,r){var d=go(this,e),_=d.size;return d.set(e,r),this.size+=d.size==_?0:1,this}Jn.prototype.clear=jd,Jn.prototype.delete=Yd,Jn.prototype.get=zd,Jn.prototype.has=Qd,Jn.prototype.set=Xd;function Gi(e){var r=-1,d=e==null?0:e.length;for(this.__data__=new Jn;++r<d;)this.add(e[r])}function Zd(e){return this.__data__.set(e,k),this}function Jd(e){return this.__data__.has(e)}Gi.prototype.add=Gi.prototype.push=Zd,Gi.prototype.has=Jd;function Cn(e){var r=this.__data__=new Zn(e);this.size=r.size}function $d(){this.__data__=new Zn,this.size=0}function eh(e){var r=this.__data__,d=r.delete(e);return this.size=r.size,d}function th(e){return this.__data__.get(e)}function rh(e){return this.__data__.has(e)}function nh(e,r){var d=this.__data__;if(d instanceof Zn){var _=d.__data__;if(!Qe||_.length<T-1)return _.push([e,r]),this.size=++d.size,this;d=this.__data__=new Jn(_)}return d.set(e,r),this.size=d.size,this}Cn.prototype.clear=$d,Cn.prototype.delete=eh,Cn.prototype.get=th,Cn.prototype.has=rh,Cn.prototype.set=nh;function Iu(e,r){var d=Ot(e),_=!d&&Wi(e),R=!d&&!_&&Ri(e),B=!d&&!_&&!R&&ys(e),X=d||_||R||B,ae=X?Mi(e.length,pl):[],ge=ae.length;for(var Ue in e)(r||Jt.call(e,Ue))&&!(X&&(Ue=="length"||R&&(Ue=="offset"||Ue=="parent")||B&&(Ue=="buffer"||Ue=="byteLength"||Ue=="byteOffset")||ri(Ue,ge)))&&ae.push(Ue);return ae}function ku(e){var r=e.length;return r?e[Dl(0,r-1)]:l}function ih(e,r){return vo($r(e),Ki(r,0,e.length))}function sh(e){return vo($r(e))}function yl(e,r,d){(d!==l&&!On(e[r],d)||d===l&&!(r in e))&&$n(e,r,d)}function oa(e,r,d){var _=e[r];(!(Jt.call(e,r)&&On(_,d))||d===l&&!(r in e))&&$n(e,r,d)}function ro(e,r){for(var d=e.length;d--;)if(On(e[d][0],r))return d;return-1}function ah(e,r,d,_){return Si(e,function(R,B,X){r(_,R,d(R),X)}),_}function Cu(e,r){return e&&Bn(r,Ur(r),e)}function oh(e,r){return e&&Bn(r,tn(r),e)}function $n(e,r,d){r=="__proto__"&&p?p(e,r,{configurable:!0,enumerable:!0,value:d,writable:!0}):e[r]=d}function El(e,r){for(var d=-1,_=r.length,R=Re(_),B=e==null;++d<_;)R[d]=B?l:$l(e,r[d]);return R}function Ki(e,r,d){return e===e&&(d!==l&&(e=e<=d?e:d),r!==l&&(e=e>=r?e:r)),e}function hn(e,r,d,_,R,B){var X,ae=r&O,ge=r&E,Ue=r&A;if(d&&(X=R?d(e,_,R,B):d(e)),X!==l)return X;if(!vr(e))return e;var Ke=Ot(e);if(Ke){if(X=Qh(e),!ae)return $r(e,X)}else{var Ye=Vr(e),st=Ye==$e||Ye==it;if(Ri(e))return tc(e,ae);if(Ye==nt||Ye==ce||st&&!R){if(X=ge||st?{}:_c(e),!ae)return ge?Uh(e,oh(X,e)):Nh(e,Cu(X,e))}else{if(!ir[Ye])return R?e:{};X=Xh(e,Ye,ae)}}B||(B=new Cn);var dt=B.get(e);if(dt)return dt;B.set(e,X),Qc(e)?e.forEach(function(Tt){X.add(hn(Tt,r,d,Tt,e,B))}):Yc(e)&&e.forEach(function(Tt,Wt){X.set(Wt,hn(Tt,r,d,Wt,e,B))});var _t=Ue?ge?Bl:Ul:ge?tn:Ur,Bt=Ke?l:_t(e);return Xr(Bt||e,function(Tt,Wt){Bt&&(Wt=Tt,Tt=e[Wt]),oa(X,Wt,hn(Tt,r,d,Wt,e,B))}),X}function lh(e){var r=Ur(e);return function(d){return Ou(d,e,r)}}function Ou(e,r,d){var _=d.length;if(e==null)return!_;for(e=$t(e);_--;){var R=d[_],B=r[R],X=e[R];if(X===l&&!(R in e)||!B(X))return!1}return!0}function Pu(e,r,d){if(typeof e!="function")throw new xr(L);return pa(function(){e.apply(l,d)},r)}function la(e,r,d,_){var R=-1,B=os,X=!0,ae=e.length,ge=[],Ue=r.length;if(!ae)return ge;d&&(r=ar(r,Hr(d))),_?(B=Mn,X=!1):r.length>=T&&(B=mi,X=!1,r=new Gi(r));e:for(;++R<ae;){var Ke=e[R],Ye=d==null?Ke:d(Ke);if(Ke=_||Ke!==0?Ke:0,X&&Ye===Ye){for(var st=Ue;st--;)if(r[st]===Ye)continue e;ge.push(Ke)}else B(r,Ye,_)||ge.push(Ke)}return ge}var Si=ac(Un),Fu=ac(Tl,!0);function uh(e,r){var d=!0;return Si(e,function(_,R,B){return d=!!r(_,R,B),d}),d}function no(e,r,d){for(var _=-1,R=e.length;++_<R;){var B=e[_],X=r(B);if(X!=null&&(ae===l?X===X&&!an(X):d(X,ae)))var ae=X,ge=B}return ge}function ch(e,r,d,_){var R=e.length;for(d=xt(d),d<0&&(d=-d>R?0:R+d),_=_===l||_>R?R:xt(_),_<0&&(_+=R),_=d>_?0:Zc(_);d<_;)e[d++]=r;return e}function Mu(e,r){var d=[];return Si(e,function(_,R,B){r(_,R,B)&&d.push(_)}),d}function Kr(e,r,d,_,R){var B=-1,X=e.length;for(d||(d=Jh),R||(R=[]);++B<X;){var ae=e[B];r>0&&d(ae)?r>1?Kr(ae,r-1,d,_,R):Sn(R,ae):_||(R[R.length]=ae)}return R}var _l=oc(),xu=oc(!0);function Un(e,r){return e&&_l(e,r,Ur)}function Tl(e,r){return e&&xu(e,r,Ur)}function io(e,r){return bn(r,function(d){return ni(e[d])})}function Hi(e,r){r=Ai(r,e);for(var d=0,_=r.length;e!=null&&d<_;)e=e[Gn(r[d++])];return d&&d==_?e:l}function Nu(e,r,d){var _=r(e);return Ot(e)?_:Sn(_,d(e))}function Wr(e){return e==null?e===l?Kt:Fe:u&&u in $t(e)?jh(e):sp(e)}function bl(e,r){return e>r}function fh(e,r){return e!=null&&Jt.call(e,r)}function dh(e,r){return e!=null&&r in $t(e)}function hh(e,r,d){return e>=be(r,d)&&e<we(r,d)}function Sl(e,r,d){for(var _=d?Mn:os,R=e[0].length,B=e.length,X=B,ae=Re(B),ge=1/0,Ue=[];X--;){var Ke=e[X];X&&r&&(Ke=ar(Ke,Hr(r))),ge=be(Ke.length,ge),ae[X]=!d&&(r||R>=120&&Ke.length>=120)?new Gi(X&&Ke):l}Ke=e[0];var Ye=-1,st=ae[0];e:for(;++Ye<R&&Ue.length<ge;){var dt=Ke[Ye],_t=r?r(dt):dt;if(dt=d||dt!==0?dt:0,!(st?mi(st,_t):_(Ue,_t,d))){for(X=B;--X;){var Bt=ae[X];if(!(Bt?mi(Bt,_t):_(e[X],_t,d)))continue e}st&&st.push(_t),Ue.push(dt)}}return Ue}function ph(e,r,d,_){return Un(e,function(R,B,X){r(_,d(R),B,X)}),_}function ua(e,r,d){r=Ai(r,e),e=Lc(e,r);var _=e==null?e:e[Gn(gn(r))];return _==null?l:Rr(_,e,d)}function Uu(e){return Sr(e)&&Wr(e)==ce}function gh(e){return Sr(e)&&Wr(e)==cr}function vh(e){return Sr(e)&&Wr(e)==Te}function ca(e,r,d,_,R){return e===r?!0:e==null||r==null||!Sr(e)&&!Sr(r)?e!==e&&r!==r:mh(e,r,d,_,ca,R)}function mh(e,r,d,_,R,B){var X=Ot(e),ae=Ot(r),ge=X?De:Vr(e),Ue=ae?De:Vr(r);ge=ge==ce?nt:ge,Ue=Ue==ce?nt:Ue;var Ke=ge==nt,Ye=Ue==nt,st=ge==Ue;if(st&&Ri(e)){if(!Ri(r))return!1;X=!0,Ke=!1}if(st&&!Ke)return B||(B=new Cn),X||ys(e)?mc(e,r,d,_,R,B):Vh(e,r,ge,d,_,R,B);if(!(d&w)){var dt=Ke&&Jt.call(e,"__wrapped__"),_t=Ye&&Jt.call(r,"__wrapped__");if(dt||_t){var Bt=dt?e.value():e,Tt=_t?r.value():r;return B||(B=new Cn),R(Bt,Tt,d,_,B)}}return st?(B||(B=new Cn),Wh(e,r,d,_,R,B)):!1}function yh(e){return Sr(e)&&Vr(e)==ue}function Ll(e,r,d,_){var R=d.length,B=R,X=!_;if(e==null)return!B;for(e=$t(e);R--;){var ae=d[R];if(X&&ae[2]?ae[1]!==e[ae[0]]:!(ae[0]in e))return!1}for(;++R<B;){ae=d[R];var ge=ae[0],Ue=e[ge],Ke=ae[1];if(X&&ae[2]){if(Ue===l&&!(ge in e))return!1}else{var Ye=new Cn;if(_)var st=_(Ue,Ke,ge,e,r,Ye);if(!(st===l?ca(Ke,Ue,w|te,_,Ye):st))return!1}}return!0}function Bu(e){if(!vr(e)||ep(e))return!1;var r=ni(e)?ml:Ra;return r.test(Vi(e))}function Eh(e){return Sr(e)&&Wr(e)==jt}function _h(e){return Sr(e)&&Vr(e)==Rt}function Th(e){return Sr(e)&&bo(e.length)&&!!rr[Wr(e)]}function Gu(e){return typeof e=="function"?e:e==null?rn:typeof e=="object"?Ot(e)?qu(e[0],e[1]):Hu(e):uf(e)}function Al(e){if(!ha(e))return Se(e);var r=[];for(var d in $t(e))Jt.call(e,d)&&d!="constructor"&&r.push(d);return r}function bh(e){if(!vr(e))return ip(e);var r=ha(e),d=[];for(var _ in e)_=="constructor"&&(r||!Jt.call(e,_))||d.push(_);return d}function wl(e,r){return e<r}function Ku(e,r){var d=-1,_=en(e)?Re(e.length):[];return Si(e,function(R,B,X){_[++d]=r(R,B,X)}),_}function Hu(e){var r=Kl(e);return r.length==1&&r[0][2]?bc(r[0][0],r[0][1]):function(d){return d===e||Ll(d,e,r)}}function qu(e,r){return ql(e)&&Tc(r)?bc(Gn(e),r):function(d){var _=$l(d,e);return _===l&&_===r?eu(d,e):ca(r,_,w|te)}}function so(e,r,d,_,R){e!==r&&_l(r,function(B,X){if(R||(R=new Cn),vr(B))Sh(e,r,X,d,so,_,R);else{var ae=_?_(Wl(e,X),B,X+"",e,r,R):l;ae===l&&(ae=B),yl(e,X,ae)}},tn)}function Sh(e,r,d,_,R,B,X){var ae=Wl(e,d),ge=Wl(r,d),Ue=X.get(ge);if(Ue){yl(e,d,Ue);return}var Ke=B?B(ae,ge,d+"",e,r,X):l,Ye=Ke===l;if(Ye){var st=Ot(ge),dt=!st&&Ri(ge),_t=!st&&!dt&&ys(ge);Ke=ge,st||dt||_t?Ot(ae)?Ke=ae:Dr(ae)?Ke=$r(ae):dt?(Ye=!1,Ke=tc(ge,!0)):_t?(Ye=!1,Ke=rc(ge,!0)):Ke=[]:ga(ge)||Wi(ge)?(Ke=ae,Wi(ae)?Ke=Jc(ae):(!vr(ae)||ni(ae))&&(Ke=_c(ge))):Ye=!1}Ye&&(X.set(ge,Ke),R(Ke,ge,_,B,X),X.delete(ge)),yl(e,d,Ke)}function Vu(e,r){var d=e.length;if(d)return r+=r<0?d:0,ri(r,d)?e[r]:l}function Wu(e,r,d){r.length?r=ar(r,function(B){return Ot(B)?function(X){return Hi(X,B.length===1?B[0]:B)}:B}):r=[rn];var _=-1;r=ar(r,Hr(Et()));var R=Ku(e,function(B,X,ae){var ge=ar(r,function(Ue){return Ue(B)});return{criteria:ge,index:++_,value:B}});return Qs(R,function(B,X){return xh(B,X,d)})}function Lh(e,r){return ju(e,r,function(d,_){return eu(e,_)})}function ju(e,r,d){for(var _=-1,R=r.length,B={};++_<R;){var X=r[_],ae=Hi(e,X);d(ae,X)&&fa(B,Ai(X,e),ae)}return B}function Ah(e){return function(r){return Hi(r,e)}}function Rl(e,r,d,_){var R=_?Qa:vi,B=-1,X=r.length,ae=e;for(e===r&&(r=$r(r)),d&&(ae=ar(e,Hr(d)));++B<X;)for(var ge=0,Ue=r[B],Ke=d?d(Ue):Ue;(ge=R(ae,Ke,ge,_))>-1;)ae!==e&&o.call(ae,ge,1),o.call(e,ge,1);return e}function Yu(e,r){for(var d=e?r.length:0,_=d-1;d--;){var R=r[d];if(d==_||R!==B){var B=R;ri(R)?o.call(e,R,1):Cl(e,R)}}return e}function Dl(e,r){return e+F(rt()*(r-e+1))}function wh(e,r,d,_){for(var R=-1,B=we(D((r-e)/(d||1)),0),X=Re(B);B--;)X[_?B:++R]=e,e+=d;return X}function Il(e,r){var d="";if(!e||r<1||r>Ae)return d;do r%2&&(d+=e),r=F(r/2),r&&(e+=e);while(r);return d}function qt(e,r){return jl(Sc(e,r,rn),e+"")}function Rh(e){return ku(Es(e))}function Dh(e,r){var d=Es(e);return vo(d,Ki(r,0,d.length))}function fa(e,r,d,_){if(!vr(e))return e;r=Ai(r,e);for(var R=-1,B=r.length,X=B-1,ae=e;ae!=null&&++R<B;){var ge=Gn(r[R]),Ue=d;if(ge==="__proto__"||ge==="constructor"||ge==="prototype")return e;if(R!=X){var Ke=ae[ge];Ue=_?_(Ke,ge,ae):l,Ue===l&&(Ue=vr(Ke)?Ke:ri(r[R+1])?[]:{})}oa(ae,ge,Ue),ae=ae[ge]}return e}var zu=Mt?function(e,r){return Mt.set(e,r),e}:rn,Ih=p?function(e,r){return p(e,"toString",{configurable:!0,enumerable:!1,value:ru(r),writable:!0})}:rn;function kh(e){return vo(Es(e))}function pn(e,r,d){var _=-1,R=e.length;r<0&&(r=-r>R?0:R+r),d=d>R?R:d,d<0&&(d+=R),R=r>d?0:d-r>>>0,r>>>=0;for(var B=Re(R);++_<R;)B[_]=e[_+r];return B}function Ch(e,r){var d;return Si(e,function(_,R,B){return d=r(_,R,B),!d}),!!d}function ao(e,r,d){var _=0,R=e==null?_:e.length;if(typeof r=="number"&&r===r&&R<=Ie){for(;_<R;){var B=_+R>>>1,X=e[B];X!==null&&!an(X)&&(d?X<=r:X<r)?_=B+1:R=B}return R}return kl(e,r,rn,d)}function kl(e,r,d,_){var R=0,B=e==null?0:e.length;if(B===0)return 0;r=d(r);for(var X=r!==r,ae=r===null,ge=an(r),Ue=r===l;R<B;){var Ke=F((R+B)/2),Ye=d(e[Ke]),st=Ye!==l,dt=Ye===null,_t=Ye===Ye,Bt=an(Ye);if(X)var Tt=_||_t;else Ue?Tt=_t&&(_||st):ae?Tt=_t&&st&&(_||!dt):ge?Tt=_t&&st&&!dt&&(_||!Bt):dt||Bt?Tt=!1:Tt=_?Ye<=r:Ye<r;Tt?R=Ke+1:B=Ke}return be(B,Ve)}function Qu(e,r){for(var d=-1,_=e.length,R=0,B=[];++d<_;){var X=e[d],ae=r?r(X):X;if(!d||!On(ae,ge)){var ge=ae;B[R++]=X===0?0:X}}return B}function Xu(e){return typeof e=="number"?e:an(e)?je:+e}function sn(e){if(typeof e=="string")return e;if(Ot(e))return ar(e,sn)+"";if(an(e))return Xn?Xn.call(e):"";var r=e+"";return r=="0"&&1/e==-Ee?"-0":r}function Li(e,r,d){var _=-1,R=os,B=e.length,X=!0,ae=[],ge=ae;if(d)X=!1,R=Mn;else if(B>=T){var Ue=r?null:Hh(e);if(Ue)return Ei(Ue);X=!1,R=mi,ge=new Gi}else ge=r?[]:ae;e:for(;++_<B;){var Ke=e[_],Ye=r?r(Ke):Ke;if(Ke=d||Ke!==0?Ke:0,X&&Ye===Ye){for(var st=ge.length;st--;)if(ge[st]===Ye)continue e;r&&ge.push(Ye),ae.push(Ke)}else R(ge,Ye,d)||(ge!==ae&&ge.push(Ye),ae.push(Ke))}return ae}function Cl(e,r){return r=Ai(r,e),e=Lc(e,r),e==null||delete e[Gn(gn(r))]}function Zu(e,r,d,_){return fa(e,r,d(Hi(e,r)),_)}function oo(e,r,d,_){for(var R=e.length,B=_?R:-1;(_?B--:++B<R)&&r(e[B],B,e););return d?pn(e,_?0:B,_?B+1:R):pn(e,_?B+1:0,_?R:B)}function Ju(e,r){var d=e;return d instanceof At&&(d=d.value()),gi(r,function(_,R){return R.func.apply(R.thisArg,Sn([_],R.args))},d)}function Ol(e,r,d){var _=e.length;if(_<2)return _?Li(e[0]):[];for(var R=-1,B=Re(_);++R<_;)for(var X=e[R],ae=-1;++ae<_;)ae!=R&&(B[R]=la(B[R]||X,e[ae],r,d));return Li(Kr(B,1),r,d)}function $u(e,r,d){for(var _=-1,R=e.length,B=r.length,X={};++_<R;){var ae=_<B?r[_]:l;d(X,e[_],ae)}return X}function Pl(e){return Dr(e)?e:[]}function Fl(e){return typeof e=="function"?e:rn}function Ai(e,r){return Ot(e)?e:ql(e,r)?[e]:Dc(er(e))}var Oh=qt;function wi(e,r,d){var _=e.length;return d=d===l?_:d,!r&&d>=_?e:pn(e,r,d)}var ec=g||function(e){return Or.clearTimeout(e)};function tc(e,r){if(r)return e.slice();var d=e.length,_=h?h(d):new e.constructor(d);return e.copy(_),_}function Ml(e){var r=new e.constructor(e.byteLength);return new v(r).set(new v(e)),r}function Ph(e,r){var d=r?Ml(e.buffer):e.buffer;return new e.constructor(d,e.byteOffset,e.byteLength)}function Fh(e){var r=new e.constructor(e.source,fn.exec(e));return r.lastIndex=e.lastIndex,r}function Mh(e){return Dn?$t(Dn.call(e)):{}}function rc(e,r){var d=r?Ml(e.buffer):e.buffer;return new e.constructor(d,e.byteOffset,e.length)}function nc(e,r){if(e!==r){var d=e!==l,_=e===null,R=e===e,B=an(e),X=r!==l,ae=r===null,ge=r===r,Ue=an(r);if(!ae&&!Ue&&!B&&e>r||B&&X&&ge&&!ae&&!Ue||_&&X&&ge||!d&&ge||!R)return 1;if(!_&&!B&&!Ue&&e<r||Ue&&d&&R&&!_&&!B||ae&&d&&R||!X&&R||!ge)return-1}return 0}function xh(e,r,d){for(var _=-1,R=e.criteria,B=r.criteria,X=R.length,ae=d.length;++_<X;){var ge=nc(R[_],B[_]);if(ge){if(_>=ae)return ge;var Ue=d[_];return ge*(Ue=="desc"?-1:1)}}return e.index-r.index}function ic(e,r,d,_){for(var R=-1,B=e.length,X=d.length,ae=-1,ge=r.length,Ue=we(B-X,0),Ke=Re(ge+Ue),Ye=!_;++ae<ge;)Ke[ae]=r[ae];for(;++R<X;)(Ye||R<B)&&(Ke[d[R]]=e[R]);for(;Ue--;)Ke[ae++]=e[R++];return Ke}function sc(e,r,d,_){for(var R=-1,B=e.length,X=-1,ae=d.length,ge=-1,Ue=r.length,Ke=we(B-ae,0),Ye=Re(Ke+Ue),st=!_;++R<Ke;)Ye[R]=e[R];for(var dt=R;++ge<Ue;)Ye[dt+ge]=r[ge];for(;++X<ae;)(st||R<B)&&(Ye[dt+d[X]]=e[R++]);return Ye}function $r(e,r){var d=-1,_=e.length;for(r||(r=Re(_));++d<_;)r[d]=e[d];return r}function Bn(e,r,d,_){var R=!d;d||(d={});for(var B=-1,X=r.length;++B<X;){var ae=r[B],ge=_?_(d[ae],e[ae],ae,d,e):l;ge===l&&(ge=e[ae]),R?$n(d,ae,ge):oa(d,ae,ge)}return d}function Nh(e,r){return Bn(e,Hl(e),r)}function Uh(e,r){return Bn(e,yc(e),r)}function lo(e,r){return function(d,_){var R=Ot(d)?ja:ah,B=r?r():{};return R(d,e,Et(_,2),B)}}function gs(e){return qt(function(r,d){var _=-1,R=d.length,B=R>1?d[R-1]:l,X=R>2?d[2]:l;for(B=e.length>3&&typeof B=="function"?(R--,B):l,X&&jr(d[0],d[1],X)&&(B=R<3?l:B,R=1),r=$t(r);++_<R;){var ae=d[_];ae&&e(r,ae,_,B)}return r})}function ac(e,r){return function(d,_){if(d==null)return d;if(!en(d))return e(d,_);for(var R=d.length,B=r?R:-1,X=$t(d);(r?B--:++B<R)&&_(X[B],B,X)!==!1;);return d}}function oc(e){return function(r,d,_){for(var R=-1,B=$t(r),X=_(r),ae=X.length;ae--;){var ge=X[e?ae:++R];if(d(B[ge],ge,B)===!1)break}return r}}function Bh(e,r,d){var _=r&K,R=da(e);function B(){var X=this&&this!==Or&&this instanceof B?R:e;return X.apply(_?d:this,arguments)}return B}function lc(e){return function(r){r=er(r);var d=yi(r)?Zr(r):l,_=d?d[0]:r.charAt(0),R=d?wi(d,1).join(""):r.slice(1);return _[e]()+R}}function vs(e){return function(r){return gi(of(af(r).replace(ss,"")),e,"")}}function da(e){return function(){var r=arguments;switch(r.length){case 0:return new e;case 1:return new e(r[0]);case 2:return new e(r[0],r[1]);case 3:return new e(r[0],r[1],r[2]);case 4:return new e(r[0],r[1],r[2],r[3]);case 5:return new e(r[0],r[1],r[2],r[3],r[4]);case 6:return new e(r[0],r[1],r[2],r[3],r[4],r[5]);case 7:return new e(r[0],r[1],r[2],r[3],r[4],r[5],r[6])}var d=gt(e.prototype),_=e.apply(d,r);return vr(_)?_:d}}function Gh(e,r,d){var _=da(e);function R(){for(var B=arguments.length,X=Re(B),ae=B,ge=ms(R);ae--;)X[ae]=arguments[ae];var Ue=B<3&&X[0]!==ge&&X[B-1]!==ge?[]:dn(X,ge);if(B-=Ue.length,B<d)return hc(e,r,uo,R.placeholder,l,X,Ue,l,l,d-B);var Ke=this&&this!==Or&&this instanceof R?_:e;return Rr(Ke,this,X)}return R}function uc(e){return function(r,d,_){var R=$t(r);if(!en(r)){var B=Et(d,3);r=Ur(r),d=function(ae){return B(R[ae],ae,R)}}var X=e(r,d,_);return X>-1?R[B?r[X]:X]:l}}function cc(e){return ti(function(r){var d=r.length,_=d,R=Nr.prototype.thru;for(e&&r.reverse();_--;){var B=r[_];if(typeof B!="function")throw new xr(L);if(R&&!X&&po(B)=="wrapper")var X=new Nr([],!0)}for(_=X?_:d;++_<d;){B=r[_];var ae=po(B),ge=ae=="wrapper"?Gl(B):l;ge&&Vl(ge[0])&&ge[1]==(N|Y|ie|W)&&!ge[4].length&&ge[9]==1?X=X[po(ge[0])].apply(X,ge[3]):X=B.length==1&&Vl(B)?X[ae]():X.thru(B)}return function(){var Ue=arguments,Ke=Ue[0];if(X&&Ue.length==1&&Ot(Ke))return X.plant(Ke).value();for(var Ye=0,st=d?r[Ye].apply(this,Ue):Ke;++Ye<d;)st=r[Ye].call(this,st);return st}})}function uo(e,r,d,_,R,B,X,ae,ge,Ue){var Ke=r&N,Ye=r&K,st=r&V,dt=r&(Y|re),_t=r&me,Bt=st?l:da(e);function Tt(){for(var Wt=arguments.length,Yt=Re(Wt),on=Wt;on--;)Yt[on]=arguments[on];if(dt)var Yr=ms(Tt),ln=Za(Yt,Yr);if(_&&(Yt=ic(Yt,_,R,dt)),B&&(Yt=sc(Yt,B,X,dt)),Wt-=ln,dt&&Wt<Ue){var Ir=dn(Yt,Yr);return hc(e,r,uo,Tt.placeholder,d,Yt,Ir,ae,ge,Ue-Wt)}var Pn=Ye?d:this,si=st?Pn[e]:e;return Wt=Yt.length,ae?Yt=ap(Yt,ae):_t&&Wt>1&&Yt.reverse(),Ke&&ge<Wt&&(Yt.length=ge),this&&this!==Or&&this instanceof Tt&&(si=Bt||da(si)),si.apply(Pn,Yt)}return Tt}function fc(e,r){return function(d,_){return ph(d,e,r(_),{})}}function co(e,r){return function(d,_){var R;if(d===l&&_===l)return r;if(d!==l&&(R=d),_!==l){if(R===l)return _;typeof d=="string"||typeof _=="string"?(d=sn(d),_=sn(_)):(d=Xu(d),_=Xu(_)),R=e(d,_)}return R}}function xl(e){return ti(function(r){return r=ar(r,Hr(Et())),qt(function(d){var _=this;return e(r,function(R){return Rr(R,_,d)})})})}function fo(e,r){r=r===l?" ":sn(r);var d=r.length;if(d<2)return d?Il(r,e):r;var _=Il(r,D(e/Ln(r)));return yi(r)?wi(Zr(_),0,e).join(""):_.slice(0,e)}function Kh(e,r,d,_){var R=r&K,B=da(e);function X(){for(var ae=-1,ge=arguments.length,Ue=-1,Ke=_.length,Ye=Re(Ke+ge),st=this&&this!==Or&&this instanceof X?B:e;++Ue<Ke;)Ye[Ue]=_[Ue];for(;ge--;)Ye[Ue++]=arguments[++ae];return Rr(st,R?d:this,Ye)}return X}function dc(e){return function(r,d,_){return _&&typeof _!="number"&&jr(r,d,_)&&(d=_=l),r=ii(r),d===l?(d=r,r=0):d=ii(d),_=_===l?r<d?1:-1:ii(_),wh(r,d,_,e)}}function ho(e){return function(r,d){return typeof r=="string"&&typeof d=="string"||(r=vn(r),d=vn(d)),e(r,d)}}function hc(e,r,d,_,R,B,X,ae,ge,Ue){var Ke=r&Y,Ye=Ke?X:l,st=Ke?l:X,dt=Ke?B:l,_t=Ke?l:B;r|=Ke?ie:Z,r&=~(Ke?Z:ie),r&ne||(r&=~(K|V));var Bt=[e,r,R,dt,Ye,_t,st,ae,ge,Ue],Tt=d.apply(l,Bt);return Vl(e)&&Ac(Tt,Bt),Tt.placeholder=_,wc(Tt,e,r)}function Nl(e){var r=br[e];return function(d,_){if(d=vn(d),_=_==null?0:be(xt(_),292),_&&J(d)){var R=(er(d)+"e").split("e"),B=r(R[0]+"e"+(+R[1]+_));return R=(er(B)+"e").split("e"),+(R[0]+"e"+(+R[1]-_))}return r(d)}}var Hh=Vt&&1/Ei(new Vt([,-0]))[1]==Ee?function(e){return new Vt(e)}:su;function pc(e){return function(r){var d=Vr(r);return d==ue?ra(r):d==Rt?dl(r):Xs(r,e(r))}}function ei(e,r,d,_,R,B,X,ae){var ge=r&V;if(!ge&&typeof e!="function")throw new xr(L);var Ue=_?_.length:0;if(Ue||(r&=~(ie|Z),_=R=l),X=X===l?X:we(xt(X),0),ae=ae===l?ae:xt(ae),Ue-=R?R.length:0,r&Z){var Ke=_,Ye=R;_=R=l}var st=ge?l:Gl(e),dt=[e,r,d,_,R,Ke,Ye,B,X,ae];if(st&&np(dt,st),e=dt[0],r=dt[1],d=dt[2],_=dt[3],R=dt[4],ae=dt[9]=dt[9]===l?ge?0:e.length:we(dt[9]-Ue,0),!ae&&r&(Y|re)&&(r&=~(Y|re)),!r||r==K)var _t=Bh(e,r,d);else r==Y||r==re?_t=Gh(e,r,ae):(r==ie||r==(K|ie))&&!R.length?_t=Kh(e,r,d,_):_t=uo.apply(l,dt);var Bt=st?zu:Ac;return wc(Bt(_t,dt),e,r)}function gc(e,r,d,_){return e===l||On(e,Ti[d])&&!Jt.call(_,d)?r:e}function vc(e,r,d,_,R,B){return vr(e)&&vr(r)&&(B.set(r,e),so(e,r,l,vc,B),B.delete(r)),e}function qh(e){return ga(e)?l:e}function mc(e,r,d,_,R,B){var X=d&w,ae=e.length,ge=r.length;if(ae!=ge&&!(X&&ge>ae))return!1;var Ue=B.get(e),Ke=B.get(r);if(Ue&&Ke)return Ue==r&&Ke==e;var Ye=-1,st=!0,dt=d&te?new Gi:l;for(B.set(e,r),B.set(r,e);++Ye<ae;){var _t=e[Ye],Bt=r[Ye];if(_)var Tt=X?_(Bt,_t,Ye,r,e,B):_(_t,Bt,Ye,e,r,B);if(Tt!==l){if(Tt)continue;st=!1;break}if(dt){if(!Ws(r,function(Wt,Yt){if(!mi(dt,Yt)&&(_t===Wt||R(_t,Wt,d,_,B)))return dt.push(Yt)})){st=!1;break}}else if(!(_t===Bt||R(_t,Bt,d,_,B))){st=!1;break}}return B.delete(e),B.delete(r),st}function Vh(e,r,d,_,R,B,X){switch(d){case fr:if(e.byteLength!=r.byteLength||e.byteOffset!=r.byteOffset)return!1;e=e.buffer,r=r.buffer;case cr:return!(e.byteLength!=r.byteLength||!B(new v(e),new v(r)));case Be:case Te:case ot:return On(+e,+r);case We:return e.name==r.name&&e.message==r.message;case jt:case Ct:return e==r+"";case ue:var ae=ra;case Rt:var ge=_&w;if(ae||(ae=Ei),e.size!=r.size&&!ge)return!1;var Ue=X.get(e);if(Ue)return Ue==r;_|=te,X.set(e,r);var Ke=mc(ae(e),ae(r),_,R,B,X);return X.delete(e),Ke;case Ft:if(Dn)return Dn.call(e)==Dn.call(r)}return!1}function Wh(e,r,d,_,R,B){var X=d&w,ae=Ul(e),ge=ae.length,Ue=Ul(r),Ke=Ue.length;if(ge!=Ke&&!X)return!1;for(var Ye=ge;Ye--;){var st=ae[Ye];if(!(X?st in r:Jt.call(r,st)))return!1}var dt=B.get(e),_t=B.get(r);if(dt&&_t)return dt==r&&_t==e;var Bt=!0;B.set(e,r),B.set(r,e);for(var Tt=X;++Ye<ge;){st=ae[Ye];var Wt=e[st],Yt=r[st];if(_)var on=X?_(Yt,Wt,st,r,e,B):_(Wt,Yt,st,e,r,B);if(!(on===l?Wt===Yt||R(Wt,Yt,d,_,B):on)){Bt=!1;break}Tt||(Tt=st=="constructor")}if(Bt&&!Tt){var Yr=e.constructor,ln=r.constructor;Yr!=ln&&"constructor"in e&&"constructor"in r&&!(typeof Yr=="function"&&Yr instanceof Yr&&typeof ln=="function"&&ln instanceof ln)&&(Bt=!1)}return B.delete(e),B.delete(r),Bt}function ti(e){return jl(Sc(e,l,Oc),e+"")}function Ul(e){return Nu(e,Ur,Hl)}function Bl(e){return Nu(e,tn,yc)}var Gl=Mt?function(e){return Mt.get(e)}:su;function po(e){for(var r=e.name+"",d=pr[r],_=Jt.call(pr,r)?d.length:0;_--;){var R=d[_],B=R.func;if(B==null||B==e)return R.name}return r}function ms(e){var r=Jt.call(P,"placeholder")?P:e;return r.placeholder}function Et(){var e=P.iteratee||nu;return e=e===nu?Gu:e,arguments.length?e(arguments[0],arguments[1]):e}function go(e,r){var d=e.__data__;return $h(r)?d[typeof r=="string"?"string":"hash"]:d.map}function Kl(e){for(var r=Ur(e),d=r.length;d--;){var _=r[d],R=e[_];r[d]=[_,R,Tc(R)]}return r}function qi(e,r){var d=ul(e,r);return Bu(d)?d:l}function jh(e){var r=Jt.call(e,u),d=e[u];try{e[u]=l;var _=!0}catch{}var R=Ui.call(e);return _&&(r?e[u]=d:delete e[u]),R}var Hl=G?function(e){return e==null?[]:(e=$t(e),bn(G(e),function(r){return s.call(e,r)}))}:au,yc=G?function(e){for(var r=[];e;)Sn(r,Hl(e)),e=t(e);return r}:au,Vr=Wr;(Je&&Vr(new Je(new ArrayBuffer(1)))!=fr||Qe&&Vr(new Qe)!=ue||Dt&&Vr(Dt.resolve())!=ht||Vt&&Vr(new Vt)!=Rt||St&&Vr(new St)!=It)&&(Vr=function(e){var r=Wr(e),d=r==nt?e.constructor:l,_=d?Vi(d):"";if(_)switch(_){case gr:return fr;case lr:return ue;case dr:return ht;case wn:return Rt;case Qn:return It}return r});function Yh(e,r,d){for(var _=-1,R=d.length;++_<R;){var B=d[_],X=B.size;switch(B.type){case"drop":e+=X;break;case"dropRight":r-=X;break;case"take":r=be(r,e+X);break;case"takeRight":e=we(e,r-X);break}}return{start:e,end:r}}function zh(e){var r=e.match(Br);return r?r[1].split(un):[]}function Ec(e,r,d){r=Ai(r,e);for(var _=-1,R=r.length,B=!1;++_<R;){var X=Gn(r[_]);if(!(B=e!=null&&d(e,X)))break;e=e[X]}return B||++_!=R?B:(R=e==null?0:e.length,!!R&&bo(R)&&ri(X,R)&&(Ot(e)||Wi(e)))}function Qh(e){var r=e.length,d=new e.constructor(r);return r&&typeof e[0]=="string"&&Jt.call(e,"index")&&(d.index=e.index,d.input=e.input),d}function _c(e){return typeof e.constructor=="function"&&!ha(e)?gt(t(e)):{}}function Xh(e,r,d){var _=e.constructor;switch(r){case cr:return Ml(e);case Be:case Te:return new _(+e);case fr:return Ph(e,d);case kr:case wr:case yr:case pe:case $:case M:case z:case Q:case se:return rc(e,d);case ue:return new _;case ot:case Ct:return new _(e);case jt:return Fh(e);case Rt:return new _;case Ft:return Mh(e)}}function Zh(e,r){var d=r.length;if(!d)return e;var _=d-1;return r[_]=(d>1?"& ":"")+r[_],r=r.join(d>2?", ":" "),e.replace(mt,`{
/* [wrapped with `+r+`] */
`)}function Jh(e){return Ot(e)||Wi(e)||!!(c&&e&&e[c])}function ri(e,r){var d=typeof e;return r=r??Ae,!!r&&(d=="number"||d!="symbol"&&Is.test(e))&&e>-1&&e%1==0&&e<r}function jr(e,r,d){if(!vr(d))return!1;var _=typeof r;return(_=="number"?en(d)&&ri(r,d.length):_=="string"&&r in d)?On(d[r],e):!1}function ql(e,r){if(Ot(e))return!1;var d=typeof e;return d=="number"||d=="symbol"||d=="boolean"||e==null||an(e)?!0:ct.test(e)||!Ht.test(e)||r!=null&&e in $t(r)}function $h(e){var r=typeof e;return r=="string"||r=="number"||r=="symbol"||r=="boolean"?e!=="__proto__":e===null}function Vl(e){var r=po(e),d=P[r];if(typeof d!="function"||!(r in At.prototype))return!1;if(e===d)return!0;var _=Gl(d);return!!_&&e===_[0]}function ep(e){return!!hs&&hs in e}var tp=fs?ni:ou;function ha(e){var r=e&&e.constructor,d=typeof r=="function"&&r.prototype||Ti;return e===d}function Tc(e){return e===e&&!vr(e)}function bc(e,r){return function(d){return d==null?!1:d[e]===r&&(r!==l||e in $t(d))}}function rp(e){var r=_o(e,function(_){return d.size===x&&d.clear(),_}),d=r.cache;return r}function np(e,r){var d=e[1],_=r[1],R=d|_,B=R<(K|V|N),X=_==N&&d==Y||_==N&&d==W&&e[7].length<=r[8]||_==(N|W)&&r[7].length<=r[8]&&d==Y;if(!(B||X))return e;_&K&&(e[2]=r[2],R|=d&K?0:ne);var ae=r[3];if(ae){var ge=e[3];e[3]=ge?ic(ge,ae,r[4]):ae,e[4]=ge?dn(e[3],U):r[4]}return ae=r[5],ae&&(ge=e[5],e[5]=ge?sc(ge,ae,r[6]):ae,e[6]=ge?dn(e[5],U):r[6]),ae=r[7],ae&&(e[7]=ae),_&N&&(e[8]=e[8]==null?r[8]:be(e[8],r[8])),e[9]==null&&(e[9]=r[9]),e[0]=r[0],e[1]=R,e}function ip(e){var r=[];if(e!=null)for(var d in $t(e))r.push(d);return r}function sp(e){return Ui.call(e)}function Sc(e,r,d){return r=we(r===l?e.length-1:r,0),function(){for(var _=arguments,R=-1,B=we(_.length-r,0),X=Re(B);++R<B;)X[R]=_[r+R];R=-1;for(var ae=Re(r+1);++R<r;)ae[R]=_[R];return ae[r]=d(X),Rr(e,this,ae)}}function Lc(e,r){return r.length<2?e:Hi(e,pn(r,0,-1))}function ap(e,r){for(var d=e.length,_=be(r.length,d),R=$r(e);_--;){var B=r[_];e[_]=ri(B,d)?R[B]:l}return e}function Wl(e,r){if(!(r==="constructor"&&typeof e[r]=="function")&&r!="__proto__")return e[r]}var Ac=Rc(zu),pa=b||function(e,r){return Or.setTimeout(e,r)},jl=Rc(Ih);function wc(e,r,d){var _=r+"";return jl(e,Zh(_,op(zh(_),d)))}function Rc(e){var r=0,d=0;return function(){var _=Pe(),R=q-(_-d);if(d=_,R>0){if(++r>=C)return arguments[0]}else r=0;return e.apply(l,arguments)}}function vo(e,r){var d=-1,_=e.length,R=_-1;for(r=r===l?_:r;++d<r;){var B=Dl(d,R),X=e[B];e[B]=e[d],e[d]=X}return e.length=r,e}var Dc=rp(function(e){var r=[];return e.charCodeAt(0)===46&&r.push(""),e.replace(zt,function(d,_,R,B){r.push(R?B.replace(cn,"$1"):_||d)}),r});function Gn(e){if(typeof e=="string"||an(e))return e;var r=e+"";return r=="0"&&1/e==-Ee?"-0":r}function Vi(e){if(e!=null){try{return ds.call(e)}catch{}try{return e+""}catch{}}return""}function op(e,r){return Xr(He,function(d){var _="_."+d[0];r&d[1]&&!os(e,_)&&e.push(_)}),e.sort()}function Ic(e){if(e instanceof At)return e.clone();var r=new Nr(e.__wrapped__,e.__chain__);return r.__actions__=$r(e.__actions__),r.__index__=e.__index__,r.__values__=e.__values__,r}function lp(e,r,d){(d?jr(e,r,d):r===l)?r=1:r=we(xt(r),0);var _=e==null?0:e.length;if(!_||r<1)return[];for(var R=0,B=0,X=Re(D(_/r));R<_;)X[B++]=pn(e,R,R+=r);return X}function up(e){for(var r=-1,d=e==null?0:e.length,_=0,R=[];++r<d;){var B=e[r];B&&(R[_++]=B)}return R}function cp(){var e=arguments.length;if(!e)return[];for(var r=Re(e-1),d=arguments[0],_=e;_--;)r[_-1]=arguments[_];return Sn(Ot(d)?$r(d):[d],Kr(r,1))}var fp=qt(function(e,r){return Dr(e)?la(e,Kr(r,1,Dr,!0)):[]}),dp=qt(function(e,r){var d=gn(r);return Dr(d)&&(d=l),Dr(e)?la(e,Kr(r,1,Dr,!0),Et(d,2)):[]}),hp=qt(function(e,r){var d=gn(r);return Dr(d)&&(d=l),Dr(e)?la(e,Kr(r,1,Dr,!0),l,d):[]});function pp(e,r,d){var _=e==null?0:e.length;return _?(r=d||r===l?1:xt(r),pn(e,r<0?0:r,_)):[]}function gp(e,r,d){var _=e==null?0:e.length;return _?(r=d||r===l?1:xt(r),r=_-r,pn(e,0,r<0?0:r)):[]}function vp(e,r){return e&&e.length?oo(e,Et(r,3),!0,!0):[]}function mp(e,r){return e&&e.length?oo(e,Et(r,3),!0):[]}function yp(e,r,d,_){var R=e==null?0:e.length;return R?(d&&typeof d!="number"&&jr(e,r,d)&&(d=0,_=R),ch(e,r,d,_)):[]}function kc(e,r,d){var _=e==null?0:e.length;if(!_)return-1;var R=d==null?0:xt(d);return R<0&&(R=we(_+R,0)),Yn(e,Et(r,3),R)}function Cc(e,r,d){var _=e==null?0:e.length;if(!_)return-1;var R=_-1;return d!==l&&(R=xt(d),R=d<0?we(_+R,0):be(R,_-1)),Yn(e,Et(r,3),R,!0)}function Oc(e){var r=e==null?0:e.length;return r?Kr(e,1):[]}function Ep(e){var r=e==null?0:e.length;return r?Kr(e,Ee):[]}function _p(e,r){var d=e==null?0:e.length;return d?(r=r===l?1:xt(r),Kr(e,r)):[]}function Tp(e){for(var r=-1,d=e==null?0:e.length,_={};++r<d;){var R=e[r];_[R[0]]=R[1]}return _}function Pc(e){return e&&e.length?e[0]:l}function bp(e,r,d){var _=e==null?0:e.length;if(!_)return-1;var R=d==null?0:xt(d);return R<0&&(R=we(_+R,0)),vi(e,r,R)}function Sp(e){var r=e==null?0:e.length;return r?pn(e,0,-1):[]}var Lp=qt(function(e){var r=ar(e,Pl);return r.length&&r[0]===e[0]?Sl(r):[]}),Ap=qt(function(e){var r=gn(e),d=ar(e,Pl);return r===gn(d)?r=l:d.pop(),d.length&&d[0]===e[0]?Sl(d,Et(r,2)):[]}),wp=qt(function(e){var r=gn(e),d=ar(e,Pl);return r=typeof r=="function"?r:l,r&&d.pop(),d.length&&d[0]===e[0]?Sl(d,l,r):[]});function Rp(e,r){return e==null?"":le.call(e,r)}function gn(e){var r=e==null?0:e.length;return r?e[r-1]:l}function Dp(e,r,d){var _=e==null?0:e.length;if(!_)return-1;var R=_;return d!==l&&(R=xt(d),R=R<0?we(_+R,0):be(R,_-1)),r===r?na(e,r,R):Yn(e,Xa,R,!0)}function Ip(e,r){return e&&e.length?Vu(e,xt(r)):l}var kp=qt(Fc);function Fc(e,r){return e&&e.length&&r&&r.length?Rl(e,r):e}function Cp(e,r,d){return e&&e.length&&r&&r.length?Rl(e,r,Et(d,2)):e}function Op(e,r,d){return e&&e.length&&r&&r.length?Rl(e,r,l,d):e}var Pp=ti(function(e,r){var d=e==null?0:e.length,_=El(e,r);return Yu(e,ar(r,function(R){return ri(R,d)?+R:R}).sort(nc)),_});function Fp(e,r){var d=[];if(!(e&&e.length))return d;var _=-1,R=[],B=e.length;for(r=Et(r,3);++_<B;){var X=e[_];r(X,_,e)&&(d.push(X),R.push(_))}return Yu(e,R),d}function Yl(e){return e==null?e:Ge.call(e)}function Mp(e,r,d){var _=e==null?0:e.length;return _?(d&&typeof d!="number"&&jr(e,r,d)?(r=0,d=_):(r=r==null?0:xt(r),d=d===l?_:xt(d)),pn(e,r,d)):[]}function xp(e,r){return ao(e,r)}function Np(e,r,d){return kl(e,r,Et(d,2))}function Up(e,r){var d=e==null?0:e.length;if(d){var _=ao(e,r);if(_<d&&On(e[_],r))return _}return-1}function Bp(e,r){return ao(e,r,!0)}function Gp(e,r,d){return kl(e,r,Et(d,2),!0)}function Kp(e,r){var d=e==null?0:e.length;if(d){var _=ao(e,r,!0)-1;if(On(e[_],r))return _}return-1}function Hp(e){return e&&e.length?Qu(e):[]}function qp(e,r){return e&&e.length?Qu(e,Et(r,2)):[]}function Vp(e){var r=e==null?0:e.length;return r?pn(e,1,r):[]}function Wp(e,r,d){return e&&e.length?(r=d||r===l?1:xt(r),pn(e,0,r<0?0:r)):[]}function jp(e,r,d){var _=e==null?0:e.length;return _?(r=d||r===l?1:xt(r),r=_-r,pn(e,r<0?0:r,_)):[]}function Yp(e,r){return e&&e.length?oo(e,Et(r,3),!1,!0):[]}function zp(e,r){return e&&e.length?oo(e,Et(r,3)):[]}var Qp=qt(function(e){return Li(Kr(e,1,Dr,!0))}),Xp=qt(function(e){var r=gn(e);return Dr(r)&&(r=l),Li(Kr(e,1,Dr,!0),Et(r,2))}),Zp=qt(function(e){var r=gn(e);return r=typeof r=="function"?r:l,Li(Kr(e,1,Dr,!0),l,r)});function Jp(e){return e&&e.length?Li(e):[]}function $p(e,r){return e&&e.length?Li(e,Et(r,2)):[]}function eg(e,r){return r=typeof r=="function"?r:l,e&&e.length?Li(e,l,r):[]}function zl(e){if(!(e&&e.length))return[];var r=0;return e=bn(e,function(d){if(Dr(d))return r=we(d.length,r),!0}),Mi(r,function(d){return ar(e,Ys(d))})}function Mc(e,r){if(!(e&&e.length))return[];var d=zl(e);return r==null?d:ar(d,function(_){return Rr(r,l,_)})}var tg=qt(function(e,r){return Dr(e)?la(e,r):[]}),rg=qt(function(e){return Ol(bn(e,Dr))}),ng=qt(function(e){var r=gn(e);return Dr(r)&&(r=l),Ol(bn(e,Dr),Et(r,2))}),ig=qt(function(e){var r=gn(e);return r=typeof r=="function"?r:l,Ol(bn(e,Dr),l,r)}),sg=qt(zl);function ag(e,r){return $u(e||[],r||[],oa)}function og(e,r){return $u(e||[],r||[],fa)}var lg=qt(function(e){var r=e.length,d=r>1?e[r-1]:l;return d=typeof d=="function"?(e.pop(),d):l,Mc(e,d)});function xc(e){var r=P(e);return r.__chain__=!0,r}function ug(e,r){return r(e),e}function mo(e,r){return r(e)}var cg=ti(function(e){var r=e.length,d=r?e[0]:0,_=this.__wrapped__,R=function(B){return El(B,e)};return r>1||this.__actions__.length||!(_ instanceof At)||!ri(d)?this.thru(R):(_=_.slice(d,+d+(r?1:0)),_.__actions__.push({func:mo,args:[R],thisArg:l}),new Nr(_,this.__chain__).thru(function(B){return r&&!B.length&&B.push(l),B}))});function fg(){return xc(this)}function dg(){return new Nr(this.value(),this.__chain__)}function hg(){this.__values__===l&&(this.__values__=Xc(this.value()));var e=this.__index__>=this.__values__.length,r=e?l:this.__values__[this.__index__++];return{done:e,value:r}}function pg(){return this}function gg(e){for(var r,d=this;d instanceof bt;){var _=Ic(d);_.__index__=0,_.__values__=l,r?R.__wrapped__=_:r=_;var R=_;d=d.__wrapped__}return R.__wrapped__=e,r}function vg(){var e=this.__wrapped__;if(e instanceof At){var r=e;return this.__actions__.length&&(r=new At(this)),r=r.reverse(),r.__actions__.push({func:mo,args:[Yl],thisArg:l}),new Nr(r,this.__chain__)}return this.thru(Yl)}function mg(){return Ju(this.__wrapped__,this.__actions__)}var yg=lo(function(e,r,d){Jt.call(e,d)?++e[d]:$n(e,d,1)});function Eg(e,r,d){var _=Ot(e)?as:uh;return d&&jr(e,r,d)&&(r=l),_(e,Et(r,3))}function _g(e,r){var d=Ot(e)?bn:Mu;return d(e,Et(r,3))}var Tg=uc(kc),bg=uc(Cc);function Sg(e,r){return Kr(yo(e,r),1)}function Lg(e,r){return Kr(yo(e,r),Ee)}function Ag(e,r,d){return d=d===l?1:xt(d),Kr(yo(e,r),d)}function Nc(e,r){var d=Ot(e)?Xr:Si;return d(e,Et(r,3))}function Uc(e,r){var d=Ot(e)?ol:Fu;return d(e,Et(r,3))}var wg=lo(function(e,r,d){Jt.call(e,d)?e[d].push(r):$n(e,d,[r])});function Rg(e,r,d,_){e=en(e)?e:Es(e),d=d&&!_?xt(d):0;var R=e.length;return d<0&&(d=we(R+d,0)),So(e)?d<=R&&e.indexOf(r,d)>-1:!!R&&vi(e,r,d)>-1}var Dg=qt(function(e,r,d){var _=-1,R=typeof r=="function",B=en(e)?Re(e.length):[];return Si(e,function(X){B[++_]=R?Rr(r,X,d):ua(X,r,d)}),B}),Ig=lo(function(e,r,d){$n(e,d,r)});function yo(e,r){var d=Ot(e)?ar:Ku;return d(e,Et(r,3))}function kg(e,r,d,_){return e==null?[]:(Ot(r)||(r=r==null?[]:[r]),d=_?l:d,Ot(d)||(d=d==null?[]:[d]),Wu(e,r,d))}var Cg=lo(function(e,r,d){e[d?0:1].push(r)},function(){return[[],[]]});function Og(e,r,d){var _=Ot(e)?gi:us,R=arguments.length<3;return _(e,Et(r,4),d,R,Si)}function Pg(e,r,d){var _=Ot(e)?Vs:us,R=arguments.length<3;return _(e,Et(r,4),d,R,Fu)}function Fg(e,r){var d=Ot(e)?bn:Mu;return d(e,To(Et(r,3)))}function Mg(e){var r=Ot(e)?ku:Rh;return r(e)}function xg(e,r,d){(d?jr(e,r,d):r===l)?r=1:r=xt(r);var _=Ot(e)?ih:Dh;return _(e,r)}function Ng(e){var r=Ot(e)?sh:kh;return r(e)}function Ug(e){if(e==null)return 0;if(en(e))return So(e)?Ln(e):e.length;var r=Vr(e);return r==ue||r==Rt?e.size:Al(e).length}function Bg(e,r,d){var _=Ot(e)?Ws:Ch;return d&&jr(e,r,d)&&(r=l),_(e,Et(r,3))}var Gg=qt(function(e,r){if(e==null)return[];var d=r.length;return d>1&&jr(e,r[0],r[1])?r=[]:d>2&&jr(r[0],r[1],r[2])&&(r=[r[0]]),Wu(e,Kr(r,1),[])}),Eo=y||function(){return Or.Date.now()};function Kg(e,r){if(typeof r!="function")throw new xr(L);return e=xt(e),function(){if(--e<1)return r.apply(this,arguments)}}function Bc(e,r,d){return r=d?l:r,r=e&&r==null?e.length:r,ei(e,N,l,l,l,l,r)}function Gc(e,r){var d;if(typeof r!="function")throw new xr(L);return e=xt(e),function(){return--e>0&&(d=r.apply(this,arguments)),e<=1&&(r=l),d}}var Ql=qt(function(e,r,d){var _=K;if(d.length){var R=dn(d,ms(Ql));_|=ie}return ei(e,_,r,d,R)}),Kc=qt(function(e,r,d){var _=K|V;if(d.length){var R=dn(d,ms(Kc));_|=ie}return ei(r,_,e,d,R)});function Hc(e,r,d){r=d?l:r;var _=ei(e,Y,l,l,l,l,l,r);return _.placeholder=Hc.placeholder,_}function qc(e,r,d){r=d?l:r;var _=ei(e,re,l,l,l,l,l,r);return _.placeholder=qc.placeholder,_}function Vc(e,r,d){var _,R,B,X,ae,ge,Ue=0,Ke=!1,Ye=!1,st=!0;if(typeof e!="function")throw new xr(L);r=vn(r)||0,vr(d)&&(Ke=!!d.leading,Ye="maxWait"in d,B=Ye?we(vn(d.maxWait)||0,r):B,st="trailing"in d?!!d.trailing:st);function dt(Ir){var Pn=_,si=R;return _=R=l,Ue=Ir,X=e.apply(si,Pn),X}function _t(Ir){return Ue=Ir,ae=pa(Wt,r),Ke?dt(Ir):X}function Bt(Ir){var Pn=Ir-ge,si=Ir-Ue,cf=r-Pn;return Ye?be(cf,B-si):cf}function Tt(Ir){var Pn=Ir-ge,si=Ir-Ue;return ge===l||Pn>=r||Pn<0||Ye&&si>=B}function Wt(){var Ir=Eo();if(Tt(Ir))return Yt(Ir);ae=pa(Wt,Bt(Ir))}function Yt(Ir){return ae=l,st&&_?dt(Ir):(_=R=l,X)}function on(){ae!==l&&ec(ae),Ue=0,_=ge=R=ae=l}function Yr(){return ae===l?X:Yt(Eo())}function ln(){var Ir=Eo(),Pn=Tt(Ir);if(_=arguments,R=this,ge=Ir,Pn){if(ae===l)return _t(ge);if(Ye)return ec(ae),ae=pa(Wt,r),dt(ge)}return ae===l&&(ae=pa(Wt,r)),X}return ln.cancel=on,ln.flush=Yr,ln}var Hg=qt(function(e,r){return Pu(e,1,r)}),qg=qt(function(e,r,d){return Pu(e,vn(r)||0,d)});function Vg(e){return ei(e,me)}function _o(e,r){if(typeof e!="function"||r!=null&&typeof r!="function")throw new xr(L);var d=function(){var _=arguments,R=r?r.apply(this,_):_[0],B=d.cache;if(B.has(R))return B.get(R);var X=e.apply(this,_);return d.cache=B.set(R,X)||B,X};return d.cache=new(_o.Cache||Jn),d}_o.Cache=Jn;function To(e){if(typeof e!="function")throw new xr(L);return function(){var r=arguments;switch(r.length){case 0:return!e.call(this);case 1:return!e.call(this,r[0]);case 2:return!e.call(this,r[0],r[1]);case 3:return!e.call(this,r[0],r[1],r[2])}return!e.apply(this,r)}}function Wg(e){return Gc(2,e)}var jg=Oh(function(e,r){r=r.length==1&&Ot(r[0])?ar(r[0],Hr(Et())):ar(Kr(r,1),Hr(Et()));var d=r.length;return qt(function(_){for(var R=-1,B=be(_.length,d);++R<B;)_[R]=r[R].call(this,_[R]);return Rr(e,this,_)})}),Xl=qt(function(e,r){var d=dn(r,ms(Xl));return ei(e,ie,l,r,d)}),Wc=qt(function(e,r){var d=dn(r,ms(Wc));return ei(e,Z,l,r,d)}),Yg=ti(function(e,r){return ei(e,W,l,l,l,r)});function zg(e,r){if(typeof e!="function")throw new xr(L);return r=r===l?r:xt(r),qt(e,r)}function Qg(e,r){if(typeof e!="function")throw new xr(L);return r=r==null?0:we(xt(r),0),qt(function(d){var _=d[r],R=wi(d,0,r);return _&&Sn(R,_),Rr(e,this,R)})}function Xg(e,r,d){var _=!0,R=!0;if(typeof e!="function")throw new xr(L);return vr(d)&&(_="leading"in d?!!d.leading:_,R="trailing"in d?!!d.trailing:R),Vc(e,r,{leading:_,maxWait:r,trailing:R})}function Zg(e){return Bc(e,1)}function Jg(e,r){return Xl(Fl(r),e)}function $g(){if(!arguments.length)return[];var e=arguments[0];return Ot(e)?e:[e]}function ev(e){return hn(e,A)}function tv(e,r){return r=typeof r=="function"?r:l,hn(e,A,r)}function rv(e){return hn(e,O|A)}function nv(e,r){return r=typeof r=="function"?r:l,hn(e,O|A,r)}function iv(e,r){return r==null||Ou(e,r,Ur(r))}function On(e,r){return e===r||e!==e&&r!==r}var sv=ho(bl),av=ho(function(e,r){return e>=r}),Wi=Uu(function(){return arguments}())?Uu:function(e){return Sr(e)&&Jt.call(e,"callee")&&!s.call(e,"callee")},Ot=Re.isArray,ov=Ga?Hr(Ga):gh;function en(e){return e!=null&&bo(e.length)&&!ni(e)}function Dr(e){return Sr(e)&&en(e)}function lv(e){return e===!0||e===!1||Sr(e)&&Wr(e)==Be}var Ri=ee||ou,uv=Ka?Hr(Ka):vh;function cv(e){return Sr(e)&&e.nodeType===1&&!ga(e)}function fv(e){if(e==null)return!0;if(en(e)&&(Ot(e)||typeof e=="string"||typeof e.splice=="function"||Ri(e)||ys(e)||Wi(e)))return!e.length;var r=Vr(e);if(r==ue||r==Rt)return!e.size;if(ha(e))return!Al(e).length;for(var d in e)if(Jt.call(e,d))return!1;return!0}function dv(e,r){return ca(e,r)}function hv(e,r,d){d=typeof d=="function"?d:l;var _=d?d(e,r):l;return _===l?ca(e,r,l,d):!!_}function Zl(e){if(!Sr(e))return!1;var r=Wr(e);return r==We||r==ze||typeof e.message=="string"&&typeof e.name=="string"&&!ga(e)}function pv(e){return typeof e=="number"&&J(e)}function ni(e){if(!vr(e))return!1;var r=Wr(e);return r==$e||r==it||r==ve||r==Pt}function jc(e){return typeof e=="number"&&e==xt(e)}function bo(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=Ae}function vr(e){var r=typeof e;return e!=null&&(r=="object"||r=="function")}function Sr(e){return e!=null&&typeof e=="object"}var Yc=Ha?Hr(Ha):yh;function gv(e,r){return e===r||Ll(e,r,Kl(r))}function vv(e,r,d){return d=typeof d=="function"?d:l,Ll(e,r,Kl(r),d)}function mv(e){return zc(e)&&e!=+e}function yv(e){if(tp(e))throw new Lt(S);return Bu(e)}function Ev(e){return e===null}function _v(e){return e==null}function zc(e){return typeof e=="number"||Sr(e)&&Wr(e)==ot}function ga(e){if(!Sr(e)||Wr(e)!=nt)return!1;var r=t(e);if(r===null)return!0;var d=Jt.call(r,"constructor")&&r.constructor;return typeof d=="function"&&d instanceof d&&ds.call(d)==to}var Jl=qa?Hr(qa):Eh;function Tv(e){return jc(e)&&e>=-Ae&&e<=Ae}var Qc=Va?Hr(Va):_h;function So(e){return typeof e=="string"||!Ot(e)&&Sr(e)&&Wr(e)==Ct}function an(e){return typeof e=="symbol"||Sr(e)&&Wr(e)==Ft}var ys=Wa?Hr(Wa):Th;function bv(e){return e===l}function Sv(e){return Sr(e)&&Vr(e)==It}function Lv(e){return Sr(e)&&Wr(e)==Zt}var Av=ho(wl),wv=ho(function(e,r){return e<=r});function Xc(e){if(!e)return[];if(en(e))return So(e)?Zr(e):$r(e);if(i&&e[i])return fl(e[i]());var r=Vr(e),d=r==ue?ra:r==Rt?Ei:Es;return d(e)}function ii(e){if(!e)return e===0?e:0;if(e=vn(e),e===Ee||e===-Ee){var r=e<0?-1:1;return r*qe}return e===e?e:0}function xt(e){var r=ii(e),d=r%1;return r===r?d?r-d:r:0}function Zc(e){return e?Ki(xt(e),0,Xe):0}function vn(e){if(typeof e=="number")return e;if(an(e))return je;if(vr(e)){var r=typeof e.valueOf=="function"?e.valueOf():e;e=vr(r)?r+"":r}if(typeof e!="string")return e===0?e:+e;e=Zs(e);var d=Ds.test(e);return d||Da.test(e)?Ut(e.slice(2),d?2:8):or.test(e)?je:+e}function Jc(e){return Bn(e,tn(e))}function Rv(e){return e?Ki(xt(e),-Ae,Ae):e===0?e:0}function er(e){return e==null?"":sn(e)}var Dv=gs(function(e,r){if(ha(r)||en(r)){Bn(r,Ur(r),e);return}for(var d in r)Jt.call(r,d)&&oa(e,d,r[d])}),$c=gs(function(e,r){Bn(r,tn(r),e)}),Lo=gs(function(e,r,d,_){Bn(r,tn(r),e,_)}),Iv=gs(function(e,r,d,_){Bn(r,Ur(r),e,_)}),kv=ti(El);function Cv(e,r){var d=gt(e);return r==null?d:Cu(d,r)}var Ov=qt(function(e,r){e=$t(e);var d=-1,_=r.length,R=_>2?r[2]:l;for(R&&jr(r[0],r[1],R)&&(_=1);++d<_;)for(var B=r[d],X=tn(B),ae=-1,ge=X.length;++ae<ge;){var Ue=X[ae],Ke=e[Ue];(Ke===l||On(Ke,Ti[Ue])&&!Jt.call(e,Ue))&&(e[Ue]=B[Ue])}return e}),Pv=qt(function(e){return e.push(l,vc),Rr(ef,l,e)});function Fv(e,r){return ls(e,Et(r,3),Un)}function Mv(e,r){return ls(e,Et(r,3),Tl)}function xv(e,r){return e==null?e:_l(e,Et(r,3),tn)}function Nv(e,r){return e==null?e:xu(e,Et(r,3),tn)}function Uv(e,r){return e&&Un(e,Et(r,3))}function Bv(e,r){return e&&Tl(e,Et(r,3))}function Gv(e){return e==null?[]:io(e,Ur(e))}function Kv(e){return e==null?[]:io(e,tn(e))}function $l(e,r,d){var _=e==null?l:Hi(e,r);return _===l?d:_}function Hv(e,r){return e!=null&&Ec(e,r,fh)}function eu(e,r){return e!=null&&Ec(e,r,dh)}var qv=fc(function(e,r,d){r!=null&&typeof r.toString!="function"&&(r=Ui.call(r)),e[r]=d},ru(rn)),Vv=fc(function(e,r,d){r!=null&&typeof r.toString!="function"&&(r=Ui.call(r)),Jt.call(e,r)?e[r].push(d):e[r]=[d]},Et),Wv=qt(ua);function Ur(e){return en(e)?Iu(e):Al(e)}function tn(e){return en(e)?Iu(e,!0):bh(e)}function jv(e,r){var d={};return r=Et(r,3),Un(e,function(_,R,B){$n(d,r(_,R,B),_)}),d}function Yv(e,r){var d={};return r=Et(r,3),Un(e,function(_,R,B){$n(d,R,r(_,R,B))}),d}var zv=gs(function(e,r,d){so(e,r,d)}),ef=gs(function(e,r,d,_){so(e,r,d,_)}),Qv=ti(function(e,r){var d={};if(e==null)return d;var _=!1;r=ar(r,function(B){return B=Ai(B,e),_||(_=B.length>1),B}),Bn(e,Bl(e),d),_&&(d=hn(d,O|E|A,qh));for(var R=r.length;R--;)Cl(d,r[R]);return d});function Xv(e,r){return tf(e,To(Et(r)))}var Zv=ti(function(e,r){return e==null?{}:Lh(e,r)});function tf(e,r){if(e==null)return{};var d=ar(Bl(e),function(_){return[_]});return r=Et(r),ju(e,d,function(_,R){return r(_,R[0])})}function Jv(e,r,d){r=Ai(r,e);var _=-1,R=r.length;for(R||(R=1,e=l);++_<R;){var B=e==null?l:e[Gn(r[_])];B===l&&(_=R,B=d),e=ni(B)?B.call(e):B}return e}function $v(e,r,d){return e==null?e:fa(e,r,d)}function em(e,r,d,_){return _=typeof _=="function"?_:l,e==null?e:fa(e,r,d,_)}var rf=pc(Ur),nf=pc(tn);function tm(e,r,d){var _=Ot(e),R=_||Ri(e)||ys(e);if(r=Et(r,4),d==null){var B=e&&e.constructor;R?d=_?new B:[]:vr(e)?d=ni(B)?gt(t(e)):{}:d={}}return(R?Xr:Un)(e,function(X,ae,ge){return r(d,X,ae,ge)}),d}function rm(e,r){return e==null?!0:Cl(e,r)}function nm(e,r,d){return e==null?e:Zu(e,r,Fl(d))}function im(e,r,d,_){return _=typeof _=="function"?_:l,e==null?e:Zu(e,r,Fl(d),_)}function Es(e){return e==null?[]:Js(e,Ur(e))}function sm(e){return e==null?[]:Js(e,tn(e))}function am(e,r,d){return d===l&&(d=r,r=l),d!==l&&(d=vn(d),d=d===d?d:0),r!==l&&(r=vn(r),r=r===r?r:0),Ki(vn(e),r,d)}function om(e,r,d){return r=ii(r),d===l?(d=r,r=0):d=ii(d),e=vn(e),hh(e,r,d)}function lm(e,r,d){if(d&&typeof d!="boolean"&&jr(e,r,d)&&(r=d=l),d===l&&(typeof r=="boolean"?(d=r,r=l):typeof e=="boolean"&&(d=e,e=l)),e===l&&r===l?(e=0,r=1):(e=ii(e),r===l?(r=e,e=0):r=ii(r)),e>r){var _=e;e=r,r=_}if(d||e%1||r%1){var R=rt();return be(e+R*(r-e+al("1e-"+((R+"").length-1))),r)}return Dl(e,r)}var um=vs(function(e,r,d){return r=r.toLowerCase(),e+(d?sf(r):r)});function sf(e){return tu(er(e).toLowerCase())}function af(e){return e=er(e),e&&e.replace(Ia,ea).replace(Ns,"")}function cm(e,r,d){e=er(e),r=sn(r);var _=e.length;d=d===l?_:Ki(xt(d),0,_);var R=d;return d-=r.length,d>=0&&e.slice(d,R)==r}function fm(e){return e=er(e),e&&at.test(e)?e.replace(Ne,Ja):e}function dm(e){return e=er(e),e&&Qt.test(e)?e.replace(Er,"\\$&"):e}var hm=vs(function(e,r,d){return e+(d?"-":"")+r.toLowerCase()}),pm=vs(function(e,r,d){return e+(d?" ":"")+r.toLowerCase()}),gm=lc("toLowerCase");function vm(e,r,d){e=er(e),r=xt(r);var _=r?Ln(e):0;if(!r||_>=r)return e;var R=(r-_)/2;return fo(F(R),d)+e+fo(D(R),d)}function mm(e,r,d){e=er(e),r=xt(r);var _=r?Ln(e):0;return r&&_<r?e+fo(r-_,d):e}function ym(e,r,d){e=er(e),r=xt(r);var _=r?Ln(e):0;return r&&_<r?fo(r-_,d)+e:e}function Em(e,r,d){return d||r==null?r=0:r&&(r=+r),tt(er(e).replace(_r,""),r||0)}function _m(e,r,d){return(d?jr(e,r,d):r===l)?r=1:r=xt(r),Il(er(e),r)}function Tm(){var e=arguments,r=er(e[0]);return e.length<3?r:r.replace(e[1],e[2])}var bm=vs(function(e,r,d){return e+(d?"_":"")+r.toLowerCase()});function Sm(e,r,d){return d&&typeof d!="number"&&jr(e,r,d)&&(r=d=l),d=d===l?Xe:d>>>0,d?(e=er(e),e&&(typeof r=="string"||r!=null&&!Jl(r))&&(r=sn(r),!r&&yi(e))?wi(Zr(e),0,d):e.split(r,d)):[]}var Lm=vs(function(e,r,d){return e+(d?" ":"")+tu(r)});function Am(e,r,d){return e=er(e),d=d==null?0:Ki(xt(d),0,e.length),r=sn(r),e.slice(d,d+r.length)==r}function wm(e,r,d){var _=P.templateSettings;d&&jr(e,r,d)&&(r=l),e=er(e),r=Lo({},r,_,gc);var R=Lo({},r.imports,_.imports,gc),B=Ur(R),X=Js(R,B),ae,ge,Ue=0,Ke=r.interpolate||Oi,Ye="__p += '",st=Ni((r.escape||Oi).source+"|"+Ke.source+"|"+(Ke===kt?Wn:Oi).source+"|"+(r.evaluate||Oi).source+"|$","g"),dt="//# sourceURL="+(Jt.call(r,"sourceURL")?(r.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++nl+"]")+`
`;e.replace(st,function(Tt,Wt,Yt,on,Yr,ln){return Yt||(Yt=on),Ye+=e.slice(Ue,ln).replace(ks,ta),Wt&&(ae=!0,Ye+=`' +
__e(`+Wt+`) +
'`),Yr&&(ge=!0,Ye+=`';
`+Yr+`;
__p += '`),Yt&&(Ye+=`' +
((__t = (`+Yt+`)) == null ? '' : __t) +
'`),Ue=ln+Tt.length,Tt}),Ye+=`';
`;var _t=Jt.call(r,"variable")&&r.variable;if(!_t)Ye=`with (obj) {
`+Ye+`
}
`;else if(Cr.test(_t))throw new Lt(I);Ye=(ge?Ye.replace(oe,""):Ye).replace(de,"$1").replace(Ce,"$1;"),Ye="function("+(_t||"obj")+`) {
`+(_t?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(ae?", __e = _.escape":"")+(ge?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+Ye+`return __p
}`;var Bt=lf(function(){return Xt(B,dt+"return "+Ye).apply(l,X)});if(Bt.source=Ye,Zl(Bt))throw Bt;return Bt}function Rm(e){return er(e).toLowerCase()}function Dm(e){return er(e).toUpperCase()}function Im(e,r,d){if(e=er(e),e&&(d||r===l))return Zs(e);if(!e||!(r=sn(r)))return e;var _=Zr(e),R=Zr(r),B=cs(_,R),X=$s(_,R)+1;return wi(_,B,X).join("")}function km(e,r,d){if(e=er(e),e&&(d||r===l))return e.slice(0,Jr(e)+1);if(!e||!(r=sn(r)))return e;var _=Zr(e),R=$s(_,Zr(r))+1;return wi(_,0,R).join("")}function Cm(e,r,d){if(e=er(e),e&&(d||r===l))return e.replace(_r,"");if(!e||!(r=sn(r)))return e;var _=Zr(e),R=cs(_,Zr(r));return wi(_,R).join("")}function Om(e,r){var d=xe,_=j;if(vr(r)){var R="separator"in r?r.separator:R;d="length"in r?xt(r.length):d,_="omission"in r?sn(r.omission):_}e=er(e);var B=e.length;if(yi(e)){var X=Zr(e);B=X.length}if(d>=B)return e;var ae=d-Ln(_);if(ae<1)return _;var ge=X?wi(X,0,ae).join(""):e.slice(0,ae);if(R===l)return ge+_;if(X&&(ae+=ge.length-ae),Jl(R)){if(e.slice(ae).search(R)){var Ue,Ke=ge;for(R.global||(R=Ni(R.source,er(fn.exec(R))+"g")),R.lastIndex=0;Ue=R.exec(Ke);)var Ye=Ue.index;ge=ge.slice(0,Ye===l?ae:Ye)}}else if(e.indexOf(sn(R),ae)!=ae){var st=ge.lastIndexOf(R);st>-1&&(ge=ge.slice(0,st))}return ge+_}function Pm(e){return e=er(e),e&&Ze.test(e)?e.replace(Me,hl):e}var Fm=vs(function(e,r,d){return e+(d?" ":"")+r.toUpperCase()}),tu=lc("toUpperCase");function of(e,r,d){return e=er(e),r=d?l:r,r===l?cl(e)?$a(e):za(e):e.match(r)||[]}var lf=qt(function(e,r){try{return Rr(e,l,r)}catch(d){return Zl(d)?d:new Lt(d)}}),Mm=ti(function(e,r){return Xr(r,function(d){d=Gn(d),$n(e,d,Ql(e[d],e))}),e});function xm(e){var r=e==null?0:e.length,d=Et();return e=r?ar(e,function(_){if(typeof _[1]!="function")throw new xr(L);return[d(_[0]),_[1]]}):[],qt(function(_){for(var R=-1;++R<r;){var B=e[R];if(Rr(B[0],this,_))return Rr(B[1],this,_)}})}function Nm(e){return lh(hn(e,O))}function ru(e){return function(){return e}}function Um(e,r){return e==null||e!==e?r:e}var Bm=cc(),Gm=cc(!0);function rn(e){return e}function nu(e){return Gu(typeof e=="function"?e:hn(e,O))}function Km(e){return Hu(hn(e,O))}function Hm(e,r){return qu(e,hn(r,O))}var qm=qt(function(e,r){return function(d){return ua(d,e,r)}}),Vm=qt(function(e,r){return function(d){return ua(e,d,r)}});function iu(e,r,d){var _=Ur(r),R=io(r,_);d==null&&!(vr(r)&&(R.length||!_.length))&&(d=r,r=e,e=this,R=io(r,Ur(r)));var B=!(vr(d)&&"chain"in d)||!!d.chain,X=ni(e);return Xr(R,function(ae){var ge=r[ae];e[ae]=ge,X&&(e.prototype[ae]=function(){var Ue=this.__chain__;if(B||Ue){var Ke=e(this.__wrapped__),Ye=Ke.__actions__=$r(this.__actions__);return Ye.push({func:ge,args:arguments,thisArg:e}),Ke.__chain__=Ue,Ke}return ge.apply(e,Sn([this.value()],arguments))})}),e}function Wm(){return Or._===this&&(Or._=vl),this}function su(){}function jm(e){return e=xt(e),qt(function(r){return Vu(r,e)})}var Ym=xl(ar),zm=xl(as),Qm=xl(Ws);function uf(e){return ql(e)?Ys(Gn(e)):Ah(e)}function Xm(e){return function(r){return e==null?l:Hi(e,r)}}var Zm=dc(),Jm=dc(!0);function au(){return[]}function ou(){return!1}function $m(){return{}}function e0(){return""}function t0(){return!0}function r0(e,r){if(e=xt(e),e<1||e>Ae)return[];var d=Xe,_=be(e,Xe);r=Et(r),e-=Xe;for(var R=Mi(_,r);++d<e;)r(d);return R}function n0(e){return Ot(e)?ar(e,Gn):an(e)?[e]:$r(Dc(er(e)))}function i0(e){var r=++gl;return er(e)+r}var s0=co(function(e,r){return e+r},0),a0=Nl("ceil"),o0=co(function(e,r){return e/r},1),l0=Nl("floor");function u0(e){return e&&e.length?no(e,rn,bl):l}function c0(e,r){return e&&e.length?no(e,Et(r,2),bl):l}function f0(e){return js(e,rn)}function d0(e,r){return js(e,Et(r,2))}function h0(e){return e&&e.length?no(e,rn,wl):l}function p0(e,r){return e&&e.length?no(e,Et(r,2),wl):l}var g0=co(function(e,r){return e*r},1),v0=Nl("round"),m0=co(function(e,r){return e-r},0);function y0(e){return e&&e.length?Fi(e,rn):0}function E0(e,r){return e&&e.length?Fi(e,Et(r,2)):0}return P.after=Kg,P.ary=Bc,P.assign=Dv,P.assignIn=$c,P.assignInWith=Lo,P.assignWith=Iv,P.at=kv,P.before=Gc,P.bind=Ql,P.bindAll=Mm,P.bindKey=Kc,P.castArray=$g,P.chain=xc,P.chunk=lp,P.compact=up,P.concat=cp,P.cond=xm,P.conforms=Nm,P.constant=ru,P.countBy=yg,P.create=Cv,P.curry=Hc,P.curryRight=qc,P.debounce=Vc,P.defaults=Ov,P.defaultsDeep=Pv,P.defer=Hg,P.delay=qg,P.difference=fp,P.differenceBy=dp,P.differenceWith=hp,P.drop=pp,P.dropRight=gp,P.dropRightWhile=vp,P.dropWhile=mp,P.fill=yp,P.filter=_g,P.flatMap=Sg,P.flatMapDeep=Lg,P.flatMapDepth=Ag,P.flatten=Oc,P.flattenDeep=Ep,P.flattenDepth=_p,P.flip=Vg,P.flow=Bm,P.flowRight=Gm,P.fromPairs=Tp,P.functions=Gv,P.functionsIn=Kv,P.groupBy=wg,P.initial=Sp,P.intersection=Lp,P.intersectionBy=Ap,P.intersectionWith=wp,P.invert=qv,P.invertBy=Vv,P.invokeMap=Dg,P.iteratee=nu,P.keyBy=Ig,P.keys=Ur,P.keysIn=tn,P.map=yo,P.mapKeys=jv,P.mapValues=Yv,P.matches=Km,P.matchesProperty=Hm,P.memoize=_o,P.merge=zv,P.mergeWith=ef,P.method=qm,P.methodOf=Vm,P.mixin=iu,P.negate=To,P.nthArg=jm,P.omit=Qv,P.omitBy=Xv,P.once=Wg,P.orderBy=kg,P.over=Ym,P.overArgs=jg,P.overEvery=zm,P.overSome=Qm,P.partial=Xl,P.partialRight=Wc,P.partition=Cg,P.pick=Zv,P.pickBy=tf,P.property=uf,P.propertyOf=Xm,P.pull=kp,P.pullAll=Fc,P.pullAllBy=Cp,P.pullAllWith=Op,P.pullAt=Pp,P.range=Zm,P.rangeRight=Jm,P.rearg=Yg,P.reject=Fg,P.remove=Fp,P.rest=zg,P.reverse=Yl,P.sampleSize=xg,P.set=$v,P.setWith=em,P.shuffle=Ng,P.slice=Mp,P.sortBy=Gg,P.sortedUniq=Hp,P.sortedUniqBy=qp,P.split=Sm,P.spread=Qg,P.tail=Vp,P.take=Wp,P.takeRight=jp,P.takeRightWhile=Yp,P.takeWhile=zp,P.tap=ug,P.throttle=Xg,P.thru=mo,P.toArray=Xc,P.toPairs=rf,P.toPairsIn=nf,P.toPath=n0,P.toPlainObject=Jc,P.transform=tm,P.unary=Zg,P.union=Qp,P.unionBy=Xp,P.unionWith=Zp,P.uniq=Jp,P.uniqBy=$p,P.uniqWith=eg,P.unset=rm,P.unzip=zl,P.unzipWith=Mc,P.update=nm,P.updateWith=im,P.values=Es,P.valuesIn=sm,P.without=tg,P.words=of,P.wrap=Jg,P.xor=rg,P.xorBy=ng,P.xorWith=ig,P.zip=sg,P.zipObject=ag,P.zipObjectDeep=og,P.zipWith=lg,P.entries=rf,P.entriesIn=nf,P.extend=$c,P.extendWith=Lo,iu(P,P),P.add=s0,P.attempt=lf,P.camelCase=um,P.capitalize=sf,P.ceil=a0,P.clamp=am,P.clone=ev,P.cloneDeep=rv,P.cloneDeepWith=nv,P.cloneWith=tv,P.conformsTo=iv,P.deburr=af,P.defaultTo=Um,P.divide=o0,P.endsWith=cm,P.eq=On,P.escape=fm,P.escapeRegExp=dm,P.every=Eg,P.find=Tg,P.findIndex=kc,P.findKey=Fv,P.findLast=bg,P.findLastIndex=Cc,P.findLastKey=Mv,P.floor=l0,P.forEach=Nc,P.forEachRight=Uc,P.forIn=xv,P.forInRight=Nv,P.forOwn=Uv,P.forOwnRight=Bv,P.get=$l,P.gt=sv,P.gte=av,P.has=Hv,P.hasIn=eu,P.head=Pc,P.identity=rn,P.includes=Rg,P.indexOf=bp,P.inRange=om,P.invoke=Wv,P.isArguments=Wi,P.isArray=Ot,P.isArrayBuffer=ov,P.isArrayLike=en,P.isArrayLikeObject=Dr,P.isBoolean=lv,P.isBuffer=Ri,P.isDate=uv,P.isElement=cv,P.isEmpty=fv,P.isEqual=dv,P.isEqualWith=hv,P.isError=Zl,P.isFinite=pv,P.isFunction=ni,P.isInteger=jc,P.isLength=bo,P.isMap=Yc,P.isMatch=gv,P.isMatchWith=vv,P.isNaN=mv,P.isNative=yv,P.isNil=_v,P.isNull=Ev,P.isNumber=zc,P.isObject=vr,P.isObjectLike=Sr,P.isPlainObject=ga,P.isRegExp=Jl,P.isSafeInteger=Tv,P.isSet=Qc,P.isString=So,P.isSymbol=an,P.isTypedArray=ys,P.isUndefined=bv,P.isWeakMap=Sv,P.isWeakSet=Lv,P.join=Rp,P.kebabCase=hm,P.last=gn,P.lastIndexOf=Dp,P.lowerCase=pm,P.lowerFirst=gm,P.lt=Av,P.lte=wv,P.max=u0,P.maxBy=c0,P.mean=f0,P.meanBy=d0,P.min=h0,P.minBy=p0,P.stubArray=au,P.stubFalse=ou,P.stubObject=$m,P.stubString=e0,P.stubTrue=t0,P.multiply=g0,P.nth=Ip,P.noConflict=Wm,P.noop=su,P.now=Eo,P.pad=vm,P.padEnd=mm,P.padStart=ym,P.parseInt=Em,P.random=lm,P.reduce=Og,P.reduceRight=Pg,P.repeat=_m,P.replace=Tm,P.result=Jv,P.round=v0,P.runInContext=fe,P.sample=Mg,P.size=Ug,P.snakeCase=bm,P.some=Bg,P.sortedIndex=xp,P.sortedIndexBy=Np,P.sortedIndexOf=Up,P.sortedLastIndex=Bp,P.sortedLastIndexBy=Gp,P.sortedLastIndexOf=Kp,P.startCase=Lm,P.startsWith=Am,P.subtract=m0,P.sum=y0,P.sumBy=E0,P.template=wm,P.times=r0,P.toFinite=ii,P.toInteger=xt,P.toLength=Zc,P.toLower=Rm,P.toNumber=vn,P.toSafeInteger=Rv,P.toString=er,P.toUpper=Dm,P.trim=Im,P.trimEnd=km,P.trimStart=Cm,P.truncate=Om,P.unescape=Pm,P.uniqueId=i0,P.upperCase=Fm,P.upperFirst=tu,P.each=Nc,P.eachRight=Uc,P.first=Pc,iu(P,function(){var e={};return Un(P,function(r,d){Jt.call(P.prototype,d)||(e[d]=r)}),e}(),{chain:!1}),P.VERSION=m,Xr(["bind","bindKey","curry","curryRight","partial","partialRight"],function(e){P[e].placeholder=P}),Xr(["drop","take"],function(e,r){At.prototype[e]=function(d){d=d===l?1:we(xt(d),0);var _=this.__filtered__&&!r?new At(this):this.clone();return _.__filtered__?_.__takeCount__=be(d,_.__takeCount__):_.__views__.push({size:be(d,Xe),type:e+(_.__dir__<0?"Right":"")}),_},At.prototype[e+"Right"]=function(d){return this.reverse()[e](d).reverse()}}),Xr(["filter","map","takeWhile"],function(e,r){var d=r+1,_=d==H||d==he;At.prototype[e]=function(R){var B=this.clone();return B.__iteratees__.push({iteratee:Et(R,3),type:d}),B.__filtered__=B.__filtered__||_,B}}),Xr(["head","last"],function(e,r){var d="take"+(r?"Right":"");At.prototype[e]=function(){return this[d](1).value()[0]}}),Xr(["initial","tail"],function(e,r){var d="drop"+(r?"":"Right");At.prototype[e]=function(){return this.__filtered__?new At(this):this[d](1)}}),At.prototype.compact=function(){return this.filter(rn)},At.prototype.find=function(e){return this.filter(e).head()},At.prototype.findLast=function(e){return this.reverse().find(e)},At.prototype.invokeMap=qt(function(e,r){return typeof e=="function"?new At(this):this.map(function(d){return ua(d,e,r)})}),At.prototype.reject=function(e){return this.filter(To(Et(e)))},At.prototype.slice=function(e,r){e=xt(e);var d=this;return d.__filtered__&&(e>0||r<0)?new At(d):(e<0?d=d.takeRight(-e):e&&(d=d.drop(e)),r!==l&&(r=xt(r),d=r<0?d.dropRight(-r):d.take(r-e)),d)},At.prototype.takeRightWhile=function(e){return this.reverse().takeWhile(e).reverse()},At.prototype.toArray=function(){return this.take(Xe)},Un(At.prototype,function(e,r){var d=/^(?:filter|find|map|reject)|While$/.test(r),_=/^(?:head|last)$/.test(r),R=P[_?"take"+(r=="last"?"Right":""):r],B=_||/^find/.test(r);R&&(P.prototype[r]=function(){var X=this.__wrapped__,ae=_?[1]:arguments,ge=X instanceof At,Ue=ae[0],Ke=ge||Ot(X),Ye=function(Wt){var Yt=R.apply(P,Sn([Wt],ae));return _&&st?Yt[0]:Yt};Ke&&d&&typeof Ue=="function"&&Ue.length!=1&&(ge=Ke=!1);var st=this.__chain__,dt=!!this.__actions__.length,_t=B&&!st,Bt=ge&&!dt;if(!B&&Ke){X=Bt?X:new At(this);var Tt=e.apply(X,ae);return Tt.__actions__.push({func:mo,args:[Ye],thisArg:l}),new Nr(Tt,st)}return _t&&Bt?e.apply(this,ae):(Tt=this.thru(Ye),_t?_?Tt.value()[0]:Tt.value():Tt)})}),Xr(["pop","push","shift","sort","splice","unshift"],function(e){var r=_i[e],d=/^(?:push|sort|unshift)$/.test(e)?"tap":"thru",_=/^(?:pop|shift)$/.test(e);P.prototype[e]=function(){var R=arguments;if(_&&!this.__chain__){var B=this.value();return r.apply(Ot(B)?B:[],R)}return this[d](function(X){return r.apply(Ot(X)?X:[],R)})}}),Un(At.prototype,function(e,r){var d=P[r];if(d){var _=d.name+"";Jt.call(pr,_)||(pr[_]=[]),pr[_].push({name:r,func:d})}}),pr[uo(l,V).name]=[{name:"wrapper",func:l}],At.prototype.clone=In,At.prototype.reverse=bi,At.prototype.value=kn,P.prototype.at=cg,P.prototype.chain=fg,P.prototype.commit=dg,P.prototype.next=hg,P.prototype.plant=gg,P.prototype.reverse=vg,P.prototype.toJSON=P.prototype.valueOf=P.prototype.value=mg,P.prototype.first=P.prototype.head,i&&(P.prototype[i]=pg),P},zn=eo();Fn?((Fn.exports=zn)._=zn,Hs._=zn):Or._=zn}).call(Ss)})(oy,hu);function ly(f){const a=f-1;return a*a*a+1}function ba(f,{delay:a=0,duration:l=400,easing:m=ly,axis:T="y"}={}){const S=getComputedStyle(f),L=+S.opacity,I=T==="y"?"height":"width",k=parseFloat(S[I]),x=T==="y"?["top","bottom"]:["left","right"],U=x.map(V=>`${V[0].toUpperCase()}${V.slice(1)}`),O=parseFloat(S[`padding${U[0]}`]),E=parseFloat(S[`padding${U[1]}`]),A=parseFloat(S[`margin${U[0]}`]),w=parseFloat(S[`margin${U[1]}`]),te=parseFloat(S[`border${U[0]}Width`]),K=parseFloat(S[`border${U[1]}Width`]);return{delay:a,duration:l,easing:m,css:V=>`overflow: hidden;opacity: ${Math.min(V*20,1)*L};${I}: ${V*k}px;padding-${x[0]}: ${V*O}px;padding-${x[1]}: ${V*E}px;margin-${x[0]}: ${V*A}px;margin-${x[1]}: ${V*w}px;border-${x[0]}-width: ${V*te}px;border-${x[1]}-width: ${V*K}px;`}}class wa{constructor(){this.listeners=[],this.subscribe=this.subscribe.bind(this)}subscribe(a){return this.listeners.push(a),this.onSubscribe(),()=>{this.listeners=this.listeners.filter(l=>l!==a),this.onUnsubscribe()}}hasListeners(){return this.listeners.length>0}onSubscribe(){}onUnsubscribe(){}}const Sa=typeof window>"u"||"Deno"in window;function mn(){}function uy(f,a){return typeof f=="function"?f(a):f}function pu(f){return typeof f=="number"&&f>=0&&f!==1/0}function Dd(f,a){return Math.max(f+(a||0)-Date.now(),0)}function ya(f,a,l){return jo(f)?typeof a=="function"?{...l,queryKey:f,queryFn:a}:{...a,queryKey:f}:f}function Di(f,a,l){return jo(f)?[{...a,queryKey:f},l]:[f||{},a]}function Cf(f,a){const{type:l="all",exact:m,fetchStatus:T,predicate:S,queryKey:L,stale:I}=f;if(jo(L)){if(m){if(a.queryHash!==wu(L,a.options))return!1}else if(!Go(a.queryKey,L))return!1}if(l!=="all"){const k=a.isActive();if(l==="active"&&!k||l==="inactive"&&k)return!1}return!(typeof I=="boolean"&&a.isStale()!==I||typeof T<"u"&&T!==a.state.fetchStatus||S&&!S(a))}function Of(f,a){const{exact:l,fetching:m,predicate:T,mutationKey:S}=f;if(jo(S)){if(!a.options.mutationKey)return!1;if(l){if(ji(a.options.mutationKey)!==ji(S))return!1}else if(!Go(a.options.mutationKey,S))return!1}return!(typeof m=="boolean"&&a.state.status==="loading"!==m||T&&!T(a))}function wu(f,a){return((a==null?void 0:a.queryKeyHashFn)||ji)(f)}function ji(f){return JSON.stringify(f,(a,l)=>gu(l)?Object.keys(l).sort().reduce((m,T)=>(m[T]=l[T],m),{}):l)}function Go(f,a){return Id(f,a)}function Id(f,a){return f===a?!0:typeof f!=typeof a?!1:f&&a&&typeof f=="object"&&typeof a=="object"?!Object.keys(a).some(l=>!Id(f[l],a[l])):!1}function kd(f,a){if(f===a)return f;const l=Ff(f)&&Ff(a);if(l||gu(f)&&gu(a)){const m=l?f.length:Object.keys(f).length,T=l?a:Object.keys(a),S=T.length,L=l?[]:{};let I=0;for(let k=0;k<S;k++){const x=l?k:T[k];L[x]=kd(f[x],a[x]),L[x]===f[x]&&I++}return m===S&&I===m?f:L}return a}function Pf(f,a){if(f&&!a||a&&!f)return!1;for(const l in f)if(f[l]!==a[l])return!1;return!0}function Ff(f){return Array.isArray(f)&&f.length===Object.keys(f).length}function gu(f){if(!Mf(f))return!1;const a=f.constructor;if(typeof a>"u")return!0;const l=a.prototype;return!(!Mf(l)||!l.hasOwnProperty("isPrototypeOf"))}function Mf(f){return Object.prototype.toString.call(f)==="[object Object]"}function jo(f){return Array.isArray(f)}function Cd(f){return new Promise(a=>{setTimeout(a,f)})}function xf(f){Cd(0).then(f)}function cy(){if(typeof AbortController=="function")return new AbortController}function vu(f,a,l){return l.isDataEqual!=null&&l.isDataEqual(f,a)?f:typeof l.structuralSharing=="function"?l.structuralSharing(f,a):l.structuralSharing!==!1?kd(f,a):a}class fy extends wa{constructor(){super(),this.setup=a=>{if(!Sa&&window.addEventListener){const l=()=>a();return window.addEventListener("visibilitychange",l,!1),window.addEventListener("focus",l,!1),()=>{window.removeEventListener("visibilitychange",l),window.removeEventListener("focus",l)}}}}onSubscribe(){this.cleanup||this.setEventListener(this.setup)}onUnsubscribe(){if(!this.hasListeners()){var a;(a=this.cleanup)==null||a.call(this),this.cleanup=void 0}}setEventListener(a){var l;this.setup=a,(l=this.cleanup)==null||l.call(this),this.cleanup=a(m=>{typeof m=="boolean"?this.setFocused(m):this.onFocus()})}setFocused(a){this.focused=a,a&&this.onFocus()}onFocus(){this.listeners.forEach(a=>{a()})}isFocused(){return typeof this.focused=="boolean"?this.focused:typeof document>"u"?!0:[void 0,"visible","prerender"].includes(document.visibilityState)}}const Ko=new fy;class dy extends wa{constructor(){super(),this.setup=a=>{if(!Sa&&window.addEventListener){const l=()=>a();return window.addEventListener("online",l,!1),window.addEventListener("offline",l,!1),()=>{window.removeEventListener("online",l),window.removeEventListener("offline",l)}}}}onSubscribe(){this.cleanup||this.setEventListener(this.setup)}onUnsubscribe(){if(!this.hasListeners()){var a;(a=this.cleanup)==null||a.call(this),this.cleanup=void 0}}setEventListener(a){var l;this.setup=a,(l=this.cleanup)==null||l.call(this),this.cleanup=a(m=>{typeof m=="boolean"?this.setOnline(m):this.onOnline()})}setOnline(a){this.online=a,a&&this.onOnline()}onOnline(){this.listeners.forEach(a=>{a()})}isOnline(){return typeof this.online=="boolean"?this.online:typeof navigator>"u"||typeof navigator.onLine>"u"?!0:navigator.onLine}}const Ho=new dy;function hy(f){return Math.min(1e3*2**f,3e4)}function Yo(f){return(f??"online")==="online"?Ho.isOnline():!0}class Od{constructor(a){this.revert=a==null?void 0:a.revert,this.silent=a==null?void 0:a.silent}}function Po(f){return f instanceof Od}function Pd(f){let a=!1,l=0,m=!1,T,S,L;const I=new Promise((K,V)=>{S=K,L=V}),k=K=>{m||(A(new Od(K)),f.abort==null||f.abort())},x=()=>{a=!0},U=()=>{a=!1},O=()=>!Ko.isFocused()||f.networkMode!=="always"&&!Ho.isOnline(),E=K=>{m||(m=!0,f.onSuccess==null||f.onSuccess(K),T==null||T(),S(K))},A=K=>{m||(m=!0,f.onError==null||f.onError(K),T==null||T(),L(K))},w=()=>new Promise(K=>{T=V=>{const ne=m||!O();return ne&&K(V),ne},f.onPause==null||f.onPause()}).then(()=>{T=void 0,m||f.onContinue==null||f.onContinue()}),te=()=>{if(m)return;let K;try{K=f.fn()}catch(V){K=Promise.reject(V)}Promise.resolve(K).then(E).catch(V=>{var ne,Y;if(m)return;const re=(ne=f.retry)!=null?ne:3,ie=(Y=f.retryDelay)!=null?Y:hy,Z=typeof ie=="function"?ie(l,V):ie,N=re===!0||typeof re=="number"&&l<re||typeof re=="function"&&re(l,V);if(a||!N){A(V);return}l++,f.onFail==null||f.onFail(l,V),Cd(Z).then(()=>{if(O())return w()}).then(()=>{a?A(V):te()})})};return Yo(f.networkMode)?te():w().then(te),{promise:I,cancel:k,continue:()=>(T==null?void 0:T())?I:Promise.resolve(),cancelRetry:x,continueRetry:U}}const Ru=console;function py(){let f=[],a=0,l=U=>{U()},m=U=>{U()};const T=U=>{let O;a++;try{O=U()}finally{a--,a||I()}return O},S=U=>{a?f.push(U):xf(()=>{l(U)})},L=U=>(...O)=>{S(()=>{U(...O)})},I=()=>{const U=f;f=[],U.length&&xf(()=>{m(()=>{U.forEach(O=>{l(O)})})})};return{batch:T,batchCalls:L,schedule:S,setNotifyFunction:U=>{l=U},setBatchNotifyFunction:U=>{m=U}}}const Pr=py();class Fd{destroy(){this.clearGcTimeout()}scheduleGc(){this.clearGcTimeout(),pu(this.cacheTime)&&(this.gcTimeout=setTimeout(()=>{this.optionalRemove()},this.cacheTime))}updateCacheTime(a){this.cacheTime=Math.max(this.cacheTime||0,a??(Sa?1/0:5*60*1e3))}clearGcTimeout(){this.gcTimeout&&(clearTimeout(this.gcTimeout),this.gcTimeout=void 0)}}class gy extends Fd{constructor(a){super(),this.abortSignalConsumed=!1,this.defaultOptions=a.defaultOptions,this.setOptions(a.options),this.observers=[],this.cache=a.cache,this.logger=a.logger||Ru,this.queryKey=a.queryKey,this.queryHash=a.queryHash,this.initialState=a.state||vy(this.options),this.state=this.initialState,this.scheduleGc()}get meta(){return this.options.meta}setOptions(a){this.options={...this.defaultOptions,...a},this.updateCacheTime(this.options.cacheTime)}optionalRemove(){!this.observers.length&&this.state.fetchStatus==="idle"&&this.cache.remove(this)}setData(a,l){const m=vu(this.state.data,a,this.options);return this.dispatch({data:m,type:"success",dataUpdatedAt:l==null?void 0:l.updatedAt,manual:l==null?void 0:l.manual}),m}setState(a,l){this.dispatch({type:"setState",state:a,setStateOptions:l})}cancel(a){var l;const m=this.promise;return(l=this.retryer)==null||l.cancel(a),m?m.then(mn).catch(mn):Promise.resolve()}destroy(){super.destroy(),this.cancel({silent:!0})}reset(){this.destroy(),this.setState(this.initialState)}isActive(){return this.observers.some(a=>a.options.enabled!==!1)}isDisabled(){return this.getObserversCount()>0&&!this.isActive()}isStale(){return this.state.isInvalidated||!this.state.dataUpdatedAt||this.observers.some(a=>a.getCurrentResult().isStale)}isStaleByTime(a=0){return this.state.isInvalidated||!this.state.dataUpdatedAt||!Dd(this.state.dataUpdatedAt,a)}onFocus(){var a;const l=this.observers.find(m=>m.shouldFetchOnWindowFocus());l&&l.refetch({cancelRefetch:!1}),(a=this.retryer)==null||a.continue()}onOnline(){var a;const l=this.observers.find(m=>m.shouldFetchOnReconnect());l&&l.refetch({cancelRefetch:!1}),(a=this.retryer)==null||a.continue()}addObserver(a){this.observers.indexOf(a)===-1&&(this.observers.push(a),this.clearGcTimeout(),this.cache.notify({type:"observerAdded",query:this,observer:a}))}removeObserver(a){this.observers.indexOf(a)!==-1&&(this.observers=this.observers.filter(l=>l!==a),this.observers.length||(this.retryer&&(this.abortSignalConsumed?this.retryer.cancel({revert:!0}):this.retryer.cancelRetry()),this.scheduleGc()),this.cache.notify({type:"observerRemoved",query:this,observer:a}))}getObserversCount(){return this.observers.length}invalidate(){this.state.isInvalidated||this.dispatch({type:"invalidate"})}fetch(a,l){var m,T;if(this.state.fetchStatus!=="idle"){if(this.state.dataUpdatedAt&&l!=null&&l.cancelRefetch)this.cancel({silent:!0});else if(this.promise){var S;return(S=this.retryer)==null||S.continueRetry(),this.promise}}if(a&&this.setOptions(a),!this.options.queryFn){const A=this.observers.find(w=>w.options.queryFn);A&&this.setOptions(A.options)}Array.isArray(this.options.queryKey);const L=cy(),I={queryKey:this.queryKey,pageParam:void 0,meta:this.meta},k=A=>{Object.defineProperty(A,"signal",{enumerable:!0,get:()=>{if(L)return this.abortSignalConsumed=!0,L.signal}})};k(I);const x=()=>this.options.queryFn?(this.abortSignalConsumed=!1,this.options.queryFn(I)):Promise.reject("Missing queryFn"),U={fetchOptions:l,options:this.options,queryKey:this.queryKey,state:this.state,fetchFn:x};if(k(U),(m=this.options.behavior)==null||m.onFetch(U),this.revertState=this.state,this.state.fetchStatus==="idle"||this.state.fetchMeta!==((T=U.fetchOptions)==null?void 0:T.meta)){var O;this.dispatch({type:"fetch",meta:(O=U.fetchOptions)==null?void 0:O.meta})}const E=A=>{if(Po(A)&&A.silent||this.dispatch({type:"error",error:A}),!Po(A)){var w,te,K,V;(w=(te=this.cache.config).onError)==null||w.call(te,A,this),(K=(V=this.cache.config).onSettled)==null||K.call(V,this.state.data,A,this)}this.isFetchingOptimistic||this.scheduleGc(),this.isFetchingOptimistic=!1};return this.retryer=Pd({fn:U.fetchFn,abort:L==null?void 0:L.abort.bind(L),onSuccess:A=>{var w,te,K,V;if(typeof A>"u"){E(new Error("undefined"));return}this.setData(A),(w=(te=this.cache.config).onSuccess)==null||w.call(te,A,this),(K=(V=this.cache.config).onSettled)==null||K.call(V,A,this.state.error,this),this.isFetchingOptimistic||this.scheduleGc(),this.isFetchingOptimistic=!1},onError:E,onFail:(A,w)=>{this.dispatch({type:"failed",failureCount:A,error:w})},onPause:()=>{this.dispatch({type:"pause"})},onContinue:()=>{this.dispatch({type:"continue"})},retry:U.options.retry,retryDelay:U.options.retryDelay,networkMode:U.options.networkMode}),this.promise=this.retryer.promise,this.promise}dispatch(a){const l=m=>{var T,S;switch(a.type){case"failed":return{...m,fetchFailureCount:a.failureCount,fetchFailureReason:a.error};case"pause":return{...m,fetchStatus:"paused"};case"continue":return{...m,fetchStatus:"fetching"};case"fetch":return{...m,fetchFailureCount:0,fetchFailureReason:null,fetchMeta:(T=a.meta)!=null?T:null,fetchStatus:Yo(this.options.networkMode)?"fetching":"paused",...!m.dataUpdatedAt&&{error:null,status:"loading"}};case"success":return{...m,data:a.data,dataUpdateCount:m.dataUpdateCount+1,dataUpdatedAt:(S=a.dataUpdatedAt)!=null?S:Date.now(),error:null,isInvalidated:!1,status:"success",...!a.manual&&{fetchStatus:"idle",fetchFailureCount:0,fetchFailureReason:null}};case"error":const L=a.error;return Po(L)&&L.revert&&this.revertState?{...this.revertState}:{...m,error:L,errorUpdateCount:m.errorUpdateCount+1,errorUpdatedAt:Date.now(),fetchFailureCount:m.fetchFailureCount+1,fetchFailureReason:L,fetchStatus:"idle",status:"error"};case"invalidate":return{...m,isInvalidated:!0};case"setState":return{...m,...a.state}}};this.state=l(this.state),Pr.batch(()=>{this.observers.forEach(m=>{m.onQueryUpdate(a)}),this.cache.notify({query:this,type:"updated",action:a})})}}function vy(f){const a=typeof f.initialData=="function"?f.initialData():f.initialData,l=typeof a<"u",m=l?typeof f.initialDataUpdatedAt=="function"?f.initialDataUpdatedAt():f.initialDataUpdatedAt:0;return{data:a,dataUpdateCount:0,dataUpdatedAt:l?m??Date.now():0,error:null,errorUpdateCount:0,errorUpdatedAt:0,fetchFailureCount:0,fetchFailureReason:null,fetchMeta:null,isInvalidated:!1,status:l?"success":"loading",fetchStatus:"idle"}}class my extends wa{constructor(a){super(),this.config=a||{},this.queries=[],this.queriesMap={}}build(a,l,m){var T;const S=l.queryKey,L=(T=l.queryHash)!=null?T:wu(S,l);let I=this.get(L);return I||(I=new gy({cache:this,logger:a.getLogger(),queryKey:S,queryHash:L,options:a.defaultQueryOptions(l),state:m,defaultOptions:a.getQueryDefaults(S)}),this.add(I)),I}add(a){this.queriesMap[a.queryHash]||(this.queriesMap[a.queryHash]=a,this.queries.push(a),this.notify({type:"added",query:a}))}remove(a){const l=this.queriesMap[a.queryHash];l&&(a.destroy(),this.queries=this.queries.filter(m=>m!==a),l===a&&delete this.queriesMap[a.queryHash],this.notify({type:"removed",query:a}))}clear(){Pr.batch(()=>{this.queries.forEach(a=>{this.remove(a)})})}get(a){return this.queriesMap[a]}getAll(){return this.queries}find(a,l){const[m]=Di(a,l);return typeof m.exact>"u"&&(m.exact=!0),this.queries.find(T=>Cf(m,T))}findAll(a,l){const[m]=Di(a,l);return Object.keys(m).length>0?this.queries.filter(T=>Cf(m,T)):this.queries}notify(a){Pr.batch(()=>{this.listeners.forEach(l=>{l(a)})})}onFocus(){Pr.batch(()=>{this.queries.forEach(a=>{a.onFocus()})})}onOnline(){Pr.batch(()=>{this.queries.forEach(a=>{a.onOnline()})})}}class yy extends Fd{constructor(a){super(),this.defaultOptions=a.defaultOptions,this.mutationId=a.mutationId,this.mutationCache=a.mutationCache,this.logger=a.logger||Ru,this.observers=[],this.state=a.state||Ey(),this.setOptions(a.options),this.scheduleGc()}setOptions(a){this.options={...this.defaultOptions,...a},this.updateCacheTime(this.options.cacheTime)}get meta(){return this.options.meta}setState(a){this.dispatch({type:"setState",state:a})}addObserver(a){this.observers.indexOf(a)===-1&&(this.observers.push(a),this.clearGcTimeout(),this.mutationCache.notify({type:"observerAdded",mutation:this,observer:a}))}removeObserver(a){this.observers=this.observers.filter(l=>l!==a),this.scheduleGc(),this.mutationCache.notify({type:"observerRemoved",mutation:this,observer:a})}optionalRemove(){this.observers.length||(this.state.status==="loading"?this.scheduleGc():this.mutationCache.remove(this))}continue(){var a,l;return(a=(l=this.retryer)==null?void 0:l.continue())!=null?a:this.execute()}async execute(){const a=()=>{var N;return this.retryer=Pd({fn:()=>this.options.mutationFn?this.options.mutationFn(this.state.variables):Promise.reject("No mutationFn found"),onFail:(W,me)=>{this.dispatch({type:"failed",failureCount:W,error:me})},onPause:()=>{this.dispatch({type:"pause"})},onContinue:()=>{this.dispatch({type:"continue"})},retry:(N=this.options.retry)!=null?N:0,retryDelay:this.options.retryDelay,networkMode:this.options.networkMode}),this.retryer.promise},l=this.state.status==="loading";try{var m,T,S,L,I,k,x,U;if(!l){var O,E,A,w;this.dispatch({type:"loading",variables:this.options.variables}),await((O=(E=this.mutationCache.config).onMutate)==null?void 0:O.call(E,this.state.variables,this));const W=await((A=(w=this.options).onMutate)==null?void 0:A.call(w,this.state.variables));W!==this.state.context&&this.dispatch({type:"loading",context:W,variables:this.state.variables})}const N=await a();return await((m=(T=this.mutationCache.config).onSuccess)==null?void 0:m.call(T,N,this.state.variables,this.state.context,this)),await((S=(L=this.options).onSuccess)==null?void 0:S.call(L,N,this.state.variables,this.state.context)),await((I=(k=this.mutationCache.config).onSettled)==null?void 0:I.call(k,N,null,this.state.variables,this.state.context,this)),await((x=(U=this.options).onSettled)==null?void 0:x.call(U,N,null,this.state.variables,this.state.context)),this.dispatch({type:"success",data:N}),N}catch(N){try{var te,K,V,ne,Y,re,ie,Z;throw await((te=(K=this.mutationCache.config).onError)==null?void 0:te.call(K,N,this.state.variables,this.state.context,this)),await((V=(ne=this.options).onError)==null?void 0:V.call(ne,N,this.state.variables,this.state.context)),await((Y=(re=this.mutationCache.config).onSettled)==null?void 0:Y.call(re,void 0,N,this.state.variables,this.state.context,this)),await((ie=(Z=this.options).onSettled)==null?void 0:ie.call(Z,void 0,N,this.state.variables,this.state.context)),N}finally{this.dispatch({type:"error",error:N})}}}dispatch(a){const l=m=>{switch(a.type){case"failed":return{...m,failureCount:a.failureCount,failureReason:a.error};case"pause":return{...m,isPaused:!0};case"continue":return{...m,isPaused:!1};case"loading":return{...m,context:a.context,data:void 0,failureCount:0,failureReason:null,error:null,isPaused:!Yo(this.options.networkMode),status:"loading",variables:a.variables};case"success":return{...m,data:a.data,failureCount:0,failureReason:null,error:null,status:"success",isPaused:!1};case"error":return{...m,data:void 0,error:a.error,failureCount:m.failureCount+1,failureReason:a.error,isPaused:!1,status:"error"};case"setState":return{...m,...a.state}}};this.state=l(this.state),Pr.batch(()=>{this.observers.forEach(m=>{m.onMutationUpdate(a)}),this.mutationCache.notify({mutation:this,type:"updated",action:a})})}}function Ey(){return{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:"idle",variables:void 0}}class _y extends wa{constructor(a){super(),this.config=a||{},this.mutations=[],this.mutationId=0}build(a,l,m){const T=new yy({mutationCache:this,logger:a.getLogger(),mutationId:++this.mutationId,options:a.defaultMutationOptions(l),state:m,defaultOptions:l.mutationKey?a.getMutationDefaults(l.mutationKey):void 0});return this.add(T),T}add(a){this.mutations.push(a),this.notify({type:"added",mutation:a})}remove(a){this.mutations=this.mutations.filter(l=>l!==a),this.notify({type:"removed",mutation:a})}clear(){Pr.batch(()=>{this.mutations.forEach(a=>{this.remove(a)})})}getAll(){return this.mutations}find(a){return typeof a.exact>"u"&&(a.exact=!0),this.mutations.find(l=>Of(a,l))}findAll(a){return this.mutations.filter(l=>Of(a,l))}notify(a){Pr.batch(()=>{this.listeners.forEach(l=>{l(a)})})}resumePausedMutations(){var a;return this.resuming=((a=this.resuming)!=null?a:Promise.resolve()).then(()=>{const l=this.mutations.filter(m=>m.state.isPaused);return Pr.batch(()=>l.reduce((m,T)=>m.then(()=>T.continue().catch(mn)),Promise.resolve()))}).then(()=>{this.resuming=void 0}),this.resuming}}function Ty(){return{onFetch:f=>{f.fetchFn=()=>{var a,l,m,T,S,L;const I=(a=f.fetchOptions)==null||(l=a.meta)==null?void 0:l.refetchPage,k=(m=f.fetchOptions)==null||(T=m.meta)==null?void 0:T.fetchMore,x=k==null?void 0:k.pageParam,U=(k==null?void 0:k.direction)==="forward",O=(k==null?void 0:k.direction)==="backward",E=((S=f.state.data)==null?void 0:S.pages)||[],A=((L=f.state.data)==null?void 0:L.pageParams)||[];let w=A,te=!1;const K=Z=>{Object.defineProperty(Z,"signal",{enumerable:!0,get:()=>{var N;if((N=f.signal)!=null&&N.aborted)te=!0;else{var W;(W=f.signal)==null||W.addEventListener("abort",()=>{te=!0})}return f.signal}})},V=f.options.queryFn||(()=>Promise.reject("Missing queryFn")),ne=(Z,N,W,me)=>(w=me?[N,...w]:[...w,N],me?[W,...Z]:[...Z,W]),Y=(Z,N,W,me)=>{if(te)return Promise.reject("Cancelled");if(typeof W>"u"&&!N&&Z.length)return Promise.resolve(Z);const xe={queryKey:f.queryKey,pageParam:W,meta:f.options.meta};K(xe);const j=V(xe);return Promise.resolve(j).then(q=>ne(Z,W,q,me))};let re;if(!E.length)re=Y([]);else if(U){const Z=typeof x<"u",N=Z?x:Nf(f.options,E);re=Y(E,Z,N)}else if(O){const Z=typeof x<"u",N=Z?x:by(f.options,E);re=Y(E,Z,N,!0)}else{w=[];const Z=typeof f.options.getNextPageParam>"u";re=(I&&E[0]?I(E[0],0,E):!0)?Y([],Z,A[0]):Promise.resolve(ne([],A[0],E[0]));for(let W=1;W<E.length;W++)re=re.then(me=>{if(I&&E[W]?I(E[W],W,E):!0){const j=Z?A[W]:Nf(f.options,me);return Y(me,Z,j)}return Promise.resolve(ne(me,A[W],E[W]))})}return re.then(Z=>({pages:Z,pageParams:w}))}}}}function Nf(f,a){return f.getNextPageParam==null?void 0:f.getNextPageParam(a[a.length-1],a)}function by(f,a){return f.getPreviousPageParam==null?void 0:f.getPreviousPageParam(a[0],a)}class Md{constructor(a={}){this.queryCache=a.queryCache||new my,this.mutationCache=a.mutationCache||new _y,this.logger=a.logger||Ru,this.defaultOptions=a.defaultOptions||{},this.queryDefaults=[],this.mutationDefaults=[],this.mountCount=0}mount(){this.mountCount++,this.mountCount===1&&(this.unsubscribeFocus=Ko.subscribe(()=>{Ko.isFocused()&&(this.resumePausedMutations(),this.queryCache.onFocus())}),this.unsubscribeOnline=Ho.subscribe(()=>{Ho.isOnline()&&(this.resumePausedMutations(),this.queryCache.onOnline())}))}unmount(){var a,l;this.mountCount--,this.mountCount===0&&((a=this.unsubscribeFocus)==null||a.call(this),this.unsubscribeFocus=void 0,(l=this.unsubscribeOnline)==null||l.call(this),this.unsubscribeOnline=void 0)}isFetching(a,l){const[m]=Di(a,l);return m.fetchStatus="fetching",this.queryCache.findAll(m).length}isMutating(a){return this.mutationCache.findAll({...a,fetching:!0}).length}getQueryData(a,l){var m;return(m=this.queryCache.find(a,l))==null?void 0:m.state.data}ensureQueryData(a,l,m){const T=ya(a,l,m),S=this.getQueryData(T.queryKey);return S?Promise.resolve(S):this.fetchQuery(T)}getQueriesData(a){return this.getQueryCache().findAll(a).map(({queryKey:l,state:m})=>{const T=m.data;return[l,T]})}setQueryData(a,l,m){const T=this.queryCache.find(a),S=T==null?void 0:T.state.data,L=uy(l,S);if(typeof L>"u")return;const I=ya(a),k=this.defaultQueryOptions(I);return this.queryCache.build(this,k).setData(L,{...m,manual:!0})}setQueriesData(a,l,m){return Pr.batch(()=>this.getQueryCache().findAll(a).map(({queryKey:T})=>[T,this.setQueryData(T,l,m)]))}getQueryState(a,l){var m;return(m=this.queryCache.find(a,l))==null?void 0:m.state}removeQueries(a,l){const[m]=Di(a,l),T=this.queryCache;Pr.batch(()=>{T.findAll(m).forEach(S=>{T.remove(S)})})}resetQueries(a,l,m){const[T,S]=Di(a,l,m),L=this.queryCache,I={type:"active",...T};return Pr.batch(()=>(L.findAll(T).forEach(k=>{k.reset()}),this.refetchQueries(I,S)))}cancelQueries(a,l,m){const[T,S={}]=Di(a,l,m);typeof S.revert>"u"&&(S.revert=!0);const L=Pr.batch(()=>this.queryCache.findAll(T).map(I=>I.cancel(S)));return Promise.all(L).then(mn).catch(mn)}invalidateQueries(a,l,m){const[T,S]=Di(a,l,m);return Pr.batch(()=>{var L,I;if(this.queryCache.findAll(T).forEach(x=>{x.invalidate()}),T.refetchType==="none")return Promise.resolve();const k={...T,type:(L=(I=T.refetchType)!=null?I:T.type)!=null?L:"active"};return this.refetchQueries(k,S)})}refetchQueries(a,l,m){const[T,S]=Di(a,l,m),L=Pr.batch(()=>this.queryCache.findAll(T).filter(k=>!k.isDisabled()).map(k=>{var x;return k.fetch(void 0,{...S,cancelRefetch:(x=S==null?void 0:S.cancelRefetch)!=null?x:!0,meta:{refetchPage:T.refetchPage}})}));let I=Promise.all(L).then(mn);return S!=null&&S.throwOnError||(I=I.catch(mn)),I}fetchQuery(a,l,m){const T=ya(a,l,m),S=this.defaultQueryOptions(T);typeof S.retry>"u"&&(S.retry=!1);const L=this.queryCache.build(this,S);return L.isStaleByTime(S.staleTime)?L.fetch(S):Promise.resolve(L.state.data)}prefetchQuery(a,l,m){return this.fetchQuery(a,l,m).then(mn).catch(mn)}fetchInfiniteQuery(a,l,m){const T=ya(a,l,m);return T.behavior=Ty(),this.fetchQuery(T)}prefetchInfiniteQuery(a,l,m){return this.fetchInfiniteQuery(a,l,m).then(mn).catch(mn)}resumePausedMutations(){return this.mutationCache.resumePausedMutations()}getQueryCache(){return this.queryCache}getMutationCache(){return this.mutationCache}getLogger(){return this.logger}getDefaultOptions(){return this.defaultOptions}setDefaultOptions(a){this.defaultOptions=a}setQueryDefaults(a,l){const m=this.queryDefaults.find(T=>ji(a)===ji(T.queryKey));m?m.defaultOptions=l:this.queryDefaults.push({queryKey:a,defaultOptions:l})}getQueryDefaults(a){if(!a)return;const l=this.queryDefaults.find(m=>Go(a,m.queryKey));return l==null?void 0:l.defaultOptions}setMutationDefaults(a,l){const m=this.mutationDefaults.find(T=>ji(a)===ji(T.mutationKey));m?m.defaultOptions=l:this.mutationDefaults.push({mutationKey:a,defaultOptions:l})}getMutationDefaults(a){if(!a)return;const l=this.mutationDefaults.find(m=>Go(a,m.mutationKey));return l==null?void 0:l.defaultOptions}defaultQueryOptions(a){if(a!=null&&a._defaulted)return a;const l={...this.defaultOptions.queries,...this.getQueryDefaults(a==null?void 0:a.queryKey),...a,_defaulted:!0};return!l.queryHash&&l.queryKey&&(l.queryHash=wu(l.queryKey,l)),typeof l.refetchOnReconnect>"u"&&(l.refetchOnReconnect=l.networkMode!=="always"),typeof l.useErrorBoundary>"u"&&(l.useErrorBoundary=!!l.suspense),l}defaultMutationOptions(a){return a!=null&&a._defaulted?a:{...this.defaultOptions.mutations,...this.getMutationDefaults(a==null?void 0:a.mutationKey),...a,_defaulted:!0}}clear(){this.queryCache.clear(),this.mutationCache.clear()}}class Sy extends wa{constructor(a,l){super(),this.client=a,this.options=l,this.trackedProps=new Set,this.selectError=null,this.bindMethods(),this.setOptions(l)}bindMethods(){this.remove=this.remove.bind(this),this.refetch=this.refetch.bind(this)}onSubscribe(){this.listeners.length===1&&(this.currentQuery.addObserver(this),Uf(this.currentQuery,this.options)&&this.executeFetch(),this.updateTimers())}onUnsubscribe(){this.listeners.length||this.destroy()}shouldFetchOnReconnect(){return mu(this.currentQuery,this.options,this.options.refetchOnReconnect)}shouldFetchOnWindowFocus(){return mu(this.currentQuery,this.options,this.options.refetchOnWindowFocus)}destroy(){this.listeners=[],this.clearStaleTimeout(),this.clearRefetchInterval(),this.currentQuery.removeObserver(this)}setOptions(a,l){const m=this.options,T=this.currentQuery;if(this.options=this.client.defaultQueryOptions(a),Pf(m,this.options)||this.client.getQueryCache().notify({type:"observerOptionsUpdated",query:this.currentQuery,observer:this}),typeof this.options.enabled<"u"&&typeof this.options.enabled!="boolean")throw new Error("Expected enabled to be a boolean");this.options.queryKey||(this.options.queryKey=m.queryKey),this.updateQuery();const S=this.hasListeners();S&&Bf(this.currentQuery,T,this.options,m)&&this.executeFetch(),this.updateResult(l),S&&(this.currentQuery!==T||this.options.enabled!==m.enabled||this.options.staleTime!==m.staleTime)&&this.updateStaleTimeout();const L=this.computeRefetchInterval();S&&(this.currentQuery!==T||this.options.enabled!==m.enabled||L!==this.currentRefetchInterval)&&this.updateRefetchInterval(L)}getOptimisticResult(a){const l=this.client.getQueryCache().build(this.client,a);return this.createResult(l,a)}getCurrentResult(){return this.currentResult}trackResult(a){const l={};return Object.keys(a).forEach(m=>{Object.defineProperty(l,m,{configurable:!1,enumerable:!0,get:()=>(this.trackedProps.add(m),a[m])})}),l}getCurrentQuery(){return this.currentQuery}remove(){this.client.getQueryCache().remove(this.currentQuery)}refetch({refetchPage:a,...l}={}){return this.fetch({...l,meta:{refetchPage:a}})}fetchOptimistic(a){const l=this.client.defaultQueryOptions(a),m=this.client.getQueryCache().build(this.client,l);return m.isFetchingOptimistic=!0,m.fetch().then(()=>this.createResult(m,l))}fetch(a){var l;return this.executeFetch({...a,cancelRefetch:(l=a.cancelRefetch)!=null?l:!0}).then(()=>(this.updateResult(),this.currentResult))}executeFetch(a){this.updateQuery();let l=this.currentQuery.fetch(this.options,a);return a!=null&&a.throwOnError||(l=l.catch(mn)),l}updateStaleTimeout(){if(this.clearStaleTimeout(),Sa||this.currentResult.isStale||!pu(this.options.staleTime))return;const l=Dd(this.currentResult.dataUpdatedAt,this.options.staleTime)+1;this.staleTimeoutId=setTimeout(()=>{this.currentResult.isStale||this.updateResult()},l)}computeRefetchInterval(){var a;return typeof this.options.refetchInterval=="function"?this.options.refetchInterval(this.currentResult.data,this.currentQuery):(a=this.options.refetchInterval)!=null?a:!1}updateRefetchInterval(a){this.clearRefetchInterval(),this.currentRefetchInterval=a,!(Sa||this.options.enabled===!1||!pu(this.currentRefetchInterval)||this.currentRefetchInterval===0)&&(this.refetchIntervalId=setInterval(()=>{(this.options.refetchIntervalInBackground||Ko.isFocused())&&this.executeFetch()},this.currentRefetchInterval))}updateTimers(){this.updateStaleTimeout(),this.updateRefetchInterval(this.computeRefetchInterval())}clearStaleTimeout(){this.staleTimeoutId&&(clearTimeout(this.staleTimeoutId),this.staleTimeoutId=void 0)}clearRefetchInterval(){this.refetchIntervalId&&(clearInterval(this.refetchIntervalId),this.refetchIntervalId=void 0)}createResult(a,l){const m=this.currentQuery,T=this.options,S=this.currentResult,L=this.currentResultState,I=this.currentResultOptions,k=a!==m,x=k?a.state:this.currentQueryInitialState,U=k?this.currentResult:this.previousQueryResult,{state:O}=a;let{dataUpdatedAt:E,error:A,errorUpdatedAt:w,fetchStatus:te,status:K}=O,V=!1,ne=!1,Y;if(l._optimisticResults){const W=this.hasListeners(),me=!W&&Uf(a,l),xe=W&&Bf(a,m,l,T);(me||xe)&&(te=Yo(a.options.networkMode)?"fetching":"paused",E||(K="loading")),l._optimisticResults==="isRestoring"&&(te="idle")}if(l.keepPreviousData&&!O.dataUpdatedAt&&U!=null&&U.isSuccess&&K!=="error")Y=U.data,E=U.dataUpdatedAt,K=U.status,V=!0;else if(l.select&&typeof O.data<"u")if(S&&O.data===(L==null?void 0:L.data)&&l.select===this.selectFn)Y=this.selectResult;else try{this.selectFn=l.select,Y=l.select(O.data),Y=vu(S==null?void 0:S.data,Y,l),this.selectResult=Y,this.selectError=null}catch(W){this.selectError=W}else Y=O.data;if(typeof l.placeholderData<"u"&&typeof Y>"u"&&K==="loading"){let W;if(S!=null&&S.isPlaceholderData&&l.placeholderData===(I==null?void 0:I.placeholderData))W=S.data;else if(W=typeof l.placeholderData=="function"?l.placeholderData():l.placeholderData,l.select&&typeof W<"u")try{W=l.select(W),this.selectError=null}catch(me){this.selectError=me}typeof W<"u"&&(K="success",Y=vu(S==null?void 0:S.data,W,l),ne=!0)}this.selectError&&(A=this.selectError,Y=this.selectResult,w=Date.now(),K="error");const re=te==="fetching",ie=K==="loading",Z=K==="error";return{status:K,fetchStatus:te,isLoading:ie,isSuccess:K==="success",isError:Z,isInitialLoading:ie&&re,data:Y,dataUpdatedAt:E,error:A,errorUpdatedAt:w,failureCount:O.fetchFailureCount,failureReason:O.fetchFailureReason,errorUpdateCount:O.errorUpdateCount,isFetched:O.dataUpdateCount>0||O.errorUpdateCount>0,isFetchedAfterMount:O.dataUpdateCount>x.dataUpdateCount||O.errorUpdateCount>x.errorUpdateCount,isFetching:re,isRefetching:re&&!ie,isLoadingError:Z&&O.dataUpdatedAt===0,isPaused:te==="paused",isPlaceholderData:ne,isPreviousData:V,isRefetchError:Z&&O.dataUpdatedAt!==0,isStale:Du(a,l),refetch:this.refetch,remove:this.remove}}updateResult(a){const l=this.currentResult,m=this.createResult(this.currentQuery,this.options);if(this.currentResultState=this.currentQuery.state,this.currentResultOptions=this.options,Pf(m,l))return;this.currentResult=m;const T={cache:!0},S=()=>{if(!l)return!0;const{notifyOnChangeProps:L}=this.options;if(L==="all"||!L&&!this.trackedProps.size)return!0;const I=new Set(L??this.trackedProps);return this.options.useErrorBoundary&&I.add("error"),Object.keys(this.currentResult).some(k=>{const x=k;return this.currentResult[x]!==l[x]&&I.has(x)})};(a==null?void 0:a.listeners)!==!1&&S()&&(T.listeners=!0),this.notify({...T,...a})}updateQuery(){const a=this.client.getQueryCache().build(this.client,this.options);if(a===this.currentQuery)return;const l=this.currentQuery;this.currentQuery=a,this.currentQueryInitialState=a.state,this.previousQueryResult=this.currentResult,this.hasListeners()&&(l==null||l.removeObserver(this),a.addObserver(this))}onQueryUpdate(a){const l={};a.type==="success"?l.onSuccess=!a.manual:a.type==="error"&&!Po(a.error)&&(l.onError=!0),this.updateResult(l),this.hasListeners()&&this.updateTimers()}notify(a){Pr.batch(()=>{if(a.onSuccess){var l,m,T,S;(l=(m=this.options).onSuccess)==null||l.call(m,this.currentResult.data),(T=(S=this.options).onSettled)==null||T.call(S,this.currentResult.data,null)}else if(a.onError){var L,I,k,x;(L=(I=this.options).onError)==null||L.call(I,this.currentResult.error),(k=(x=this.options).onSettled)==null||k.call(x,void 0,this.currentResult.error)}a.listeners&&this.listeners.forEach(U=>{U(this.currentResult)}),a.cache&&this.client.getQueryCache().notify({query:this.currentQuery,type:"observerResultsUpdated"})})}}function Ly(f,a){return a.enabled!==!1&&!f.state.dataUpdatedAt&&!(f.state.status==="error"&&a.retryOnMount===!1)}function Uf(f,a){return Ly(f,a)||f.state.dataUpdatedAt>0&&mu(f,a,a.refetchOnMount)}function mu(f,a,l){if(a.enabled!==!1){const m=typeof l=="function"?l(f):l;return m==="always"||m!==!1&&Du(f,a)}return!1}function Bf(f,a,l,m){return l.enabled!==!1&&(f!==a||m.enabled===!1)&&(!l.suspense||f.state.status!=="error")&&Du(f,l)}function Du(f,a){return f.isStaleByTime(a.staleTime)}const xd="$$_queryClient",Ay=()=>{const f=ws(xd);if(!f)throw new Error("No QueryClient was found in Svelte context. Did you forget to wrap your component with QueryClientProvider?");return f},wy=f=>{Co(xd,f)};function Ry(){return Ay()}const Ts=[];function yu(f,a){return{subscribe:Fo(f,a).subscribe}}function Fo(f,a=mr){let l;const m=new Set;function T(I){if(Ii(f,I)&&(f=I,l)){const k=!Ts.length;for(const x of m)x[1](),Ts.push(x,f);if(k){for(let x=0;x<Ts.length;x+=2)Ts[x][0](Ts[x+1]);Ts.length=0}}}function S(I){T(I(f))}function L(I,k=mr){const x=[I,k];return m.add(x),m.size===1&&(l=a(T)||mr),I(f),()=>{m.delete(x),m.size===0&&l&&(l(),l=null)}}return{set:T,update:S,subscribe:L}}function Dy(f,a,l){const m=!Array.isArray(f),T=m?[f]:f,S=a.length<2;return yu(l,L=>{let I=!1;const k=[];let x=0,U=mr;const O=()=>{if(x)return;U();const A=a(m?k[0]:k,L);S?L(A):U=Rs(A)?A:mr},E=T.map((A,w)=>pd(A,te=>{k[w]=te,x&=~(1<<w),I&&O()},()=>{x|=1<<w}));return I=!0,O(),function(){yn(E),U(),I=!1}})}function Iy(f,a){const l=Ry(),m=l.defaultQueryOptions(f);m._optimisticResults="optimistic";let T=new a(l,m);m.onError&&(m.onError=Pr.batchCalls(m.onError)),m.onSuccess&&(m.onSuccess=Pr.batchCalls(m.onSuccess)),m.onSettled&&(m.onSettled=Pr.batchCalls(m.onSettled)),yu(T).subscribe(I=>{T=I,T.setOptions(m,{listeners:!1})});const S=yu(T.getCurrentResult(),I=>T.subscribe(Pr.batchCalls(I))),{subscribe:L}=Dy(S,I=>(I=T.getOptimisticResult(m),m.notifyOnChangeProps?I:T.trackResult(I)));return{subscribe:L}}function Gf(f,a,l){const m=ya(f,a,l);return Iy(m,Sy)}function ky(f){let a;const l=f[2].default,m=_u(l,f,f[1],null);return{c(){m&&m.c()},m(T,S){m&&m.m(T,S),a=!0},p(T,[S]){m&&m.p&&(!a||S&2)&&bu(m,l,T,T[1],a?Tu(l,T[1],S,null):Su(T[1]),null)},i(T){a||(Gt(m,T),a=!0)},o(T){tr(m,T),a=!1},d(T){m&&m.d(T)}}}function Cy(f,a,l){let{$$slots:m={},$$scope:T}=a,{client:S=new Md}=a;return Aa(()=>{S.mount()}),wy(S),bd(()=>{S.unmount()}),f.$$set=L=>{"client"in L&&l(0,S=L.client),"$$scope"in L&&l(1,T=L.$$scope)},[S,T,m]}class Oy extends Xi{constructor(a){super(),Qi(this,a,Cy,ky,Ii,{client:0})}}function Kf(f,a,l){const m=f.slice();return m[32]=a[l],m[17]=l,m}function Hf(f,a,l){const m=f.slice();return m[34]=a[l],m[36]=l,m}function qf(f,a,l){const m=f.slice();return m[37]=a[l],m[39]=l,m}function Vf(f,a,l){const m=f.slice();return m[40]=a[l],m[36]=l,m}function Wf(f,a,l){const m=f.slice();return m[40]=a[l],m[36]=l,m}function jf(f){let a,l,m,T,S;const L=[Fy,Py],I=[];function k(x,U){return x[10]&&!x[5]?0:1}return l=k(f),m=I[l]=L[l](f),{c(){a=Oe("div"),m.c(),_e(a,"class","vimonial_shoppable_card_body svelte-rymqg")},m(x,U){vt(x,a,U),I[l].m(a,null),S=!0},p(x,U){let O=l;l=k(x),l===O?I[l].p(x,U):(Hn(),tr(I[O],1,1,()=>{I[O]=null}),qn(),m=I[l],m?m.p(x,U):(m=I[l]=L[l](x),m.c()),Gt(m,1),m.m(a,null))},i(x){S||(Gt(m),T||ui(()=>{T=C0(a,ba,{duration:300}),T.start()}),S=!0)},o(x){tr(m),S=!1},d(x){x&&pt(a),I[l].d()}}}function Py(f){var Xe,Ve;let a,l,m,T,S,L,I,k,x=f[2].data.title+"",U,O,E,A,w,te,K,V,ne,Y,re=f[0].buyNowText+"",ie,Z,N,W,me,xe,j,C=f[3]&&Yf(f),q=(Xe=f[2].data.images)==null?void 0:Xe.filter(nd),H=[];for(let Ie=0;Ie<q.length;Ie+=1)H[Ie]=Qf(Vf(f,q,Ie));function ye(Ie,He){if(He[0]&8&&(w=null),w==null&&(w=!!(Ie[3]&&Ie[3].compare_at_price&&parseFloat(Ie[3].price)<parseFloat(Ie[3].compare_at_price))),w)return xy;if(Ie[3])return My}let he=ye(f,[-1,-1]),Ee=he&&he(f),Ae=((Ve=f[2].data.variants)==null?void 0:Ve.length)>1&&Xf(f),qe=f[2].data.body_html&&$f(f),je=f[1].status==="success"&&td(f);return{c(){a=Oe("div"),l=Oe("div"),l.innerHTML='<svg width="20" height="20" fill="none" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewBox="0 0 24 24" stroke="currentColor" class="svelte-rymqg"><path d="M9 5l7 7-7 7"></path></svg>',m=yt(),T=Oe("div"),C&&C.c(),S=yt();for(let Ie=0;Ie<H.length;Ie+=1)H[Ie].c();L=yt(),I=Oe("div"),k=Oe("h1"),U=ur(x),O=yt(),E=Oe("div"),A=Oe("div"),Ee&&Ee.c(),te=yt(),Ae&&Ae.c(),K=yt(),V=Oe("div"),ne=Oe("div"),Y=Oe("button"),ie=ur(re),Z=yt(),qe&&qe.c(),N=yt(),je&&je.c(),_e(l,"class","mobile_close_icon svelte-rymqg"),_e(T,"class","vimonial_product_images_slider svelte-rymqg"),_e(k,"class","svelte-rymqg"),_e(I,"class","vimonial_product_title svelte-rymqg"),_e(A,"class","price price--large  svelte-rymqg"),_e(E,"id","price"),_e(E,"role","status"),_e(Y,"name","add"),_e(Y,"class","vimonial_atc_button svelte-rymqg"),_e(ne,"class","product-form__buttons")},m(Ie,He){vt(Ie,a,He),Le(a,l),Le(a,m),Le(a,T),C&&C.m(T,null),Le(T,S);for(let ce=0;ce<H.length;ce+=1)H[ce]&&H[ce].m(T,null);Le(a,L),Le(a,I),Le(I,k),Le(k,U),Le(a,O),Le(a,E),Le(E,A),Ee&&Ee.m(A,null),Le(a,te),Ae&&Ae.m(a,null),Le(a,K),Le(a,V),Le(V,ne),Le(ne,Y),Le(Y,ie),Le(a,Z),qe&&qe.m(a,null),Le(a,N),je&&je.m(a,null),me=!0,xe||(j=[nr(l,"click",f[23]),nr(Y,"click",f[25])],xe=!0)},p(Ie,He){var ce,De;if(f=Ie,f[3]?C?C.p(f,He):(C=Yf(f),C.c(),C.m(T,S)):C&&(C.d(1),C=null),He[0]&4){q=(ce=f[2].data.images)==null?void 0:ce.filter(nd);let ve;for(ve=0;ve<q.length;ve+=1){const Be=Vf(f,q,ve);H[ve]?H[ve].p(Be,He):(H[ve]=Qf(Be),H[ve].c(),H[ve].m(T,null))}for(;ve<H.length;ve+=1)H[ve].d(1);H.length=q.length}(!me||He[0]&4)&&x!==(x=f[2].data.title+"")&&Ar(U,x),he===(he=ye(f,He))&&Ee?Ee.p(f,He):(Ee&&Ee.d(1),Ee=he&&he(f),Ee&&(Ee.c(),Ee.m(A,null))),((De=f[2].data.variants)==null?void 0:De.length)>1?Ae?Ae.p(f,He):(Ae=Xf(f),Ae.c(),Ae.m(a,K)):Ae&&(Ae.d(1),Ae=null),(!me||He[0]&1)&&re!==(re=f[0].buyNowText+"")&&Ar(ie,re),f[2].data.body_html?qe?(qe.p(f,He),He[0]&4&&Gt(qe,1)):(qe=$f(f),qe.c(),Gt(qe,1),qe.m(a,N)):qe&&(Hn(),tr(qe,1,1,()=>{qe=null}),qn()),f[1].status==="success"?je?je.p(f,He):(je=td(f),je.c(),je.m(a,null)):je&&(je.d(1),je=null)},i(Ie){me||(Gt(qe),ui(()=>{me&&(W||(W=Uo(a,ba,{duration:f[10]?300:0},!0)),W.run(1))}),me=!0)},o(Ie){tr(qe),W||(W=Uo(a,ba,{duration:f[10]?300:0},!1)),W.run(0),me=!1},d(Ie){Ie&&pt(a),C&&C.d(),Yi(H,Ie),Ee&&Ee.d(),Ae&&Ae.d(),qe&&qe.d(),je&&je.d(),Ie&&W&&W.end(),xe=!1,yn(j)}}}function Fy(f){let a,l,m,T,S,L,I,k,x=f[2].data.title+"",U,O,E,A,w,te,K,V=f[0].buyNowText+"",ne,Y,re;function ie(W,me){if(me[0]&8&&(w=null),w==null&&(w=!!(W[3]&&W[3].compare_at_price&&parseFloat(W[3].price)<parseFloat(W[3].compare_at_price))),w)return Gy;if(W[3])return By}let Z=ie(f,[-1,-1]),N=Z&&Z(f);return{c(){var W;a=Oe("div"),l=Oe("div"),m=Oe("img"),S=yt(),L=Oe("div"),I=Oe("div"),k=Oe("h1"),U=ur(x),O=yt(),E=Oe("div"),A=Oe("div"),N&&N.c(),te=yt(),K=Oe("button"),ne=ur(V),_e(m,"class","vimonial_slider_image svelte-rymqg"),_e(m,"alt","product_image"),Vn(m.src,T=((W=f[2].data.image)==null?void 0:W.src)+"&width=200")||_e(m,"src",T),_e(l,"class","vimonial_shoppable_card_image svelte-rymqg"),_e(k,"class","svelte-rymqg"),_e(I,"class","vimonial_product_title svelte-rymqg"),_e(A,"class","price price--large svelte-rymqg"),_e(E,"id","price"),_e(E,"role","status"),_e(K,"name","add"),_e(K,"class","vimonial_atc_button svelte-rymqg"),_e(L,"class","vimonial_shoppable_card_body_mobile_details svelte-rymqg"),_e(a,"class","vimonial_shoppable_card_body_mobile svelte-rymqg")},m(W,me){vt(W,a,me),Le(a,l),Le(l,m),Le(a,S),Le(a,L),Le(L,I),Le(I,k),Le(k,U),Le(L,O),Le(L,E),Le(E,A),N&&N.m(A,null),Le(L,te),Le(L,K),Le(K,ne),Y||(re=nr(L,"click",f[22]),Y=!0)},p(W,me){var xe;me[0]&4&&!Vn(m.src,T=((xe=W[2].data.image)==null?void 0:xe.src)+"&width=200")&&_e(m,"src",T),me[0]&4&&x!==(x=W[2].data.title+"")&&Ar(U,x),Z===(Z=ie(W,me))&&N?N.p(W,me):(N&&N.d(1),N=Z&&Z(W),N&&(N.c(),N.m(A,null))),me[0]&1&&V!==(V=W[0].buyNowText+"")&&Ar(ne,V)},i:mr,o:mr,d(W){W&&pt(a),N&&N.d(),Y=!1,re()}}}function Yf(f){let a,l=f[3].images,m=[];for(let T=0;T<l.length;T+=1)m[T]=zf(Wf(f,l,T));return{c(){for(let T=0;T<m.length;T+=1)m[T].c();a=Wo()},m(T,S){for(let L=0;L<m.length;L+=1)m[L]&&m[L].m(T,S);vt(T,a,S)},p(T,S){if(S[0]&8){l=T[3].images;let L;for(L=0;L<l.length;L+=1){const I=Wf(T,l,L);m[L]?m[L].p(I,S):(m[L]=zf(I),m[L].c(),m[L].m(a.parentNode,a))}for(;L<m.length;L+=1)m[L].d(1);m.length=l.length}},d(T){Yi(m,T),T&&pt(a)}}}function zf(f){let a,l,m;return{c(){a=Oe("img"),Vn(a.src,l=f[40].src+"?width=300")||_e(a,"src",l),_e(a,"alt",m=f[40].alt),_e(a,"class","vimonial_product_image_slide svelte-rymqg")},m(T,S){vt(T,a,S)},p(T,S){S[0]&8&&!Vn(a.src,l=T[40].src+"?width=300")&&_e(a,"src",l),S[0]&8&&m!==(m=T[40].alt)&&_e(a,"alt",m)},d(T){T&&pt(a)}}}function Qf(f){let a,l,m;return{c(){a=Oe("img"),Vn(a.src,l=f[40].src+"?width=300")||_e(a,"src",l),_e(a,"alt",m=f[40].alt),_e(a,"class","vimonial_product_image_slide svelte-rymqg")},m(T,S){vt(T,a,S)},p(T,S){S[0]&4&&!Vn(a.src,l=T[40].src+"?width=300")&&_e(a,"src",l),S[0]&4&&m!==(m=T[40].alt)&&_e(a,"alt",m)},d(T){T&&pt(a)}}}function My(f){let a,l,m=Lr(f[3].price,f[7])+"",T;return{c(){a=Oe("div"),l=Oe("span"),T=ur(m),_e(l,"class","price-item price-item--regular"),_e(a,"class","price__regular svelte-rymqg")},m(S,L){vt(S,a,L),Le(a,l),Le(l,T)},p(S,L){L[0]&8&&m!==(m=Lr(S[3].price,S[7])+"")&&Ar(T,m)},d(S){S&&pt(a)}}}function xy(f){let a,l,m,T,S=Lr(f[3].compare_at_price,f[7])+"",L,I,k,x,U,O=Lr(f[3].price,f[7])+"",E;return{c(){a=Oe("div"),l=Oe("dt"),l.innerHTML='<span class="visually-hidden visually-hidden--inline svelte-rymqg">Regular price</span>',m=yt(),T=Oe("s"),L=ur(S),I=yt(),k=Oe("dt"),k.innerHTML='<span class="visually-hidden visually-hidden--inline svelte-rymqg">Sale price</span>',x=yt(),U=Oe("span"),E=ur(O),_e(l,"class","price__compare"),_e(T,"class","price-item price-item--regular svelte-rymqg"),_e(U,"class","price-item price-item--sale"),_e(a,"class","price__sale price--on-sale svelte-rymqg")},m(A,w){vt(A,a,w),Le(a,l),Le(a,m),Le(a,T),Le(T,L),Le(a,I),Le(a,k),Le(a,x),Le(a,U),Le(U,E)},p(A,w){w[0]&8&&S!==(S=Lr(A[3].compare_at_price,A[7])+"")&&Ar(L,S),w[0]&8&&O!==(O=Lr(A[3].price,A[7])+"")&&Ar(E,O)},d(A){A&&pt(a)}}}function Xf(f){let a,l=f[2].data.options,m=[];for(let T=0;T<l.length;T+=1)m[T]=Jf(Hf(f,l,T));return{c(){for(let T=0;T<m.length;T+=1)m[T].c();a=Wo()},m(T,S){for(let L=0;L<m.length;L+=1)m[L]&&m[L].m(T,S);vt(T,a,S)},p(T,S){if(S[0]&32788){l=T[2].data.options;let L;for(L=0;L<l.length;L+=1){const I=Hf(T,l,L);m[L]?m[L].p(I,S):(m[L]=Jf(I),m[L].c(),m[L].m(a.parentNode,a))}for(;L<m.length;L+=1)m[L].d(1);m.length=l.length}},d(T){Yi(m,T),T&&pt(a)}}}function Zf(f){let a,l,m,T,S,L,I,k=f[37]+"",x,U,O,E;function A(){return f[24](f[34],f[37])}return{c(){a=Oe("input"),S=yt(),L=Oe("label"),I=Oe("span"),x=ur(k),U=yt(),_e(a,"id",f[36]+"-"+f[39]),_e(a,"type","radio"),_e(a,"name",l=f[34].name),_e(a,"class","hide svelte-rymqg"),a.value=m=f[37],a.checked=T=f[4][f[34].name]==f[37]?"checked":"",_e(I,"class",""),_e(L,"for",f[36]+"-"+f[39]),_e(L,"class","vimonial_variant_option svelte-rymqg")},m(w,te){vt(w,a,te),vt(w,S,te),vt(w,L,te),Le(L,I),Le(I,x),Le(L,U),O||(E=nr(a,"click",A),O=!0)},p(w,te){f=w,te[0]&4&&l!==(l=f[34].name)&&_e(a,"name",l),te[0]&4&&m!==(m=f[37])&&(a.value=m),te[0]&20&&T!==(T=f[4][f[34].name]==f[37]?"checked":"")&&(a.checked=T),te[0]&4&&k!==(k=f[37]+"")&&Ar(x,k)},d(w){w&&pt(a),w&&pt(S),w&&pt(L),O=!1,E()}}}function Jf(f){let a,l,m=f[34].name+"",T,S,L,I,k=f[34].values,x=[];for(let U=0;U<k.length;U+=1)x[U]=Zf(qf(f,k,U));return{c(){a=Oe("fieldset"),l=Oe("legend"),T=ur(m),S=yt(),L=Oe("div");for(let U=0;U<x.length;U+=1)x[U].c();I=yt(),_e(l,"class","svelte-rymqg"),_e(L,"class","vimonial_fieldset_grid svelte-rymqg"),_e(a,"class","vimonial_fieldset svelte-rymqg")},m(U,O){vt(U,a,O),Le(a,l),Le(l,T),Le(a,S),Le(a,L);for(let E=0;E<x.length;E+=1)x[E]&&x[E].m(L,null);Le(a,I)},p(U,O){if(O[0]&4&&m!==(m=U[34].name+"")&&Ar(T,m),O[0]&32788){k=U[34].values;let E;for(E=0;E<k.length;E+=1){const A=qf(U,k,E);x[E]?x[E].p(A,O):(x[E]=Zf(A),x[E].c(),x[E].m(L,null))}for(;E<x.length;E+=1)x[E].d(1);x.length=k.length}},d(U){U&&pt(a),Yi(x,U)}}}function $f(f){let a,l,m,T,S,L,I,k,x,U,O=f[6]&&ed(f);return{c(){a=Oe("div"),l=Oe("div"),m=Oe("span"),m.textContent="Description",T=yt(),S=hf("svg"),L=hf("path"),I=yt(),O&&O.c(),_e(L,"d","M9 5l7 7-7 7"),_e(S,"width","20"),_e(S,"height","20"),_e(S,"fill","none"),_e(S,"stroke-linecap","round"),_e(S,"stroke-linejoin","round"),_e(S,"stroke-width","2"),_e(S,"viewBox","0 0 24 24"),_e(S,"stroke","currentColor"),_e(S,"class","svelte-rymqg"),_e(l,"class","vimonial_description_row svelte-rymqg"),_e(l,"aria-expanded",f[6]),_e(a,"class","vimonial_description svelte-rymqg")},m(E,A){vt(E,a,A),Le(a,l),Le(l,m),Le(l,T),Le(l,S),Le(S,L),Le(a,I),O&&O.m(a,null),k=!0,x||(U=nr(l,"click",f[11]),x=!0)},p(E,A){(!k||A[0]&64)&&_e(l,"aria-expanded",E[6]),E[6]?O?(O.p(E,A),A[0]&64&&Gt(O,1)):(O=ed(E),O.c(),Gt(O,1),O.m(a,null)):O&&(Hn(),tr(O,1,1,()=>{O=null}),qn())},i(E){k||(Gt(O),k=!0)},o(E){tr(O),k=!1},d(E){E&&pt(a),O&&O.d(),x=!1,U()}}}function ed(f){let a,l=f[2].data.body_html+"",m,T;return{c(){a=Oe("div"),_e(a,"class","vimonial_description_body")},m(S,L){vt(S,a,L),a.innerHTML=l,T=!0},p(S,L){(!T||L[0]&4)&&l!==(l=S[2].data.body_html+"")&&(a.innerHTML=l)},i(S){T||(ui(()=>{T&&(m||(m=Uo(a,ba,{duration:300},!0)),m.run(1))}),T=!0)},o(S){m||(m=Uo(a,ba,{duration:300},!1)),m.run(0),T=!1},d(S){S&&pt(a),S&&m&&m.end()}}}function td(f){let a,l,m,T=f[1].data,S=[];for(let L=0;L<T.length;L+=1)S[L]=rd(Kf(f,T,L));return{c(){a=Oe("p"),a.textContent="You may also like",l=yt(),m=Oe("div");for(let L=0;L<S.length;L+=1)S[L].c();_e(m,"class","vimonial_recommended_products svelte-rymqg")},m(L,I){vt(L,a,I),vt(L,l,I),vt(L,m,I);for(let k=0;k<S.length;k+=1)S[k]&&S[k].m(m,null)},p(L,I){if(I[0]&4226){T=L[1].data;let k;for(k=0;k<T.length;k+=1){const x=Kf(L,T,k);S[k]?S[k].p(x,I):(S[k]=rd(x),S[k].c(),S[k].m(m,null))}for(;k<S.length;k+=1)S[k].d(1);S.length=T.length}},d(L){L&&pt(a),L&&pt(l),L&&pt(m),Yi(S,L)}}}function Ny(f){let a,l,m=Lr(f[32].price/100,f[7])+"",T;return{c(){a=Oe("div"),l=Oe("span"),T=ur(m),_e(l,"class","price-item price-item--regular"),_e(a,"class","price__regular svelte-rymqg")},m(S,L){vt(S,a,L),Le(a,l),Le(l,T)},p(S,L){L[0]&2&&m!==(m=Lr(S[32].price/100,S[7])+"")&&Ar(T,m)},d(S){S&&pt(a)}}}function Uy(f){let a,l,m,T,S=Lr(f[32].compare_at_price/100,f[7])+"",L,I,k,x,U,O=Lr(f[32].price/100,f[7])+"",E;return{c(){a=Oe("div"),l=Oe("dt"),l.innerHTML='<span class="visually-hidden visually-hidden--inline svelte-rymqg">Regular price</span>',m=yt(),T=Oe("s"),L=ur(S),I=yt(),k=Oe("dt"),k.innerHTML='<span class="visually-hidden visually-hidden--inline svelte-rymqg">Sale price</span>',x=yt(),U=Oe("span"),E=ur(O),_e(l,"class","price__compare"),_e(T,"class","price-item price-item--regular svelte-rymqg"),_e(U,"class","price-item price-item--sale"),_e(a,"class","price__sale price--on-sale svelte-rymqg")},m(A,w){vt(A,a,w),Le(a,l),Le(a,m),Le(a,T),Le(T,L),Le(a,I),Le(a,k),Le(a,x),Le(a,U),Le(U,E)},p(A,w){w[0]&2&&S!==(S=Lr(A[32].compare_at_price/100,A[7])+"")&&Ar(L,S),w[0]&2&&O!==(O=Lr(A[32].price/100,A[7])+"")&&Ar(E,O)},d(A){A&&pt(a)}}}function rd(f){let a,l,m,T,S,L,I=f[32].title+"",k,x,U,O,E,A;function w(V,ne){return ne[0]&2&&(O=null),O==null&&(O=!!(V[32].compare_at_price&&parseFloat(V[32].price)<parseFloat(V[32].compare_at_price))),O?Uy:Ny}let te=w(f,[-1,-1]),K=te(f);return{c(){a=Oe("a"),l=Oe("div"),m=Oe("img"),S=yt(),L=Oe("div"),k=ur(I),x=yt(),U=Oe("div"),K.c(),E=yt(),Vn(m.src,T=f[32].featured_image+"&width=200")||_e(m,"src",T),_e(m,"alt","featured image"),_e(m,"class","svelte-rymqg"),_e(l,"class","vimonial_related_product_image svelte-rymqg"),_e(L,"class","vimonial_related_product_title svelte-rymqg"),_e(U,"class","vimonial_related_product_price svelte-rymqg"),_e(a,"class","vimonial_related_product svelte-rymqg"),_e(a,"href",A=f[12]+"/products/"+f[32].handle)},m(V,ne){vt(V,a,ne),Le(a,l),Le(l,m),Le(a,S),Le(a,L),Le(L,k),Le(a,x),Le(a,U),K.m(U,null),Le(a,E)},p(V,ne){ne[0]&2&&!Vn(m.src,T=V[32].featured_image+"&width=200")&&_e(m,"src",T),ne[0]&2&&I!==(I=V[32].title+"")&&Ar(k,I),te===(te=w(V,ne))&&K?K.p(V,ne):(K.d(1),K=te(V),K&&(K.c(),K.m(U,null))),ne[0]&2&&A!==(A=V[12]+"/products/"+V[32].handle)&&_e(a,"href",A)},d(V){V&&pt(a),K.d()}}}function By(f){let a,l,m=Lr(f[3].price,f[7])+"",T;return{c(){a=Oe("div"),l=Oe("span"),T=ur(m),_e(l,"class","price-item price-item--regular"),_e(a,"class","price__regular svelte-rymqg")},m(S,L){vt(S,a,L),Le(a,l),Le(l,T)},p(S,L){L[0]&8&&m!==(m=Lr(S[3].price,S[7])+"")&&Ar(T,m)},d(S){S&&pt(a)}}}function Gy(f){let a,l,m,T,S=Lr(f[3].compare_at_price,f[7])+"",L,I,k,x,U,O=Lr(f[3].price,f[7])+"",E;return{c(){a=Oe("div"),l=Oe("dt"),l.innerHTML='<span class="visually-hidden visually-hidden--inline svelte-rymqg">Regular price</span>',m=yt(),T=Oe("span"),L=ur(S),I=yt(),k=Oe("dt"),k.innerHTML='<span class="visually-hidden visually-hidden--inline svelte-rymqg">Sale price</span>',x=yt(),U=Oe("span"),E=ur(O),_e(l,"class","price__compare"),_e(T,"class","price-item price-item--regular svelte-rymqg"),_e(U,"class","price-item price-item--sale"),_e(a,"class","price__sale price--on-sale svelte-rymqg")},m(A,w){vt(A,a,w),Le(a,l),Le(a,m),Le(a,T),Le(T,L),Le(a,I),Le(a,k),Le(a,x),Le(a,U),Le(U,E)},p(A,w){w[0]&8&&S!==(S=Lr(A[3].compare_at_price,A[7])+"")&&Ar(L,S),w[0]&8&&O!==(O=Lr(A[3].price,A[7])+"")&&Ar(E,O)},d(A){A&&pt(a)}}}function Ky(f){let a,l,m=f[2].status==="success"&&jf(f);return{c(){m&&m.c(),a=Wo()},m(T,S){m&&m.m(T,S),vt(T,a,S),l=!0},p(T,S){T[2].status==="success"?m?(m.p(T,S),S[0]&4&&Gt(m,1)):(m=jf(T),m.c(),Gt(m,1),m.m(a.parentNode,a)):m&&(Hn(),tr(m,1,1,()=>{m=null}),qn())},i(T){l||(Gt(m),l=!0)},o(T){tr(m),l=!1},d(T){m&&m.d(T),T&&pt(a)}}}const nd=f=>f.variant_ids.length==0;function Hy(f,a,l){var Ae,qe,je,Xe,Ve;let m,T,S,L,I=((Ae=window.Shopify)==null?void 0:Ae.currency)||{active:"USD"},{index:k}=a,{variable:x=!1}=a,U=ws("openIndex");oi(f,U,Ie=>l(21,L=Ie));let O=ws("vimonialSlideStore");oi(f,O,Ie=>l(20,S=Ie));let E=S[k],{shopId:A}=a,{options:w}=a,te,K={},V=w.isMobile,ne=!1,Y=!1;const re=()=>l(6,Y=!Y),ie=window.location.href.split("/")[0];let Z=[],N=`${w.shopUrl}/recommendations/products.json?product_id=${(qe=E.productShopify)==null?void 0:qe.id}&limit=12`,W=`${w.shopUrl}/products/${(je=E.productShopify)==null?void 0:je.handle}.json`;const me=async Ie=>{var He;Ie&&(Z=await Promise.all((He=Ie.variants)==null?void 0:He.map(ce=>{var ve,Be;const De={};return(ve=Ie.options)==null||ve.forEach(Te=>{De[Te.name]=ce["option"+String(Te.position)]}),{...ce,images:(Be=Ie.images)==null?void 0:Be.filter(Te=>Te.variant_ids.includes(ce.id)),options:De}})),Z.length>0&&(l(3,te=Z[0]),Object.keys(te.options).forEach(ce=>{l(4,K[ce]=te.options[ce],K)})))};let xe=Gf({queryKey:["products",(Xe=E.productShopify)==null?void 0:Xe.handle],queryFn:async()=>await fetch(W).then(Ie=>Ie.json()).then(Ie=>{if(Ie.product)return Ie.product}),onSuccess:async Ie=>{await me(Ie)},staleTime:1e3*60*3,onError:()=>{console.log("PRODUCT_ERROR")}});oi(f,xe,Ie=>l(2,T=Ie));let j=Gf({queryKey:["recommendations",(Ve=E.productShopify)==null?void 0:Ve.id],queryFn:()=>fetch(N).then(Ie=>Ie.json()).then(Ie=>{if(Ie.products)return Ie.products;console.log("no products")}),onError:Ie=>{console.log("RECOM ERROR"),console.log(Ie)},staleTime:1e3*60*3});oi(f,j,Ie=>l(1,m=Ie));function C(Ie,He){l(4,K={...K,[Ie]:He});const ce={...K,[Ie]:He};Z.map(De=>{JSON.stringify(De.options)===JSON.stringify(ce)&&l(3,te=De)})}const q=Ie=>{let He={items:[{id:te.id,quantity:1}]};Bo("A",A,E.id,te.id,te.price),fetch(window.Shopify.routes.root+"cart/add.js",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(He)}).then(ce=>{ce.json(),ce.status==200&&(window.location.href="/cart")}).catch(ce=>{console.error("Error:",ce)})},H=()=>{l(5,ne=!ne)},ye=()=>{l(5,ne=!ne)},he=(Ie,He)=>{C(Ie.name,He)},Ee=()=>{q()};return f.$$set=Ie=>{"index"in Ie&&l(17,k=Ie.index),"variable"in Ie&&l(18,x=Ie.variable),"shopId"in Ie&&l(19,A=Ie.shopId),"options"in Ie&&l(0,w=Ie.options)},f.$$.update=()=>{var Ie,He;f.$$.dirty[0]&3538951&&x&&(L||L==0)&&(l(17,k=L),E=S[k],N=`${w.shopUrl}/recommendations/products.json?product_id=${(Ie=S[k].productShopify)==null?void 0:Ie.id}&limit=12`,W=`${w.shopUrl}/products/${(He=S[k].productShopify)==null?void 0:He.handle}.json`,T.refetch().then(ce=>{m.refetch()}))},[w,m,T,te,K,ne,Y,I,U,O,V,re,ie,xe,j,C,q,k,x,A,S,L,H,ye,he,Ee]}class Nd extends Xi{constructor(a){super(),Qi(this,a,Hy,Ky,Ii,{index:17,variable:18,shopId:19,options:0},null,[-1,-1])}}function qy(f){let a,l,m;return{c(){a=Oe("span"),a.innerHTML='<svg width="24" height="24" viewBox="0 0 32 32" fill="none"><path d="M2 10H7.81818L17 3V29L7.81818 22H2V10ZM8.49361 12L15 7.03968V24.9603L8.49361 20H4V12H8.49361Z" fill="white"></path><path d="M20.8219 10.4325C20.4314 10.042 19.7982 10.042 19.4077 10.4325C19.0172 10.8231 19.0172 11.4562 19.4077 11.8468L23.643 16.0821L19.4077 20.3174C19.0172 20.708 19.0172 21.3411 19.4077 21.7316C19.7982 22.1222 20.4314 22.1222 20.8219 21.7316L25.0573 17.4963L29.2926 21.7316C29.6831 22.1222 30.3163 22.1222 30.7068 21.7316C31.0973 21.3411 31.0973 20.708 30.7068 20.3174L26.4715 16.0821L30.7068 11.8468C31.0973 11.4562 31.0973 10.8231 30.7068 10.4325C30.3163 10.042 29.6831 10.042 29.2926 10.4325L25.0573 14.6679L20.8219 10.4325Z" fill="white"></path></svg>',_e(a,"class","icon_sound")},m(T,S){vt(T,a,S),l||(m=nr(a,"click",f[21]),l=!0)},p:mr,d(T){T&&pt(a),l=!1,m()}}}function Vy(f){let a,l,m;return{c(){a=Oe("span"),a.innerHTML='<svg width="24" height="24" viewBox="0 0 32 32" fill="none"><path d="M7.81818 10H2V22H7.81818L17 29V3L7.81818 10Z" fill="white"></path><path d="M21.8642 15.3638C21.8642 13.7454 21.0183 12.3245 19.7446 11.5191C19.1424 11.1383 18.7963 10.3527 19.1446 9.73111C19.4028 9.27025 19.9605 9.05403 20.4304 9.29546C22.6312 10.4263 24.1369 12.7192 24.1369 15.3638C24.1369 18.0084 22.6312 20.3014 20.4304 21.4322C19.9605 21.6736 19.4028 21.4574 19.1446 20.9965C18.7963 20.375 19.1424 19.5893 19.7446 19.2085C21.0183 18.4031 21.8642 16.9822 21.8642 15.3638Z" fill="white"></path><path d="M23.3875 8.37237C25.8645 9.72016 27.5457 12.3459 27.5457 15.3643C27.5457 18.3826 25.8645 21.0084 23.3875 22.3562C22.8014 22.6751 22.4991 23.3888 22.7871 23.9907C23.0394 24.518 23.6578 24.7694 24.18 24.5067C27.524 22.825 29.8184 19.3626 29.8184 15.3643C29.8184 11.366 27.524 7.90355 24.18 6.2218C23.6578 5.95916 23.0394 6.21054 22.7871 6.73783C22.4991 7.3397 22.8014 8.05347 23.3875 8.37237Z" fill="white"></path></svg>',_e(a,"class","icon_sound")},m(T,S){vt(T,a,S),l||(m=nr(a,"click",f[21]),l=!0)},p:mr,d(T){T&&pt(a),l=!1,m()}}}function id(f){let a,l,m,T,S;m=new Nd({props:{options:f[2],shopId:f[0],index:f[1],variable:!1}});let L=f[2].displayQuote&&f[17].highlightQuote&&sd(f);return{c(){a=Oe("div"),l=Oe("div"),zi(m.$$.fragment),T=yt(),L&&L.c(),_e(l,"class","vimonial_shoppable_card svelte-14llvjk"),lt(l,"z-index","104"),_e(a,"class","vimonial_card_content svelte-14llvjk")},m(I,k){vt(I,a,k),Le(a,l),ki(m,l,null),Le(l,T),L&&L.m(l,null),f[32](a),S=!0},p(I,k){const x={};k[0]&4&&(x.options=I[2]),k[0]&1&&(x.shopId=I[0]),k[0]&2&&(x.index=I[1]),m.$set(x),I[2].displayQuote&&I[17].highlightQuote?L?L.p(I,k):(L=sd(I),L.c(),L.m(l,null)):L&&(L.d(1),L=null)},i(I){S||(Gt(m.$$.fragment,I),S=!0)},o(I){tr(m.$$.fragment,I),S=!1},d(I){I&&pt(a),Ci(m),L&&L.d(),f[32](null)}}}function sd(f){let a,l;return{c(){a=Oe("div"),l=Oe("p"),l.textContent=`${f[17].highlightQuote}`,_e(a,"class","vimonial_callout"),lt(a,"background-color","rgb(93, 93, 255)")},m(m,T){vt(m,a,T),Le(a,l)},p:mr,d(m){m&&pt(a)}}}function Wy(f){let a,l,m,T,S,L,I,k,x,U,O,E,A,w,te,K=`url(${f[17].previewImg})`,V,ne,Y,re;function ie(j,C){return j[12]?qy:Vy}let Z=ie(f),N=Z(f),W=!f[2].isMobile&&f[2].displayCard&&f[17].productShopify&&f[1]==f[13]&&id(f),me=[{class:"vimonial_popup "},{style:"background: linear-gradient(180deg, rgba(0, 0, 0, 0.6) 2.67%, rgba(0, 0, 0, 0.9) 100%);z-index:100;"},f[22]],xe={};for(let j=0;j<me.length;j+=1)xe=Mo(xe,me[j]);return{c(){a=Oe("div"),l=Oe("div"),m=Oe("div"),T=Oe("div"),S=Oe("video"),L=yt(),I=Oe("div"),k=Oe("span"),k.innerHTML='<svg width="100%" height="100%" viewBox="0 0 80 80" fill="none"><circle opacity="0.7" cx="40" cy="40" r="40" fill="black"></circle><path d="M31.25 25.5162C31.25 24.7389 32.098 24.2588 32.7645 24.6587L57.6188 39.5713C57.9424 39.7655 57.9424 40.2345 57.6188 40.4287L32.7645 55.3413C32.098 55.7412 31.25 55.2611 31.25 54.4838V25.5162Z" fill="white"></path></svg>',x=yt(),U=Oe("div"),O=Oe("div"),O.innerHTML='<div class="vimonial_player_controls_progress_curr_future" style="position: absolute;"></div>',E=yt(),A=Oe("div"),w=Oe("span"),w.innerHTML='<svg width="20" height="20" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" fill="white" version="1.1" id="Capa_1" viewBox="0 0 460.775 460.775" xml:space="preserve"><path d="M285.08,230.397L456.218,59.27c6.076-6.077,6.076-15.911,0-21.986L423.511,4.565c-2.913-2.911-6.866-4.55-10.992-4.55  c-4.127,0-8.08,1.639-10.993,4.55l-171.138,171.14L59.25,4.565c-2.913-2.911-6.866-4.55-10.993-4.55  c-4.126,0-8.08,1.639-10.992,4.55L4.558,37.284c-6.077,6.075-6.077,15.909,0,21.986l171.138,171.128L4.575,401.505  c-6.074,6.077-6.074,15.911,0,21.986l32.709,32.719c2.911,2.911,6.865,4.55,10.992,4.55c4.127,0,8.08-1.639,10.994-4.55  l171.117-171.12l171.118,171.12c2.913,2.911,6.866,4.55,10.993,4.55c4.128,0,8.081-1.639,10.992-4.55l32.709-32.719  c6.074-6.075,6.074-15.909,0-21.986L285.08,230.397z"></path></svg>',te=yt(),N.c(),V=yt(),W&&W.c(),_e(S,"class","vimonial_video svelte-14llvjk"),_e(S,"preload","auto"),S.loop="true",S.muted="true",S.playsInline="true",_e(S,"webkit-playsinline",""),_e(S,"x5-playsinline",""),lt(S,"width","100%",1),lt(S,"height","100%",1),lt(S,"z-index","101"),lt(S,"background-color",f[2].videoLoadingColor),_e(k,"class","vimonial_player_controls_play_icon"),lt(k,"z-index","104"),_e(O,"class","vimonial_player_controls_progress_curr"),lt(O,"left","0%"),lt(O,"width","0%"),_e(U,"class","vimonial_player_controls_progress svelte-14llvjk"),lt(U,"display","none"),_e(w,"class","icon_close"),_e(A,"class","vimonial_player_sound"),lt(A,"display","flex"),lt(A,"flex-direction","column"),lt(A,"gap","8px"),lt(A,"z-index","104"),lt(A,"cursor","pointer"),_e(I,"class","vimonial_player_controls svelte-14llvjk"),lt(I,"z-index","102"),_e(T,"class","vimonial_card_video svelte-14llvjk"),lt(T,"background-image",K),_e(m,"class","vimonial_video_wrapper svelte-14llvjk"),_e(l,"class","vimonial_popup_inner svelte-14llvjk"),pf(a,xe),gf(a,"svelte-14llvjk",!0)},m(j,C){vt(j,a,C),Le(a,l),Le(l,m),Le(m,T),Le(T,S),f[26](S),Le(T,L),Le(T,I),Le(I,k),f[27](k),Le(I,x),Le(I,U),Le(U,O),f[28](O),Le(I,E),Le(I,A),Le(A,w),Le(A,te),N.m(A,null),f[30](T),f[31](m),Le(l,V),W&&W.m(l,null),f[33](l),ne=!0,Y||(re=[nr(S,"pause",f[4]),nr(S,"click",f[4]),nr(S,"loadedmetadata",f[18]),nr(S,"timeupdate",f[20]),nr(k,"click",f[3]),nr(k,"timeupdate",f[20]),nr(O,"click",f[19]),nr(w,"click",f[29])],Y=!0)},p(j,C){C[0]&4&&lt(S,"background-color",j[2].videoLoadingColor),Z===(Z=ie(j))&&N?N.p(j,C):(N.d(1),N=Z(j),N&&(N.c(),N.m(A,null))),!j[2].isMobile&&j[2].displayCard&&j[17].productShopify&&j[1]==j[13]?W?(W.p(j,C),C[0]&8198&&Gt(W,1)):(W=id(j),W.c(),Gt(W,1),W.m(l,null)):W&&(Hn(),tr(W,1,1,()=>{W=null}),qn()),pf(a,xe=P0(me,[{class:"vimonial_popup "},{style:"background: linear-gradient(180deg, rgba(0, 0, 0, 0.6) 2.67%, rgba(0, 0, 0, 0.9) 100%);z-index:100;"},C[0]&4194304&&j[22]])),gf(a,"svelte-14llvjk",!0)},i(j){ne||(Gt(W),ne=!0)},o(j){tr(W),ne=!1},d(j){j&&pt(a),f[26](null),f[27](null),f[28](null),N.d(),f[30](null),f[31](null),W&&W.d(),f[33](null),Y=!1,yn(re)}}}function jy(f,a,l){const m=["shopId","index","options","hidePlayButton","showPlayButton","unloadVideo","loadVideo","loadVideoNoPlay"];let T=df(a,m),S,L;const I=Au();let{shopId:k}=a,x=ws("vimonialSlideStore");oi(f,x,He=>l(37,S=He));let{index:U}=a,O=ws("openIndex");oi(f,O,He=>l(13,L=He));let E=S[U];window.location.href.split("/")[0];let{options:A={displayProduct:!1,displayDiscount:!1,displayReviews:!1,displayQuote:!1,displayCard:!1,autoplay:!0,videoLoadingColor:"black",currencySymbol:"$",buyNowText:"Buy Now"}}=a,w,te,K,V,ne,Y,re,ie,Z=!0;function N(He){l(5,w.muted=!1,w),l(6,te.style.display="none",te),w.play(),l(12,Z=w.muted),l(7,K.parentNode.style.display="block",K)}function W(){w.duration}function me(){w.pause(),l(5,w.muted=!0,w),l(6,te.style.display="inline-block",te)}function xe(He){var ce=(He.pageX-w.offsetParent.offsetParent.offsetParent.offsetLeft)/w.offsetWidth;l(5,w.currentTime=ce*w.duration,w)}function j(){l(7,K.style.width=Math.floor(w.currentTime/w.duration*100)+"%",K)}function C(){l(5,w.muted=!w.muted,w),l(12,Z=w.muted)}function q(){l(5,w.src="",w),w.load()}function H(){ai.isSupported()?(V=new ai({debug:!1,capLevelToPlayerSize:!0,maxBufferLength:3,maxBufferSize:60,startLevel:A.isMobile?void 0:0}),V.loadSource(E.mediaTranscoded),V.on(ai.Events.MANIFEST_LOADED,function(){N()}),V.attachMedia(w)):w.canPlayType("application/vnd.apple.mpegurl")&&(l(5,w.src=E.mediaTranscoded,w),w.addEventListener("loadedmetadata",function(){N()}))}function ye(){ai.isSupported()?(V=new ai({debug:!1,capLevelToPlayerSize:!0,maxBufferLength:10,maxBufferSize:60,startLevel:A.isMobile?void 0:0}),V.loadSource(E.mediaTranscoded),V.on(ai.Events.MANIFEST_LOADED,function(){}),V.attachMedia(w)):w.canPlayType("application/vnd.apple.mpegurl")&&(l(5,w.src=E.mediaTranscoded,w),w.addEventListener("canplay",function(){})),l(5,w.poster=E.previewImg,w),w.load()}Aa(()=>{A.isMobile||w.addEventListener("resize",function(He){ie.style.setProperty("height",this.videoHeight*ne.offsetWidth/this.videoWidth+"px"),Y.style.setProperty("height",this.videoHeight*ne.offsetWidth/this.videoWidth+"px"),A.displayCard&&E.productShopify&&re.style.setProperty("height",this.videoHeight*ne.offsetWidth/this.videoWidth+"px")},!1)});function he(He){Fr[He?"unshift":"push"](()=>{w=He,l(5,w)})}function Ee(He){Fr[He?"unshift":"push"](()=>{te=He,l(6,te)})}function Ae(He){Fr[He?"unshift":"push"](()=>{K=He,l(7,K)})}const qe=()=>{me(),I("close")};function je(He){Fr[He?"unshift":"push"](()=>{ie=He,l(11,ie)})}function Xe(He){Fr[He?"unshift":"push"](()=>{ne=He,l(8,ne)})}function Ve(He){Fr[He?"unshift":"push"](()=>{re=He,l(10,re)})}function Ie(He){Fr[He?"unshift":"push"](()=>{Y=He,l(9,Y)})}return f.$$set=He=>{a=Mo(Mo({},a),T0(He)),l(22,T=df(a,m)),"shopId"in He&&l(0,k=He.shopId),"index"in He&&l(1,U=He.index),"options"in He&&l(2,A=He.options)},[k,U,A,N,me,w,te,K,ne,Y,re,ie,Z,L,I,x,O,E,W,xe,j,C,T,q,H,ye,he,Ee,Ae,qe,je,Xe,Ve,Ie]}class Yy extends Xi{constructor(a){super(),Qi(this,a,jy,Wy,Ii,{shopId:0,index:1,options:2,hidePlayButton:3,showPlayButton:4,unloadVideo:23,loadVideo:24,loadVideoNoPlay:25},null,[-1,-1])}get hidePlayButton(){return this.$$.ctx[3]}get showPlayButton(){return this.$$.ctx[4]}get unloadVideo(){return this.$$.ctx[23]}get loadVideo(){return this.$$.ctx[24]}get loadVideoNoPlay(){return this.$$.ctx[25]}}const zy=300,Qy=60,Ud="none";function ma(f,a,l){return f.addEventListener(a,l),()=>f.removeEventListener(a,l)}function Xy(f,a){return a.filter(l=>f.pointerId!==l.pointerId)}function ko(f,a,l,m,T){f.dispatchEvent(new CustomEvent(`${a}${T}`,{detail:{event:l,pointersCount:m.length}}))}function Zy(f,a,l,m,T,S=Ud){a.style.touchAction=S;let L=[];function I(x){L.push(x),ko(a,f,x,L,"down"),m==null||m(L,x);const U=x.pointerId;function O(V){U===V.pointerId&&(L=Xy(V,L),L.length||E(),ko(a,f,V,L,"up"),T==null||T(L,V))}function E(){A(),w(),te(),K()}const A=ma(a,"pointermove",V=>{L=L.map(ne=>V.pointerId===ne.pointerId?V:ne),ko(a,f,V,L,"move"),l==null||l(L,V)}),w=ma(a,"lostpointercapture",V=>{O(V)}),te=ma(a,"pointerup",V=>{O(V)}),K=ma(a,"pointerleave",V=>{L=[],E(),ko(a,f,V,L,"up"),T==null||T(L,V)})}const k=ma(a,"pointerdown",I);return{destroy:()=>{k()}}}function Jy(f,a={timeframe:zy,minSwipeDistance:Qy,touchAction:Ud}){const l="swipe";let m,T,S,L;function I(x,U){T=U.clientX,S=U.clientY,m=Date.now(),x.length===1&&(L=U.target)}function k(x,U){if(U.type==="pointerup"&&x.length===0&&Date.now()-m<a.timeframe){const O=U.clientX-T,E=U.clientY-S,A=Math.abs(O),w=Math.abs(E);let te=null;A>=2*w&&A>a.minSwipeDistance?te=O>0?"right":"left":w>=2*A&&w>a.minSwipeDistance&&(te=E>0?"bottom":"top"),te&&f.dispatchEvent(new CustomEvent(l,{detail:{direction:te,target:L}}))}}return Zy(l,f,null,I,k,a.touchAction)}const{Boolean:ad,window:qo}=O0;function od(f,a,l){const m=f.slice();return m[49]=a[l],m[50]=a,m[51]=l,m}function ld(f,a,l){const m=f.slice();return m[49]=a[l],m[52]=a,m[51]=l,m}function ud(f){let a,l=f[51],m;const T=()=>f[27](a,l),S=()=>f[27](null,l);let L={index:f[51],options:{displayDiscount:f[0].displayDiscount==="true",displayQuote:f[0].displayQuote==="true",autoplay:f[0].autoplay==="true",displayCard:!0,displayReviews:!0,displayProduct:!0,currencySymbol:"$",videoLoadingColor:f[0].loadBackgroundColor,shopUrl:f[0].shopUrl,buyNowText:f[0].buyNowText,isMobile:f[2]},transitionDuration:"1",shopId:f[17]};return a=new Yy({props:L}),T(),a.$on("close",f[20]),{c(){zi(a.$$.fragment)},m(I,k){ki(a,I,k),m=!0},p(I,k){l!==I[51]&&(S(),l=I[51],T());const x={};k[0]&5&&(x.options={displayDiscount:I[0].displayDiscount==="true",displayQuote:I[0].displayQuote==="true",autoplay:I[0].autoplay==="true",displayCard:!0,displayReviews:!0,displayProduct:!0,currencySymbol:"$",videoLoadingColor:I[0].loadBackgroundColor,shopUrl:I[0].shopUrl,buyNowText:I[0].buyNowText,isMobile:I[2]}),a.$set(x)},i(I){m||(Gt(a.$$.fragment,I),m=!0)},o(I){tr(a.$$.fragment,I),m=!1},d(I){S(),Ci(a,I)}}}function cd(f){let a,l,m,T;return m=new Nd({props:{options:{displayDiscount:f[0].displayDiscount==="true",displayQuote:f[0].displayQuote==="true",autoplay:f[0].autoplay==="true",displayCard:!0,displayReviews:!0,displayProduct:!0,currencySymbol:"$",videoLoadingColor:f[0].loadBackgroundColor,shopUrl:f[0].shopUrl,buyNowText:f[0].buyNowText,isMobile:f[2]},shopId:f[17],variable:!0,index:f[12]}}),{c(){a=Oe("div"),l=Oe("div"),zi(m.$$.fragment),_e(l,"class","vimonial_shoppable_card"),lt(l,"z-index","104"),_e(a,"class","vimonial_card_content")},m(S,L){vt(S,a,L),Le(a,l),ki(m,l,null),T=!0},p(S,L){const I={};L[0]&5&&(I.options={displayDiscount:S[0].displayDiscount==="true",displayQuote:S[0].displayQuote==="true",autoplay:S[0].autoplay==="true",displayCard:!0,displayReviews:!0,displayProduct:!0,currencySymbol:"$",videoLoadingColor:S[0].loadBackgroundColor,shopUrl:S[0].shopUrl,buyNowText:S[0].buyNowText,isMobile:S[2]}),L[0]&4096&&(I.index=S[12]),m.$set(I)},i(S){T||(Gt(m.$$.fragment,S),T=!0)},o(S){tr(m.$$.fragment,S),T=!1},d(S){S&&pt(a),Ci(m)}}}function fd(f){let a,l=f[51],m;const T=()=>f[28](a,l),S=()=>f[28](null,l);function L(){return f[29](f[51])}function I(){return f[30](f[51])}function k(){return f[31](f[51])}let x={totalSlides:f[4].length,loaded:!1,index:f[51],point:f[3],data:{id:f[49].id,src:f[49].mediaTranscoded,previewImg:f[49].previewImg,product:f[49].productShopify},options:{innerWidth:f[1],coverflow:Vo,displayDiscount:f[0].displayDiscount==="true",displayQuote:f[0].displayQuote==="true",autoplay:f[0].autoplay==="true",displayProduct:f[0].displayProduct==="true",slideGap:f[0].slideGap,displayReviews:f[0].displayReviews==="true",borderSize:f[0].borderSize,borderColor:f[0].borderColor,displayCard:f[0].displayCard==="true",cardWidth:f[0].width,cardWidthMobile:f[0].widthMobile,isMobile:f[2],currencySymbol:"$",buyNowText:f[0].buyNowText,displayATCSlide:!1,videoLoadingColor:f[0].loadBackgroundColor,popup:f[0].popup==="true"},shopId:f[17]};return a=new H0({props:x}),T(),a.$on("playVid",L),a.$on("selectslide",I),a.$on("open",k),{c(){zi(a.$$.fragment)},m(U,O){ki(a,U,O),m=!0},p(U,O){f=U,l!==f[51]&&(S(),l=f[51],T());const E={};O[0]&16&&(E.totalSlides=f[4].length),O[0]&8&&(E.point=f[3]),O[0]&16&&(E.data={id:f[49].id,src:f[49].mediaTranscoded,previewImg:f[49].previewImg,product:f[49].productShopify}),O[0]&7&&(E.options={innerWidth:f[1],coverflow:Vo,displayDiscount:f[0].displayDiscount==="true",displayQuote:f[0].displayQuote==="true",autoplay:f[0].autoplay==="true",displayProduct:f[0].displayProduct==="true",slideGap:f[0].slideGap,displayReviews:f[0].displayReviews==="true",borderSize:f[0].borderSize,borderColor:f[0].borderColor,displayCard:f[0].displayCard==="true",cardWidth:f[0].width,cardWidthMobile:f[0].widthMobile,isMobile:f[2],currencySymbol:"$",buyNowText:f[0].buyNowText,displayATCSlide:!1,videoLoadingColor:f[0].loadBackgroundColor,popup:f[0].popup==="true"}),a.$set(E)},i(U){m||(Gt(a.$$.fragment,U),m=!0)},o(U){tr(a.$$.fragment,U),m=!1},d(U){S(),Ci(a,U)}}}function $y(f){var Z;let a,l,m,T,S,L,I,k,x,U,O,E,A,w,te=f[4],K=[];for(let N=0;N<te.length;N+=1)K[N]=ud(ld(f,te,N));const V=N=>tr(K[N],1,1,()=>{K[N]=null});let ne=f[5]&&!0&&((Z=f[13][f[12]])==null?void 0:Z.productShopify)&&cd(f),Y=f[4],re=[];for(let N=0;N<Y.length;N+=1)re[N]=fd(od(f,Y,N));const ie=N=>tr(re[N],1,1,()=>{re[N]=null});return x=new ay({props:{isAdmin:!0,displaySpinner:!0}}),x.$on("infinite",f[18]),{c(){a=Oe("div"),l=Oe("div"),m=Oe("div");for(let N=0;N<K.length;N+=1)K[N].c();T=yt(),ne&&ne.c(),S=yt(),L=Oe("div"),I=Oe("div");for(let N=0;N<re.length;N+=1)re[N].c();k=yt(),zi(x.$$.fragment),_e(m,"class","vimonial_popup_container"),lt(m,"transition-duration",(f[2]?"500":"0")+"ms"),lt(m,"transform",f[10]),_e(l,"class","vimonial_popup_wrapper vimonial_text_testimonial"),lt(l,"display",f[5]?"block":"none"),_e(I,"class",U="vimonial_carousel_wrapper "+(f[0].alignItems=="center"&&"vimonial_carousel_wrapper-center")+" "+(f[0].alignItems=="right"&&"vimonial_carousel_wrapper-right")+" "+(f[0].overflow==="true"&&"show_scroll_bar")+" "+(!!Vo&&"vimonial_coverflow")+" svelte-789585"),_e(L,"class",O="vimonial_carousel vimonial_text_testimonial "+(f[0].overflow==="true"&&"vimonial_scrollable")+" svelte-789585"),_e(a,"id","vimonial-carousel-inner"),lt(a,"--vimonial-centered-offset",f[11]+"px"),lt(a,"--quotesBackground",f[0].quotesBackground),lt(a,"--slideGap",f[0].slideGap+"px"),lt(a,"--shadowSize",f[0].shadowSize+"px"),lt(a,"--cardWidth",f[0].width+"px"),lt(a,"--cardWidthMobile",f[0].widthMobile+"px"),lt(a,"--colorPlayButton",f[0].colorPlayButton),lt(a,"--colorPlayButtonInner",f[0].colorPlayButtonInner),lt(a,"--ringColor",f[0].borderColor),lt(a,"--ringSize",f[0].borderSize+"px")},m(N,W){vt(N,a,W),Le(a,l),Le(l,m);for(let me=0;me<K.length;me+=1)K[me]&&K[me].m(m,null);Le(l,T),ne&&ne.m(l,null),Le(a,S),Le(a,L),Le(L,I);for(let me=0;me<re.length;me+=1)re[me]&&re[me].m(I,null);Le(I,k),ki(x,I,null),f[32](I),E=!0,A||(w=[b0(Jy.call(null,m,{timeframe:300,minSwipeDistance:60,touchAction:"none"})),nr(m,"swipe",f[24])],A=!0)},p(N,W){var xe;if(W[0]&1179925){te=N[4];let j;for(j=0;j<te.length;j+=1){const C=ld(N,te,j);K[j]?(K[j].p(C,W),Gt(K[j],1)):(K[j]=ud(C),K[j].c(),Gt(K[j],1),K[j].m(m,null))}for(Hn(),j=te.length;j<K.length;j+=1)V(j);qn()}if((!E||W[0]&4)&&lt(m,"transition-duration",(N[2]?"500":"0")+"ms"),(W[0]&4||W[0]&1028)&&lt(m,"transform",N[10]),N[5]&&((xe=N[13][N[12]])!=null&&xe.productShopify)?ne?(ne.p(N,W),W[0]&12320&&Gt(ne,1)):(ne=cd(N),ne.c(),Gt(ne,1),ne.m(l,null)):ne&&(Hn(),tr(ne,1,1,()=>{ne=null}),qn()),W[0]&32&&lt(l,"display",N[5]?"block":"none"),W[0]&6946975){Y=N[4];let j;for(j=0;j<Y.length;j+=1){const C=od(N,Y,j);re[j]?(re[j].p(C,W),Gt(re[j],1)):(re[j]=fd(C),re[j].c(),Gt(re[j],1),re[j].m(I,k))}for(Hn(),j=Y.length;j<re.length;j+=1)ie(j);qn()}(!E||W[0]&1&&U!==(U="vimonial_carousel_wrapper "+(N[0].alignItems=="center"&&"vimonial_carousel_wrapper-center")+" "+(N[0].alignItems=="right"&&"vimonial_carousel_wrapper-right")+" "+(N[0].overflow==="true"&&"show_scroll_bar")+" "+(!!Vo&&"vimonial_coverflow")+" svelte-789585"))&&_e(I,"class",U),(!E||W[0]&1&&O!==(O="vimonial_carousel vimonial_text_testimonial "+(N[0].overflow==="true"&&"vimonial_scrollable")+" svelte-789585"))&&_e(L,"class",O),(!E||W[0]&2048)&&lt(a,"--vimonial-centered-offset",N[11]+"px"),(!E||W[0]&1)&&lt(a,"--quotesBackground",N[0].quotesBackground),(!E||W[0]&1)&&lt(a,"--slideGap",N[0].slideGap+"px"),(!E||W[0]&1)&&lt(a,"--shadowSize",N[0].shadowSize+"px"),(!E||W[0]&1)&&lt(a,"--cardWidth",N[0].width+"px"),(!E||W[0]&1)&&lt(a,"--cardWidthMobile",N[0].widthMobile+"px"),(!E||W[0]&1)&&lt(a,"--colorPlayButton",N[0].colorPlayButton),(!E||W[0]&1)&&lt(a,"--colorPlayButtonInner",N[0].colorPlayButtonInner),(!E||W[0]&1)&&lt(a,"--ringColor",N[0].borderColor),(!E||W[0]&1)&&lt(a,"--ringSize",N[0].borderSize+"px")},i(N){if(!E){for(let W=0;W<te.length;W+=1)Gt(K[W]);Gt(ne);for(let W=0;W<Y.length;W+=1)Gt(re[W]);Gt(x.$$.fragment,N),E=!0}},o(N){K=K.filter(ad);for(let W=0;W<K.length;W+=1)tr(K[W]);tr(ne),re=re.filter(ad);for(let W=0;W<re.length;W+=1)tr(re[W]);tr(x.$$.fragment,N),E=!1},d(N){N&&pt(a),Yi(K,N),ne&&ne.d(),Yi(re,N),Ci(x),f[32](null),A=!1,yn(w)}}}function e1(f){let a,l,m,T;return ui(f[26]),a=new Oy({props:{client:f[14],$$slots:{default:[$y]},$$scope:{ctx:f}}}),{c(){zi(a.$$.fragment)},m(S,L){ki(a,S,L),l=!0,m||(T=[nr(qo,"keydown",f[25]),nr(qo,"resize",f[26])],m=!0)},p(S,L){const I={};L[0]&15871|L[1]&4194304&&(I.$$scope={dirty:L,ctx:S}),a.$set(I)},i(S){l||(Gt(a.$$.fragment,S),l=!0)},o(S){tr(a.$$.fragment,S),l=!1},d(S){Ci(a,S),m=!1,yn(T)}}}const t1=10,r1="https://vimonial.com/api/testimonials/new?",Vo=!1;function n1(f,a,l){let m,T,S,L,I;const k=new Md,x=Fo([]);oi(f,x,Fe=>l(13,I=Fe));const U=Fo([]),O=Fo(0);oi(f,O,Fe=>l(12,L=Fe));let E=0,A,w=0;Co("vimonialSlideStore",x),Co("vimonialViewedStore",U),Co("openIndex",O);let{props:te}=a;var{productId:K="",shopId:V="",campaignId:ne="",orderBy:Y="date_desc",shopUrl:re="",overflow:ie="false"}=te;let Z=0,N=[],W=!1;ne=="none"&&(ne="");const me=new URLSearchParams({...V!=""&&ne==""&&{shopId:V},...K!=""&&ne==""&&{productId:K},...ne!=""&&{campaignId:ne},...Y!=""&&{orderBy:Y}});Bo("I",V,null,null,null);let xe;const j=Fe=>{let nt=-1*Math.max(Fe-S,0)*(parseInt(m?te.widthMobile:te.width)+parseInt(te.slideGap));xe.scrollTo({left:-nt,behavior:"smooth"}),l(3,w=Fe)};function C({detail:{loaded:Fe,complete:nt}}){fetch(`${r1}${me.toString()}&skip=${Z}&limit=${t1}`).then(ht=>ht.json()).then(ht=>{var Pt,jt;(jt=(Pt=ht.data)==null?void 0:Pt.submissions)!=null&&jt.length?(l(4,N=[...N,...ht.data.submissions]),x.set(N),Z+=1,Fe()):nt()}).catch(ht=>{nt()})}const q=Fe=>{if(!W)document.body.classList.add("vimonial-no-scroll");else try{Ve[L].showPlayButton()}catch{}Fe>=Ve.length?Fe=0:Fe<0&&(Fe=Ve.length-1),ce(Fe),O.set(Fe),l(5,W=!0),qe(-1),Ve.forEach((nt,ht)=>{Fe!=ht&&nt.showPlayButton()})},H=()=>{l(5,W=!1),document.body.classList.remove("vimonial-no-scroll"),Ve[L].showPlayButton(),Ve.forEach((Fe,nt)=>{Fe.showPlayButton()}),Ae(),je()},ye=Fe=>{j(Fe)};let he=[];const Ee=Fe=>{he.forEach((nt,ht)=>{Fe!=ht&&nt.muteVideoDisplayPlayButton()})},Ae=(Fe=-1)=>{Ve.forEach((nt,ht)=>{Fe!=ht&&nt.unloadVideo()})},qe=Fe=>{he.forEach((nt,ht)=>{Fe!=ht&&nt.showPlayButton()})},je=(Fe=-1)=>{he.forEach((nt,ht)=>{Fe!=ht&&nt.checkViewport()})};function Xe(){he.forEach((Fe,nt)=>{Fe.checkViewport()})}Aa(()=>{A=M0(),l(9,Ie=A()),l(2,m=E<768),S=Math.max(Math.ceil(E/(m?te.widthMobile:te.width))/2-1,0),l(3,w=0),j(0),xe.addEventListener("scroll",mf(Xe,100),!1),xe.addEventListener("resize",mf(Xe,100),!1),window.addEventListener("resize",()=>{l(9,Ie=A()),l(10,He=`translate3d(0,${-Ie*L}px,0)`)})});let Ve=[],Ie,He="";const ce=(Fe=0)=>{l(9,Ie=A());let nt=-Ie*Fe;if(!Ve[Fe].loaded)Ve[Fe].loadVideo();else try{Ve[Fe].loaded&&Ve[Fe].hidePlayButton()}catch{}l(10,He=`translate3d(0,${nt}px,0)`);try{Fe+1<Ve.length&&Ve[Fe+1].loadVideoNoPlay()}catch{}},De=Fe=>{W&&(Fe.key==="Escape"?H():Fe.key==="ArrowLeft"?q(L-1):Fe.key==="ArrowRight"&&q(L+1))};console.log("%c   Vimonial Video Carousel Initialized  ","color: #FF8675; font-size: 20px; background-color: #180040; padding:2px; border-radius:5px;");function ve(Fe){Fe.detail.direction==="bottom"?q(L-1):Fe.detail.direction==="top"&&q(L+1)}const Be=Fe=>De(Fe);function Te(){l(1,E=qo.innerWidth),l(9,Ie=qo.innerHeight)}function ze(Fe,nt){Fr[Fe?"unshift":"push"](()=>{Ve[nt]=Fe,l(8,Ve)})}function We(Fe,nt){Fr[Fe?"unshift":"push"](()=>{he[nt]=Fe,l(7,he)})}const $e=Fe=>Ee(Fe),it=Fe=>ye(Fe),ue=Fe=>q(Fe);function ot(Fe){Fr[Fe?"unshift":"push"](()=>{xe=Fe,l(6,xe)})}return f.$$set=Fe=>{"props"in Fe&&l(0,te=Fe.props)},f.$$.update=()=>{f.$$.dirty[0]&2&&l(2,m=E<768),f.$$.dirty[0]&7&&l(11,T=Math.ceil((E-(m?te.widthMobile:te.width))/2/2)),f.$$.dirty[0]&7&&(S=Math.max(Math.ceil(E/(m?te.widthMobile:te.width))/2-1,0))},[te,E,m,w,N,W,xe,he,Ve,Ie,He,T,L,I,k,x,O,V,C,q,H,ye,Ee,De,ve,Be,Te,ze,We,$e,it,ue,ot]}class Bd extends Xi{constructor(a){super(),Qi(this,a,n1,e1,Ii,{props:0},null,[-1,-1])}}let Eu=document.querySelectorAll("#vimonial-carousel");Eu.forEach((f,a)=>{var{addReview:l=!1,alignItems:m="center",productId:T="",shopId:S="",campaignId:L="",showNames:I=!0,showVerified:k=!0,showBox:x=!1,displayProduct:U="true",displayDiscount:O="true",displayReviews:E="false",displayQuote:A="true",displayCard:w="true",autoplay:te="true",popup:K="true",width:V="300",widthMobile:ne="200",slideGap:Y="10",namesSizeMobile:re="text-base",namesSize:ie="text-base",shadowSize:Z="10",colorVerified:N="#76a9fa",colorVerifiedTick:W="#1e439f",colorPlayButton:me="#000000",colorPlayButtonInner:xe="#FFFFFF",orderBy:j="date_desc",borderColor:C="#000",borderSize:q="0",loadBackgroundColor:H="transparent",quotesBackground:ye="#5d5dff",shopUrl:he="",buyNowText:Ee="Buy Now",overflow:Ae="false"}=f.dataset;return new Bd({target:f,props:{props:{addReview:l,alignItems:m,productId:T,shopId:S,campaignId:L,showNames:I,showVerified:k,showBox:x,displayProduct:U,displayDiscount:O,displayReviews:E,displayQuote:A,displayCard:w,autoplay:te,popup:K,width:V,widthMobile:ne,slideGap:Y,namesSizeMobile:re,namesSize:ie,shadowSize:Z,colorVerified:N,colorVerifiedTick:W,colorPlayButton:me,colorPlayButtonInner:xe,orderBy:j,borderColor:C,borderSize:q,loadBackgroundColor:H,quotesBackground:ye,shopUrl:he,buyNowText:Ee,overflow:Ae}}})});window.reInitVimonial=function(){Eu=document.querySelectorAll("#vimonial-carousel"),Eu.forEach((f,a)=>{if(console.log(f),!(f.childElementCount>0)){console.log(f.childElementCount);var{addReview:l=!1,alignItems:m="center",productId:T="",shopId:S="",campaignId:L="",showNames:I=!0,showVerified:k=!0,showBox:x=!1,displayProduct:U="true",displayDiscount:O="true",displayReviews:E="false",displayQuote:A="true",displayCard:w="true",autoplay:te="true",popup:K="true",width:V="300",widthMobile:ne="200",slideGap:Y="10",namesSizeMobile:re="text-base",namesSize:ie="text-base",shadowSize:Z="10",colorVerified:N="#76a9fa",colorVerifiedTick:W="#1e439f",colorPlayButton:me="#000000",colorPlayButtonInner:xe="#FFFFFF",orderBy:j="date_desc",borderColor:C="#000",borderSize:q="0",loadBackgroundColor:H="transparent",quotesBackground:ye="#5d5dff",shopUrl:he="",buyNowText:Ee="Buy Now",overflow:Ae="false"}=f.dataset;return new Bd({target:f,props:{props:{addReview:l,alignItems:m,productId:T,shopId:S,campaignId:L,showNames:I,showVerified:k,showBox:x,displayProduct:U,displayDiscount:O,displayReviews:E,displayQuote:A,displayCard:w,autoplay:te,popup:K,width:V,widthMobile:ne,slideGap:Y,namesSizeMobile:re,namesSize:ie,shadowSize:Z,colorVerified:N,colorVerifiedTick:W,colorPlayButton:me,colorPlayButtonInner:xe,orderBy:j,borderColor:C,borderSize:q,loadBackgroundColor:H,quotesBackground:ye,shopUrl:he,buyNowText:Ee,overflow:Ae}}})}})};
